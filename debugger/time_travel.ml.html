<!-- generated by the vscode.pl tool from vscoded.-->

<html>
 <head>
  <title>ocaml/debugger/time_travel.ml - ocaml</title>
  <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
  <style>
body {
    text-align: left;
    text-align-last: left;
}

.nav-bar {
    font-size: 120%;
    margin-top: 5px;
    margin-bottom: 5px;
}

.nav-link {
    padding-left: 5em;
    padding-right: 5em;
}

ul.toc {
    line-height: 200%;
    font-size: 150%;
}

code {
    font-family: consolas, monospace;
    line-height: 130%;
}

span.Constant {
    color: DarkGreen;
}

span.Special {
    color: #c06000;
}

span.Comment {
    color: DarkRed;
    font-style: italic;
}

span.Identifier {
    color: DarkCyan;
}

span.PreProc {
    color: DarkMagenta;
}

span.Statement, span.Type, span.Keyword, span.Repeat, span.Conditional,
    span.Operator, span.Exception
{
    color: DarkBlue;
}

span.Todo {
    color: DarkRed;
    background-color: Gold;
    font-style: italic;
}

span.Underlined {
    text-decoration: underline;
}

span.linkable {
    font-weight: bold;
}

code ol {
    counter-reset: item;
    list-style-type: none;
    margin-left: 0;
    padding-left: 0;
    list-style-position: inside;
}

code li {
    display: block;
}

code li:before {
    content: counter(item) "  ";
    counter-increment: item;
    color: #999;
    padding-right: 0.5em;
    padding-left: 0.4em;
    list-style-position: inside;
    text-align: right
}

  </style>
 </head>
 <body>
 <p class="nav-bar">
  <span class="nav-link"><a href="./index.html">One Level Up</a></span>
  <span class="nav-link"><a href="index.html">Top Level</a></span>
 </p>

  <h1>ocaml/debugger/time_travel.ml - ocaml</h1>
 <h2>Global variables defined</h2>
 <ul class="toc">
<li><a href="#L191">accepted</a></li>
<li><a href="#L534">back_run</a></li>
<li><a href="#L170">chk_merge</a></li>
<li><a href="#L156">chk_merge2</a></li>
<li><a href="#L129">cut</a></li>
<li><a href="#L143">cut2</a></li>
<li><a href="#L45">debug_time_travel</a></li>
<li><a href="#L225">duplicate_current_checkpoint</a></li>
<li><a href="#L205">find_checkpoint_before</a></li>
<li><a href="#L486">find_last_breakpoint</a></li>
<li><a href="#L549">finish</a></li>
<li><a href="#L417">forget_process</a></li>
<li><a href="#L52">insert_checkpoint</a></li>
<li><a href="#L473">internal_go_to</a></li>
<li><a href="#L321">internal_step</a></li>
<li><a href="#L194">kept</a></li>
<li><a href="#L411">kill_all_checkpoints</a></li>
<li><a href="#L110">kill_checkpoint</a></li>
<li><a href="#L176">new_checkpoint_list</a></li>
<li><a href="#L510">new_time</a></li>
<li><a href="#L640">pc</a></li>
<li><a href="#L655">previous_1</a></li>
<li><a href="#L450">recover</a></li>
<li><a href="#L35">remove_1st</a></li>
<li><a href="#L69">remove_checkpoint</a></li>
<li><a href="#L527">run</a></li>
<li><a href="#L96">set_current_checkpoint</a></li>
<li><a href="#L391">set_file_descriptor</a></li>
<li><a href="#L617">start</a></li>
<li><a href="#L540">step</a></li>
<li><a href="#L520">step_backward</a></li>
<li><a href="#L457">step_forward</a></li>
<li><a href="#L293">stop_on_event</a></li>
<li><a href="#L53">traverse</a></li>
<li><a href="#L75">wait_for_connection</a></li>
</ul>
 <h2>Source code</h2>

  <code><ol><li><span class="Comment">(**************************************************************************)<br/></li>
<li></span><span class="Comment">(*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *)<br/></li>
<li></span><span class="Comment">(*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; OCaml&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *)<br/></li>
<li></span><span class="Comment">(*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *)<br/></li>
<li></span><span class="Comment">(*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; Jerome Vouillon, projet Cristal, INRIA Rocquencourt&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *)<br/></li>
<li></span><span class="Comment">(*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; OCaml port by John Malecki and Xavier Leroy&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *)<br/></li>
<li></span><span class="Comment">(*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *)<br/></li>
<li></span><span class="Comment">(*&nbsp;&nbsp; Copyright 1996 Institut National de Recherche <a href="command_line.ml.html#L808" title="ocaml/debugger/command_line.ml:808">en</a> Informatique et&nbsp; &nbsp;&nbsp; *)<br/></li>
<li></span><span class="Comment">(*&nbsp; &nbsp;&nbsp; <a href="command_line.ml.html#L808" title="ocaml/debugger/command_line.ml:808">en</a> Automatique.&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *)<br/></li>
<li></span><span class="Comment">(*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *)<br/></li>
<li></span><span class="Comment">(*&nbsp;&nbsp; All rights reserved.&nbsp; This file is distributed under the terms of&nbsp; &nbsp; *)<br/></li>
<li></span><span class="Comment">(*&nbsp;&nbsp; the GNU Lesser General Public License <a href="parameters.ml.html#L31" title="ocaml/debugger/parameters.ml:31">version</a> 2.1, with the&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *)<br/></li>
<li></span><span class="Comment">(*&nbsp;&nbsp; special exception on linking described in the file LICENSE.&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *)<br/></li>
<li></span><span class="Comment">(*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *)<br/></li>
<li></span><span class="Comment">(**************************************************************************)<br/></li>
<li></span><br/></li>
<li><span class="Comment">(**************************** Time travel ******************************)<br/></li>
<li></span><br/></li>
<li><span class="Statement">open</span><span class="ocamlNone"> </span><span class="PreProc">Int64ops<br/></li>
<li></span><span class="Statement">open</span><span class="ocamlNone"> </span><span class="PreProc">Instruct<br/></li>
<li></span><span class="Statement">open</span><span class="ocamlNone"> </span><span class="PreProc">Events<br/></li>
<li></span><span class="Statement">open</span><span class="ocamlNone"> </span><span class="PreProc">Debugcom<br/></li>
<li></span><span class="Statement">open</span><span class="ocamlNone"> </span><span class="PreProc">Primitives<br/></li>
<li></span><span class="Statement">open</span><span class="ocamlNone"> </span><span class="PreProc">Checkpoints<br/></li>
<li></span><span class="Statement">open</span><span class="ocamlNone"> </span><span class="PreProc">Breakpoints<br/></li>
<li></span><span class="Statement">open</span><span class="ocamlNone"> </span><span class="PreProc">Trap_barrier<br/></li>
<li></span><span class="Statement">open</span><span class="ocamlNone"> </span><span class="PreProc">Input_handling<br/></li>
<li></span><span class="Statement">open</span><span class="ocamlNone"> </span><span class="PreProc">Debugger_config<br/></li>
<li></span><span class="Statement">open</span><span class="ocamlNone"> </span><span class="PreProc">Program_loading<br/></li>
<li></span><span class="Statement">open</span><span class="ocamlNone"> </span><span class="PreProc">Question<br/></li>
<li></span><br/></li>
<li><span class="Statement">exception</span> <span class="Constant">Current_checkpoint_lost<br/></li>
<li></span><span class="Statement">exception</span> <span class="Constant">Current_checkpoint_lost_start_at</span> <span class="Statement">of</span> <span class="Type">int64</span> <span class="Statement">*</span> <span class="Type">int64<br/></li>
<li></span><br/></li>
<li><a id="L35">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">remove_1st</span></span> <span class="ocamlLCIdentifier">key</span> <span class="Type">list</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="Statement">rec</span> <span class="ocamlLCIdentifier"><a href="breakpoints.ml.html#L195" title="ocaml/debugger/breakpoints.ml:195">remove</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">function<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Constant">[]</span>&nbsp;&nbsp; <span class="Statement">-&gt;</span> <span class="Constant">[]<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="ocamlLCIdentifier">a</span><span class="Statement">::</span><span class="ocamlLCIdentifier">l</span> <span class="Statement">-&gt;</span> <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">a</span><span class="ocamlNone"> </span><span class="Statement">==</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">key</span><span class="ocamlNone"> </span><span class="Statement">then</span> <span class="ocamlLCIdentifier">l</span> <span class="Statement">else</span> <span class="ocamlLCIdentifier">a</span><span class="Statement">::(</span><span class="ocamlLCIdentifier"><a href="breakpoints.ml.html#L195" title="ocaml/debugger/breakpoints.ml:195">remove</a></span> <span class="ocamlLCIdentifier">l</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="breakpoints.ml.html#L195" title="ocaml/debugger/breakpoints.ml:195">remove</a></span> <span class="Type">list<br/></li>
<li></span><br/></li>
<li><span class="Comment">(*** Debugging. ***)<br/></li>
<li></span><br/></li>
<li><a id="L45">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">debug_time_travel</span></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">ref</span> <span class="Constant">false<br/></li>
<li></span><br/></li>
<li><span class="Comment">(*** Internal utilities. ***)<br/></li>
<li></span><br/></li>
<li><span class="Comment">(* Insert a <a href="checkpoints.mli.html#L36" title="ocaml/debugger/checkpoints.mli:36">checkpoint</a> in the <a href="checkpoints.mli.html#L36" title="ocaml/debugger/checkpoints.mli:36">checkpoint</a> list.<br/></li>
<li></span><span class="Comment"> * Raise `Exit' if there is already a <a href="checkpoints.mli.html#L36" title="ocaml/debugger/checkpoints.mli:36">checkpoint</a> at the <a href="debugcom.ml.html#L377" title="ocaml/debugger/debugcom.ml:377">same</a> <a href="parameters.ml.html#L30" title="ocaml/debugger/parameters.ml:30">time</a>.<br/></li>
<li></span><span class="Comment"> *)<br/></li>
<li><a id="L52">&#x200c;</a></span><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">insert_checkpoint</span></span> <span class="Statement">({</span><span class="ocamlLCIdentifier">c_time</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="parameters.ml.html#L30" title="ocaml/debugger/parameters.ml:30">time</a></span><span class="Statement">}</span> <span class="Statement">as</span> <span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L36" title="ocaml/debugger/checkpoints.mli:36">checkpoint</a></span><span class="Statement">)</span> <span class="Statement">=<br/></li>
<li><a id="L53">&#x200c;</a></span>&nbsp; <span class="Statement">let</span> <span class="Statement">rec</span> <span class="ocamlLCIdentifier"><span class="linkable">traverse</span></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">function<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Constant">[]</span> <span class="Statement">-&gt;</span> <span class="Statement">[</span><span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L36" title="ocaml/debugger/checkpoints.mli:36">checkpoint</a></span><span class="Statement">]<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Statement">(({</span><span class="ocamlLCIdentifier">c_time</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="debugcom.ml.html#L55" title="ocaml/debugger/debugcom.ml:55">t</a></span><span class="Statement">}</span> <span class="Statement">as</span> <span class="ocamlLCIdentifier">a</span><span class="Statement">)::</span><span class="ocamlLCIdentifier">l</span><span class="Statement">)</span> <span class="Statement">as</span> <span class="ocamlLCIdentifier">l</span>' <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier"><a href="debugcom.ml.html#L55" title="ocaml/debugger/debugcom.ml:55">t</a></span><span class="ocamlNone"> </span><span class="Statement">&gt;</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier"><a href="parameters.ml.html#L30" title="ocaml/debugger/parameters.ml:30">time</a></span><span class="ocamlNone"> </span><span class="Statement">then<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">a</span><span class="Statement">::(</span><span class="ocamlLCIdentifier"><a href="#L53" title="ocaml/debugger/time_travel.ml:53">traverse</a></span> <span class="ocamlLCIdentifier">l</span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">else</span> <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier"><a href="debugcom.ml.html#L55" title="ocaml/debugger/debugcom.ml:55">t</a></span><span class="ocamlNone"> </span><span class="Statement">=</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier"><a href="parameters.ml.html#L30" title="ocaml/debugger/parameters.ml:30">time</a></span><span class="ocamlNone"> </span><span class="Statement">then<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">raise</span> <span class="Constant">Exit<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L36" title="ocaml/debugger/checkpoints.mli:36">checkpoint</a></span><span class="Statement">::</span><span class="ocamlLCIdentifier">l</span>'<br/></li>
<li>&nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L54" title="ocaml/debugger/checkpoints.mli:54">checkpoints</a></span> <span class="Statement">:=</span> <span class="ocamlLCIdentifier"><a href="#L53" title="ocaml/debugger/time_travel.ml:53">traverse</a></span> <span class="Statement">!</span><span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L54" title="ocaml/debugger/checkpoints.mli:54">checkpoints</a><br/></li>
<li></span><br/></li>
<li><span class="Comment">(* Remove a <a href="checkpoints.mli.html#L36" title="ocaml/debugger/checkpoints.mli:36">checkpoint</a> from the <a href="checkpoints.mli.html#L36" title="ocaml/debugger/checkpoints.mli:36">checkpoint</a> list.<br/></li>
<li></span><span class="Comment"> * --- No <a href="loadprinter.ml.html#L23" title="ocaml/debugger/loadprinter.ml:23">error</a> if not found.<br/></li>
<li></span><span class="Comment"> *)<br/></li>
<li><a id="L69">&#x200c;</a></span><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">remove_checkpoint</span></span> <span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L36" title="ocaml/debugger/checkpoints.mli:36">checkpoint</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L54" title="ocaml/debugger/checkpoints.mli:54">checkpoints</a></span> <span class="Statement">:=</span> <span class="ocamlLCIdentifier"><a href="#L35" title="ocaml/debugger/time_travel.ml:35">remove_1st</a></span> <span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L36" title="ocaml/debugger/checkpoints.mli:36">checkpoint</a></span> <span class="Statement">!</span><span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L54" title="ocaml/debugger/checkpoints.mli:54">checkpoints</a><br/></li>
<li></span><br/></li>
<li><span class="Comment">(* Wait for the process used by `<a href="checkpoints.mli.html#L36" title="ocaml/debugger/checkpoints.mli:36">checkpoint</a>' to connect.<br/></li>
<li></span><span class="Comment"> * --- Usually not called (the process is already connected).<br/></li>
<li></span><span class="Comment"> *)<br/></li>
<li><a id="L75">&#x200c;</a></span><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">wait_for_connection</span></span> <span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L36" title="ocaml/debugger/checkpoints.mli:36">checkpoint</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">try<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Exec</span>.<span class="ocamlLCIdentifier"><a href="exec.mli.html#L20" title="ocaml/debugger/exec.mli:20">unprotect</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">(function</span> <span class="Constant">()</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">old_controller</span> <span class="Statement">=</span> <span class="PreProc">Input_handling</span>.<span class="ocamlLCIdentifier"><a href="input_handling.ml.html#L41" title="ocaml/debugger/input_handling.ml:41">current_controller</a></span> <span class="Statement">!</span><span class="ocamlLCIdentifier"><a href="program_loading.ml.html#L187" title="ocaml/debugger/program_loading.ml:187">connection</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier"><a href="input_handling.ml.html#L46" title="ocaml/debugger/input_handling.ml:46">execute_with_other_controller</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">(function<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">fd</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">old_controller</span> <span class="ocamlLCIdentifier">fd</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L36" title="ocaml/debugger/checkpoints.mli:36">checkpoint</a></span><span class="ocamlNone">.</span><span class="ocamlLCIdentifier">c_valid</span><span class="ocamlNone"> </span><span class="Statement">=</span><span class="ocamlNone"> </span><span class="Constant">true</span><span class="ocamlNone"> </span><span class="Statement">then<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="input_handling.ml.html#L57" title="ocaml/debugger/input_handling.ml:57">exit_main_loop</a></span> <span class="Constant">()</span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">!</span><span class="ocamlLCIdentifier"><a href="program_loading.ml.html#L187" title="ocaml/debugger/program_loading.ml:187">connection</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier"><a href="input_handling.ml.html#L61" title="ocaml/debugger/input_handling.ml:61">main_loop</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Sys</span>.<span class="Constant">Break</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L36" title="ocaml/debugger/checkpoints.mli:36">checkpoint</a></span>.<span class="ocamlLCIdentifier">c_parent</span> <span class="Statement">&lt;-</span> <span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L51" title="ocaml/debugger/checkpoints.mli:51">root</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L69" title="ocaml/debugger/time_travel.ml:69">remove_checkpoint</a></span> <span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L36" title="ocaml/debugger/checkpoints.mli:36">checkpoint</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L36" title="ocaml/debugger/checkpoints.mli:36">checkpoint</a></span>.<span class="ocamlLCIdentifier">c_pid</span> <span class="Statement">&lt;-</span> -<span class="Constant">1</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">raise</span> <span class="PreProc">Sys</span>.<span class="Constant">Break<br/></li>
<li></span><br/></li>
<li><span class="Comment">(* Select a <a href="checkpoints.mli.html#L36" title="ocaml/debugger/checkpoints.mli:36">checkpoint</a> as current. *)<br/></li>
<li><a id="L96">&#x200c;</a></span><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">set_current_checkpoint</span></span> <span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L36" title="ocaml/debugger/checkpoints.mli:36">checkpoint</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="Statement">!</span><span class="ocamlLCIdentifier"><a href="#L45" title="ocaml/debugger/time_travel.ml:45">debug_time_travel</a></span><span class="ocamlNone"> </span><span class="Statement">then<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier">prerr_endline</span> <span class="Statement">(</span><span class="Constant">&quot;Select: &quot;</span> <span class="Statement">^</span> <span class="Statement">(</span><span class="PreProc">Int</span>.<span class="ocamlLCIdentifier">to_string</span> <span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L36" title="ocaml/debugger/checkpoints.mli:36">checkpoint</a></span>.<span class="ocamlLCIdentifier">c_pid</span><span class="Statement">));<br/></li>
<li></span>&nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="Statement">not</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L36" title="ocaml/debugger/checkpoints.mli:36">checkpoint</a></span><span class="ocamlNone">.</span><span class="ocamlLCIdentifier">c_valid</span><span class="ocamlNone"> </span><span class="Statement">then<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L75" title="ocaml/debugger/time_travel.ml:75">wait_for_connection</a></span> <span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L36" title="ocaml/debugger/checkpoints.mli:36">checkpoint</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L55" title="ocaml/debugger/checkpoints.mli:55">current_checkpoint</a></span> <span class="Statement">:=</span> <span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L36" title="ocaml/debugger/checkpoints.mli:36">checkpoint</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">dead_frags</span> <span class="Statement">=</span> <span class="PreProc">List</span>.<span class="ocamlLCIdentifier">filter</span> <span class="Statement">(fun</span> <span class="ocamlLCIdentifier"><a href="command_line.ml.html#L955" title="ocaml/debugger/command_line.ml:955">frag</a></span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">not</span> <span class="Statement">(</span><span class="PreProc">List</span>.<span class="ocamlLCIdentifier">mem</span> <span class="ocamlLCIdentifier"><a href="command_line.ml.html#L955" title="ocaml/debugger/command_line.ml:955">frag</a></span> <span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L36" title="ocaml/debugger/checkpoints.mli:36">checkpoint</a></span>.<span class="ocamlLCIdentifier">c_code_fragments</span><span class="Statement">))<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">(</span><span class="PreProc">Symbols</span>.<span class="ocamlLCIdentifier"><a href="symbols.mli.html#L41" title="ocaml/debugger/symbols.mli:41">code_fragments</a></span> <span class="Constant">()</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="PreProc">List</span>.<span class="ocamlLCIdentifier">iter</span> <span class="PreProc">Symbols</span>.<span class="ocamlLCIdentifier"><a href="symbols.ml.html#L139" title="ocaml/debugger/symbols.ml:139">erase_symbols</a></span> <span class="ocamlLCIdentifier">dead_frags</span><span class="Statement">;<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier"><a href="debugcom.ml.html#L42" title="ocaml/debugger/debugcom.ml:42">set_current_connection</a></span> <span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L36" title="ocaml/debugger/checkpoints.mli:36">checkpoint</a></span>.<span class="ocamlLCIdentifier">c_fd<br/></li>
<li></span><br/></li>
<li><span class="Comment">(* Kill `<a href="checkpoints.mli.html#L36" title="ocaml/debugger/checkpoints.mli:36">checkpoint</a>'. *)<br/></li>
<li><a id="L110">&#x200c;</a></span><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">kill_checkpoint</span></span> <span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L36" title="ocaml/debugger/checkpoints.mli:36">checkpoint</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="Statement">!</span><span class="ocamlLCIdentifier"><a href="#L45" title="ocaml/debugger/time_travel.ml:45">debug_time_travel</a></span><span class="ocamlNone"> </span><span class="Statement">then<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier">prerr_endline</span> <span class="Statement">(</span><span class="Constant">&quot;Kill: &quot;</span> <span class="Statement">^</span> <span class="Statement">(</span><span class="PreProc">Int</span>.<span class="ocamlLCIdentifier">to_string</span> <span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L36" title="ocaml/debugger/checkpoints.mli:36">checkpoint</a></span>.<span class="ocamlLCIdentifier">c_pid</span><span class="Statement">));<br/></li>
<li></span>&nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L36" title="ocaml/debugger/checkpoints.mli:36">checkpoint</a></span><span class="ocamlNone">.</span><span class="ocamlLCIdentifier">c_pid</span><span class="ocamlNone"> </span><span class="Statement">&gt;</span><span class="ocamlNone"> </span><span class="Constant">0</span><span class="ocamlNone"> </span><span class="Statement">then</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">(* Ghosts don'<a href="debugcom.ml.html#L55" title="ocaml/debugger/debugcom.ml:55">t</a> have to be killed ! *)<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">(if</span><span class="ocamlNone"> </span><span class="Statement">not</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L36" title="ocaml/debugger/checkpoints.mli:36">checkpoint</a></span><span class="ocamlNone">.</span><span class="ocamlLCIdentifier">c_valid</span><span class="ocamlNone"> </span><span class="Statement">then<br/></li>
<li></span>&nbsp; &nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier"><a href="#L75" title="ocaml/debugger/time_travel.ml:75">wait_for_connection</a></span> <span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L36" title="ocaml/debugger/checkpoints.mli:36">checkpoint</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier"><a href="debugcom.ml.html#L174" title="ocaml/debugger/debugcom.ml:174">stop</a></span> <span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L36" title="ocaml/debugger/checkpoints.mli:36">checkpoint</a></span>.<span class="ocamlLCIdentifier">c_fd</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp;&nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L36" title="ocaml/debugger/checkpoints.mli:36">checkpoint</a></span><span class="ocamlNone">.</span><span class="ocamlLCIdentifier">c_parent</span><span class="ocamlNone">.</span><span class="ocamlLCIdentifier">c_pid</span><span class="ocamlNone"> </span><span class="Statement">&gt;</span><span class="ocamlNone"> </span><span class="Constant">0</span><span class="ocamlNone"> </span><span class="Statement">then<br/></li>
<li></span>&nbsp; &nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier"><a href="debugcom.ml.html#L183" title="ocaml/debugger/debugcom.ml:183">wait_child</a></span> <span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L36" title="ocaml/debugger/checkpoints.mli:36">checkpoint</a></span>.<span class="ocamlLCIdentifier">c_parent</span>.<span class="ocamlLCIdentifier">c_fd</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L36" title="ocaml/debugger/checkpoints.mli:36">checkpoint</a></span>.<span class="ocamlLCIdentifier">c_parent</span> <span class="Statement">&lt;-</span> <span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L51" title="ocaml/debugger/checkpoints.mli:51">root</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier"><a href="primitives.mli.html#L66" title="ocaml/debugger/primitives.mli:66">close_io</a></span> <span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L36" title="ocaml/debugger/checkpoints.mli:36">checkpoint</a></span>.<span class="ocamlLCIdentifier">c_fd</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier"><a href="input_handling.ml.html#L33" title="ocaml/debugger/input_handling.ml:33">remove_file</a></span> <span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L36" title="ocaml/debugger/checkpoints.mli:36">checkpoint</a></span>.<span class="ocamlLCIdentifier">c_fd</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier"><a href="#L69" title="ocaml/debugger/time_travel.ml:69">remove_checkpoint</a></span> <span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L36" title="ocaml/debugger/checkpoints.mli:36">checkpoint</a></span><span class="Statement">);<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L36" title="ocaml/debugger/checkpoints.mli:36">checkpoint</a></span>.<span class="ocamlLCIdentifier">c_pid</span> <span class="Statement">&lt;-</span> -<span class="Constant">1</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">(* Don'<a href="debugcom.ml.html#L55" title="ocaml/debugger/debugcom.ml:55">t</a> exist anymore *)<br/></li>
<li></span><br/></li>
<li><span class="Comment">(*** Cleaning the <a href="checkpoints.mli.html#L36" title="ocaml/debugger/checkpoints.mli:36">checkpoint</a> list. ***)<br/></li>
<li></span><br/></li>
<li><span class="Comment">(* Separate <a href="checkpoints.mli.html#L54" title="ocaml/debugger/checkpoints.mli:54">checkpoints</a> before (&lt;=) and after (&gt;) `<a href="debugcom.ml.html#L55" title="ocaml/debugger/debugcom.ml:55">t</a>'. *)<br/></li>
<li></span><span class="Comment">(* ### <a href="debugcom.ml.html#L55" title="ocaml/debugger/debugcom.ml:55">t</a> <a href="checkpoints.mli.html#L54" title="ocaml/debugger/checkpoints.mli:54">checkpoints</a> -&gt; (after, before) *)<br/></li>
<li><a id="L129">&#x200c;</a></span><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">cut</span></span> <span class="ocamlLCIdentifier"><a href="debugcom.ml.html#L55" title="ocaml/debugger/debugcom.ml:55">t</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="Statement">rec</span> <span class="ocamlLCIdentifier">cut_t</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">function<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Constant">[]</span> <span class="Statement">-&gt;</span> <span class="Statement">(</span><span class="Constant">[]</span>, <span class="Constant">[]</span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Statement">({</span><span class="ocamlLCIdentifier">c_time</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="debugcom.ml.html#L55" title="ocaml/debugger/debugcom.ml:55">t</a></span>'<span class="Statement">}</span> <span class="Statement">as</span> <span class="ocamlLCIdentifier">a</span><span class="Statement">::</span><span class="ocamlLCIdentifier">l</span><span class="Statement">)</span> <span class="Statement">as</span> <span class="ocamlLCIdentifier">l</span>' <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier"><a href="debugcom.ml.html#L55" title="ocaml/debugger/debugcom.ml:55">t</a></span><span class="ocamlNone">' </span><span class="Statement">&lt;=</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier"><a href="debugcom.ml.html#L55" title="ocaml/debugger/debugcom.ml:55">t</a></span><span class="ocamlNone"> </span><span class="Statement">then<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="Constant">[]</span>, <span class="ocamlLCIdentifier">l</span>'<span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">b</span>, <span class="ocamlLCIdentifier"><a href="symbols.ml.html#L195" title="ocaml/debugger/symbols.ml:195">e</a></span><span class="Statement">)</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">cut_t</span> <span class="ocamlLCIdentifier">l</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="ocamlLCIdentifier">a</span><span class="Statement">::</span><span class="ocamlLCIdentifier">b</span>, <span class="ocamlLCIdentifier"><a href="symbols.ml.html#L195" title="ocaml/debugger/symbols.ml:195">e</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier">cut_t<br/></li>
<li></span><br/></li>
<li><span class="Comment">(* Partition the <a href="checkpoints.mli.html#L54" title="ocaml/debugger/checkpoints.mli:54">checkpoints</a> list. *)<br/></li>
<li><a id="L143">&#x200c;</a></span><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">cut2</span></span> <span class="ocamlLCIdentifier">t0</span> <span class="ocamlLCIdentifier"><a href="debugcom.ml.html#L55" title="ocaml/debugger/debugcom.ml:55">t</a></span> <span class="ocamlLCIdentifier">l</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="Statement">rec</span> <span class="ocamlLCIdentifier">cut2_t0</span> <span class="ocamlLCIdentifier"><a href="debugcom.ml.html#L55" title="ocaml/debugger/debugcom.ml:55">t</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">function<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Constant">[]</span> <span class="Statement">-&gt;</span> <span class="Constant">[]<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="ocamlLCIdentifier">l</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">let</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">after</span>, <span class="ocamlLCIdentifier">before</span><span class="Statement">)</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="#L129" title="ocaml/debugger/time_travel.ml:129">cut</a></span> <span class="Statement">(</span><span class="ocamlLCIdentifier">t0</span> -- <span class="ocamlLCIdentifier"><a href="debugcom.ml.html#L55" title="ocaml/debugger/debugcom.ml:55">t</a></span> -- <span class="ocamlLCIdentifier">_1</span><span class="Statement">)</span> <span class="ocamlLCIdentifier">l</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">l</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">cut2_t0</span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="debugcom.ml.html#L55" title="ocaml/debugger/debugcom.ml:55">t</a></span> ++ <span class="ocamlLCIdentifier"><a href="debugcom.ml.html#L55" title="ocaml/debugger/debugcom.ml:55">t</a></span><span class="Statement">)</span> <span class="ocamlLCIdentifier">before</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier">after</span><span class="Statement">::</span><span class="ocamlLCIdentifier">l<br/></li>
<li></span>&nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">let</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">after</span>, <span class="ocamlLCIdentifier">before</span><span class="Statement">)</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="#L129" title="ocaml/debugger/time_travel.ml:129">cut</a></span> <span class="Statement">(</span><span class="ocamlLCIdentifier">t0</span> -- <span class="ocamlLCIdentifier">_1</span><span class="Statement">)</span> <span class="ocamlLCIdentifier">l</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">after</span><span class="Statement">::(</span><span class="ocamlLCIdentifier">cut2_t0</span> <span class="ocamlLCIdentifier"><a href="debugcom.ml.html#L55" title="ocaml/debugger/debugcom.ml:55">t</a></span> <span class="ocamlLCIdentifier">before</span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li><span class="Comment">(* Separate first elements and last element of a list of <a href="checkpoints.mli.html#L54" title="ocaml/debugger/checkpoints.mli:54">checkpoints</a>. *)<br/></li>
<li><a id="L156">&#x200c;</a></span><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">chk_merge2</span></span> <span class="ocamlLCIdentifier">cont</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="Statement">rec</span> <span class="ocamlLCIdentifier">chk_merge2_cont</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">function<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Constant">[]</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier">cont<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Statement">[</span><span class="ocamlLCIdentifier">a</span><span class="Statement">]</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L191" title="ocaml/debugger/time_travel.ml:191">accepted</a></span>, <span class="ocamlLCIdentifier">rejected</span><span class="Statement">)</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">cont</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="ocamlLCIdentifier">a</span><span class="Statement">::</span><span class="ocamlLCIdentifier"><a href="#L191" title="ocaml/debugger/time_travel.ml:191">accepted</a></span>, <span class="ocamlLCIdentifier">rejected</span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="ocamlLCIdentifier">a</span><span class="Statement">::</span><span class="ocamlLCIdentifier">l</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L191" title="ocaml/debugger/time_travel.ml:191">accepted</a></span>, <span class="ocamlLCIdentifier">rejected</span><span class="Statement">)</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">chk_merge2_cont</span> <span class="ocamlLCIdentifier">l</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L191" title="ocaml/debugger/time_travel.ml:191">accepted</a></span>, <span class="ocamlLCIdentifier">a</span><span class="Statement">::</span><span class="ocamlLCIdentifier">rejected</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">in</span> <span class="ocamlLCIdentifier">chk_merge2_cont<br/></li>
<li></span><br/></li>
<li><span class="Comment">(* Separate the <a href="checkpoints.mli.html#L36" title="ocaml/debugger/checkpoints.mli:36">checkpoint</a> list. *)<br/></li>
<li></span><span class="Comment">(* ### list -&gt; <a href="#L191" title="ocaml/debugger/time_travel.ml:191">accepted</a> * rejected *)<br/></li>
<li><a id="L170">&#x200c;</a></span><span class="Statement">let</span> <span class="Statement">rec</span> <span class="ocamlLCIdentifier"><span class="linkable">chk_merge</span></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">function<br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">[]</span> <span class="Statement">-&gt;</span> <span class="Statement">(</span><span class="Constant">[]</span>, <span class="Constant">[]</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="ocamlLCIdentifier">l</span><span class="Statement">::</span><span class="ocamlLCIdentifier">tail</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier"><a href="#L156" title="ocaml/debugger/time_travel.ml:156">chk_merge2</a></span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L170" title="ocaml/debugger/time_travel.ml:170">chk_merge</a></span> <span class="ocamlLCIdentifier">tail</span><span class="Statement">)</span> <span class="ocamlLCIdentifier">l<br/></li>
<li></span><br/></li>
<li><a id="L176">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">new_checkpoint_list</span></span> <span class="ocamlLCIdentifier">checkpoint_count</span> <span class="ocamlLCIdentifier"><a href="#L191" title="ocaml/debugger/time_travel.ml:191">accepted</a></span> <span class="ocamlLCIdentifier">rejected</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="PreProc">List</span><span class="ocamlNone">.</span><span class="ocamlLCIdentifier">length</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier"><a href="#L191" title="ocaml/debugger/time_travel.ml:191">accepted</a></span><span class="ocamlNone"> </span><span class="Statement">&gt;=</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">checkpoint_count</span><span class="ocamlNone"> </span><span class="Statement">then<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">let</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">k</span>, <span class="ocamlLCIdentifier">l</span><span class="Statement">)</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="primitives.mli.html#L43" title="ocaml/debugger/primitives.mli:43">list_truncate2</a></span> <span class="ocamlLCIdentifier">checkpoint_count</span> <span class="ocamlLCIdentifier"><a href="#L191" title="ocaml/debugger/time_travel.ml:191">accepted</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="ocamlLCIdentifier">k</span>, <span class="ocamlLCIdentifier">l</span> @ <span class="ocamlLCIdentifier">rejected</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">let</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">k</span>, <span class="ocamlLCIdentifier">l</span><span class="Statement">)</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="primitives.mli.html#L43" title="ocaml/debugger/primitives.mli:43">list_truncate2</a></span> <span class="Statement">(</span><span class="ocamlLCIdentifier">checkpoint_count</span> - <span class="PreProc">List</span>.<span class="ocamlLCIdentifier">length</span> <span class="ocamlLCIdentifier"><a href="#L191" title="ocaml/debugger/time_travel.ml:191">accepted</a></span><span class="Statement">)</span> <span class="ocamlLCIdentifier">rejected<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="PreProc">List</span>.<span class="ocamlLCIdentifier">merge</span> <span class="Statement">(fun</span> <span class="ocamlLCIdentifier">t1</span> <span class="ocamlLCIdentifier">t2</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier"><a href="debugcom.ml.html#L64" title="ocaml/debugger/debugcom.ml:64">compare</a></span> <span class="ocamlLCIdentifier">t2</span>.<span class="ocamlLCIdentifier">c_time</span> <span class="ocamlLCIdentifier">t1</span>.<span class="ocamlLCIdentifier">c_time</span><span class="Statement">)</span> <span class="ocamlLCIdentifier"><a href="#L191" title="ocaml/debugger/time_travel.ml:191">accepted</a></span> <span class="ocamlLCIdentifier">k</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier">l</span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li><span class="Comment">(* Clean the <a href="checkpoints.mli.html#L36" title="ocaml/debugger/checkpoints.mli:36">checkpoint</a> list. *)<br/></li>
<li></span><span class="Comment">(* Reference <a href="parameters.ml.html#L30" title="ocaml/debugger/parameters.ml:30">time</a> is `<a href="parameters.ml.html#L30" title="ocaml/debugger/parameters.ml:30">time</a>'. *)<br/></li>
<li></span><span class="Statement">let</span> <span class="ocamlLCIdentifier">clean_checkpoints</span> <span class="ocamlLCIdentifier"><a href="parameters.ml.html#L30" title="ocaml/debugger/parameters.ml:30">time</a></span> <span class="ocamlLCIdentifier">checkpoint_count</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">after</span>, <span class="ocamlLCIdentifier">before</span><span class="Statement">)</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="#L129" title="ocaml/debugger/time_travel.ml:129">cut</a></span> <span class="ocamlLCIdentifier"><a href="parameters.ml.html#L30" title="ocaml/debugger/parameters.ml:30">time</a></span> <span class="Statement">!</span><span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L54" title="ocaml/debugger/checkpoints.mli:54">checkpoints</a></span> <span class="Statement">in<br/></li>
<li><a id="L191">&#x200c;</a></span>&nbsp; &nbsp; <span class="Statement">let</span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><span class="linkable">accepted</span></span>, <span class="ocamlLCIdentifier">rejected</span><span class="Statement">)</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L170" title="ocaml/debugger/time_travel.ml:170">chk_merge</a></span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L143" title="ocaml/debugger/time_travel.ml:143">cut2</a></span> <span class="ocamlLCIdentifier"><a href="parameters.ml.html#L30" title="ocaml/debugger/parameters.ml:30">time</a></span> <span class="Statement">!</span><span class="ocamlLCIdentifier"><a href="debugger_config.ml.html#L74" title="ocaml/debugger/debugger_config.ml:74">checkpoint_small_step</a></span> <span class="ocamlLCIdentifier">before</span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">in<br/></li>
<li><a id="L194">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><span class="linkable">kept</span></span>, <span class="ocamlLCIdentifier">lost</span><span class="Statement">)</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L176" title="ocaml/debugger/time_travel.ml:176">new_checkpoint_list</a></span> <span class="ocamlLCIdentifier">checkpoint_count</span> <span class="ocamlLCIdentifier"><a href="#L191" title="ocaml/debugger/time_travel.ml:191">accepted</a></span> <span class="ocamlLCIdentifier">after<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="PreProc">List</span>.<span class="ocamlLCIdentifier">iter</span> <span class="ocamlLCIdentifier"><a href="#L110" title="ocaml/debugger/time_travel.ml:110">kill_checkpoint</a></span> <span class="Statement">(</span><span class="ocamlLCIdentifier">lost</span> @ <span class="ocamlLCIdentifier">rejected</span><span class="Statement">);<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L54" title="ocaml/debugger/checkpoints.mli:54">checkpoints</a></span> <span class="Statement">:=</span> <span class="ocamlLCIdentifier"><a href="#L194" title="ocaml/debugger/time_travel.ml:194">kept</a><br/></li>
<li></span><br/></li>
<li><span class="Comment">(*** Internal functions for moving. ***)<br/></li>
<li></span><br/></li>
<li><span class="Comment">(* Find the first <a href="checkpoints.mli.html#L36" title="ocaml/debugger/checkpoints.mli:36">checkpoint</a> before (or at) `<a href="parameters.ml.html#L30" title="ocaml/debugger/parameters.ml:30">time</a>'.<br/></li>
<li></span><span class="Comment"> * Ask for reloading the program if necessary.<br/></li>
<li></span><span class="Comment"> *)<br/></li>
<li><a id="L205">&#x200c;</a></span><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">find_checkpoint_before</span></span> <span class="ocamlLCIdentifier"><a href="parameters.ml.html#L30" title="ocaml/debugger/parameters.ml:30">time</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="Statement">rec</span> <span class="ocamlLCIdentifier">find</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">function<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Constant">[]</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">print_string</span> <span class="Constant">&quot;Can'<a href="debugcom.ml.html#L55" title="ocaml/debugger/debugcom.ml:55">t</a> go that far in the past !&quot;</span><span class="Statement">;</span> <span class="ocamlLCIdentifier">print_newline</span> <span class="Constant">()</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier"><a href="question.mli.html#L17" title="ocaml/debugger/question.mli:17">yes_or_no</a></span><span class="ocamlNone"> </span><span class="Constant">&quot;Reload program&quot;</span><span class="ocamlNone"> </span><span class="Statement">then</span> <span class="Statement">begin<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="program_loading.mli.html#L26" title="ocaml/debugger/program_loading.mli:26">load_program</a></span><span class="ocamlEnd"> </span><span class="Constant">()</span><span class="Statement">;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier">find</span><span class="ocamlEnd"> </span><span class="Statement">!</span><span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L54" title="ocaml/debugger/checkpoints.mli:54">checkpoints</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">end<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">raise</span> <span class="Constant">Toplevel<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Statement">{</span> <span class="ocamlLCIdentifier">c_time</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="debugcom.ml.html#L55" title="ocaml/debugger/debugcom.ml:55">t</a></span> <span class="Statement">}</span> <span class="Statement">as</span> <span class="ocamlLCIdentifier">a</span><span class="Statement">::</span><span class="ocamlLCIdentifier">l</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier"><a href="debugcom.ml.html#L55" title="ocaml/debugger/debugcom.ml:55">t</a></span><span class="ocamlNone"> </span><span class="Statement">&gt;</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier"><a href="parameters.ml.html#L30" title="ocaml/debugger/parameters.ml:30">time</a></span><span class="ocamlNone"> </span><span class="Statement">then<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">find</span> <span class="ocamlLCIdentifier">l<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">a<br/></li>
<li></span>&nbsp; <span class="Statement">in</span> <span class="ocamlLCIdentifier">find</span> <span class="Statement">!</span><span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L54" title="ocaml/debugger/checkpoints.mli:54">checkpoints</a><br/></li>
<li></span><br/></li>
<li><span class="Comment">(* Make a copy of the current <a href="checkpoints.mli.html#L36" title="ocaml/debugger/checkpoints.mli:36">checkpoint</a> and clean the <a href="checkpoints.mli.html#L36" title="ocaml/debugger/checkpoints.mli:36">checkpoint</a> list. *)<br/></li>
<li></span><span class="Comment">(* --- The new <a href="checkpoints.mli.html#L36" title="ocaml/debugger/checkpoints.mli:36">checkpoint</a> is not put in the list. *)<br/></li>
<li><a id="L225">&#x200c;</a></span><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">duplicate_current_checkpoint</span></span> <span class="Constant">()</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L36" title="ocaml/debugger/checkpoints.mli:36">checkpoint</a></span> <span class="Statement">=</span> <span class="Statement">!</span><span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L55" title="ocaml/debugger/checkpoints.mli:55">current_checkpoint</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="Statement">not</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L36" title="ocaml/debugger/checkpoints.mli:36">checkpoint</a></span><span class="ocamlNone">.</span><span class="ocamlLCIdentifier">c_valid</span><span class="ocamlNone"> </span><span class="Statement">then<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L75" title="ocaml/debugger/time_travel.ml:75">wait_for_connection</a></span> <span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L36" title="ocaml/debugger/checkpoints.mli:36">checkpoint</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="time_travel.mli.html#L24" title="ocaml/debugger/time_travel.mli:24">new_checkpoint</a></span> <span class="Statement">=</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">(* Ghost *)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">{</span><span class="ocamlLCIdentifier">c_time</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L36" title="ocaml/debugger/checkpoints.mli:36">checkpoint</a></span>.<span class="ocamlLCIdentifier">c_time</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier">c_pid</span> <span class="Statement">=</span> <span class="Constant">0</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier">c_fd</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L36" title="ocaml/debugger/checkpoints.mli:36">checkpoint</a></span>.<span class="ocamlLCIdentifier">c_fd</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier">c_valid</span> <span class="Statement">=</span> <span class="Constant">false</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier">c_report</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L36" title="ocaml/debugger/checkpoints.mli:36">checkpoint</a></span>.<span class="ocamlLCIdentifier">c_report</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier">c_state</span> <span class="Statement">=</span> <span class="Constant">C_stopped</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier">c_parent</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L36" title="ocaml/debugger/checkpoints.mli:36">checkpoint</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier">c_breakpoint_version</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L36" title="ocaml/debugger/checkpoints.mli:36">checkpoint</a></span>.<span class="ocamlLCIdentifier">c_breakpoint_version</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier">c_breakpoints</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L36" title="ocaml/debugger/checkpoints.mli:36">checkpoint</a></span>.<span class="ocamlLCIdentifier">c_breakpoints</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier">c_trap_barrier</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L36" title="ocaml/debugger/checkpoints.mli:36">checkpoint</a></span>.<span class="ocamlLCIdentifier">c_trap_barrier</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier">c_code_fragments</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L36" title="ocaml/debugger/checkpoints.mli:36">checkpoint</a></span>.<span class="ocamlLCIdentifier">c_code_fragments</span><span class="Statement">}<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L54" title="ocaml/debugger/checkpoints.mli:54">checkpoints</a></span> <span class="Statement">:=</span> <span class="ocamlLCIdentifier"><a href="primitives.mli.html#L47" title="ocaml/debugger/primitives.mli:47">list_replace</a></span> <span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L36" title="ocaml/debugger/checkpoints.mli:36">checkpoint</a></span> <span class="ocamlLCIdentifier"><a href="time_travel.mli.html#L24" title="ocaml/debugger/time_travel.mli:24">new_checkpoint</a></span> <span class="Statement">!</span><span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L54" title="ocaml/debugger/checkpoints.mli:54">checkpoints</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L96" title="ocaml/debugger/time_travel.ml:96">set_current_checkpoint</a></span> <span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L36" title="ocaml/debugger/checkpoints.mli:36">checkpoint</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">clean_checkpoints</span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L36" title="ocaml/debugger/checkpoints.mli:36">checkpoint</a></span>.<span class="ocamlLCIdentifier">c_time</span> ++ <span class="ocamlLCIdentifier">_1</span><span class="Statement">)</span> <span class="Statement">(!</span><span class="ocamlLCIdentifier"><a href="debugger_config.ml.html#L77" title="ocaml/debugger/debugger_config.ml:77">checkpoint_max_count</a></span> - <span class="Constant">1</span><span class="Statement">);<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier"><a href="time_travel.mli.html#L24" title="ocaml/debugger/time_travel.mli:24">new_checkpoint</a></span><span class="ocamlNone">.</span><span class="ocamlLCIdentifier">c_pid</span><span class="ocamlNone"> </span><span class="Statement">=</span><span class="ocamlNone"> </span><span class="Constant">0</span><span class="ocamlNone"> </span><span class="Statement">then</span>&nbsp; <span class="Comment">(* The ghost has not been killed *)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">(match</span> <span class="ocamlLCIdentifier"><a href="debugcom.ml.html#L164" title="ocaml/debugger/debugcom.ml:164">do_checkpoint</a></span> <span class="Constant">()</span> <span class="Statement">with</span>&nbsp; &nbsp; <span class="Comment">(* Duplicate <a href="checkpoints.mli.html#L36" title="ocaml/debugger/checkpoints.mli:36">checkpoint</a> *)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">Checkpoint_done</span> <span class="ocamlLCIdentifier">pid</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="time_travel.mli.html#L24" title="ocaml/debugger/time_travel.mli:24">new_checkpoint</a></span>.<span class="ocamlLCIdentifier">c_pid</span> <span class="Statement">&lt;-</span> <span class="ocamlLCIdentifier">pid</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="Statement">!</span><span class="ocamlLCIdentifier"><a href="#L45" title="ocaml/debugger/time_travel.ml:45">debug_time_travel</a></span><span class="ocamlNone"> </span><span class="Statement">then<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">prerr_endline</span> <span class="Statement">(</span><span class="Constant">&quot;Waiting for <a href="program_loading.ml.html#L187" title="ocaml/debugger/program_loading.ml:187">connection</a>: &quot;</span> <span class="Statement">^</span> <span class="PreProc">Int</span>.<span class="ocamlLCIdentifier">to_string</span> <span class="ocamlLCIdentifier">pid</span><span class="Statement">))<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">|</span> <span class="Constant">Checkpoint_failed</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier">prerr_endline<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">&quot;A fork failed. Reducing maximum number of <a href="checkpoints.mli.html#L54" title="ocaml/debugger/checkpoints.mli:54">checkpoints</a>.&quot;</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier"><a href="debugger_config.ml.html#L77" title="ocaml/debugger/debugger_config.ml:77">checkpoint_max_count</a></span> <span class="Statement">:=</span> <span class="PreProc">List</span>.<span class="ocamlLCIdentifier">length</span> <span class="Statement">!</span><span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L54" title="ocaml/debugger/checkpoints.mli:54">checkpoints</a></span> - <span class="Constant">1</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier"><a href="#L69" title="ocaml/debugger/time_travel.ml:69">remove_checkpoint</a></span> <span class="ocamlLCIdentifier"><a href="time_travel.mli.html#L24" title="ocaml/debugger/time_travel.mli:24">new_checkpoint</a></span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li><span class="Comment">(* Was the movement <a href="exec.ml.html#L19" title="ocaml/debugger/exec.ml:19">interrupted</a> ? *)<br/></li>
<li></span><span class="Comment">(* --- An exception could have been used instead, *)<br/></li>
<li></span><span class="Comment">(* --- but it is not clear where it should be caught. *)<br/></li>
<li></span><span class="Comment">(* --- For instance, it should not be caught in `<a href="#L540" title="ocaml/debugger/time_travel.ml:540">step</a>' *)<br/></li>
<li></span><span class="Comment">(* --- (as `<a href="#L540" title="ocaml/debugger/time_travel.ml:540">step</a>' is used in `next_1'). *)<br/></li>
<li></span><span class="Comment">(* --- On the other side, other <a href="symbols.ml.html#L26" title="ocaml/debugger/symbols.ml:26">modules</a> does not need to know *)<br/></li>
<li></span><span class="Comment">(* --- about this exception. *)<br/></li>
<li></span><span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="exec.ml.html#L19" title="ocaml/debugger/exec.ml:19">interrupted</a></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">ref</span> <span class="Constant">false<br/></li>
<li></span><br/></li>
<li><span class="Comment">(* Information about last <a href="parameters.ml.html#L28" title="ocaml/debugger/parameters.ml:28">breakpoint</a> encountered *)<br/></li>
<li></span><span class="Statement">let</span> <span class="ocamlLCIdentifier">last_breakpoint</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">ref</span> <span class="Constant">None<br/></li>
<li></span><br/></li>
<li><span class="Comment">(* Last debug info <a href="program_management.mli.html#L19" title="ocaml/debugger/program_management.mli:19">loaded</a> *)<br/></li>
<li></span><span class="Statement">let</span> <span class="ocamlLCIdentifier">last_debug_info</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">ref</span> <span class="Constant">None<br/></li>
<li></span><br/></li>
<li><span class="Statement">let</span> <span class="Statement">rec</span> <span class="ocamlLCIdentifier">do_go_dynlink</span> <span class="ocamlLCIdentifier">steps</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">match</span> <span class="ocamlLCIdentifier"><a href="debugcom.mli.html#L72" title="ocaml/debugger/debugcom.mli:72">do_go</a></span> <span class="ocamlLCIdentifier">steps</span> <span class="Statement">with<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Statement">{</span> <span class="ocamlLCIdentifier">rep_type</span> <span class="Statement">=</span> <span class="Constant">Code_loaded</span> <span class="ocamlLCIdentifier"><a href="command_line.ml.html#L955" title="ocaml/debugger/command_line.ml:955">frag</a></span><span class="Statement">;</span> <span class="ocamlLCIdentifier">rep_event_count</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">steps</span> <span class="Statement">}</span> <span class="Statement">as</span> <span class="ocamlLCIdentifier"><a href="main.ml.html#L197" title="ocaml/debugger/main.ml:197">report</a></span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">begin</span><span class="ocamlEnd"> </span><span class="Statement">match</span><span class="ocamlEnd"> </span><span class="Statement">!</span><span class="ocamlLCIdentifier">last_debug_info</span><span class="ocamlEnd"> </span><span class="Statement">with<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Constant">Some</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">di</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="PreProc">Symbols</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier"><a href="symbols.ml.html#L104" title="ocaml/debugger/symbols.ml:104">add_symbols</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="command_line.ml.html#L955" title="ocaml/debugger/command_line.ml:955">frag</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">di</span><span class="Statement">;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="PreProc">Symbols</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier"><a href="symbols.ml.html#L230" title="ocaml/debugger/symbols.ml:230">set_all_events</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="command_line.ml.html#L955" title="ocaml/debugger/command_line.ml:955">frag</a></span><span class="Statement">;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier">last_debug_info</span><span class="ocamlEnd"> </span><span class="Statement">:=</span><span class="ocamlEnd"> </span><span class="Constant">None<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Constant">None</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;</span><span class="ocamlEnd"> </span><span class="Statement">assert</span><span class="ocamlEnd"> </span><span class="Constant">false<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="Statement">end;<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="Statement">!</span><span class="ocamlLCIdentifier"><a href="debugger_config.mli.html#L37" title="ocaml/debugger/debugger_config.mli:37">break_on_load</a></span><span class="ocamlNone"> </span><span class="Statement">then</span> <span class="ocamlLCIdentifier"><a href="main.ml.html#L197" title="ocaml/debugger/main.ml:197">report</a><br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">else</span> <span class="ocamlLCIdentifier">do_go_dynlink</span> <span class="ocamlLCIdentifier">steps<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Statement">{</span> <span class="ocamlLCIdentifier">rep_type</span> <span class="Statement">=</span> <span class="Constant">Code_unloaded</span> <span class="ocamlLCIdentifier"><a href="command_line.ml.html#L955" title="ocaml/debugger/command_line.ml:955">frag</a></span><span class="Statement">;</span> <span class="ocamlLCIdentifier">rep_event_count</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">steps</span> <span class="Statement">}</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Symbols</span>.<span class="ocamlLCIdentifier"><a href="symbols.ml.html#L139" title="ocaml/debugger/symbols.ml:139">erase_symbols</a></span> <span class="ocamlLCIdentifier"><a href="command_line.ml.html#L955" title="ocaml/debugger/command_line.ml:955">frag</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier">do_go_dynlink</span> <span class="ocamlLCIdentifier">steps<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Statement">{</span> <span class="ocamlLCIdentifier">rep_type</span> <span class="Statement">=</span> <span class="Constant">Debug_info</span> <span class="ocamlLCIdentifier">di</span><span class="Statement">;</span> <span class="ocamlLCIdentifier">rep_event_count</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">steps</span> <span class="Statement">}</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier">last_debug_info</span> <span class="Statement">:=</span> <span class="Constant">Some</span> <span class="Statement">(</span><span class="PreProc">Array</span>.<span class="ocamlLCIdentifier">to_list</span> <span class="ocamlLCIdentifier">di</span><span class="Statement">);<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier">do_go_dynlink</span> <span class="ocamlLCIdentifier">steps<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="ocamlLCIdentifier"><a href="main.ml.html#L197" title="ocaml/debugger/main.ml:197">report</a></span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier"><a href="main.ml.html#L197" title="ocaml/debugger/main.ml:197">report</a><br/></li>
<li></span><br/></li>
<li><span class="Comment">(* Ensure we <a href="debugcom.ml.html#L174" title="ocaml/debugger/debugcom.ml:174">stop</a> on an event. *)<br/></li>
<li><a id="L293">&#x200c;</a></span><span class="Statement">let</span> <span class="Statement">rec</span> <span class="ocamlLCIdentifier"><span class="linkable">stop_on_event</span></span> <span class="ocamlLCIdentifier"><a href="main.ml.html#L197" title="ocaml/debugger/main.ml:197">report</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">match</span> <span class="ocamlLCIdentifier"><a href="main.ml.html#L197" title="ocaml/debugger/main.ml:197">report</a></span> <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">{</span><span class="ocamlLCIdentifier">rep_type</span> <span class="Statement">=</span> <span class="Constant">Breakpoint</span><span class="Statement">;</span> <span class="ocamlLCIdentifier">rep_program_pointer</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="debugcom.ml.html#L48" title="ocaml/debugger/debugcom.ml:48">pc</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier">rep_stack_pointer</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">sp</span><span class="Statement">}</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">last_breakpoint</span> <span class="Statement">:=</span> <span class="Constant">Some</span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="debugcom.ml.html#L48" title="ocaml/debugger/debugcom.ml:48">pc</a></span>, <span class="ocamlLCIdentifier">sp</span><span class="Statement">);<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="PreProc">Symbols</span>.<span class="ocamlLCIdentifier"><a href="symbols.mli.html#L71" title="ocaml/debugger/symbols.mli:71">update_current_event</a></span> <span class="Constant">()</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">begin</span><span class="ocamlEnd"> </span><span class="Statement">match</span><span class="ocamlEnd"> </span><span class="Statement">!</span><span class="ocamlLCIdentifier"><a href="events.mli.html#L29" title="ocaml/debugger/events.mli:29">current_event</a></span><span class="ocamlEnd"> </span><span class="Statement">with<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Constant">None</span><span class="ocamlEnd">&nbsp;&nbsp; </span><span class="Statement">-&gt;</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="symbols.ml.html#L187" title="ocaml/debugger/symbols.ml:187">find_event</a></span><span class="ocamlEnd"> </span><span class="Constant">()<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Constant">Some</span><span class="ocamlEnd"> </span><span class="Statement">_</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;</span><span class="ocamlEnd"> </span><span class="Constant">()<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">end<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Statement">{</span><span class="ocamlLCIdentifier">rep_type</span> <span class="Statement">=</span> <span class="Constant">Trap_barrier</span><span class="Statement">}</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Comment">(* No event at current <a href="source.ml.html#L94" title="ocaml/debugger/source.ml:94">position</a>. *)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="symbols.ml.html#L187" title="ocaml/debugger/symbols.ml:187">find_event</a></span> <span class="Constant">()<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Statement">_</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Constant">()<br/></li>
<li></span><br/></li>
<li><span class="Statement">and</span> <span class="ocamlLCIdentifier"><a href="symbols.ml.html#L187" title="ocaml/debugger/symbols.ml:187">find_event</a></span> <span class="Constant">()</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="Statement">!</span><span class="ocamlLCIdentifier"><a href="#L45" title="ocaml/debugger/time_travel.ml:45">debug_time_travel</a></span><span class="ocamlNone"> </span><span class="Statement">then</span> <span class="Statement">begin<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="ocamlLCIdentifier">print_string</span><span class="ocamlEnd"> </span><span class="Constant">&quot;Searching <a href="time_travel.mli.html#L36" title="ocaml/debugger/time_travel.mli:36">next</a> event...&quot;</span><span class="Statement">;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="ocamlLCIdentifier">print_newline</span><span class="ocamlEnd"> </span><span class="Constant">()<br/></li>
<li></span><span class="ocamlEnd">&nbsp; </span><span class="Statement">end;<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="main.ml.html#L197" title="ocaml/debugger/main.ml:197">report</a></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">do_go_dynlink</span> <span class="ocamlLCIdentifier">_1</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">!</span><span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L55" title="ocaml/debugger/checkpoints.mli:55">current_checkpoint</a></span>.<span class="ocamlLCIdentifier">c_report</span> <span class="Statement">&lt;-</span> <span class="Constant">Some</span> <span class="ocamlLCIdentifier"><a href="main.ml.html#L197" title="ocaml/debugger/main.ml:197">report</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier"><a href="#L293" title="ocaml/debugger/time_travel.ml:293">stop_on_event</a></span> <span class="ocamlLCIdentifier"><a href="main.ml.html#L197" title="ocaml/debugger/main.ml:197">report</a><br/></li>
<li></span><br/></li>
<li><span class="Comment">(* Internal function for running debugged program.<br/></li>
<li></span><span class="Comment"> * Requires `duration &gt; 0'.<br/></li>
<li></span><span class="Comment"> *)<br/></li>
<li><a id="L321">&#x200c;</a></span><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">internal_step</span></span> <span class="ocamlLCIdentifier">duration</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">match</span> <span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L58" title="ocaml/debugger/checkpoints.mli:58">current_report</a></span> <span class="Constant">()</span> <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">Some</span> <span class="Statement">{</span><span class="ocamlLCIdentifier">rep_type</span> <span class="Statement">=</span> <span class="Constant">Exited</span> <span class="Statement">|</span> <span class="Constant">Uncaught_exc</span><span class="Statement">}</span> <span class="Statement">-&gt;</span> <span class="Constant">()<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Statement">_</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="PreProc">Exec</span>.<span class="ocamlLCIdentifier"><a href="main.ml.html#L36" title="ocaml/debugger/main.ml:36">protect</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">(function</span> <span class="Constant">()</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="Statement">!</span><span class="ocamlLCIdentifier"><a href="debugger_config.ml.html#L80" title="ocaml/debugger/debugger_config.ml:80">make_checkpoints</a></span><span class="ocamlNone"> </span><span class="Statement">then<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier"><a href="#L225" title="ocaml/debugger/time_travel.ml:225">duplicate_current_checkpoint</a></span> <span class="Constant">()<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier"><a href="#L69" title="ocaml/debugger/time_travel.ml:69">remove_checkpoint</a></span> <span class="Statement">!</span><span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L55" title="ocaml/debugger/checkpoints.mli:55">current_checkpoint</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier"><a href="breakpoints.ml.html#L105" title="ocaml/debugger/breakpoints.ml:105">update_breakpoints</a></span> <span class="Constant">()</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier"><a href="trap_barrier.ml.html#L31" title="ocaml/debugger/trap_barrier.ml:31">update_trap_barrier</a></span> <span class="Constant">()</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">!</span><span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L55" title="ocaml/debugger/checkpoints.mli:55">current_checkpoint</a></span>.<span class="ocamlLCIdentifier">c_state</span> <span class="Statement">&lt;-</span> <span class="Constant">C_running</span> <span class="ocamlLCIdentifier">duration</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="main.ml.html#L197" title="ocaml/debugger/main.ml:197">report</a></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">do_go_dynlink</span> <span class="ocamlLCIdentifier">duration</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">!</span><span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L55" title="ocaml/debugger/checkpoints.mli:55">current_checkpoint</a></span>.<span class="ocamlLCIdentifier">c_report</span> <span class="Statement">&lt;-</span> <span class="Constant">Some</span> <span class="ocamlLCIdentifier"><a href="main.ml.html#L197" title="ocaml/debugger/main.ml:197">report</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">!</span><span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L55" title="ocaml/debugger/checkpoints.mli:55">current_checkpoint</a></span>.<span class="ocamlLCIdentifier">c_state</span> <span class="Statement">&lt;-</span> <span class="Constant">C_stopped</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">!</span><span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L55" title="ocaml/debugger/checkpoints.mli:55">current_checkpoint</a></span>.<span class="ocamlLCIdentifier">c_code_fragments</span> <span class="Statement">&lt;-</span> <span class="PreProc">Symbols</span>.<span class="ocamlLCIdentifier"><a href="symbols.mli.html#L41" title="ocaml/debugger/symbols.mli:41">code_fragments</a></span> <span class="Constant">()</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier"><a href="main.ml.html#L197" title="ocaml/debugger/main.ml:197">report</a></span><span class="ocamlNone">.</span><span class="ocamlLCIdentifier">rep_type</span><span class="ocamlNone"> </span><span class="Statement">=</span><span class="ocamlNone"> </span><span class="Constant">Event</span><span class="ocamlNone"> </span><span class="Statement">then</span> <span class="Statement">begin<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="Statement">!</span><span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L55" title="ocaml/debugger/checkpoints.mli:55">current_checkpoint</a></span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">c_time</span><span class="ocamlEnd"> </span><span class="Statement">&lt;-<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="Statement">!</span><span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L55" title="ocaml/debugger/checkpoints.mli:55">current_checkpoint</a></span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">c_time</span><span class="ocamlEnd"> ++ </span><span class="ocamlLCIdentifier">duration</span><span class="Statement">;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="ocamlLCIdentifier"><a href="exec.ml.html#L19" title="ocaml/debugger/exec.ml:19">interrupted</a></span><span class="ocamlEnd"> </span><span class="Statement">:=</span><span class="ocamlEnd"> </span><span class="Constant">false</span><span class="Statement">;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="ocamlLCIdentifier">last_breakpoint</span><span class="ocamlEnd"> </span><span class="Statement">:=</span><span class="ocamlEnd"> </span><span class="Constant">None<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="Statement">end<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">else</span> <span class="Statement">begin<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="Statement">!</span><span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L55" title="ocaml/debugger/checkpoints.mli:55">current_checkpoint</a></span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">c_time</span><span class="ocamlEnd"> </span><span class="Statement">&lt;-<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">!</span><span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L55" title="ocaml/debugger/checkpoints.mli:55">current_checkpoint</a></span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">c_time</span><span class="ocamlEnd"> ++ </span><span class="ocamlLCIdentifier">duration<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -- </span><span class="ocamlLCIdentifier"><a href="main.ml.html#L197" title="ocaml/debugger/main.ml:197">report</a></span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">rep_event_count</span><span class="ocamlEnd"> ++ </span><span class="ocamlLCIdentifier">_1</span><span class="Statement">;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="ocamlLCIdentifier"><a href="exec.ml.html#L19" title="ocaml/debugger/exec.ml:19">interrupted</a></span><span class="ocamlEnd"> </span><span class="Statement">:=</span><span class="ocamlEnd"> </span><span class="Constant">true</span><span class="Statement">;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="ocamlLCIdentifier">last_breakpoint</span><span class="ocamlEnd"> </span><span class="Statement">:=</span><span class="ocamlEnd"> </span><span class="Constant">None</span><span class="Statement">;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="ocamlLCIdentifier"><a href="#L293" title="ocaml/debugger/time_travel.ml:293">stop_on_event</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="main.ml.html#L197" title="ocaml/debugger/main.ml:197">report</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="Statement">end;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">(try<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L52" title="ocaml/debugger/time_travel.ml:52">insert_checkpoint</a></span> <span class="Statement">!</span><span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L55" title="ocaml/debugger/checkpoints.mli:55">current_checkpoint</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">Exit</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L110" title="ocaml/debugger/time_travel.ml:110">kill_checkpoint</a></span> <span class="Statement">!</span><span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L55" title="ocaml/debugger/checkpoints.mli:55">current_checkpoint</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L96" title="ocaml/debugger/time_travel.ml:96">set_current_checkpoint</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L205" title="ocaml/debugger/time_travel.ml:205">find_checkpoint_before</a></span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L57" title="ocaml/debugger/checkpoints.mli:57">current_time</a></span> <span class="Constant">()</span><span class="Statement">))));<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="Statement">!</span><span class="ocamlLCIdentifier"><a href="#L45" title="ocaml/debugger/time_travel.ml:45">debug_time_travel</a></span><span class="ocamlNone"> </span><span class="Statement">then</span> <span class="Statement">begin<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier">print_string</span><span class="ocamlEnd"> </span><span class="Constant">&quot;Checkpoints: pid(<a href="parameters.ml.html#L30" title="ocaml/debugger/parameters.ml:30">time</a>)&quot;</span><span class="Statement">;</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">print_newline</span><span class="ocamlEnd"> </span><span class="Constant">()</span><span class="Statement">;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="PreProc">List</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">iter<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">(function</span><span class="ocamlEnd"> </span><span class="Statement">{</span><span class="ocamlLCIdentifier">c_time</span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="parameters.ml.html#L30" title="ocaml/debugger/parameters.ml:30">time</a></span><span class="Statement">;</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">c_pid</span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">pid</span><span class="Statement">;</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">c_valid</span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">valid</span><span class="Statement">}</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="PreProc">Printf</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">printf</span><span class="ocamlEnd"> </span><span class="Constant">&quot;%d(%Ld)%<a href="eval.ml.html#L135" title="ocaml/debugger/eval.ml:135">s</a> &quot;</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">pid</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="parameters.ml.html#L30" title="ocaml/debugger/parameters.ml:30">time</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">(if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">valid</span><span class="ocamlNone"> </span><span class="Statement">then</span><span class="ocamlEnd"> </span><span class="Constant">&quot;&quot;</span><span class="ocamlEnd"> </span><span class="Statement">else</span><span class="ocamlEnd"> </span><span class="Constant">&quot;(invalid)&quot;</span><span class="Statement">))<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">!</span><span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L54" title="ocaml/debugger/checkpoints.mli:54">checkpoints</a></span><span class="Statement">;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier">print_newline</span><span class="ocamlEnd"> </span><span class="Constant">()<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">end<br/></li>
<li></span><br/></li>
<li><span class="Comment">(*** Miscellaneous functions (exported). ***)<br/></li>
<li></span><br/></li>
<li><span class="Comment">(* Create a <a href="checkpoints.mli.html#L36" title="ocaml/debugger/checkpoints.mli:36">checkpoint</a> at <a href="parameters.ml.html#L30" title="ocaml/debugger/parameters.ml:30">time</a> 0 (new program). *)<br/></li>
<li></span><span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="time_travel.mli.html#L24" title="ocaml/debugger/time_travel.mli:24">new_checkpoint</a></span> <span class="ocamlLCIdentifier">pid</span> <span class="ocamlLCIdentifier">fd</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="time_travel.mli.html#L24" title="ocaml/debugger/time_travel.mli:24">new_checkpoint</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">{</span><span class="ocamlLCIdentifier">c_time</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">_0</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier">c_pid</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">pid</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier">c_fd</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">fd</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier">c_valid</span> <span class="Statement">=</span> <span class="Constant">true</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier">c_report</span> <span class="Statement">=</span> <span class="Constant">None</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier">c_state</span> <span class="Statement">=</span> <span class="Constant">C_stopped</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier">c_parent</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L51" title="ocaml/debugger/checkpoints.mli:51">root</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier">c_breakpoint_version</span> <span class="Statement">=</span> <span class="Constant">0</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier">c_breakpoints</span> <span class="Statement">=</span> <span class="Constant">[]</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier">c_trap_barrier</span> <span class="Statement">=</span> <span class="PreProc">Sp</span>.<span class="ocamlLCIdentifier"><a href="debugcom.ml.html#L60" title="ocaml/debugger/debugcom.ml:60">null</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier">c_code_fragments</span> <span class="Statement">=</span> <span class="Statement">[</span><span class="ocamlLCIdentifier"><a href="debugcom.ml.html#L75" title="ocaml/debugger/debugcom.ml:75">main_frag</a></span><span class="Statement">]}<br/></li>
<li></span>&nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L52" title="ocaml/debugger/time_travel.ml:52">insert_checkpoint</a></span> <span class="ocamlLCIdentifier"><a href="time_travel.mli.html#L24" title="ocaml/debugger/time_travel.mli:24">new_checkpoint</a><br/></li>
<li></span><br/></li>
<li><span class="Comment">(* Set the file descriptor of a <a href="checkpoints.mli.html#L36" title="ocaml/debugger/checkpoints.mli:36">checkpoint</a> *)<br/></li>
<li></span><span class="Comment">(* (a new process has connected with the debugger). *)<br/></li>
<li></span><span class="Comment">(* --- Return `true' on success (close the <a href="program_loading.ml.html#L187" title="ocaml/debugger/program_loading.ml:187">connection</a> otherwise). *)<br/></li>
<li><a id="L391">&#x200c;</a></span><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">set_file_descriptor</span></span> <span class="ocamlLCIdentifier">pid</span> <span class="ocamlLCIdentifier">fd</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="Statement">rec</span> <span class="ocamlLCIdentifier">find</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">function<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Constant">[]</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">prerr_endline</span> <span class="Constant">&quot;Unexpected <a href="program_loading.ml.html#L187" title="ocaml/debugger/program_loading.ml:187">connection</a>&quot;</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="primitives.mli.html#L66" title="ocaml/debugger/primitives.mli:66">close_io</a></span> <span class="ocamlLCIdentifier">fd</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">false<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Statement">({</span><span class="ocamlLCIdentifier">c_pid</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">pid</span>'<span class="Statement">}</span> <span class="Statement">as</span> <span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L36" title="ocaml/debugger/checkpoints.mli:36">checkpoint</a></span><span class="Statement">)::</span><span class="ocamlLCIdentifier">l</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">pid</span><span class="ocamlNone"> </span><span class="Statement">&lt;&gt;</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">pid</span><span class="ocamlNone">' </span><span class="Statement">then<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">find</span> <span class="ocamlLCIdentifier">l<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L36" title="ocaml/debugger/checkpoints.mli:36">checkpoint</a></span>.<span class="ocamlLCIdentifier">c_fd</span> <span class="Statement">&lt;-</span> <span class="ocamlLCIdentifier">fd</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L36" title="ocaml/debugger/checkpoints.mli:36">checkpoint</a></span>.<span class="ocamlLCIdentifier">c_valid</span> <span class="Statement">&lt;-</span> <span class="Constant">true</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">true</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="Statement">!</span><span class="ocamlLCIdentifier"><a href="#L45" title="ocaml/debugger/time_travel.ml:45">debug_time_travel</a></span><span class="ocamlNone"> </span><span class="Statement">then<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">prerr_endline</span> <span class="Statement">(</span><span class="Constant">&quot;New <a href="program_loading.ml.html#L187" title="ocaml/debugger/program_loading.ml:187">connection</a>: &quot;</span> <span class="Statement">^(</span><span class="PreProc">Int</span>.<span class="ocamlLCIdentifier">to_string</span> <span class="ocamlLCIdentifier">pid</span><span class="Statement">));<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier">find</span> <span class="Statement">(!</span><span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L55" title="ocaml/debugger/checkpoints.mli:55">current_checkpoint</a></span><span class="Statement">::!</span><span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L54" title="ocaml/debugger/checkpoints.mli:54">checkpoints</a></span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li><span class="Comment">(* Kill all the <a href="checkpoints.mli.html#L54" title="ocaml/debugger/checkpoints.mli:54">checkpoints</a>. *)<br/></li>
<li><a id="L411">&#x200c;</a></span><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">kill_all_checkpoints</span></span> <span class="Constant">()</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="PreProc">List</span>.<span class="ocamlLCIdentifier">iter</span> <span class="ocamlLCIdentifier"><a href="#L110" title="ocaml/debugger/time_travel.ml:110">kill_checkpoint</a></span> <span class="Statement">(!</span><span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L55" title="ocaml/debugger/checkpoints.mli:55">current_checkpoint</a></span><span class="Statement">::!</span><span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L54" title="ocaml/debugger/checkpoints.mli:54">checkpoints</a></span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li><span class="Comment">(* Kill a <a href="checkpoints.mli.html#L36" title="ocaml/debugger/checkpoints.mli:36">checkpoint</a> without killing the process. *)<br/></li>
<li></span><span class="Comment">(* (used when <a href="program_loading.ml.html#L187" title="ocaml/debugger/program_loading.ml:187">connection</a> with the process is lost). *)<br/></li>
<li></span><span class="Comment">(* --- Assume that the <a href="checkpoints.mli.html#L36" title="ocaml/debugger/checkpoints.mli:36">checkpoint</a> is valid. *)<br/></li>
<li><a id="L417">&#x200c;</a></span><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">forget_process</span></span> <span class="ocamlLCIdentifier">fd</span> <span class="ocamlLCIdentifier">pid</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L36" title="ocaml/debugger/checkpoints.mli:36">checkpoint</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">List</span>.<span class="ocamlLCIdentifier">find</span> <span class="Statement">(function</span> <span class="ocamlLCIdentifier">c</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier">c</span>.<span class="ocamlLCIdentifier">c_pid</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">pid</span><span class="Statement">)</span> <span class="Statement">(!</span><span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L55" title="ocaml/debugger/checkpoints.mli:55">current_checkpoint</a></span><span class="Statement">::!</span><span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L54" title="ocaml/debugger/checkpoints.mli:54">checkpoints</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">pid</span><span class="ocamlNone"> </span><span class="Statement">&gt;</span><span class="ocamlNone"> </span><span class="Constant">0</span><span class="ocamlNone"> </span><span class="Statement">then</span> <span class="Statement">begin<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="PreProc">Printf</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">eprintf</span><span class="ocamlEnd"> </span><span class="Constant">&quot;Lost <a href="program_loading.ml.html#L187" title="ocaml/debugger/program_loading.ml:187">connection</a> with process %d&quot;</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">pid</span><span class="Statement">;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">kont</span><span class="ocamlEnd"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L36" title="ocaml/debugger/checkpoints.mli:36">checkpoint</a></span><span class="ocamlNone"> </span><span class="Statement">==</span><span class="ocamlNone"> </span><span class="Statement">!</span><span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L55" title="ocaml/debugger/checkpoints.mli:55">current_checkpoint</a></span><span class="ocamlNone"> </span><span class="Statement">then</span><span class="ocamlEnd"> </span><span class="Statement">begin<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="PreProc">Printf</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">eprintf</span><span class="ocamlEnd"> </span><span class="Constant">&quot; (active process)\n&quot;</span><span class="Statement">;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">match</span><span class="ocamlEnd"> </span><span class="Statement">!</span><span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L55" title="ocaml/debugger/checkpoints.mli:55">current_checkpoint</a></span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">c_state</span><span class="ocamlEnd"> </span><span class="Statement">with<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Constant">C_stopped</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="PreProc">Printf</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">eprintf</span><span class="ocamlEnd"> </span><span class="Constant">&quot;at <a href="parameters.ml.html#L30" title="ocaml/debugger/parameters.ml:30">time</a> %Ld&quot;</span><span class="ocamlEnd"> </span><span class="Statement">!</span><span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L55" title="ocaml/debugger/checkpoints.mli:55">current_checkpoint</a></span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">c_time</span><span class="Statement">;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">fun</span><span class="ocamlEnd"> </span><span class="Constant">()</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;</span><span class="ocamlEnd"> </span><span class="Statement">raise</span><span class="ocamlEnd"> </span><span class="Constant">Current_checkpoint_lost<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Constant">C_running</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">duration</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="PreProc">Printf</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">eprintf</span><span class="ocamlEnd"> </span><span class="Constant">&quot;between <a href="parameters.ml.html#L30" title="ocaml/debugger/parameters.ml:30">time</a> %Ld and <a href="parameters.ml.html#L30" title="ocaml/debugger/parameters.ml:30">time</a> %Ld&quot;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">!</span><span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L55" title="ocaml/debugger/checkpoints.mli:55">current_checkpoint</a></span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">c_time<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">(!</span><span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L55" title="ocaml/debugger/checkpoints.mli:55">current_checkpoint</a></span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">c_time</span><span class="ocamlEnd"> ++ </span><span class="ocamlLCIdentifier">duration</span><span class="Statement">);<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">fun</span><span class="ocamlEnd"> </span><span class="Constant">()</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;</span><span class="ocamlEnd"> </span><span class="Statement">raise</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="Constant">Current_checkpoint_lost_start_at<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">(!</span><span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L55" title="ocaml/debugger/checkpoints.mli:55">current_checkpoint</a></span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">c_time</span><span class="ocamlEnd">, </span><span class="ocamlLCIdentifier">duration</span><span class="Statement">))<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">end<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">else</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">ignore</span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="PreProc">Printf</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">eprintf</span><span class="ocamlEnd"> </span><span class="Constant">&quot;\n&quot;</span><span class="Statement">;</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">flush</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">stderr</span><span class="Statement">;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="PreProc">Input_handling</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier"><a href="input_handling.ml.html#L33" title="ocaml/debugger/input_handling.ml:33">remove_file</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">fd</span><span class="Statement">;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="primitives.mli.html#L66" title="ocaml/debugger/primitives.mli:66">close_io</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L36" title="ocaml/debugger/checkpoints.mli:36">checkpoint</a></span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">c_fd</span><span class="Statement">;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="input_handling.ml.html#L33" title="ocaml/debugger/input_handling.ml:33">remove_file</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L36" title="ocaml/debugger/checkpoints.mli:36">checkpoint</a></span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">c_fd</span><span class="Statement">;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="#L69" title="ocaml/debugger/time_travel.ml:69">remove_checkpoint</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L36" title="ocaml/debugger/checkpoints.mli:36">checkpoint</a></span><span class="Statement">;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L36" title="ocaml/debugger/checkpoints.mli:36">checkpoint</a></span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">c_pid</span><span class="ocamlEnd"> </span><span class="Statement">&lt;-</span><span class="ocamlEnd"> -</span><span class="Constant">1</span><span class="Statement">;</span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="Comment">(* Don'<a href="debugcom.ml.html#L55" title="ocaml/debugger/debugcom.ml:55">t</a> exist anymore *)<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L36" title="ocaml/debugger/checkpoints.mli:36">checkpoint</a></span><span class="ocamlNone">.</span><span class="ocamlLCIdentifier">c_parent</span><span class="ocamlNone">.</span><span class="ocamlLCIdentifier">c_pid</span><span class="ocamlNone"> </span><span class="Statement">&gt;</span><span class="ocamlNone"> </span><span class="Constant">0</span><span class="ocamlNone"> </span><span class="Statement">then<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="debugcom.ml.html#L183" title="ocaml/debugger/debugcom.ml:183">wait_child</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L36" title="ocaml/debugger/checkpoints.mli:36">checkpoint</a></span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">c_parent</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">c_fd</span><span class="Statement">;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="ocamlLCIdentifier">kont</span><span class="ocamlEnd"> </span><span class="Constant">()<br/></li>
<li></span><span class="ocamlEnd">&nbsp; </span><span class="Statement">end<br/></li>
<li></span><br/></li>
<li><span class="Comment">(* Try to <a href="#L450" title="ocaml/debugger/time_travel.ml:450">recover</a> when the current <a href="checkpoints.mli.html#L36" title="ocaml/debugger/checkpoints.mli:36">checkpoint</a> is lost. *)<br/></li>
<li><a id="L450">&#x200c;</a></span><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">recover</span></span> <span class="Constant">()</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier"><a href="#L96" title="ocaml/debugger/time_travel.ml:96">set_current_checkpoint</a><br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L205" title="ocaml/debugger/time_travel.ml:205">find_checkpoint_before</a></span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L57" title="ocaml/debugger/checkpoints.mli:57">current_time</a></span> <span class="Constant">()</span><span class="Statement">))<br/></li>
<li></span><br/></li>
<li><span class="Comment">(*** Simple movements. ***)<br/></li>
<li></span><br/></li>
<li><span class="Comment">(* Forward stepping.&nbsp; Requires `duration &gt;= 0'. *)<br/></li>
<li><a id="L457">&#x200c;</a></span><span class="Statement">let</span> <span class="Statement">rec</span> <span class="ocamlLCIdentifier"><span class="linkable">step_forward</span></span> <span class="ocamlLCIdentifier">duration</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">duration</span><span class="ocamlNone"> </span><span class="Statement">&gt;</span><span class="ocamlNone"> </span><span class="Statement">!</span><span class="ocamlLCIdentifier"><a href="debugger_config.ml.html#L74" title="ocaml/debugger/debugger_config.ml:74">checkpoint_small_step</a></span><span class="ocamlNone"> </span><span class="Statement">then</span> <span class="Statement">begin<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">first_step</span><span class="ocamlEnd"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">duration</span><span class="ocamlNone"> </span><span class="Statement">&gt;</span><span class="ocamlNone"> </span><span class="Statement">!</span><span class="ocamlLCIdentifier"><a href="debugger_config.ml.html#L71" title="ocaml/debugger/debugger_config.ml:71">checkpoint_big_step</a></span><span class="ocamlNone"> </span><span class="Statement">then<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">!</span><span class="ocamlLCIdentifier"><a href="debugger_config.ml.html#L71" title="ocaml/debugger/debugger_config.ml:71">checkpoint_big_step</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">else<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">!</span><span class="ocamlLCIdentifier"><a href="debugger_config.ml.html#L74" title="ocaml/debugger/debugger_config.ml:74">checkpoint_small_step</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="#L321" title="ocaml/debugger/time_travel.ml:321">internal_step</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">first_step</span><span class="Statement">;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">if</span><span class="ocamlNone"> </span><span class="Statement">not</span><span class="ocamlNone"> </span><span class="Statement">!</span><span class="ocamlLCIdentifier"><a href="exec.ml.html#L19" title="ocaml/debugger/exec.ml:19">interrupted</a></span><span class="ocamlNone"> </span><span class="Statement">then<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="#L457" title="ocaml/debugger/time_travel.ml:457">step_forward</a></span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">duration</span><span class="ocamlEnd"> -- </span><span class="ocamlLCIdentifier">first_step</span><span class="Statement">)<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="Statement">end<br/></li>
<li></span>&nbsp; <span class="Statement">else</span> <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">duration</span><span class="ocamlNone"> </span><span class="Statement">!=</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">_0</span><span class="ocamlNone"> </span><span class="Statement">then<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L321" title="ocaml/debugger/time_travel.ml:321">internal_step</a></span> <span class="ocamlLCIdentifier">duration<br/></li>
<li></span><br/></li>
<li><span class="Comment">(* Go to <a href="parameters.ml.html#L30" title="ocaml/debugger/parameters.ml:30">time</a> `<a href="parameters.ml.html#L30" title="ocaml/debugger/parameters.ml:30">time</a>' from current <a href="checkpoints.mli.html#L36" title="ocaml/debugger/checkpoints.mli:36">checkpoint</a> (internal). *)<br/></li>
<li><a id="L473">&#x200c;</a></span><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">internal_go_to</span></span> <span class="ocamlLCIdentifier"><a href="parameters.ml.html#L30" title="ocaml/debugger/parameters.ml:30">time</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">duration</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="parameters.ml.html#L30" title="ocaml/debugger/parameters.ml:30">time</a></span> -- <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L57" title="ocaml/debugger/checkpoints.mli:57">current_time</a></span> <span class="Constant">()</span><span class="Statement">)</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">duration</span><span class="ocamlNone"> </span><span class="Statement">&gt;</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">_0</span><span class="ocamlNone"> </span><span class="Statement">then<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="breakpoints.mli.html#L43" title="ocaml/debugger/breakpoints.mli:43">execute_without_breakpoints</a></span> <span class="Statement">(function</span> <span class="Constant">()</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier"><a href="#L457" title="ocaml/debugger/time_travel.ml:457">step_forward</a></span> <span class="ocamlLCIdentifier">duration</span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li><span class="Comment">(* Move to a given <a href="parameters.ml.html#L30" title="ocaml/debugger/parameters.ml:30">time</a>. *)<br/></li>
<li></span><span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="time_travel.mli.html#L30" title="ocaml/debugger/time_travel.mli:30">go_to</a></span> <span class="ocamlLCIdentifier"><a href="parameters.ml.html#L30" title="ocaml/debugger/parameters.ml:30">time</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L36" title="ocaml/debugger/checkpoints.mli:36">checkpoint</a></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="#L205" title="ocaml/debugger/time_travel.ml:205">find_checkpoint_before</a></span> <span class="ocamlLCIdentifier"><a href="parameters.ml.html#L30" title="ocaml/debugger/parameters.ml:30">time</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L96" title="ocaml/debugger/time_travel.ml:96">set_current_checkpoint</a></span> <span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L36" title="ocaml/debugger/checkpoints.mli:36">checkpoint</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L473" title="ocaml/debugger/time_travel.ml:473">internal_go_to</a></span> <span class="ocamlLCIdentifier"><a href="parameters.ml.html#L30" title="ocaml/debugger/parameters.ml:30">time</a><br/></li>
<li></span><br/></li>
<li><span class="Comment">(* Return the <a href="parameters.ml.html#L30" title="ocaml/debugger/parameters.ml:30">time</a> of the last <a href="parameters.ml.html#L28" title="ocaml/debugger/parameters.ml:28">breakpoint</a> *)<br/></li>
<li></span><span class="Comment">(* between current <a href="parameters.ml.html#L30" title="ocaml/debugger/parameters.ml:30">time</a> and `max_time'. *)<br/></li>
<li><a id="L486">&#x200c;</a></span><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">find_last_breakpoint</span></span> <span class="ocamlLCIdentifier">max_time</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="Statement">rec</span> <span class="ocamlLCIdentifier">find</span> <span class="ocamlLCIdentifier"><a href="exec.ml.html#L23" title="ocaml/debugger/exec.ml:23">break</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="parameters.ml.html#L30" title="ocaml/debugger/parameters.ml:30">time</a></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L57" title="ocaml/debugger/checkpoints.mli:57">current_time</a></span> <span class="Constant">()</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L457" title="ocaml/debugger/time_travel.ml:457">step_forward</a></span> <span class="Statement">(</span><span class="ocamlLCIdentifier">max_time</span> -- <span class="ocamlLCIdentifier"><a href="parameters.ml.html#L30" title="ocaml/debugger/parameters.ml:30">time</a></span><span class="Statement">);<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">match</span> <span class="Statement">!</span><span class="ocamlLCIdentifier">last_breakpoint</span>, <span class="Statement">!</span><span class="ocamlLCIdentifier"><a href="breakpoints.mli.html#L56" title="ocaml/debugger/breakpoints.mli:56">temporary_breakpoint_position</a></span> <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="Constant">Some</span> <span class="Statement">_</span>, <span class="Statement">_)</span> <span class="Statement">when</span> <span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L57" title="ocaml/debugger/checkpoints.mli:57">current_time</a></span> <span class="Constant">()</span> <span class="Statement">&lt;</span> <span class="ocamlLCIdentifier">max_time</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">find</span> <span class="Statement">!</span><span class="ocamlLCIdentifier">last_breakpoint<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Statement">(</span><span class="Constant">Some</span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="debugcom.ml.html#L48" title="ocaml/debugger/debugcom.ml:48">pc</a></span>, <span class="Statement">_)</span>, <span class="Constant">Some</span> <span class="ocamlLCIdentifier"><a href="debugcom.ml.html#L48" title="ocaml/debugger/debugcom.ml:48">pc</a></span>'<span class="Statement">)</span> <span class="Statement">when</span> <span class="ocamlLCIdentifier"><a href="debugcom.ml.html#L48" title="ocaml/debugger/debugcom.ml:48">pc</a></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="debugcom.ml.html#L48" title="ocaml/debugger/debugcom.ml:48">pc</a></span>' <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="ocamlLCIdentifier">max_time</span>, <span class="Statement">!</span><span class="ocamlLCIdentifier">last_breakpoint</span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Statement">_</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="parameters.ml.html#L30" title="ocaml/debugger/parameters.ml:30">time</a></span>, <span class="ocamlLCIdentifier"><a href="exec.ml.html#L23" title="ocaml/debugger/exec.ml:23">break</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier">find<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">(match</span> <span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L60" title="ocaml/debugger/checkpoints.mli:60">current_pc_sp</a></span> <span class="Constant">()</span> <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">(</span><span class="Constant">Some</span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="debugcom.ml.html#L48" title="ocaml/debugger/debugcom.ml:48">pc</a></span>, <span class="Statement">_))</span> <span class="Statement">as</span> <span class="ocamlLCIdentifier">state</span> <span class="Statement">when</span> <span class="ocamlLCIdentifier"><a href="breakpoints.mli.html#L31" title="ocaml/debugger/breakpoints.mli:31">breakpoint_at_pc</a></span> <span class="ocamlLCIdentifier"><a href="debugcom.ml.html#L48" title="ocaml/debugger/debugcom.ml:48">pc</a></span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier">state<br/></li>
<li></span>&nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">|</span> <span class="Statement">_</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">-&gt;</span> <span class="Constant">None</span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li><span class="Comment">(* Run from `time_max' back to `<a href="parameters.ml.html#L30" title="ocaml/debugger/parameters.ml:30">time</a>'. *)<br/></li>
<li></span><span class="Comment">(* --- Assume 0 &lt;= <a href="parameters.ml.html#L30" title="ocaml/debugger/parameters.ml:30">time</a> &lt; time_max *)<br/></li>
<li></span><span class="Statement">let</span> <span class="Statement">rec</span> <span class="ocamlLCIdentifier">back_to</span> <span class="ocamlLCIdentifier"><a href="parameters.ml.html#L30" title="ocaml/debugger/parameters.ml:30">time</a></span> <span class="ocamlLCIdentifier">time_max</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">{</span><span class="ocamlLCIdentifier">c_time</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="debugcom.ml.html#L55" title="ocaml/debugger/debugcom.ml:55">t</a></span><span class="Statement">}</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="#L205" title="ocaml/debugger/time_travel.ml:205">find_checkpoint_before</a></span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="int64ops.mli.html#L21" title="ocaml/debugger/int64ops.mli:21">pre64</a></span> <span class="ocamlLCIdentifier">time_max</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="time_travel.mli.html#L30" title="ocaml/debugger/time_travel.mli:30">go_to</a></span> <span class="Statement">(</span><span class="PreProc">Int64</span>.<span class="ocamlLCIdentifier">max</span> <span class="ocamlLCIdentifier"><a href="parameters.ml.html#L30" title="ocaml/debugger/parameters.ml:30">time</a></span> <span class="ocamlLCIdentifier"><a href="debugcom.ml.html#L55" title="ocaml/debugger/debugcom.ml:55">t</a></span><span class="Statement">);<br/></li>
<li><a id="L510">&#x200c;</a></span>&nbsp; &nbsp; <span class="Statement">let</span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><span class="linkable">new_time</span></span>, <span class="ocamlLCIdentifier"><a href="exec.ml.html#L23" title="ocaml/debugger/exec.ml:23">break</a></span><span class="Statement">)</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="#L486" title="ocaml/debugger/time_travel.ml:486">find_last_breakpoint</a></span> <span class="ocamlLCIdentifier">time_max</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier"><a href="exec.ml.html#L23" title="ocaml/debugger/exec.ml:23">break</a></span><span class="ocamlNone"> </span><span class="Statement">&lt;&gt;</span><span class="ocamlNone"> </span><span class="Constant">None</span><span class="ocamlNone"> </span><span class="Statement">||</span><span class="ocamlNone"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L510" title="ocaml/debugger/time_travel.ml:510">new_time</a></span><span class="ocamlNone"> </span><span class="Statement">&lt;=</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier"><a href="parameters.ml.html#L30" title="ocaml/debugger/parameters.ml:30">time</a></span><span class="Statement">)</span><span class="ocamlNone"> </span><span class="Statement">then</span> <span class="Statement">begin<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="time_travel.mli.html#L30" title="ocaml/debugger/time_travel.mli:30">go_to</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L510" title="ocaml/debugger/time_travel.ml:510">new_time</a></span><span class="Statement">;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="exec.ml.html#L19" title="ocaml/debugger/exec.ml:19">interrupted</a></span><span class="ocamlEnd"> </span><span class="Statement">:=</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="exec.ml.html#L23" title="ocaml/debugger/exec.ml:23">break</a></span><span class="ocamlEnd"> </span><span class="Statement">&lt;&gt;</span><span class="ocamlEnd"> </span><span class="Constant">None</span><span class="Statement">;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier">last_breakpoint</span><span class="ocamlEnd"> </span><span class="Statement">:=</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="exec.ml.html#L23" title="ocaml/debugger/exec.ml:23">break</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="Statement">end</span> <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">back_to</span> <span class="ocamlLCIdentifier"><a href="parameters.ml.html#L30" title="ocaml/debugger/parameters.ml:30">time</a></span> <span class="ocamlLCIdentifier"><a href="#L510" title="ocaml/debugger/time_travel.ml:510">new_time</a><br/></li>
<li></span><br/></li>
<li><span class="Comment">(* Backward stepping. *)<br/></li>
<li></span><span class="Comment">(* --- Assume duration &gt; 1 *)<br/></li>
<li><a id="L520">&#x200c;</a></span><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">step_backward</span></span> <span class="ocamlLCIdentifier">duration</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="parameters.ml.html#L30" title="ocaml/debugger/parameters.ml:30">time</a></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L57" title="ocaml/debugger/checkpoints.mli:57">current_time</a></span> <span class="Constant">()</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier"><a href="parameters.ml.html#L30" title="ocaml/debugger/parameters.ml:30">time</a></span><span class="ocamlNone"> </span><span class="Statement">&gt;</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">_0</span><span class="ocamlNone"> </span><span class="Statement">then<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">back_to</span> <span class="Statement">(</span><span class="PreProc">Int64</span>.<span class="ocamlLCIdentifier">max</span> <span class="ocamlLCIdentifier">_0</span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="parameters.ml.html#L30" title="ocaml/debugger/parameters.ml:30">time</a></span> -- <span class="ocamlLCIdentifier">duration</span><span class="Statement">))</span> <span class="ocamlLCIdentifier"><a href="parameters.ml.html#L30" title="ocaml/debugger/parameters.ml:30">time</a><br/></li>
<li></span><br/></li>
<li><span class="Comment">(* Run the program from current <a href="parameters.ml.html#L30" title="ocaml/debugger/parameters.ml:30">time</a>. *)<br/></li>
<li></span><span class="Comment">(* Stop at the first <a href="parameters.ml.html#L28" title="ocaml/debugger/parameters.ml:28">breakpoint</a>, or at the end of the program. *)<br/></li>
<li><a id="L527">&#x200c;</a></span><span class="Statement">let</span> <span class="Statement">rec</span> <span class="ocamlLCIdentifier"><span class="linkable">run</span></span> <span class="Constant">()</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier"><a href="#L321" title="ocaml/debugger/time_travel.ml:321">internal_step</a></span> <span class="Statement">!</span><span class="ocamlLCIdentifier"><a href="debugger_config.ml.html#L71" title="ocaml/debugger/debugger_config.ml:71">checkpoint_big_step</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="Statement">not</span><span class="ocamlNone"> </span><span class="Statement">!</span><span class="ocamlLCIdentifier"><a href="exec.ml.html#L19" title="ocaml/debugger/exec.ml:19">interrupted</a></span><span class="ocamlNone"> </span><span class="Statement">then<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L527" title="ocaml/debugger/time_travel.ml:527">run</a></span> <span class="Constant">()<br/></li>
<li></span><br/></li>
<li><span class="Comment">(* Run the program backward from current <a href="parameters.ml.html#L30" title="ocaml/debugger/parameters.ml:30">time</a>. *)<br/></li>
<li></span><span class="Comment">(* Stop at the first <a href="parameters.ml.html#L28" title="ocaml/debugger/parameters.ml:28">breakpoint</a>, or at the <a href="command_line.ml.html#L796" title="ocaml/debugger/command_line.ml:796">beginning</a> of the program. *)<br/></li>
<li><a id="L534">&#x200c;</a></span><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">back_run</span></span> <span class="Constant">()</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L57" title="ocaml/debugger/checkpoints.mli:57">current_time</a></span><span class="ocamlNone"> </span><span class="Constant">()</span><span class="ocamlNone"> </span><span class="Statement">&gt;</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">_0</span><span class="ocamlNone"> </span><span class="Statement">then<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier">back_to</span> <span class="ocamlLCIdentifier">_0</span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="checkpoints.mli.html#L57" title="ocaml/debugger/checkpoints.mli:57">current_time</a></span> <span class="Constant">()</span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li><span class="Comment">(* Step in any direction. *)<br/></li>
<li></span><span class="Comment">(* Stop at the first <a href="parameters.ml.html#L28" title="ocaml/debugger/parameters.ml:28">breakpoint</a>, or after `duration' steps. *)<br/></li>
<li><a id="L540">&#x200c;</a></span><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">step</span></span> <span class="ocamlLCIdentifier">duration</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">duration</span><span class="ocamlNone"> </span><span class="Statement">&gt;=</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">_0</span><span class="ocamlNone"> </span><span class="Statement">then<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L457" title="ocaml/debugger/time_travel.ml:457">step_forward</a></span> <span class="ocamlLCIdentifier">duration<br/></li>
<li></span>&nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L520" title="ocaml/debugger/time_travel.ml:520">step_backward</a></span> <span class="Statement">(</span><span class="ocamlLCIdentifier">_0</span> -- <span class="ocamlLCIdentifier">duration</span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li><span class="Comment">(*** Next, <a href="#L549" title="ocaml/debugger/time_travel.ml:549">finish</a>. ***)<br/></li>
<li></span><br/></li>
<li><span class="Comment">(* Finish current function. *)<br/></li>
<li><a id="L549">&#x200c;</a></span><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">finish</span></span> <span class="Constant">()</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="PreProc">Symbols</span>.<span class="ocamlLCIdentifier"><a href="symbols.mli.html#L71" title="ocaml/debugger/symbols.mli:71">update_current_event</a></span> <span class="Constant">()</span><span class="Statement">;<br/></li>
<li></span>&nbsp; <span class="Statement">match</span> <span class="Statement">!</span><span class="ocamlLCIdentifier"><a href="events.mli.html#L29" title="ocaml/debugger/events.mli:29">current_event</a></span> <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">None</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">prerr_endline</span> <span class="Constant">&quot;`<a href="#L549" title="ocaml/debugger/time_travel.ml:549">finish</a>' not meaningful in outermost frame.&quot;</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">raise</span> <span class="Constant">Toplevel<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Some</span> <span class="Statement">{</span><span class="ocamlLCIdentifier">ev_ev</span><span class="Statement">={</span><span class="ocamlLCIdentifier">ev_stacksize</span><span class="Statement">}}</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="debugcom.ml.html#L201" title="ocaml/debugger/debugcom.ml:201">set_initial_frame</a></span><span class="Constant">()</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">frame</span>, <span class="ocamlLCIdentifier"><a href="debugcom.ml.html#L48" title="ocaml/debugger/debugcom.ml:48">pc</a></span><span class="Statement">)</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="debugcom.ml.html#L208" title="ocaml/debugger/debugcom.ml:208">up_frame</a></span> <span class="ocamlLCIdentifier">ev_stacksize</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">frame</span><span class="ocamlNone"> </span><span class="Statement">=</span><span class="ocamlNone"> </span><span class="PreProc">Sp</span><span class="ocamlNone">.</span><span class="ocamlLCIdentifier"><a href="debugcom.ml.html#L60" title="ocaml/debugger/debugcom.ml:60">null</a></span><span class="ocamlNone"> </span><span class="Statement">then</span> <span class="Statement">begin<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier">prerr_endline</span><span class="ocamlEnd"> </span><span class="Constant">&quot;`<a href="#L549" title="ocaml/debugger/time_travel.ml:549">finish</a>' not meaningful in outermost frame.&quot;</span><span class="Statement">;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">raise</span><span class="ocamlEnd"> </span><span class="Constant">Toplevel<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">end;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">begin<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">try</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">ignore</span><span class="Statement">(</span><span class="PreProc">Symbols</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier"><a href="symbols.ml.html#L167" title="ocaml/debugger/symbols.ml:167">any_event_at_pc</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="debugcom.ml.html#L48" title="ocaml/debugger/debugcom.ml:48">pc</a></span><span class="Statement">)<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">with</span><span class="ocamlEnd"> </span><span class="Constant">Not_found</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="ocamlLCIdentifier">prerr_endline</span><span class="ocamlEnd"> </span><span class="Constant">&quot;Calling function has no debugging information.&quot;</span><span class="Statement">;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="Statement">raise</span><span class="ocamlEnd"> </span><span class="Constant">Toplevel<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">end;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="trap_barrier.mli.html#L28" title="ocaml/debugger/trap_barrier.mli:28">exec_with_trap_barrier</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">frame<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">(fun</span> <span class="Constant">()</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier"><a href="breakpoints.mli.html#L60" title="ocaml/debugger/breakpoints.mli:60">exec_with_temporary_breakpoint</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier"><a href="debugcom.ml.html#L48" title="ocaml/debugger/debugcom.ml:48">pc</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">(fun</span> <span class="Constant">()</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">while<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L527" title="ocaml/debugger/time_travel.ml:527">run</a></span> <span class="Constant">()</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">match</span> <span class="Statement">!</span><span class="ocamlLCIdentifier">last_breakpoint</span> <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">Some</span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="debugcom.ml.html#L48" title="ocaml/debugger/debugcom.ml:48">pc</a></span>', <span class="ocamlLCIdentifier">frame</span>'<span class="Statement">)</span> <span class="Statement">when</span> <span class="ocamlLCIdentifier"><a href="debugcom.ml.html#L48" title="ocaml/debugger/debugcom.ml:48">pc</a></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="debugcom.ml.html#L48" title="ocaml/debugger/debugcom.ml:48">pc</a></span>' <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="exec.ml.html#L19" title="ocaml/debugger/exec.ml:19">interrupted</a></span> <span class="Statement">:=</span> <span class="Constant">false</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">frame</span> <span class="Statement">&lt;&gt;</span> <span class="ocamlLCIdentifier">frame</span>'<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Statement">_</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">false<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">do<br/></li>
<li></span><span class="ocamlDo">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Constant">()<br/></li>
<li></span><span class="ocamlDo">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">done))<br/></li>
<li></span><br/></li>
<li><span class="Statement">let</span> <span class="ocamlLCIdentifier">next_1</span> <span class="Constant">()</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="PreProc">Symbols</span>.<span class="ocamlLCIdentifier"><a href="symbols.mli.html#L71" title="ocaml/debugger/symbols.mli:71">update_current_event</a></span> <span class="Constant">()</span><span class="Statement">;<br/></li>
<li></span>&nbsp; <span class="Statement">match</span> <span class="Statement">!</span><span class="ocamlLCIdentifier"><a href="events.mli.html#L29" title="ocaml/debugger/events.mli:29">current_event</a></span> <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">None</span> <span class="Statement">-&gt;</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Comment">(* Beginning of the program. *)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L540" title="ocaml/debugger/time_travel.ml:540">step</a></span> <span class="ocamlLCIdentifier">_1<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Some</span> <span class="Statement">{</span><span class="ocamlLCIdentifier">ev_ev</span><span class="Statement">={</span><span class="ocamlLCIdentifier">ev_stacksize</span><span class="Statement">=</span><span class="ocamlLCIdentifier">ev_stacksize1</span><span class="Statement">}}</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">frame1</span>, <span class="ocamlLCIdentifier">_pc1</span><span class="Statement">)</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="debugcom.ml.html#L192" title="ocaml/debugger/debugcom.ml:192">initial_frame</a></span><span class="Constant">()</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L540" title="ocaml/debugger/time_travel.ml:540">step</a></span> <span class="ocamlLCIdentifier">_1</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="Statement">not</span><span class="ocamlNone"> </span><span class="Statement">!</span><span class="ocamlLCIdentifier"><a href="exec.ml.html#L19" title="ocaml/debugger/exec.ml:19">interrupted</a></span><span class="ocamlNone"> </span><span class="Statement">then</span> <span class="Statement">begin<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="PreProc">Symbols</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier"><a href="symbols.mli.html#L71" title="ocaml/debugger/symbols.mli:71">update_current_event</a></span><span class="ocamlEnd"> </span><span class="Constant">()</span><span class="Statement">;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">match</span><span class="ocamlEnd"> </span><span class="Statement">!</span><span class="ocamlLCIdentifier"><a href="events.mli.html#L29" title="ocaml/debugger/events.mli:29">current_event</a></span><span class="ocamlEnd"> </span><span class="Statement">with<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Constant">None</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;</span><span class="ocamlEnd"> </span><span class="Constant">()<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Constant">Some</span><span class="ocamlEnd"> </span><span class="Statement">{</span><span class="ocamlLCIdentifier">ev_ev</span><span class="Statement">={</span><span class="ocamlLCIdentifier">ev_stacksize</span><span class="Statement">=</span><span class="ocamlLCIdentifier">ev_stacksize2</span><span class="Statement">}}</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">frame2</span><span class="ocamlEnd">, </span><span class="ocamlLCIdentifier">_pc2</span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="debugcom.ml.html#L192" title="ocaml/debugger/debugcom.ml:192">initial_frame</a></span><span class="Constant">()</span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Comment">(* Call `<a href="#L549" title="ocaml/debugger/time_travel.ml:549">finish</a>' if we've entered a function. *)<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">frame1</span><span class="ocamlNone"> </span><span class="Statement">&lt;&gt;</span><span class="ocamlNone"> </span><span class="PreProc">Sp</span><span class="ocamlNone">.</span><span class="ocamlLCIdentifier"><a href="debugcom.ml.html#L60" title="ocaml/debugger/debugcom.ml:60">null</a></span><span class="ocamlNone"> </span><span class="Statement">&amp;&amp;</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">frame2</span><span class="ocamlNone"> </span><span class="Statement">&lt;&gt;</span><span class="ocamlNone"> </span><span class="PreProc">Sp</span><span class="ocamlNone">.</span><span class="ocamlLCIdentifier"><a href="debugcom.ml.html#L60" title="ocaml/debugger/debugcom.ml:60">null</a></span><span class="ocamlNone"> </span><span class="Statement">&amp;&amp;<br/></li>
<li></span><span class="ocamlNone">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="PreProc">Sp</span><span class="ocamlNone">.</span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="debugcom.ml.html#L64" title="ocaml/debugger/debugcom.ml:64">compare</a></span><span class="ocamlNone"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="debugcom.ml.html#L62" title="ocaml/debugger/debugcom.ml:62">base</a></span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">frame2</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">ev_stacksize2</span><span class="Statement">)<br/></li>
<li></span><span class="ocamlNone">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="debugcom.ml.html#L62" title="ocaml/debugger/debugcom.ml:62">base</a></span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">frame1</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">ev_stacksize1</span><span class="Statement">))</span><span class="ocamlNone"> </span><span class="Statement">&gt;</span><span class="ocamlNone"> </span><span class="Constant">0<br/></li>
<li></span><span class="ocamlNone">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">then</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L549" title="ocaml/debugger/time_travel.ml:549">finish</a></span><span class="Constant">()<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">end<br/></li>
<li></span><br/></li>
<li><span class="Comment">(* Same as `<a href="#L540" title="ocaml/debugger/time_travel.ml:540">step</a>' (forward) but skip over function calls. *)<br/></li>
<li></span><span class="Statement">let</span> <span class="Statement">rec</span> <span class="ocamlLCIdentifier"><a href="time_travel.mli.html#L36" title="ocaml/debugger/time_travel.mli:36">next</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">function<br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">0</span> <span class="Statement">-&gt;</span> <span class="Constant">()<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="ocamlLCIdentifier">n</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">next_1</span> <span class="Constant">()</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="Statement">not</span><span class="ocamlNone"> </span><span class="Statement">!</span><span class="ocamlLCIdentifier"><a href="exec.ml.html#L19" title="ocaml/debugger/exec.ml:19">interrupted</a></span><span class="ocamlNone"> </span><span class="Statement">then<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="time_travel.mli.html#L36" title="ocaml/debugger/time_travel.mli:36">next</a></span> <span class="Statement">(</span><span class="ocamlLCIdentifier">n</span> - <span class="Constant">1</span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li><span class="Comment">(* Run backward until just before current function. *)<br/></li>
<li><a id="L617">&#x200c;</a></span><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">start</span></span> <span class="Constant">()</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="PreProc">Symbols</span>.<span class="ocamlLCIdentifier"><a href="symbols.mli.html#L71" title="ocaml/debugger/symbols.mli:71">update_current_event</a></span> <span class="Constant">()</span><span class="Statement">;<br/></li>
<li></span>&nbsp; <span class="Statement">match</span> <span class="Statement">!</span><span class="ocamlLCIdentifier"><a href="events.mli.html#L29" title="ocaml/debugger/events.mli:29">current_event</a></span> <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">None</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">prerr_endline</span> <span class="Constant">&quot;`<a href="#L617" title="ocaml/debugger/time_travel.ml:617">start</a> not meaningful in outermost frame.&quot;</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">raise</span> <span class="Constant">Toplevel<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Some</span> <span class="Statement">{</span><span class="ocamlLCIdentifier">ev_ev</span><span class="Statement">={</span><span class="ocamlLCIdentifier">ev_stacksize</span><span class="Statement">}}</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">frame</span>, <span class="Statement">_)</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="debugcom.ml.html#L192" title="ocaml/debugger/debugcom.ml:192">initial_frame</a></span><span class="Constant">()</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">frame</span>', <span class="ocamlLCIdentifier"><a href="debugcom.ml.html#L48" title="ocaml/debugger/debugcom.ml:48">pc</a></span><span class="Statement">)</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="debugcom.ml.html#L208" title="ocaml/debugger/debugcom.ml:208">up_frame</a></span> <span class="ocamlLCIdentifier">ev_stacksize</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">frame</span><span class="ocamlNone">' </span><span class="Statement">=</span><span class="ocamlNone"> </span><span class="PreProc">Sp</span><span class="ocamlNone">.</span><span class="ocamlLCIdentifier"><a href="debugcom.ml.html#L60" title="ocaml/debugger/debugcom.ml:60">null</a></span><span class="ocamlNone"> </span><span class="Statement">then</span> <span class="Statement">begin<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier">prerr_endline</span><span class="ocamlEnd"> </span><span class="Constant">&quot;`<a href="#L617" title="ocaml/debugger/time_travel.ml:617">start</a> not meaningful in outermost frame.&quot;</span><span class="Statement">;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">raise</span><span class="ocamlEnd"> </span><span class="Constant">Toplevel<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">end;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">nargs</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">match<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">try</span> <span class="PreProc">Symbols</span>.<span class="ocamlLCIdentifier"><a href="symbols.ml.html#L167" title="ocaml/debugger/symbols.ml:167">any_event_at_pc</a></span> <span class="ocamlLCIdentifier"><a href="debugcom.ml.html#L48" title="ocaml/debugger/debugcom.ml:48">pc</a></span> <span class="Statement">with</span> <span class="Constant">Not_found</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">prerr_endline</span> <span class="Constant">&quot;Calling function has no debugging information.&quot;</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">raise</span> <span class="Constant">Toplevel<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">{</span><span class="ocamlLCIdentifier">ev_ev</span> <span class="Statement">=</span> <span class="Statement">{</span><span class="ocamlLCIdentifier">ev_info</span> <span class="Statement">=</span> <span class="Constant">Event_return</span> <span class="ocamlLCIdentifier">nargs</span><span class="Statement">}}</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier">nargs<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Statement">_</span> <span class="Statement">-&gt;</span>&nbsp; <span class="PreProc">Misc</span>.<span class="ocamlLCIdentifier">fatal_error</span> <span class="Constant">&quot;Time_travel.<a href="#L617" title="ocaml/debugger/time_travel.ml:617">start</a>&quot;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">offset</span> <span class="Statement">=</span> <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">nargs</span><span class="ocamlNone"> </span><span class="Statement">&lt;</span><span class="ocamlNone"> </span><span class="Constant">4</span><span class="ocamlNone"> </span><span class="Statement">then</span> <span class="Constant">1</span> <span class="Statement">else</span> <span class="Constant">2</span> <span class="Statement">in<br/></li>
<li><a id="L640">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">pc</span></span> <span class="Statement">=</span> <span class="Statement">{</span> <span class="ocamlLCIdentifier"><span class="linkable">pc</span></span> <span class="Statement">with</span> <span class="ocamlLCIdentifier"><a href="eval.ml.html#L150" title="ocaml/debugger/eval.ml:150">pos</a></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><span class="linkable">pc</span></span>.<span class="ocamlLCIdentifier"><a href="eval.ml.html#L150" title="ocaml/debugger/eval.ml:150">pos</a></span> - <span class="Constant">4</span> <span class="Statement">*</span> <span class="ocamlLCIdentifier">offset</span> <span class="Statement">}</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">while<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="breakpoints.mli.html#L60" title="ocaml/debugger/breakpoints.mli:60">exec_with_temporary_breakpoint</a></span> <span class="ocamlLCIdentifier"><a href="debugcom.ml.html#L48" title="ocaml/debugger/debugcom.ml:48">pc</a></span> <span class="ocamlLCIdentifier"><a href="#L534" title="ocaml/debugger/time_travel.ml:534">back_run</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">match</span> <span class="Statement">!</span><span class="ocamlLCIdentifier">last_breakpoint</span> <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">Some</span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="debugcom.ml.html#L48" title="ocaml/debugger/debugcom.ml:48">pc</a></span>', <span class="ocamlLCIdentifier">frame</span>'<span class="Statement">)</span> <span class="Statement">when</span> <span class="ocamlLCIdentifier"><a href="debugcom.ml.html#L48" title="ocaml/debugger/debugcom.ml:48">pc</a></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="debugcom.ml.html#L48" title="ocaml/debugger/debugcom.ml:48">pc</a></span>' <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L540" title="ocaml/debugger/time_travel.ml:540">step</a></span> <span class="ocamlLCIdentifier">_minus1</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">(not</span> <span class="Statement">!</span><span class="ocamlLCIdentifier"><a href="exec.ml.html#L19" title="ocaml/debugger/exec.ml:19">interrupted</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">&amp;&amp;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="PreProc">Sp</span>.<span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="debugcom.ml.html#L64" title="ocaml/debugger/debugcom.ml:64">compare</a></span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="debugcom.ml.html#L62" title="ocaml/debugger/debugcom.ml:62">base</a></span> <span class="ocamlLCIdentifier">frame</span>' <span class="ocamlLCIdentifier">nargs</span><span class="Statement">)</span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="debugcom.ml.html#L62" title="ocaml/debugger/debugcom.ml:62">base</a></span> <span class="ocamlLCIdentifier">frame</span> <span class="ocamlLCIdentifier">ev_stacksize</span><span class="Statement">))</span> <span class="Statement">&gt;</span> <span class="Constant">0<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Statement">_</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">false<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">do<br/></li>
<li></span><span class="ocamlDo">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Constant">()<br/></li>
<li></span><span class="ocamlDo">&nbsp; &nbsp; &nbsp; </span><span class="Statement">done<br/></li>
<li></span><br/></li>
<li><a id="L655">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">previous_1</span></span> <span class="Constant">()</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="PreProc">Symbols</span>.<span class="ocamlLCIdentifier"><a href="symbols.mli.html#L71" title="ocaml/debugger/symbols.mli:71">update_current_event</a></span> <span class="Constant">()</span><span class="Statement">;<br/></li>
<li></span>&nbsp; <span class="Statement">match</span> <span class="Statement">!</span><span class="ocamlLCIdentifier"><a href="events.mli.html#L29" title="ocaml/debugger/events.mli:29">current_event</a></span> <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">None</span> <span class="Statement">-&gt;</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Comment">(* End of the program. *)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L540" title="ocaml/debugger/time_travel.ml:540">step</a></span> <span class="ocamlLCIdentifier">_minus1<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Some</span> <span class="Statement">{</span><span class="ocamlLCIdentifier">ev_ev</span><span class="Statement">={</span><span class="ocamlLCIdentifier">ev_stacksize</span><span class="Statement">=</span><span class="ocamlLCIdentifier">ev_stacksize1</span><span class="Statement">}}</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">frame1</span>, <span class="ocamlLCIdentifier">_pc1</span><span class="Statement">)</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="debugcom.ml.html#L192" title="ocaml/debugger/debugcom.ml:192">initial_frame</a></span><span class="Constant">()</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L540" title="ocaml/debugger/time_travel.ml:540">step</a></span> <span class="ocamlLCIdentifier">_minus1</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="Statement">not</span><span class="ocamlNone"> </span><span class="Statement">!</span><span class="ocamlLCIdentifier"><a href="exec.ml.html#L19" title="ocaml/debugger/exec.ml:19">interrupted</a></span><span class="ocamlNone"> </span><span class="Statement">then</span> <span class="Statement">begin<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="PreProc">Symbols</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier"><a href="symbols.mli.html#L71" title="ocaml/debugger/symbols.mli:71">update_current_event</a></span><span class="ocamlEnd"> </span><span class="Constant">()</span><span class="Statement">;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">match</span><span class="ocamlEnd"> </span><span class="Statement">!</span><span class="ocamlLCIdentifier"><a href="events.mli.html#L29" title="ocaml/debugger/events.mli:29">current_event</a></span><span class="ocamlEnd"> </span><span class="Statement">with<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Constant">None</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;</span><span class="ocamlEnd"> </span><span class="Constant">()<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Constant">Some</span><span class="ocamlEnd"> </span><span class="Statement">{</span><span class="ocamlLCIdentifier">ev_ev</span><span class="Statement">={</span><span class="ocamlLCIdentifier">ev_stacksize</span><span class="Statement">=</span><span class="ocamlLCIdentifier">ev_stacksize2</span><span class="Statement">}}</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">frame2</span><span class="ocamlEnd">, </span><span class="ocamlLCIdentifier">_pc2</span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="debugcom.ml.html#L192" title="ocaml/debugger/debugcom.ml:192">initial_frame</a></span><span class="Constant">()</span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Comment">(* Call `<a href="#L617" title="ocaml/debugger/time_travel.ml:617">start</a>' if we've entered a function. *)<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">frame1</span><span class="ocamlNone"> </span><span class="Statement">&lt;&gt;</span><span class="ocamlNone"> </span><span class="PreProc">Sp</span><span class="ocamlNone">.</span><span class="ocamlLCIdentifier"><a href="debugcom.ml.html#L60" title="ocaml/debugger/debugcom.ml:60">null</a></span><span class="ocamlNone"> </span><span class="Statement">&amp;&amp;</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">frame2</span><span class="ocamlNone"> </span><span class="Statement">&lt;&gt;</span><span class="ocamlNone"> </span><span class="PreProc">Sp</span><span class="ocamlNone">.</span><span class="ocamlLCIdentifier"><a href="debugcom.ml.html#L60" title="ocaml/debugger/debugcom.ml:60">null</a></span><span class="ocamlNone"> </span><span class="Statement">&amp;&amp;<br/></li>
<li></span><span class="ocamlNone">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="PreProc">Sp</span><span class="ocamlNone">.</span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="debugcom.ml.html#L64" title="ocaml/debugger/debugcom.ml:64">compare</a></span><span class="ocamlNone"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="debugcom.ml.html#L62" title="ocaml/debugger/debugcom.ml:62">base</a></span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">frame2</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">ev_stacksize2</span><span class="Statement">)<br/></li>
<li></span><span class="ocamlNone">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="debugcom.ml.html#L62" title="ocaml/debugger/debugcom.ml:62">base</a></span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">frame1</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">ev_stacksize1</span><span class="Statement">))</span><span class="ocamlNone"> </span><span class="Statement">&gt;</span><span class="ocamlNone"> </span><span class="Constant">0<br/></li>
<li></span><span class="ocamlNone">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">then</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L617" title="ocaml/debugger/time_travel.ml:617">start</a></span><span class="Constant">()<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">end<br/></li>
<li></span><br/></li>
<li><span class="Comment">(* Same as `<a href="#L540" title="ocaml/debugger/time_travel.ml:540">step</a>' (backward) but skip over function calls. *)<br/></li>
<li></span><span class="Statement">let</span> <span class="Statement">rec</span> <span class="ocamlLCIdentifier"><a href="time_travel.mli.html#L38" title="ocaml/debugger/time_travel.mli:38">previous</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">function<br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">0</span> <span class="Statement">-&gt;</span> <span class="Constant">()<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="ocamlLCIdentifier">n</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L655" title="ocaml/debugger/time_travel.ml:655">previous_1</a></span> <span class="Constant">()</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="Statement">not</span><span class="ocamlNone"> </span><span class="Statement">!</span><span class="ocamlLCIdentifier"><a href="exec.ml.html#L19" title="ocaml/debugger/exec.ml:19">interrupted</a></span><span class="ocamlNone"> </span><span class="Statement">then<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="time_travel.mli.html#L38" title="ocaml/debugger/time_travel.mli:38">previous</a></span> <span class="Statement">(</span><span class="ocamlLCIdentifier">n</span> - <span class="Constant">1</span><span class="Statement">)<br/></li>
</ol></span></code>
 <p class="nav-bar">
  <span class="nav-link"><a href="./index.html">One Level Up</a></span>
  <span class="nav-link"><a href="index.html">Top Level</a></span>
 </p>

 </body>
</html>
