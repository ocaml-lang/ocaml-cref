<!-- generated by the vscode.pl tool from vscoded.-->

<html>
 <head>
  <title>ocaml/ocamltest/ocaml_actions.ml - ocaml</title>
  <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
  <style>
body {
    text-align: left;
    text-align-last: left;
}

.nav-bar {
    font-size: 120%;
    margin-top: 5px;
    margin-bottom: 5px;
}

.nav-link {
    padding-left: 5em;
    padding-right: 5em;
}

ul.toc {
    line-height: 200%;
    font-size: 150%;
}

code {
    font-family: consolas, monospace;
    line-height: 130%;
}

span.Constant {
    color: DarkGreen;
}

span.Special {
    color: #c06000;
}

span.Comment {
    color: DarkRed;
    font-style: italic;
}

span.Identifier {
    color: DarkCyan;
}

span.PreProc {
    color: DarkMagenta;
}

span.Statement, span.Type, span.Keyword, span.Repeat, span.Conditional,
    span.Operator, span.Exception
{
    color: DarkBlue;
}

span.Todo {
    color: DarkRed;
    background-color: Gold;
    font-style: italic;
}

span.Underlined {
    text-decoration: underline;
}

span.linkable {
    font-weight: bold;
}

code ol {
    counter-reset: item;
    list-style-type: none;
    margin-left: 0;
    padding-left: 0;
    list-style-position: inside;
}

code li {
    display: block;
}

code li:before {
    content: counter(item) "  ";
    counter-increment: item;
    color: #999;
    padding-right: 0.5em;
    padding-left: 0.4em;
    list-style-position: inside;
    text-align: right
}

  </style>
 </head>
 <body>
 <p class="nav-bar">
  <span class="nav-link"><a href="./index.html">One Level Up</a></span>
  <span class="nav-link"><a href="index.html">Top Level</a></span>
 </p>

  <h1>ocaml/ocamltest/ocaml_actions.ml - ocaml</h1>
 <h2>Global variables defined</h2>
 <ul class="toc">
<li><a href="#L62">add_extension</a></li>
<li><a href="#L329">add_module_interface</a></li>
<li><a href="#L1222">afl_instrument</a></li>
<li><a href="#L73">backend_default_flags</a></li>
<li><a href="#L78">backend_flags</a></li>
<li><a href="#L69">binary_modules</a></li>
<li><a href="#L249">bytecode_links_c_code</a></li>
<li><a href="#L785">cc</a></li>
<li><a href="#L1096">check_ocaml_output</a></li>
<li><a href="#L845">check_ocamlc_byte_output</a></li>
<li><a href="#L848">check_ocamlc_opt_output</a></li>
<li><a href="#L1248">check_ocamldoc_output</a></li>
<li><a href="#L1099">check_ocamlnat_output</a></li>
<li><a href="#L853">check_ocamlopt_byte_output</a></li>
<li><a href="#L858">check_ocamlopt_opt_output</a></li>
<li><a href="#L188">cmas_need_dynamic_loading</a></li>
<li><a href="#L238">cmas_need_dynamic_loading</a></li>
<li><a href="#L749">codegen</a></li>
<li><a href="#L250">commandline</a></li>
<li><a href="#L294">commandline</a></li>
<li><a href="#L760">commandline</a></li>
<li><a href="#L793">commandline</a></li>
<li><a href="#L968">commandline</a></li>
<li><a href="#L974">commandline</a></li>
<li><a href="#L980">commandline</a></li>
<li><a href="#L915">compare_binary_files</a></li>
<li><a href="#L907">compare_bytecode_programs</a></li>
<li><a href="#L901">compare_bytecode_programs_code</a></li>
<li><a href="#L885">compare_programs</a></li>
<li><a href="#L463">compile</a></li>
<li><a href="#L233">compile_flags</a></li>
<li><a href="#L285">compile_module</a></li>
<li><a href="#L923">compile_module</a></li>
<li><a href="#L989">compile_modules</a></li>
<li><a href="#L1268">compile_ocamldoc</a></li>
<li><a href="#L230">compile_only</a></li>
<li><a href="#L210">compile_program</a></li>
<li><a href="#L1254">compiled_doc_name</a></li>
<li><a href="#L1258">compiler_for_ocamldoc</a></li>
<li><a href="#L1104">config_variables</a></li>
<li><a href="#L1208">csharp_compiler</a></li>
<li><a href="#L532">debug</a></li>
<li><a href="#L1194">debugger</a></li>
<li><a href="#L88">default_ocaml_env</a></li>
<li><a href="#L41">directories</a></li>
<li><a href="#L44">directory_flags</a></li>
<li><a href="#L83">env_setting</a></li>
<li><a href="#L523">env_with_lib_unix</a></li>
<li><a href="#L268">exit_status</a></li>
<li><a href="#L306">exit_status</a></li>
<li><a href="#L591">exit_status</a></li>
<li><a href="#L769">exit_status</a></li>
<li><a href="#L802">exit_status</a></li>
<li><a href="#L222">expected_exit_status</a></li>
<li><a href="#L590">expected_exit_status</a></li>
<li><a href="#L768">expected_exit_status</a></li>
<li><a href="#L59">filelist</a></li>
<li><a href="#L61">filenames</a></li>
<li><a href="#L649">finalise_codegen_cc</a></li>
<li><a href="#L663">finalise_codegen_msvc</a></li>
<li><a href="#L341">find_source_modules</a></li>
<li><a href="#L49">flags</a></li>
<li><a href="#L1152">flambda</a></li>
<li><a href="#L1136">flat_float_array</a></li>
<li><a href="#L124">generate_module</a></li>
<li><a href="#L159">generate_parser</a></li>
<li><a href="#L30">get_backend_value_from_env</a></li>
<li><a href="#L1201">instrumented_runtime</a></li>
<li><a href="#L965">interface_name</a></li>
<li><a href="#L186">is_c_file</a></li>
<li><a href="#L51">last_flags</a></li>
<li><a href="#L65">libraries</a></li>
<li><a href="#L237">libraries</a></li>
<li><a href="#L893">make_bytecode_programs_comparison_tool</a></li>
<li><a href="#L837">make_check_tool_output</a></li>
<li><a href="#L420">mk_compiler_env_setup</a></li>
<li><a href="#L424">mk_toplevel_env_setup</a></li>
<li><a href="#L611">mklib</a></li>
<li><a href="#L971">module_extension</a></li>
<li><a href="#L323">module_has_interface</a></li>
<li><a href="#L224">module_names</a></li>
<li><a href="#L972">module_output_name</a></li>
<li><a href="#L35">modules</a></li>
<li><a href="#L26">native_action</a></li>
<li><a href="#L1180">native_compiler</a></li>
<li><a href="#L1187">native_dynlink</a></li>
<li><a href="#L899">native_programs_comparison_tool</a></li>
<li><a href="#L1229">no_afl_instrument</a></li>
<li><a href="#L1159">no_flambda</a></li>
<li><a href="#L1144">no_flat_float_array</a></li>
<li><a href="#L23">no_native_compilers</a></li>
<li><a href="#L1173">no_shared_libraries</a></li>
<li><a href="#L978">object_extension</a></li>
<li><a href="#L569">objinfo</a></li>
<li><a href="#L1084">ocaml</a></li>
<li><a href="#L502">ocamlc_opt</a></li>
<li><a href="#L1236">ocamldoc</a></li>
<li><a href="#L1335">ocamldoc_backend_flag</a></li>
<li><a href="#L1251">ocamldoc_flags</a></li>
<li><a href="#L1339">ocamldoc_o_flag</a></li>
<li><a href="#L1238">ocamldoc_output_file</a></li>
<li><a href="#L1333">ocamldoc_plugin</a></li>
<li><a href="#L102">ocamllex</a></li>
<li><a href="#L53">ocamllex_flags</a></li>
<li><a href="#L1089">ocamlnat</a></li>
<li><a href="#L607">ocamlobjinfo</a></li>
<li><a href="#L509">ocamlopt_byte</a></li>
<li><a href="#L516">ocamlopt_opt</a></li>
<li><a href="#L111">ocamlyacc</a></li>
<li><a href="#L56">ocamlyacc_flags</a></li>
<li><a href="#L236">output</a></li>
<li><a href="#L38">plugins</a></li>
<li><a href="#L161">prepare_module</a></li>
<li><a href="#L336">print_module_names</a></li>
<li><a href="#L863">really_compare_programs</a></li>
<li><a href="#L279">reason</a></li>
<li><a href="#L317">reason</a></li>
<li><a href="#L601">reason</a></li>
<li><a href="#L743">reason</a></li>
<li><a href="#L779">reason</a></li>
<li><a href="#L807">reason</a></li>
<li><a href="#L985">reason</a></li>
<li><a href="#L1077">reason</a></li>
<li><a href="#L753">run_cc</a></li>
<li><a href="#L830">run_expect</a></li>
<li><a href="#L834">run_expect</a></li>
<li><a href="#L789">run_expect_once</a></li>
<li><a href="#L812">run_expect_twice</a></li>
<li><a href="#L1345">run_ocamldoc</a></li>
<li><a href="#L1003">run_test_program_in_toplevel</a></li>
<li><a href="#L399">setup_compiler_build_env</a></li>
<li><a href="#L452">setup_ocaml_build_env</a></li>
<li><a href="#L429">setup_ocamlc_byte_build_env</a></li>
<li><a href="#L434">setup_ocamlc_opt_build_env</a></li>
<li><a href="#L1312">setup_ocamldoc_build_env</a></li>
<li><a href="#L457">setup_ocamlnat_build_env</a></li>
<li><a href="#L440">setup_ocamlopt_byte_build_env</a></li>
<li><a href="#L446">setup_ocamlopt_opt_build_env</a></li>
<li><a href="#L357">setup_tool_build_env</a></li>
<li><a href="#L417">setup_toplevel_build_env</a></li>
<li><a href="#L1166">shared_libraries</a></li>
<li><a href="#L581">systemenv</a></li>
<li><a href="#L227">what</a></li>
<li><a href="#L1215">windows_unicode</a></li>
</ul>
 <h2>Data types defined</h2>
 <ul class="toc">
<li><a href="#L94">module_generator</a></li>
</ul>
 <h2>Source code</h2>

  <code><ol><li><span class="Comment">(**************************************************************************)<br/></li>
<li></span><span class="Comment">(*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *)<br/></li>
<li></span><span class="Comment">(*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; OCaml&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *)<br/></li>
<li></span><span class="Comment">(*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *)<br/></li>
<li></span><span class="Comment">(*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; Sebastien Hinderer, projet Gallium, INRIA Paris&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *)<br/></li>
<li></span><span class="Comment">(*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *)<br/></li>
<li></span><span class="Comment">(*&nbsp;&nbsp; Copyright 2017 Institut National de Recherche en Informatique et&nbsp; &nbsp;&nbsp; *)<br/></li>
<li></span><span class="Comment">(*&nbsp; &nbsp;&nbsp; en Automatique.&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *)<br/></li>
<li></span><span class="Comment">(*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *)<br/></li>
<li></span><span class="Comment">(*&nbsp;&nbsp; All rights reserved.&nbsp; This <a href="builtin_variables.mli.html#L30" title="ocaml/ocamltest/builtin_variables.mli:30">file</a> is distributed under the terms of&nbsp; &nbsp; *)<br/></li>
<li></span><span class="Comment">(*&nbsp;&nbsp; the GNU Lesser General Public License version 2<a href="tsl_semantics.ml.html#L72" title="ocaml/ocamltest/tsl_semantics.ml:72">.</a>1, with the&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *)<br/></li>
<li></span><span class="Comment">(*&nbsp;&nbsp; special exception on linking described in the <a href="builtin_variables.mli.html#L30" title="ocaml/ocamltest/builtin_variables.mli:30">file</a> LICENSE.&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *)<br/></li>
<li></span><span class="Comment">(*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *)<br/></li>
<li></span><span class="Comment">(**************************************************************************)<br/></li>
<li></span><br/></li>
<li><span class="Comment">(* Actions specific to the OCaml compilers *)<br/></li>
<li></span><br/></li>
<li><span class="Statement"><a href="actions_helpers.ml.html#L299" title="ocaml/ocamltest/actions_helpers.ml:299">open</a></span><span class="ocamlNone"> </span><span class="PreProc">Ocamltest_stdlib<br/></li>
<li></span><span class="Statement"><a href="actions_helpers.ml.html#L299" title="ocaml/ocamltest/actions_helpers.ml:299">open</a></span><span class="ocamlNone"> </span><span class="PreProc">Actions<br/></li>
<li></span><br/></li>
<li><span class="Comment">(* Extracting information from <a href="environments.ml.html#L199" title="ocaml/ocamltest/environments.ml:199">environment</a> *)<br/></li>
<li></span><br/></li>
<li><a id="L23">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">no_native_compilers</span></span> <span class="ocamlLCIdentifier">_log</span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">(</span><span class="PreProc">Result</span>.<span class="ocamlLCIdentifier"><a href="result.ml.html#L37" title="ocaml/ocamltest/result.ml:37">skip_with_reason</a></span> <span class="Constant">&quot;<a href="ocaml_tests.mli.html#L20" title="ocaml/ocamltest/ocaml_tests.mli:20">native</a> compilers disabled&quot;</span>, <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li><a id="L26">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">native_action</span></span> <span class="ocamlLCIdentifier">a</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="PreProc">Ocamltest_config</span><span class="ocamlNone">.</span><span class="ocamlLCIdentifier"><a href="ocaml_actions.mli.html#L50" title="ocaml/ocamltest/ocaml_actions.mli:50">native_compiler</a></span><span class="ocamlNone"> </span><span class="Statement">then</span> <span class="ocamlLCIdentifier">a<br/></li>
<li></span>&nbsp; <span class="Statement">else</span> <span class="Statement">(</span><span class="PreProc">Actions</span>.<span class="ocamlLCIdentifier"><a href="actions.mli.html#L28" title="ocaml/ocamltest/actions.mli:28">update</a></span> <span class="ocamlLCIdentifier">a</span> <span class="ocamlLCIdentifier"><a href="#L23" title="ocaml/ocamltest/ocaml_actions.ml:23">no_native_compilers</a></span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li><a id="L30">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">get_backend_value_from_env</span></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="ocamlLCIdentifier">bytecode_var</span> <span class="ocamlLCIdentifier">native_var</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="PreProc">Ocaml_backends</span>.<span class="ocamlLCIdentifier"><a href="ocaml_backends.ml.html#L30" title="ocaml/ocamltest/ocaml_backends.ml:30">make_backend_function</a><br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">(</span><span class="PreProc">Environments</span>.<span class="ocamlLCIdentifier"><a href="environments.mli.html#L29" title="ocaml/ocamltest/environments.mli:29">safe_lookup</a></span> <span class="ocamlLCIdentifier">bytecode_var</span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">(</span><span class="PreProc">Environments</span>.<span class="ocamlLCIdentifier"><a href="environments.mli.html#L29" title="ocaml/ocamltest/environments.mli:29">safe_lookup</a></span> <span class="ocamlLCIdentifier">native_var</span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li><a id="L35">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">modules</span></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="PreProc">Actions_helpers</span>.<span class="ocamlLCIdentifier"><a href="actions_helpers.ml.html#L53" title="ocaml/ocamltest/actions_helpers.ml:53">words_of_variable</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="PreProc">Ocaml_variables</span>.<span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L75" title="ocaml/ocamltest/ocaml_variables.mli:75">modules</a><br/></li>
<li></span><br/></li>
<li><a id="L38">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">plugins</span></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="PreProc">Actions_helpers</span>.<span class="ocamlLCIdentifier"><a href="actions_helpers.ml.html#L53" title="ocaml/ocamltest/actions_helpers.ml:53">words_of_variable</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="PreProc">Ocaml_variables</span>.<span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L130" title="ocaml/ocamltest/ocaml_variables.mli:130">plugins</a><br/></li>
<li></span><br/></li>
<li><a id="L41">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">directories</span></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="PreProc">Actions_helpers</span>.<span class="ocamlLCIdentifier"><a href="actions_helpers.ml.html#L53" title="ocaml/ocamltest/actions_helpers.ml:53">words_of_variable</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="PreProc">Ocaml_variables</span>.<span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L59" title="ocaml/ocamltest/ocaml_variables.mli:59">directories</a><br/></li>
<li></span><br/></li>
<li><a id="L44">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">directory_flags</span></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="actions_helpers.ml.html#L85" title="ocaml/ocamltest/actions_helpers.ml:85">f</a></span> <span class="ocamlLCIdentifier">dir</span> <span class="Statement">=</span> <span class="Statement">(</span><span class="Constant">&quot;-I &quot;</span> <span class="Statement">^</span> <span class="ocamlLCIdentifier">dir</span><span class="Statement">)</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">l</span> <span class="Statement">=</span> <span class="PreProc">List</span>.<span class="ocamlLCIdentifier">map</span> <span class="ocamlLCIdentifier"><a href="actions_helpers.ml.html#L85" title="ocaml/ocamltest/actions_helpers.ml:85">f</a></span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L59" title="ocaml/ocamltest/ocaml_variables.mli:59">directories</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="Statement">)</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="PreProc">String</span>.<span class="ocamlLCIdentifier">concat</span> <span class="Constant">&quot; &quot;</span> <span class="ocamlLCIdentifier">l<br/></li>
<li></span><br/></li>
<li><a id="L49">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">flags</span></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">=</span> <span class="PreProc">Environments</span>.<span class="ocamlLCIdentifier"><a href="environments.mli.html#L29" title="ocaml/ocamltest/environments.mli:29">safe_lookup</a></span> <span class="PreProc">Ocaml_variables</span>.<span class="ocamlLCIdentifier"><span class="linkable">flags</span></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a><br/></li>
<li></span><br/></li>
<li><a id="L51">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">last_flags</span></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">=</span> <span class="PreProc">Environments</span>.<span class="ocamlLCIdentifier"><a href="environments.mli.html#L29" title="ocaml/ocamltest/environments.mli:29">safe_lookup</a></span> <span class="PreProc">Ocaml_variables</span>.<span class="ocamlLCIdentifier"><span class="linkable">last_flags</span></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a><br/></li>
<li></span><br/></li>
<li><a id="L53">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">ocamllex_flags</span></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="PreProc">Environments</span>.<span class="ocamlLCIdentifier"><a href="environments.mli.html#L29" title="ocaml/ocamltest/environments.mli:29">safe_lookup</a></span> <span class="PreProc">Ocaml_variables</span>.<span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L91" title="ocaml/ocamltest/ocaml_variables.mli:91">ocamllex_flags</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a><br/></li>
<li></span><br/></li>
<li><a id="L56">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">ocamlyacc_flags</span></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="PreProc">Environments</span>.<span class="ocamlLCIdentifier"><a href="environments.mli.html#L29" title="ocaml/ocamltest/environments.mli:29">safe_lookup</a></span> <span class="PreProc">Ocaml_variables</span>.<span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L96" title="ocaml/ocamltest/ocaml_variables.mli:96">ocamlyacc_flags</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a><br/></li>
<li></span><br/></li>
<li><a id="L59">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">filelist</span></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="ocamlLCIdentifier">variable</span> <span class="ocamlLCIdentifier">extension</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">value</span> <span class="Statement">=</span> <span class="PreProc">Environments</span>.<span class="ocamlLCIdentifier"><a href="environments.mli.html#L29" title="ocaml/ocamltest/environments.mli:29">safe_lookup</a></span> <span class="ocamlLCIdentifier">variable</span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">in<br/></li>
<li><a id="L61">&#x200c;</a></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">filenames</span></span> <span class="Statement">=</span> <span class="PreProc">String</span>.<span class="ocamlLCIdentifier"><a href="ocamltest_stdlib.ml.html#L57" title="ocaml/ocamltest/ocamltest_stdlib.ml:57">words</a></span> <span class="ocamlLCIdentifier">value</span> <span class="Statement">in<br/></li>
<li><a id="L62">&#x200c;</a></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">add_extension</span></span> <span class="ocamlLCIdentifier"><a href="ocaml_compilers.ml.html#L57" title="ocaml/ocamltest/ocaml_compilers.ml:57">filename</a></span> <span class="Statement">=</span> <span class="PreProc">Filename</span>.<span class="ocamlLCIdentifier"><a href="ocaml_filetypes.ml.html#L106" title="ocaml/ocamltest/ocaml_filetypes.ml:106">make_filename</a></span> <span class="ocamlLCIdentifier"><a href="ocaml_compilers.ml.html#L57" title="ocaml/ocamltest/ocaml_compilers.ml:57">filename</a></span> <span class="ocamlLCIdentifier">extension</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="PreProc">String</span>.<span class="ocamlLCIdentifier">concat</span> <span class="Constant">&quot; &quot;</span> <span class="Statement">(</span><span class="PreProc">List</span>.<span class="ocamlLCIdentifier">map</span> <span class="ocamlLCIdentifier"><a href="#L62" title="ocaml/ocamltest/ocaml_actions.ml:62">add_extension</a></span> <span class="ocamlLCIdentifier"><a href="#L61" title="ocaml/ocamltest/ocaml_actions.ml:61">filenames</a></span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li><a id="L65">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">libraries</span></span> <span class="ocamlLCIdentifier"><a href="ocaml_tools.ml.html#L66" title="ocaml/ocamltest/ocaml_tools.ml:66">backend</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">extension</span> <span class="Statement">=</span> <span class="PreProc">Ocaml_backends</span>.<span class="ocamlLCIdentifier"><a href="ocaml_backends.ml.html#L36" title="ocaml/ocamltest/ocaml_backends.ml:36">library_extension</a></span> <span class="ocamlLCIdentifier"><a href="ocaml_tools.ml.html#L66" title="ocaml/ocamltest/ocaml_tools.ml:66">backend</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier"><a href="#L59" title="ocaml/ocamltest/ocaml_actions.ml:59">filelist</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="PreProc">Ocaml_variables</span>.<span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L65" title="ocaml/ocamltest/ocaml_variables.mli:65">libraries</a></span> <span class="ocamlLCIdentifier">extension<br/></li>
<li></span><br/></li>
<li><a id="L69">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">binary_modules</span></span> <span class="ocamlLCIdentifier"><a href="ocaml_tools.ml.html#L66" title="ocaml/ocamltest/ocaml_tools.ml:66">backend</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">extension</span> <span class="Statement">=</span> <span class="PreProc">Ocaml_backends</span>.<span class="ocamlLCIdentifier"><a href="ocaml_backends.ml.html#L34" title="ocaml/ocamltest/ocaml_backends.ml:34">module_extension</a></span> <span class="ocamlLCIdentifier"><a href="ocaml_tools.ml.html#L66" title="ocaml/ocamltest/ocaml_tools.ml:66">backend</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier"><a href="#L59" title="ocaml/ocamltest/ocaml_actions.ml:59">filelist</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="PreProc">Ocaml_variables</span>.<span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L24" title="ocaml/ocamltest/ocaml_variables.mli:24">binary_modules</a></span> <span class="ocamlLCIdentifier">extension<br/></li>
<li></span><br/></li>
<li><a id="L73">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">backend_default_flags</span></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier"><a href="#L30" title="ocaml/ocamltest/ocaml_actions.ml:30">get_backend_value_from_env</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a><br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Ocaml_variables</span>.<span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L89" title="ocaml/ocamltest/ocaml_variables.mli:89">ocamlc_default_flags</a><br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Ocaml_variables</span>.<span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L94" title="ocaml/ocamltest/ocaml_variables.mli:94">ocamlopt_default_flags</a><br/></li>
<li></span><br/></li>
<li><a id="L78">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">backend_flags</span></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier"><a href="#L30" title="ocaml/ocamltest/ocaml_actions.ml:30">get_backend_value_from_env</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a><br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Ocaml_variables</span>.<span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L88" title="ocaml/ocamltest/ocaml_variables.mli:88">ocamlc_flags</a><br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Ocaml_variables</span>.<span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L93" title="ocaml/ocamltest/ocaml_variables.mli:93">ocamlopt_flags</a><br/></li>
<li></span><br/></li>
<li><a id="L83">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">env_setting</span></span> <span class="ocamlLCIdentifier">env_reader</span> <span class="ocamlLCIdentifier">default_setting</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="PreProc">Printf</span>.<span class="ocamlLCIdentifier">sprintf</span> <span class="Constant">&quot;%s=%s&quot;<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier">env_reader</span>.<span class="PreProc">Clflags</span>.<span class="ocamlLCIdentifier">env_var<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">(</span><span class="ocamlLCIdentifier">env_reader</span>.<span class="PreProc">Clflags</span>.<span class="ocamlLCIdentifier">print</span> <span class="ocamlLCIdentifier">default_setting</span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li><a id="L88">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">default_ocaml_env</span></span> <span class="Statement">=</span> <span class="Statement">[|<br/></li>
<li></span>&nbsp; <span class="Constant">&quot;TERM=dumb&quot;</span><span class="Statement">;<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier"><a href="#L83" title="ocaml/ocamltest/ocaml_actions.ml:83">env_setting</a></span> <span class="PreProc">Clflags</span>.<span class="ocamlLCIdentifier">color_reader</span> <span class="PreProc">Misc</span>.<span class="PreProc">Color</span>.<span class="ocamlLCIdentifier">default_setting</span><span class="Statement">;<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier"><a href="#L83" title="ocaml/ocamltest/ocaml_actions.ml:83">env_setting</a></span> <span class="PreProc">Clflags</span>.<span class="ocamlLCIdentifier">error_style_reader</span> <span class="PreProc">Misc</span>.<span class="PreProc">Error_style</span>.<span class="ocamlLCIdentifier">default_setting</span><span class="Statement">;<br/></li>
<li></span><span class="Statement">|]<br/></li>
<li></span><br/></li>
<li><a id="L94">&#x200c;</a><span class="Statement">type</span> <span class="ocamlLCIdentifier"><span class="linkable">module_generator</span></span> <span class="Statement">=</span> <span class="Statement">{<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier"><a href="actions.mli.html#L24" title="ocaml/ocamltest/actions.mli:24">description</a></span> : <span class="Type">string</span><span class="Statement">;<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier">command</span> : <span class="Type">string</span><span class="Statement">;<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L61" title="ocaml/ocamltest/ocaml_variables.mli:61">flags</a></span> : <span class="PreProc">Environments</span>.<span class="ocamlLCIdentifier"><a href="environments.ml.html#L22" title="ocaml/ocamltest/environments.ml:22">t</a></span> <span class="Statement">-&gt;</span> <span class="Type">string</span><span class="Statement">;<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier">generated_compilation_units</span> :<br/></li>
<li>&nbsp; &nbsp; <span class="Type">string</span> <span class="Statement">-&gt;</span> <span class="Statement">(</span><span class="Type">string</span> <span class="Statement">*</span> <span class="PreProc">Ocaml_filetypes</span>.<span class="ocamlLCIdentifier"><a href="environments.ml.html#L22" title="ocaml/ocamltest/environments.ml:22">t</a></span><span class="Statement">)</span> <span class="Type">list<br/></li>
<li></span><span class="Statement">}<br/></li>
<li></span><br/></li>
<li><a id="L102">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">ocamllex</span></span> <span class="Statement">=<br/></li>
<li></span><span class="Statement">{<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier"><a href="actions.mli.html#L24" title="ocaml/ocamltest/actions.mli:24">description</a></span> <span class="Statement">=</span> <span class="Constant">&quot;lexer&quot;</span><span class="Statement">;<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier">command</span> <span class="Statement">=</span> <span class="PreProc">Ocaml_commands</span>.<span class="ocamlLCIdentifier"><a href="ocaml_commands.ml.html#L30" title="ocaml/ocamltest/ocaml_commands.ml:30">ocamlrun_ocamllex</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L61" title="ocaml/ocamltest/ocaml_variables.mli:61">flags</a></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L91" title="ocaml/ocamltest/ocaml_variables.mli:91">ocamllex_flags</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier">generated_compilation_units</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">fun</span> <span class="ocamlLCIdentifier">lexer_name</span> <span class="Statement">-&gt;</span> <span class="Statement">[(</span><span class="ocamlLCIdentifier">lexer_name</span>, <span class="PreProc">Ocaml_filetypes</span>.<span class="Constant">Implementation</span><span class="Statement">)]<br/></li>
<li></span><span class="Statement">}<br/></li>
<li></span><br/></li>
<li><a id="L111">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">ocamlyacc</span></span> <span class="Statement">=<br/></li>
<li></span><span class="Statement">{<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier"><a href="actions.mli.html#L24" title="ocaml/ocamltest/actions.mli:24">description</a></span> <span class="Statement">=</span> <span class="Constant">&quot;parser&quot;</span><span class="Statement">;<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier">command</span> <span class="Statement">=</span> <span class="PreProc">Ocaml_files</span>.<span class="ocamlLCIdentifier"><a href="ocaml_files.ml.html#L70" title="ocaml/ocamltest/ocaml_files.ml:70">ocamlyacc</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L61" title="ocaml/ocamltest/ocaml_variables.mli:61">flags</a></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L96" title="ocaml/ocamltest/ocaml_variables.mli:96">ocamlyacc_flags</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier">generated_compilation_units</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">fun</span> <span class="ocamlLCIdentifier">parser_name</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">[<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="ocamlLCIdentifier">parser_name</span>, <span class="PreProc">Ocaml_filetypes</span>.<span class="Constant">Interface</span><span class="Statement">);<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="ocamlLCIdentifier">parser_name</span>, <span class="PreProc">Ocaml_filetypes</span>.<span class="Constant">Implementation</span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">]<br/></li>
<li></span><span class="Statement">}<br/></li>
<li></span><br/></li>
<li><a id="L124">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">generate_module</span></span> <span class="ocamlLCIdentifier">generator</span> <span class="ocamlLCIdentifier">output_variable</span> <span class="ocamlLCIdentifier">input</span> <span class="ocamlLCIdentifier"><a href="main.ml.html#L166" title="ocaml/ocamltest/main.ml:166">log</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">basename</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">fst</span> <span class="ocamlLCIdentifier">input</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">input_file</span> <span class="Statement">=</span> <span class="PreProc">Ocaml_filetypes</span>.<span class="ocamlLCIdentifier"><a href="ocaml_filetypes.ml.html#L106" title="ocaml/ocamltest/ocaml_filetypes.ml:106">make_filename</a></span> <span class="ocamlLCIdentifier">input</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="#L227" title="ocaml/ocamltest/ocaml_actions.ml:227">what</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Printf</span>.<span class="ocamlLCIdentifier">sprintf</span> <span class="Constant">&quot;Generating %s module from %s&quot;<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier">generator</span>.<span class="ocamlLCIdentifier"><a href="actions.mli.html#L24" title="ocaml/ocamltest/actions.mli:24">description</a></span> <span class="ocamlLCIdentifier">input_file<br/></li>
<li></span>&nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="PreProc">Printf</span>.<span class="ocamlLCIdentifier">fprintf</span> <span class="ocamlLCIdentifier"><a href="main.ml.html#L166" title="ocaml/ocamltest/main.ml:166">log</a></span> <span class="Constant">&quot;%s\<a href="actions_helpers.ml.html#L174" title="ocaml/ocamltest/actions_helpers.ml:174">n</a>%!&quot;</span> <span class="ocamlLCIdentifier"><a href="#L227" title="ocaml/ocamltest/ocaml_actions.ml:227">what</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L24" title="ocaml/ocamltest/builtin_variables.mli:24">commandline</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">[<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier">generator</span>.<span class="ocamlLCIdentifier">command</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier">generator</span>.<span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L61" title="ocaml/ocamltest/ocaml_variables.mli:61">flags</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier">input_file<br/></li>
<li></span>&nbsp; <span class="Statement">]</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="ocaml_tools.ml.html#L50" title="ocaml/ocamltest/ocaml_tools.ml:50">expected_exit_status</a></span> <span class="Statement">=</span> <span class="Constant">0</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L28" title="ocaml/ocamltest/builtin_variables.mli:28">exit_status</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Actions_helpers</span>.<span class="ocamlLCIdentifier"><a href="actions_helpers.ml.html#L117" title="ocaml/ocamltest/actions_helpers.ml:117">run_cmd</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier"><a href="environments.ml.html#L199" title="ocaml/ocamltest/environments.ml:199">environment</a></span>:<span class="ocamlLCIdentifier"><a href="#L88" title="ocaml/ocamltest/ocaml_actions.ml:88">default_ocaml_env</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier">stdin_variable</span>: <span class="PreProc">Ocaml_variables</span>.<span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L51" title="ocaml/ocamltest/ocaml_variables.mli:51">compiler_stdin</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier">stdout_variable</span>:<span class="ocamlLCIdentifier">output_variable<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier">stderr_variable</span>:<span class="ocamlLCIdentifier">output_variable<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier"><a href="ocaml_modifiers.ml.html#L22" title="ocaml/ocamltest/ocaml_modifiers.ml:22">append</a></span>:<span class="Constant">true<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="main.ml.html#L166" title="ocaml/ocamltest/main.ml:166">log</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L24" title="ocaml/ocamltest/builtin_variables.mli:24">commandline</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L28" title="ocaml/ocamltest/builtin_variables.mli:28">exit_status</a></span><span class="Statement">=</span><span class="ocamlLCIdentifier"><a href="ocaml_tools.ml.html#L50" title="ocaml/ocamltest/ocaml_tools.ml:50">expected_exit_status</a><br/></li>
<li></span><span class="ocamlNone">&nbsp; </span><span class="Statement">then</span> <span class="ocamlLCIdentifier">generator</span>.<span class="ocamlLCIdentifier">generated_compilation_units</span> <span class="ocamlLCIdentifier">basename<br/></li>
<li></span>&nbsp; <span class="Statement">else</span> <span class="Statement">begin<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L47" title="ocaml/ocamltest/builtin_variables.mli:47">reason</a></span><span class="ocamlEnd"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">(</span><span class="PreProc">Actions_helpers</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier"><a href="actions_helpers.ml.html#L35" title="ocaml/ocamltest/actions_helpers.ml:35">mkreason</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="#L227" title="ocaml/ocamltest/ocaml_actions.ml:227">what</a></span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="PreProc">String</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">concat</span><span class="ocamlEnd"> </span><span class="Constant">&quot; &quot;</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L24" title="ocaml/ocamltest/builtin_variables.mli:24">commandline</a></span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L28" title="ocaml/ocamltest/builtin_variables.mli:28">exit_status</a></span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="PreProc">Printf</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">fprintf</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="main.ml.html#L166" title="ocaml/ocamltest/main.ml:166">log</a></span><span class="ocamlEnd"> </span><span class="Constant">&quot;%s\<a href="actions_helpers.ml.html#L174" title="ocaml/ocamltest/actions_helpers.ml:174">n</a>%!&quot;</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L47" title="ocaml/ocamltest/builtin_variables.mli:47">reason</a></span><span class="Statement">;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="Constant">[]<br/></li>
<li></span><span class="ocamlEnd">&nbsp; </span><span class="Statement">end<br/></li>
<li></span><br/></li>
<li><span class="Statement">let</span> <span class="ocamlLCIdentifier">generate_lexer</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="#L124" title="ocaml/ocamltest/ocaml_actions.ml:124">generate_module</a></span> <span class="ocamlLCIdentifier"><a href="ocaml_files.ml.html#L66" title="ocaml/ocamltest/ocaml_files.ml:66">ocamllex</a><br/></li>
<li></span><br/></li>
<li><a id="L159">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">generate_parser</span></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="#L124" title="ocaml/ocamltest/ocaml_actions.ml:124">generate_module</a></span> <span class="ocamlLCIdentifier"><a href="ocaml_files.ml.html#L70" title="ocaml/ocamltest/ocaml_files.ml:70">ocamlyacc</a><br/></li>
<li></span><br/></li>
<li><a id="L161">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">prepare_module</span></span> <span class="ocamlLCIdentifier">output_variable</span> <span class="ocamlLCIdentifier"><a href="main.ml.html#L166" title="ocaml/ocamltest/main.ml:166">log</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="ocamlLCIdentifier">input</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">input_type</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">snd</span> <span class="ocamlLCIdentifier">input</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="Statement"><a href="actions_helpers.ml.html#L299" title="ocaml/ocamltest/actions_helpers.ml:299">open</a></span><span class="ocamlNone"> </span><span class="PreProc">Ocaml_filetypes</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">match</span> <span class="ocamlLCIdentifier">input_type</span> <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Implementation</span> <span class="Statement">|</span> <span class="Constant">Interface</span> <span class="Statement">|</span> <span class="Constant">C</span> <span class="Statement">|</span> <span class="Constant">Obj</span> <span class="Statement">-&gt;</span> <span class="Statement">[</span><span class="ocamlLCIdentifier">input</span><span class="Statement">]<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Binary_interface</span> <span class="Statement">-&gt;</span> <span class="Statement">[</span><span class="ocamlLCIdentifier">input</span><span class="Statement">]<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Backend_specific</span> <span class="Statement">_</span> <span class="Statement">-&gt;</span> <span class="Statement">[</span><span class="ocamlLCIdentifier">input</span><span class="Statement">]<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">C_minus_minus</span> <span class="Statement">-&gt;</span> <span class="Statement">assert</span> <span class="Constant">false<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Lexer</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">generate_lexer</span> <span class="ocamlLCIdentifier">output_variable</span> <span class="ocamlLCIdentifier">input</span> <span class="ocamlLCIdentifier"><a href="main.ml.html#L166" title="ocaml/ocamltest/main.ml:166">log</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a><br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Grammar</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L159" title="ocaml/ocamltest/ocaml_actions.ml:159">generate_parser</a></span> <span class="ocamlLCIdentifier">output_variable</span> <span class="ocamlLCIdentifier">input</span> <span class="ocamlLCIdentifier"><a href="main.ml.html#L166" title="ocaml/ocamltest/main.ml:166">log</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a><br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Text</span> <span class="Statement">-&gt;</span> <span class="Statement">assert</span> <span class="Constant">false<br/></li>
<li></span><br/></li>
<li><span class="Statement">let</span> <span class="ocamlLCIdentifier">get_program_file</span> <span class="ocamlLCIdentifier"><a href="ocaml_tools.ml.html#L66" title="ocaml/ocamltest/ocaml_tools.ml:66">backend</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="actions_helpers.ml.html#L39" title="ocaml/ocamltest/actions_helpers.ml:39">testfile</a></span> <span class="Statement">=</span> <span class="PreProc">Actions_helpers</span>.<span class="ocamlLCIdentifier"><a href="actions_helpers.ml.html#L39" title="ocaml/ocamltest/actions_helpers.ml:39">testfile</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">testfile_basename</span> <span class="Statement">=</span> <span class="PreProc">Filename</span>.<span class="ocamlLCIdentifier">chop_extension</span> <span class="ocamlLCIdentifier"><a href="actions_helpers.ml.html#L39" title="ocaml/ocamltest/actions_helpers.ml:39">testfile</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">program_filename</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Filename</span>.<span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L70" title="ocaml/ocamltest/ocaml_variables.mli:70">mkexe</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="PreProc">Filename</span>.<span class="ocamlLCIdentifier"><a href="ocaml_filetypes.ml.html#L106" title="ocaml/ocamltest/ocaml_filetypes.ml:106">make_filename</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">testfile_basename</span> <span class="Statement">(</span><span class="PreProc">Ocaml_backends</span>.<span class="ocamlLCIdentifier"><a href="ocaml_backends.ml.html#L38" title="ocaml/ocamltest/ocaml_backends.ml:38">executable_extension</a></span> <span class="ocamlLCIdentifier"><a href="ocaml_tools.ml.html#L66" title="ocaml/ocamltest/ocaml_tools.ml:66">backend</a></span><span class="Statement">))</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L64" title="ocaml/ocamltest/builtin_variables.mli:64">test_build_directory</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Actions_helpers</span>.<span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L64" title="ocaml/ocamltest/builtin_variables.mli:64">test_build_directory</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="PreProc">Filename</span>.<span class="ocamlLCIdentifier">make_path</span> <span class="Statement">[</span><span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L64" title="ocaml/ocamltest/builtin_variables.mli:64">test_build_directory</a></span><span class="Statement">;</span> <span class="ocamlLCIdentifier">program_filename</span><span class="Statement">]<br/></li>
<li></span><br/></li>
<li><a id="L186">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">is_c_file</span></span> <span class="Statement">(</span><span class="ocamlLCIdentifier">_filename</span>, <span class="ocamlLCIdentifier"><a href="filecompare.ml.html#L54" title="ocaml/ocamltest/filecompare.ml:54">filetype</a></span><span class="Statement">)</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="filecompare.ml.html#L54" title="ocaml/ocamltest/filecompare.ml:54">filetype</a></span><span class="Statement">=</span><span class="PreProc">Ocaml_filetypes</span>.<span class="Constant">C<br/></li>
<li></span><br/></li>
<li><a id="L188">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">cmas_need_dynamic_loading</span></span> <span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L59" title="ocaml/ocamltest/ocaml_variables.mli:59">directories</a></span> <span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L65" title="ocaml/ocamltest/ocaml_variables.mli:65">libraries</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">loads_c_code</span> <span class="ocamlLCIdentifier">library</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">library</span> <span class="Statement">=</span> <span class="PreProc">Misc</span>.<span class="ocamlLCIdentifier">find_in_path</span> <span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L59" title="ocaml/ocamltest/ocaml_variables.mli:59">directories</a></span> <span class="ocamlLCIdentifier">library</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">ic</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">open_in_bin</span> <span class="ocamlLCIdentifier">library</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">try<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">len_magic_number</span> <span class="Statement">=</span> <span class="PreProc">String</span>.<span class="ocamlLCIdentifier">length</span> <span class="PreProc">Config</span>.<span class="ocamlLCIdentifier">cma_magic_number</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">magic_number</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">really_input_string</span> <span class="ocamlLCIdentifier">ic</span> <span class="ocamlLCIdentifier">len_magic_number</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">magic_number</span><span class="ocamlNone"> </span><span class="Statement">=</span><span class="ocamlNone"> </span><span class="PreProc">Config</span><span class="ocamlNone">.</span><span class="ocamlLCIdentifier">cma_magic_number</span><span class="ocamlNone"> </span><span class="Statement">then<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">toc_pos</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">input_binary_int</span> <span class="ocamlLCIdentifier">ic</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">seek_in</span> <span class="ocamlLCIdentifier">ic</span> <span class="ocamlLCIdentifier">toc_pos</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">toc</span> <span class="Statement">=</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">input_value</span> <span class="ocamlLCIdentifier">ic</span> : <span class="PreProc">Cmo_format</span>.<span class="ocamlLCIdentifier">library</span><span class="Statement">)</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">close_in</span> <span class="ocamlLCIdentifier">ic</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">toc</span><span class="ocamlNone">.</span><span class="PreProc">Cmo_format</span><span class="ocamlNone">.</span><span class="ocamlLCIdentifier">lib_dllibs</span><span class="ocamlNone"> </span><span class="Statement">&lt;&gt;</span><span class="ocamlNone"> </span><span class="Constant">[]</span><span class="ocamlNone"> </span><span class="Statement">then</span> <span class="Constant">Some</span> <span class="Statement">(</span><span class="Constant">Ok</span> <span class="Constant">()</span><span class="Statement">)</span> <span class="Statement">else</span> <span class="Constant">None<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">raise</span> <span class="Constant">End_of_file<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">with</span> <span class="Constant">End_of_file<br/></li>
<li></span>&nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">|</span> <span class="Constant">Sys_error</span> <span class="Statement">_</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">begin</span><span class="ocamlEnd"> </span><span class="Statement">try</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">close_in</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">ic</span><span class="ocamlEnd"> </span><span class="Statement">with</span><span class="ocamlEnd"> </span><span class="Constant">Sys_error</span><span class="ocamlEnd"> </span><span class="Statement">_</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;</span><span class="ocamlEnd"> </span><span class="Constant">()</span><span class="ocamlEnd"> </span><span class="Statement">end;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">Some</span> <span class="Statement">(</span><span class="Constant">Error</span> <span class="Statement">(</span><span class="Constant">&quot;Corrupt or non-CMA <a href="builtin_variables.mli.html#L30" title="ocaml/ocamltest/builtin_variables.mli:30">file</a>: &quot;</span> <span class="Statement">^</span> <span class="ocamlLCIdentifier">library</span><span class="Statement">))<br/></li>
<li></span>&nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="PreProc">List</span>.<span class="ocamlLCIdentifier">find_map</span> <span class="ocamlLCIdentifier">loads_c_code</span> <span class="Statement">(</span><span class="PreProc">String</span>.<span class="ocamlLCIdentifier"><a href="ocamltest_stdlib.ml.html#L57" title="ocaml/ocamltest/ocamltest_stdlib.ml:57">words</a></span> <span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L65" title="ocaml/ocamltest/ocaml_variables.mli:65">libraries</a></span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li><a id="L210">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">compile_program</span></span> <span class="Statement">(</span><span class="ocamlLCIdentifier">compiler</span> : <span class="PreProc">Ocaml_compilers</span>.<span class="ocamlLCIdentifier">compiler</span><span class="Statement">)</span> <span class="ocamlLCIdentifier"><a href="main.ml.html#L166" title="ocaml/ocamltest/main.ml:166">log</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">program_variable</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">compiler</span><span class="PreProc">#</span><span class="ocamlLCIdentifier">program_variable</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">program_file</span> <span class="Statement">=</span> <span class="PreProc">Environments</span>.<span class="ocamlLCIdentifier"><a href="environments.mli.html#L29" title="ocaml/ocamltest/environments.mli:29">safe_lookup</a></span> <span class="ocamlLCIdentifier">program_variable</span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L20" title="ocaml/ocamltest/ocaml_variables.mli:20">all_modules</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Actions_helpers</span>.<span class="ocamlLCIdentifier"><a href="actions_helpers.ml.html#L53" title="ocaml/ocamltest/actions_helpers.ml:53">words_of_variable</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="PreProc">Ocaml_variables</span>.<span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L20" title="ocaml/ocamltest/ocaml_variables.mli:20">all_modules</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">output_variable</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">compiler</span><span class="PreProc">#</span><span class="ocamlLCIdentifier">output_variable</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">prepare</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="#L161" title="ocaml/ocamltest/ocaml_actions.ml:161">prepare_module</a></span> <span class="ocamlLCIdentifier">output_variable</span> <span class="ocamlLCIdentifier"><a href="main.ml.html#L166" title="ocaml/ocamltest/main.ml:166">log</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L75" title="ocaml/ocamltest/ocaml_variables.mli:75">modules</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">List</span>.<span class="ocamlLCIdentifier">concatmap</span> <span class="ocamlLCIdentifier">prepare</span> <span class="Statement">(</span><span class="PreProc">List</span>.<span class="ocamlLCIdentifier">map</span> <span class="PreProc">Ocaml_filetypes</span>.<span class="ocamlLCIdentifier"><a href="filecompare.ml.html#L54" title="ocaml/ocamltest/filecompare.ml:54">filetype</a></span> <span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L20" title="ocaml/ocamltest/ocaml_variables.mli:20">all_modules</a></span><span class="Statement">)</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">has_c_file</span> <span class="Statement">=</span> <span class="PreProc">List</span>.<span class="ocamlLCIdentifier">exists</span> <span class="ocamlLCIdentifier"><a href="#L186" title="ocaml/ocamltest/ocaml_actions.ml:186">is_c_file</a></span> <span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L75" title="ocaml/ocamltest/ocaml_variables.mli:75">modules</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">c_headers_flags</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">has_c_file</span><span class="ocamlNone"> </span><span class="Statement">then</span> <span class="PreProc">Ocaml_flags</span>.<span class="ocamlLCIdentifier"><a href="ocaml_flags.mli.html#L22" title="ocaml/ocamltest/ocaml_flags.mli:22">c_includes</a></span> <span class="Statement">else</span> <span class="Constant">&quot;&quot;</span> <span class="Statement">in<br/></li>
<li><a id="L222">&#x200c;</a></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">expected_exit_status</span></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Ocaml_tools</span>.<span class="ocamlLCIdentifier"><a href="ocaml_tools.ml.html#L50" title="ocaml/ocamltest/ocaml_tools.ml:50">expected_exit_status</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">(</span><span class="ocamlLCIdentifier">compiler</span> :<span class="Statement">&gt;</span> <span class="PreProc">Ocaml_tools</span>.<span class="ocamlLCIdentifier"><a href="filecompare.ml.html#L27" title="ocaml/ocamltest/filecompare.ml:27">tool</a></span><span class="Statement">)</span> <span class="Statement">in<br/></li>
<li><a id="L224">&#x200c;</a></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">module_names</span></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L24" title="ocaml/ocamltest/ocaml_variables.mli:24">binary_modules</a></span> <span class="ocamlLCIdentifier">compiler</span><span class="PreProc">#</span><span class="ocamlLCIdentifier">target</span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="Statement">)</span> <span class="Statement">^</span> <span class="Constant">&quot; &quot;</span> <span class="Statement">^<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">(</span><span class="PreProc">String</span>.<span class="ocamlLCIdentifier">concat</span> <span class="Constant">&quot; &quot;</span> <span class="Statement">(</span><span class="PreProc">List</span>.<span class="ocamlLCIdentifier">map</span> <span class="PreProc">Ocaml_filetypes</span>.<span class="ocamlLCIdentifier"><a href="ocaml_filetypes.ml.html#L106" title="ocaml/ocamltest/ocaml_filetypes.ml:106">make_filename</a></span> <span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L75" title="ocaml/ocamltest/ocaml_variables.mli:75">modules</a></span><span class="Statement">))</span> <span class="Statement">in<br/></li>
<li><a id="L227">&#x200c;</a></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">what</span></span> <span class="Statement">=</span> <span class="PreProc">Printf</span>.<span class="ocamlLCIdentifier">sprintf</span> <span class="Constant">&quot;Compiling <a href="builtin_variables.mli.html#L42" title="ocaml/ocamltest/builtin_variables.mli:42">program</a> %s from <a href="ocaml_variables.mli.html#L75" title="ocaml/ocamltest/ocaml_variables.mli:75">modules</a> %s&quot;<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier">program_file</span> <span class="ocamlLCIdentifier"><a href="#L224" title="ocaml/ocamltest/ocaml_actions.ml:224">module_names</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="PreProc">Printf</span>.<span class="ocamlLCIdentifier">fprintf</span> <span class="ocamlLCIdentifier"><a href="main.ml.html#L166" title="ocaml/ocamltest/main.ml:166">log</a></span> <span class="Constant">&quot;%s\<a href="actions_helpers.ml.html#L174" title="ocaml/ocamltest/actions_helpers.ml:174">n</a>%!&quot;</span> <span class="ocamlLCIdentifier"><a href="#L227" title="ocaml/ocamltest/ocaml_actions.ml:227">what</a></span><span class="Statement">;<br/></li>
<li><a id="L230">&#x200c;</a></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">compile_only</span></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Environments</span>.<span class="ocamlLCIdentifier"><a href="environments.ml.html#L93" title="ocaml/ocamltest/environments.ml:93">lookup_as_bool</a></span> <span class="PreProc">Ocaml_variables</span>.<span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L53" title="ocaml/ocamltest/ocaml_variables.mli:53">compile_only</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">=</span> <span class="Constant">Some</span> <span class="Constant">true<br/></li>
<li></span>&nbsp; <span class="Statement">in<br/></li>
<li><a id="L233">&#x200c;</a></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">compile_flags</span></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L53" title="ocaml/ocamltest/ocaml_variables.mli:53">compile_only</a></span><span class="ocamlNone"> </span><span class="Statement">then</span> <span class="Constant">&quot; -c &quot;</span> <span class="Statement">else</span> <span class="Constant">&quot;&quot;<br/></li>
<li></span>&nbsp; <span class="Statement">in<br/></li>
<li><a id="L236">&#x200c;</a></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">output</span></span> <span class="Statement">=</span> <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L53" title="ocaml/ocamltest/ocaml_variables.mli:53">compile_only</a></span><span class="ocamlNone"> </span><span class="Statement">then</span> <span class="Constant">&quot;&quot;</span> <span class="Statement">else</span> <span class="Constant">&quot;-o &quot;</span> <span class="Statement">^</span> <span class="ocamlLCIdentifier">program_file</span> <span class="Statement">in<br/></li>
<li><a id="L237">&#x200c;</a></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">libraries</span></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><span class="linkable">libraries</span></span> <span class="ocamlLCIdentifier">compiler</span><span class="PreProc">#</span><span class="ocamlLCIdentifier">target</span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">in<br/></li>
<li><a id="L238">&#x200c;</a></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">cmas_need_dynamic_loading</span></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="Statement">not</span><span class="ocamlNone"> </span><span class="PreProc">Config</span><span class="ocamlNone">.</span><span class="ocamlLCIdentifier">supports_shared_libraries</span><span class="ocamlNone"> </span><span class="Statement">&amp;&amp;<br/></li>
<li></span><span class="ocamlNone">&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="ocamlLCIdentifier">compiler</span><span class="PreProc">#</span><span class="ocamlLCIdentifier">target</span><span class="ocamlNone"> </span><span class="Statement">=</span><span class="ocamlNone"> </span><span class="PreProc">Ocaml_backends</span><span class="ocamlNone">.</span><span class="Constant">Bytecode</span><span class="ocamlNone"> </span><span class="Statement">then<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L188" title="ocaml/ocamltest/ocaml_actions.ml:188">cmas_need_dynamic_loading</a></span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L59" title="ocaml/ocamltest/ocaml_variables.mli:59">directories</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="Statement">)</span> <span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L65" title="ocaml/ocamltest/ocaml_variables.mli:65">libraries</a><br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Constant">None<br/></li>
<li></span>&nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">match</span> <span class="ocamlLCIdentifier"><a href="#L188" title="ocaml/ocamltest/ocaml_actions.ml:188">cmas_need_dynamic_loading</a></span> <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Some</span> <span class="Statement">(</span><span class="Constant">Error</span> <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L47" title="ocaml/ocamltest/builtin_variables.mli:47">reason</a></span><span class="Statement">)</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="PreProc">Result</span>.<span class="ocamlLCIdentifier"><a href="result.ml.html#L39" title="ocaml/ocamltest/result.ml:39">fail_with_reason</a></span> <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L47" title="ocaml/ocamltest/builtin_variables.mli:47">reason</a></span>, <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Statement">_</span> <span class="Statement">-&gt;<br/></li>
<li><a id="L249">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">bytecode_links_c_code</span></span> <span class="Statement">=</span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L188" title="ocaml/ocamltest/ocaml_actions.ml:188">cmas_need_dynamic_loading</a></span> <span class="Statement">=</span> <span class="Constant">Some</span> <span class="Statement">(</span><span class="Constant">Ok</span> <span class="Constant">()</span><span class="Statement">))</span> <span class="Statement">in<br/></li>
<li><a id="L250">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">commandline</span></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">[<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">compiler</span><span class="PreProc">#</span><span class="ocamlLCIdentifier"><a href="actions.mli.html#L22" title="ocaml/ocamltest/actions.mli:22">name</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="PreProc">Ocaml_flags</span>.<span class="ocamlLCIdentifier"><a href="ocaml_flags.mli.html#L24" title="ocaml/ocamltest/ocaml_flags.mli:24">runtime_flags</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="ocamlLCIdentifier">compiler</span><span class="PreProc">#</span><span class="ocamlLCIdentifier">target<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="ocamlLCIdentifier">has_c_file</span> <span class="Statement">||</span> <span class="ocamlLCIdentifier"><a href="#L249" title="ocaml/ocamltest/ocaml_actions.ml:249">bytecode_links_c_code</a></span><span class="Statement">);<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">c_headers_flags</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="PreProc">Ocaml_flags</span>.<span class="ocamlLCIdentifier"><a href="ocaml_directories.ml.html#L23" title="ocaml/ocamltest/ocaml_directories.ml:23">stdlib</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L44" title="ocaml/ocamltest/ocaml_actions.ml:44">directory_flags</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L61" title="ocaml/ocamltest/ocaml_variables.mli:61">flags</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L65" title="ocaml/ocamltest/ocaml_variables.mli:65">libraries</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L73" title="ocaml/ocamltest/ocaml_actions.ml:73">backend_default_flags</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="ocamlLCIdentifier">compiler</span><span class="PreProc">#</span><span class="ocamlLCIdentifier">target</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L78" title="ocaml/ocamltest/ocaml_actions.ml:78">backend_flags</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="ocamlLCIdentifier">compiler</span><span class="PreProc">#</span><span class="ocamlLCIdentifier">target</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L233" title="ocaml/ocamltest/ocaml_actions.ml:233">compile_flags</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L40" title="ocaml/ocamltest/builtin_variables.mli:40">output</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="PreProc">Environments</span>.<span class="ocamlLCIdentifier"><a href="environments.mli.html#L29" title="ocaml/ocamltest/environments.mli:29">safe_lookup</a></span> <span class="PreProc">Ocaml_variables</span>.<span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L100" title="ocaml/ocamltest/ocaml_variables.mli:100">ocaml_filetype_flag</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="Statement">);<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L224" title="ocaml/ocamltest/ocaml_actions.ml:224">module_names</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L63" title="ocaml/ocamltest/ocaml_variables.mli:63">last_flags</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">]</span> <span class="Statement">in<br/></li>
<li><a id="L268">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">exit_status</span></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="PreProc">Actions_helpers</span>.<span class="ocamlLCIdentifier"><a href="actions_helpers.ml.html#L117" title="ocaml/ocamltest/actions_helpers.ml:117">run_cmd</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier"><a href="environments.ml.html#L199" title="ocaml/ocamltest/environments.ml:199">environment</a></span>:<span class="ocamlLCIdentifier"><a href="#L88" title="ocaml/ocamltest/ocaml_actions.ml:88">default_ocaml_env</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier">stdin_variable</span>: <span class="PreProc">Ocaml_variables</span>.<span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L51" title="ocaml/ocamltest/ocaml_variables.mli:51">compiler_stdin</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier">stdout_variable</span>:<span class="ocamlLCIdentifier">compiler</span><span class="PreProc">#</span><span class="ocamlLCIdentifier">output_variable<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier">stderr_variable</span>:<span class="ocamlLCIdentifier">compiler</span><span class="PreProc">#</span><span class="ocamlLCIdentifier">output_variable<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier"><a href="ocaml_modifiers.ml.html#L22" title="ocaml/ocamltest/ocaml_modifiers.ml:22">append</a></span>:<span class="Constant">true<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="main.ml.html#L166" title="ocaml/ocamltest/main.ml:166">log</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L24" title="ocaml/ocamltest/builtin_variables.mli:24">commandline</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L28" title="ocaml/ocamltest/builtin_variables.mli:28">exit_status</a></span><span class="Statement">=</span><span class="ocamlLCIdentifier"><a href="ocaml_tools.ml.html#L50" title="ocaml/ocamltest/ocaml_tools.ml:50">expected_exit_status</a><br/></li>
<li></span><span class="ocamlNone">&nbsp; &nbsp; &nbsp; </span><span class="Statement">then</span> <span class="Statement">(</span><span class="PreProc">Result</span>.<span class="ocamlLCIdentifier"><a href="builtin_actions.mli.html#L18" title="ocaml/ocamltest/builtin_actions.mli:18">pass</a></span>, <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">else</span> <span class="Statement">begin<br/></li>
<li><a id="L279">&#x200c;</a></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><span class="linkable">reason</span></span><span class="ocamlEnd"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">(</span><span class="PreProc">Actions_helpers</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier"><a href="actions_helpers.ml.html#L35" title="ocaml/ocamltest/actions_helpers.ml:35">mkreason</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="#L227" title="ocaml/ocamltest/ocaml_actions.ml:227">what</a></span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="PreProc">String</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">concat</span><span class="ocamlEnd"> </span><span class="Constant">&quot; &quot;</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L24" title="ocaml/ocamltest/builtin_variables.mli:24">commandline</a></span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L28" title="ocaml/ocamltest/builtin_variables.mli:28">exit_status</a></span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">(</span><span class="PreProc">Result</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier"><a href="result.ml.html#L39" title="ocaml/ocamltest/result.ml:39">fail_with_reason</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L47" title="ocaml/ocamltest/builtin_variables.mli:47">reason</a></span><span class="ocamlEnd">, </span><span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="Statement">)<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">end<br/></li>
<li></span><br/></li>
<li><a id="L285">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">compile_module</span></span> <span class="ocamlLCIdentifier">compiler</span> <span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L73" title="ocaml/ocamltest/ocaml_variables.mli:73">module_</a></span> <span class="ocamlLCIdentifier"><a href="main.ml.html#L166" title="ocaml/ocamltest/main.ml:166">log</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="ocaml_tools.ml.html#L50" title="ocaml/ocamltest/ocaml_tools.ml:50">expected_exit_status</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Ocaml_tools</span>.<span class="ocamlLCIdentifier"><a href="ocaml_tools.ml.html#L50" title="ocaml/ocamltest/ocaml_tools.ml:50">expected_exit_status</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">(</span><span class="ocamlLCIdentifier">compiler</span> :<span class="Statement">&gt;</span> <span class="PreProc">Ocaml_tools</span>.<span class="ocamlLCIdentifier"><a href="filecompare.ml.html#L27" title="ocaml/ocamltest/filecompare.ml:27">tool</a></span><span class="Statement">)</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="#L227" title="ocaml/ocamltest/ocaml_actions.ml:227">what</a></span> <span class="Statement">=</span> <span class="PreProc">Printf</span>.<span class="ocamlLCIdentifier">sprintf</span> <span class="Constant">&quot;Compiling module %s&quot;</span> <span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L73" title="ocaml/ocamltest/ocaml_variables.mli:73">module_</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="PreProc">Printf</span>.<span class="ocamlLCIdentifier">fprintf</span> <span class="ocamlLCIdentifier"><a href="main.ml.html#L166" title="ocaml/ocamltest/main.ml:166">log</a></span> <span class="Constant">&quot;%s\<a href="actions_helpers.ml.html#L174" title="ocaml/ocamltest/actions_helpers.ml:174">n</a>%!&quot;</span> <span class="ocamlLCIdentifier"><a href="#L227" title="ocaml/ocamltest/ocaml_actions.ml:227">what</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">module_with_filetype</span> <span class="Statement">=</span> <span class="PreProc">Ocaml_filetypes</span>.<span class="ocamlLCIdentifier"><a href="filecompare.ml.html#L54" title="ocaml/ocamltest/filecompare.ml:54">filetype</a></span> <span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L73" title="ocaml/ocamltest/ocaml_variables.mli:73">module_</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">is_c</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="#L186" title="ocaml/ocamltest/ocaml_actions.ml:186">is_c_file</a></span> <span class="ocamlLCIdentifier">module_with_filetype</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">c_headers_flags</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">is_c</span><span class="ocamlNone"> </span><span class="Statement">then</span> <span class="PreProc">Ocaml_flags</span>.<span class="ocamlLCIdentifier"><a href="ocaml_flags.mli.html#L22" title="ocaml/ocamltest/ocaml_flags.mli:22">c_includes</a></span> <span class="Statement">else</span> <span class="Constant">&quot;&quot;</span> <span class="Statement">in<br/></li>
<li><a id="L294">&#x200c;</a></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">commandline</span></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">[<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier">compiler</span><span class="PreProc">#</span><span class="ocamlLCIdentifier"><a href="actions.mli.html#L22" title="ocaml/ocamltest/actions.mli:22">name</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Ocaml_flags</span>.<span class="ocamlLCIdentifier"><a href="ocaml_directories.ml.html#L23" title="ocaml/ocamltest/ocaml_directories.ml:23">stdlib</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier">c_headers_flags</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L44" title="ocaml/ocamltest/ocaml_actions.ml:44">directory_flags</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L61" title="ocaml/ocamltest/ocaml_variables.mli:61">flags</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L65" title="ocaml/ocamltest/ocaml_variables.mli:65">libraries</a></span> <span class="ocamlLCIdentifier">compiler</span><span class="PreProc">#</span><span class="ocamlLCIdentifier">target</span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L73" title="ocaml/ocamltest/ocaml_actions.ml:73">backend_default_flags</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="ocamlLCIdentifier">compiler</span><span class="PreProc">#</span><span class="ocamlLCIdentifier">target</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L78" title="ocaml/ocamltest/ocaml_actions.ml:78">backend_flags</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="ocamlLCIdentifier">compiler</span><span class="PreProc">#</span><span class="ocamlLCIdentifier">target</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">&quot;-c &quot;</span> <span class="Statement">^</span> <span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L73" title="ocaml/ocamltest/ocaml_variables.mli:73">module_</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; <span class="Statement">]</span> <span class="Statement">in<br/></li>
<li><a id="L306">&#x200c;</a></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">exit_status</span></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Actions_helpers</span>.<span class="ocamlLCIdentifier"><a href="actions_helpers.ml.html#L117" title="ocaml/ocamltest/actions_helpers.ml:117">run_cmd</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier"><a href="environments.ml.html#L199" title="ocaml/ocamltest/environments.ml:199">environment</a></span>:<span class="ocamlLCIdentifier"><a href="#L88" title="ocaml/ocamltest/ocaml_actions.ml:88">default_ocaml_env</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier">stdin_variable</span>: <span class="PreProc">Ocaml_variables</span>.<span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L51" title="ocaml/ocamltest/ocaml_variables.mli:51">compiler_stdin</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier">stdout_variable</span>:<span class="ocamlLCIdentifier">compiler</span><span class="PreProc">#</span><span class="ocamlLCIdentifier">output_variable<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier">stderr_variable</span>:<span class="ocamlLCIdentifier">compiler</span><span class="PreProc">#</span><span class="ocamlLCIdentifier">output_variable<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier"><a href="ocaml_modifiers.ml.html#L22" title="ocaml/ocamltest/ocaml_modifiers.ml:22">append</a></span>:<span class="Constant">true<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="main.ml.html#L166" title="ocaml/ocamltest/main.ml:166">log</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L24" title="ocaml/ocamltest/builtin_variables.mli:24">commandline</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L28" title="ocaml/ocamltest/builtin_variables.mli:28">exit_status</a></span><span class="Statement">=</span><span class="ocamlLCIdentifier"><a href="ocaml_tools.ml.html#L50" title="ocaml/ocamltest/ocaml_tools.ml:50">expected_exit_status</a><br/></li>
<li></span><span class="ocamlNone">&nbsp; </span><span class="Statement">then</span> <span class="Statement">(</span><span class="PreProc">Result</span>.<span class="ocamlLCIdentifier"><a href="builtin_actions.mli.html#L18" title="ocaml/ocamltest/builtin_actions.mli:18">pass</a></span>, <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">else</span> <span class="Statement">begin<br/></li>
<li><a id="L317">&#x200c;</a></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><span class="linkable">reason</span></span><span class="ocamlEnd"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">(</span><span class="PreProc">Actions_helpers</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier"><a href="actions_helpers.ml.html#L35" title="ocaml/ocamltest/actions_helpers.ml:35">mkreason</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="#L227" title="ocaml/ocamltest/ocaml_actions.ml:227">what</a></span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="PreProc">String</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">concat</span><span class="ocamlEnd"> </span><span class="Constant">&quot; &quot;</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L24" title="ocaml/ocamltest/builtin_variables.mli:24">commandline</a></span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L28" title="ocaml/ocamltest/builtin_variables.mli:28">exit_status</a></span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="Statement">(</span><span class="PreProc">Result</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier"><a href="result.ml.html#L39" title="ocaml/ocamltest/result.ml:39">fail_with_reason</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L47" title="ocaml/ocamltest/builtin_variables.mli:47">reason</a></span><span class="ocamlEnd">, </span><span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="Statement">)<br/></li>
<li></span><span class="ocamlEnd">&nbsp; </span><span class="Statement">end<br/></li>
<li></span><br/></li>
<li><a id="L323">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">module_has_interface</span></span> <span class="ocamlLCIdentifier">directory</span> <span class="ocamlLCIdentifier">module_name</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="#L965" title="ocaml/ocamltest/ocaml_actions.ml:965">interface_name</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Ocaml_filetypes</span>.<span class="ocamlLCIdentifier"><a href="ocaml_filetypes.ml.html#L106" title="ocaml/ocamltest/ocaml_filetypes.ml:106">make_filename</a></span> <span class="Statement">(</span><span class="ocamlLCIdentifier">module_name</span>, <span class="PreProc">Ocaml_filetypes</span>.<span class="Constant">Interface</span><span class="Statement">)</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">interface_fullpath</span> <span class="Statement">=</span> <span class="PreProc">Filename</span>.<span class="ocamlLCIdentifier">make_path</span> <span class="Statement">[</span><span class="ocamlLCIdentifier">directory</span><span class="Statement">;</span><span class="ocamlLCIdentifier"><a href="#L965" title="ocaml/ocamltest/ocaml_actions.ml:965">interface_name</a></span><span class="Statement">]</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="PreProc">Sys</span>.<span class="ocamlLCIdentifier"><a href="builtin_actions.mli.html#L51" title="ocaml/ocamltest/builtin_actions.mli:51">file_exists</a></span> <span class="ocamlLCIdentifier">interface_fullpath<br/></li>
<li></span><br/></li>
<li><a id="L329">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">add_module_interface</span></span> <span class="ocamlLCIdentifier">directory</span> <span class="ocamlLCIdentifier">module_description</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">match</span> <span class="ocamlLCIdentifier">module_description</span> <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="ocaml_compilers.ml.html#L57" title="ocaml/ocamltest/ocaml_compilers.ml:57">filename</a></span>, <span class="PreProc">Ocaml_filetypes</span>.<span class="Constant">Implementation</span><span class="Statement">)</span> <span class="Statement">when<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L323" title="ocaml/ocamltest/ocaml_actions.ml:323">module_has_interface</a></span> <span class="ocamlLCIdentifier">directory</span> <span class="ocamlLCIdentifier"><a href="ocaml_compilers.ml.html#L57" title="ocaml/ocamltest/ocaml_compilers.ml:57">filename</a></span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">[(</span><span class="ocamlLCIdentifier"><a href="ocaml_compilers.ml.html#L57" title="ocaml/ocamltest/ocaml_compilers.ml:57">filename</a></span>, <span class="PreProc">Ocaml_filetypes</span>.<span class="Constant">Interface</span><span class="Statement">);</span> <span class="ocamlLCIdentifier">module_description</span><span class="Statement">]<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Statement">_</span> <span class="Statement">-&gt;</span> <span class="Statement">[</span><span class="ocamlLCIdentifier">module_description</span><span class="Statement">]<br/></li>
<li></span><br/></li>
<li><a id="L336">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">print_module_names</span></span> <span class="ocamlLCIdentifier"><a href="main.ml.html#L166" title="ocaml/ocamltest/main.ml:166">log</a></span> <span class="ocamlLCIdentifier"><a href="actions.mli.html#L24" title="ocaml/ocamltest/actions.mli:24">description</a></span> <span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L75" title="ocaml/ocamltest/ocaml_variables.mli:75">modules</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="PreProc">Printf</span>.<span class="ocamlLCIdentifier">fprintf</span> <span class="ocamlLCIdentifier"><a href="main.ml.html#L166" title="ocaml/ocamltest/main.ml:166">log</a></span> <span class="Constant">&quot;%s <a href="ocaml_variables.mli.html#L75" title="ocaml/ocamltest/ocaml_variables.mli:75">modules</a>: %s\<a href="actions_helpers.ml.html#L174" title="ocaml/ocamltest/actions_helpers.ml:174">n</a>%!&quot;<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="actions.mli.html#L24" title="ocaml/ocamltest/actions.mli:24">description</a><br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">(</span><span class="PreProc">String</span>.<span class="ocamlLCIdentifier">concat</span> <span class="Constant">&quot; &quot;</span> <span class="Statement">(</span><span class="PreProc">List</span>.<span class="ocamlLCIdentifier">map</span> <span class="PreProc">Ocaml_filetypes</span>.<span class="ocamlLCIdentifier"><a href="ocaml_filetypes.ml.html#L106" title="ocaml/ocamltest/ocaml_filetypes.ml:106">make_filename</a></span> <span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L75" title="ocaml/ocamltest/ocaml_variables.mli:75">modules</a></span><span class="Statement">))<br/></li>
<li></span><br/></li>
<li><a id="L341">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">find_source_modules</span></span> <span class="ocamlLCIdentifier"><a href="main.ml.html#L166" title="ocaml/ocamltest/main.ml:166">log</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">source_directory</span> <span class="Statement">=</span> <span class="PreProc">Actions_helpers</span>.<span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L69" title="ocaml/ocamltest/builtin_variables.mli:69">test_source_directory</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">specified_modules</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">List</span>.<span class="ocamlLCIdentifier">map</span> <span class="PreProc">Ocaml_filetypes</span>.<span class="ocamlLCIdentifier"><a href="filecompare.ml.html#L54" title="ocaml/ocamltest/filecompare.ml:54">filetype</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">((</span><span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L130" title="ocaml/ocamltest/ocaml_variables.mli:130">plugins</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="Statement">)</span> @ <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L75" title="ocaml/ocamltest/ocaml_variables.mli:75">modules</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="Statement">)</span> @ <span class="Statement">[(</span><span class="PreProc">Actions_helpers</span>.<span class="ocamlLCIdentifier"><a href="actions_helpers.ml.html#L39" title="ocaml/ocamltest/actions_helpers.ml:39">testfile</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="Statement">)])</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier"><a href="#L336" title="ocaml/ocamltest/ocaml_actions.ml:336">print_module_names</a></span> <span class="ocamlLCIdentifier"><a href="main.ml.html#L166" title="ocaml/ocamltest/main.ml:166">log</a></span> <span class="Constant">&quot;Specified&quot;</span> <span class="ocamlLCIdentifier">specified_modules</span><span class="Statement">;<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">source_modules</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">List</span>.<span class="ocamlLCIdentifier">concatmap<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L329" title="ocaml/ocamltest/ocaml_actions.ml:329">add_module_interface</a></span> <span class="ocamlLCIdentifier">source_directory</span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">specified_modules</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier"><a href="#L336" title="ocaml/ocamltest/ocaml_actions.ml:336">print_module_names</a></span> <span class="ocamlLCIdentifier"><a href="main.ml.html#L166" title="ocaml/ocamltest/main.ml:166">log</a></span> <span class="Constant">&quot;Source&quot;</span> <span class="ocamlLCIdentifier">source_modules</span><span class="Statement">;<br/></li>
<li></span>&nbsp; <span class="PreProc">Environments</span>.<span class="ocamlLCIdentifier"><a href="ocaml_modifiers.ml.html#L23" title="ocaml/ocamltest/ocaml_modifiers.ml:23">add</a><br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Ocaml_variables</span>.<span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L20" title="ocaml/ocamltest/ocaml_variables.mli:20">all_modules</a><br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">(</span><span class="PreProc">String</span>.<span class="ocamlLCIdentifier">concat</span> <span class="Constant">&quot; &quot;</span> <span class="Statement">(</span><span class="PreProc">List</span>.<span class="ocamlLCIdentifier">map</span> <span class="PreProc">Ocaml_filetypes</span>.<span class="ocamlLCIdentifier"><a href="ocaml_filetypes.ml.html#L106" title="ocaml/ocamltest/ocaml_filetypes.ml:106">make_filename</a></span> <span class="ocamlLCIdentifier">source_modules</span><span class="Statement">))<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a><br/></li>
<li></span><br/></li>
<li><a id="L357">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">setup_tool_build_env</span></span> <span class="ocamlLCIdentifier"><a href="filecompare.ml.html#L27" title="ocaml/ocamltest/filecompare.ml:27">tool</a></span> <span class="ocamlLCIdentifier"><a href="main.ml.html#L166" title="ocaml/ocamltest/main.ml:166">log</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">source_directory</span> <span class="Statement">=</span> <span class="PreProc">Actions_helpers</span>.<span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L69" title="ocaml/ocamltest/builtin_variables.mli:69">test_source_directory</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="actions_helpers.ml.html#L39" title="ocaml/ocamltest/actions_helpers.ml:39">testfile</a></span> <span class="Statement">=</span> <span class="PreProc">Actions_helpers</span>.<span class="ocamlLCIdentifier"><a href="actions_helpers.ml.html#L39" title="ocaml/ocamltest/actions_helpers.ml:39">testfile</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">testfile_basename</span> <span class="Statement">=</span> <span class="PreProc">Filename</span>.<span class="ocamlLCIdentifier">chop_extension</span> <span class="ocamlLCIdentifier"><a href="actions_helpers.ml.html#L39" title="ocaml/ocamltest/actions_helpers.ml:39">testfile</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">tool_reference_variable</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="filecompare.ml.html#L27" title="ocaml/ocamltest/filecompare.ml:27">tool</a></span><span class="PreProc">#</span><span class="ocamlLCIdentifier">reference_variable</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">tool_reference_prefix</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Filename</span>.<span class="ocamlLCIdentifier">make_path</span> <span class="Statement">[</span><span class="ocamlLCIdentifier">source_directory</span><span class="Statement">;</span> <span class="ocamlLCIdentifier">testfile_basename</span><span class="Statement">]</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">tool_reference_file</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="filecompare.ml.html#L27" title="ocaml/ocamltest/filecompare.ml:27">tool</a></span><span class="PreProc">#</span><span class="ocamlLCIdentifier">reference_file</span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="ocamlLCIdentifier">tool_reference_prefix<br/></li>
<li></span>&nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Environments</span>.<span class="ocamlLCIdentifier"><a href="environments.ml.html#L114" title="ocaml/ocamltest/environments.ml:114">add_if_undefined</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">tool_reference_variable<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">tool_reference_file</span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a><br/></li>
<li></span>&nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">source_modules</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Actions_helpers</span>.<span class="ocamlLCIdentifier"><a href="actions_helpers.ml.html#L53" title="ocaml/ocamltest/actions_helpers.ml:53">words_of_variable</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="PreProc">Ocaml_variables</span>.<span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L20" title="ocaml/ocamltest/ocaml_variables.mli:20">all_modules</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">tool_directory_suffix</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Environments</span>.<span class="ocamlLCIdentifier"><a href="environments.mli.html#L29" title="ocaml/ocamltest/environments.mli:29">safe_lookup</a></span> <span class="PreProc">Ocaml_variables</span>.<span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L39" title="ocaml/ocamltest/ocaml_variables.mli:39">compiler_directory_suffix</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">tool_directory_name</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="filecompare.ml.html#L27" title="ocaml/ocamltest/filecompare.ml:27">tool</a></span><span class="PreProc">#</span><span class="ocamlLCIdentifier">directory</span> <span class="Statement">^</span> <span class="ocamlLCIdentifier">tool_directory_suffix</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">build_dir</span> <span class="Statement">=</span> <span class="PreProc">Filename</span>.<span class="ocamlLCIdentifier">concat<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">(</span><span class="PreProc">Environments</span>.<span class="ocamlLCIdentifier"><a href="environments.mli.html#L29" title="ocaml/ocamltest/environments.mli:29">safe_lookup</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="PreProc">Builtin_variables</span>.<span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L65" title="ocaml/ocamltest/builtin_variables.mli:65">test_build_directory_prefix</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier">tool_directory_name</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">tool_output_variable</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="filecompare.ml.html#L27" title="ocaml/ocamltest/filecompare.ml:27">tool</a></span><span class="PreProc">#</span><span class="ocamlLCIdentifier">output_variable</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">tool_output_filename</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Filename</span>.<span class="ocamlLCIdentifier"><a href="ocaml_filetypes.ml.html#L106" title="ocaml/ocamltest/ocaml_filetypes.ml:106">make_filename</a></span> <span class="ocamlLCIdentifier"><a href="filecompare.ml.html#L27" title="ocaml/ocamltest/filecompare.ml:27">tool</a></span><span class="PreProc">#</span><span class="ocamlLCIdentifier">directory</span> <span class="Constant">&quot;<a href="builtin_variables.mli.html#L40" title="ocaml/ocamltest/builtin_variables.mli:40">output</a>&quot;</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">tool_output_file</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Filename</span>.<span class="ocamlLCIdentifier">make_path</span> <span class="Statement">[</span><span class="ocamlLCIdentifier">build_dir</span><span class="Statement">;</span> <span class="ocamlLCIdentifier">tool_output_filename</span><span class="Statement">]<br/></li>
<li></span>&nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Environments</span>.<span class="ocamlLCIdentifier"><a href="environments.ml.html#L114" title="ocaml/ocamltest/environments.ml:114">add_if_undefined</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">tool_output_variable<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">tool_output_file</span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a><br/></li>
<li></span>&nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="PreProc">Sys</span>.<span class="ocamlLCIdentifier"><a href="ocamltest_stdlib.ml.html#L213" title="ocaml/ocamltest/ocamltest_stdlib.ml:213">force_remove</a></span> <span class="ocamlLCIdentifier">tool_output_file</span><span class="Statement">;<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Environments</span>.<span class="ocamlLCIdentifier"><a href="ocaml_modifiers.ml.html#L23" title="ocaml/ocamltest/ocaml_modifiers.ml:23">add</a></span> <span class="PreProc">Builtin_variables</span>.<span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L64" title="ocaml/ocamltest/builtin_variables.mli:64">test_build_directory</a></span> <span class="ocamlLCIdentifier">build_dir</span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="PreProc">Actions_helpers</span>.<span class="ocamlLCIdentifier"><a href="builtin_actions.mli.html#L42" title="ocaml/ocamltest/builtin_actions.mli:42">setup_build_env</a></span> <span class="Constant">false</span> <span class="ocamlLCIdentifier">source_modules</span> <span class="ocamlLCIdentifier"><a href="main.ml.html#L166" title="ocaml/ocamltest/main.ml:166">log</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a><br/></li>
<li></span><br/></li>
<li><a id="L399">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">setup_compiler_build_env</span></span> <span class="Statement">(</span><span class="ocamlLCIdentifier">compiler</span> : <span class="PreProc">Ocaml_compilers</span>.<span class="ocamlLCIdentifier">compiler</span><span class="Statement">)</span> <span class="ocamlLCIdentifier"><a href="main.ml.html#L166" title="ocaml/ocamltest/main.ml:166">log</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">r</span>, <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="Statement">)</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="#L357" title="ocaml/ocamltest/ocaml_actions.ml:357">setup_tool_build_env</a></span> <span class="ocamlLCIdentifier">compiler</span> <span class="ocamlLCIdentifier"><a href="main.ml.html#L166" title="ocaml/ocamltest/main.ml:166">log</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="PreProc">Result</span><span class="ocamlNone">.</span><span class="ocamlLCIdentifier"><a href="result.ml.html#L53" title="ocaml/ocamltest/result.ml:53">is_pass</a></span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">r</span><span class="ocamlNone"> </span><span class="Statement">then<br/></li>
<li></span>&nbsp; <span class="Statement">begin<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">prog_var</span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">compiler</span><span class="PreProc">#</span><span class="ocamlLCIdentifier">program_variable</span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">prog_output_var</span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">compiler</span><span class="PreProc">#</span><span class="ocamlLCIdentifier">program_output_variable</span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">default_prog_file</span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">get_program_file</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">compiler</span><span class="PreProc">#</span><span class="ocamlLCIdentifier">target</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="PreProc">Environments</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier"><a href="environments.ml.html#L114" title="ocaml/ocamltest/environments.ml:114">add_if_undefined</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">prog_var</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">default_prog_file</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">prog_file</span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="PreProc">Environments</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier"><a href="environments.mli.html#L29" title="ocaml/ocamltest/environments.mli:29">safe_lookup</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">prog_var</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">prog_output_file</span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">prog_file</span><span class="ocamlEnd"> </span><span class="Statement">^</span><span class="ocamlEnd"> </span><span class="Constant">&quot;.<a href="builtin_variables.mli.html#L40" title="ocaml/ocamltest/builtin_variables.mli:40">output</a>&quot;</span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="Statement">match</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">prog_output_var</span><span class="ocamlEnd"> </span><span class="Statement">with<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Constant">None</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Constant">Some</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">outputvar</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="PreProc">Environments</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier"><a href="environments.ml.html#L114" title="ocaml/ocamltest/environments.ml:114">add_if_undefined</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">outputvar</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">prog_output_file</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="Statement">(</span><span class="ocamlLCIdentifier">r</span><span class="ocamlEnd">, </span><span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="Statement">)<br/></li>
<li></span><span class="ocamlEnd">&nbsp; </span><span class="Statement">end</span> <span class="Statement">else</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">r</span>, <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li><a id="L417">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">setup_toplevel_build_env</span></span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="ocaml_directories.ml.html#L29" title="ocaml/ocamltest/ocaml_directories.ml:29">toplevel</a></span> : <span class="PreProc">Ocaml_toplevels</span>.<span class="ocamlLCIdentifier"><a href="ocaml_directories.ml.html#L29" title="ocaml/ocamltest/ocaml_directories.ml:29">toplevel</a></span><span class="Statement">)</span> <span class="ocamlLCIdentifier"><a href="main.ml.html#L166" title="ocaml/ocamltest/main.ml:166">log</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier"><a href="#L357" title="ocaml/ocamltest/ocaml_actions.ml:357">setup_tool_build_env</a></span> <span class="ocamlLCIdentifier"><a href="ocaml_directories.ml.html#L29" title="ocaml/ocamltest/ocaml_directories.ml:29">toplevel</a></span> <span class="ocamlLCIdentifier"><a href="main.ml.html#L166" title="ocaml/ocamltest/main.ml:166">log</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a><br/></li>
<li></span><br/></li>
<li><a id="L420">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">mk_compiler_env_setup</span></span> <span class="ocamlLCIdentifier"><a href="actions.mli.html#L22" title="ocaml/ocamltest/actions.mli:22">name</a></span> <span class="Statement">(</span><span class="ocamlLCIdentifier">compiler</span> : <span class="PreProc">Ocaml_compilers</span>.<span class="ocamlLCIdentifier">compiler</span><span class="Statement">)</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="PreProc">Actions</span>.<span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L34" title="ocaml/ocamltest/builtin_variables.mli:34">make</a></span> <span class="Statement">~</span><span class="Identifier"><a href="actions.mli.html#L22" title="ocaml/ocamltest/actions.mli:22">name</a></span> <span class="Statement">~</span><span class="Identifier"><a href="actions.mli.html#L24" title="ocaml/ocamltest/actions.mli:24">description</a></span>:<span class="Statement">(</span><span class="PreProc">Printf</span>.<span class="ocamlLCIdentifier">sprintf</span> <span class="Constant">&quot;Setup build <a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a> (%s)&quot;</span> <span class="ocamlLCIdentifier"><a href="actions.mli.html#L22" title="ocaml/ocamltest/actions.mli:22">name</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L399" title="ocaml/ocamltest/ocaml_actions.ml:399">setup_compiler_build_env</a></span> <span class="ocamlLCIdentifier">compiler</span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li><a id="L424">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">mk_toplevel_env_setup</span></span> <span class="ocamlLCIdentifier"><a href="actions.mli.html#L22" title="ocaml/ocamltest/actions.mli:22">name</a></span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="ocaml_directories.ml.html#L29" title="ocaml/ocamltest/ocaml_directories.ml:29">toplevel</a></span> : <span class="PreProc">Ocaml_toplevels</span>.<span class="ocamlLCIdentifier"><a href="ocaml_directories.ml.html#L29" title="ocaml/ocamltest/ocaml_directories.ml:29">toplevel</a></span><span class="Statement">)</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="PreProc">Actions</span>.<span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L34" title="ocaml/ocamltest/builtin_variables.mli:34">make</a></span> <span class="Statement">~</span><span class="Identifier"><a href="actions.mli.html#L22" title="ocaml/ocamltest/actions.mli:22">name</a><br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier"><a href="actions.mli.html#L24" title="ocaml/ocamltest/actions.mli:24">description</a></span>:<span class="Statement">(</span><span class="PreProc">Printf</span>.<span class="ocamlLCIdentifier">sprintf</span> <span class="Constant">&quot;Setup <a href="ocaml_directories.ml.html#L29" title="ocaml/ocamltest/ocaml_directories.ml:29">toplevel</a> <a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a> (%s)&quot;</span> <span class="ocamlLCIdentifier"><a href="actions.mli.html#L22" title="ocaml/ocamltest/actions.mli:22">name</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L417" title="ocaml/ocamltest/ocaml_actions.ml:417">setup_toplevel_build_env</a></span> <span class="ocamlLCIdentifier"><a href="ocaml_directories.ml.html#L29" title="ocaml/ocamltest/ocaml_directories.ml:29">toplevel</a></span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li><a id="L429">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">setup_ocamlc_byte_build_env</span></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier"><a href="#L420" title="ocaml/ocamltest/ocaml_actions.ml:420">mk_compiler_env_setup</a><br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">&quot;setup-<a href="ocaml_files.ml.html#L39" title="ocaml/ocamltest/ocaml_files.ml:39">ocamlc</a><a href="tsl_semantics.ml.html#L72" title="ocaml/ocamltest/tsl_semantics.ml:72">.</a>byte-build-<a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a>&quot;<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Ocaml_compilers</span>.<span class="ocamlLCIdentifier"><a href="ocaml_actions.mli.html#L19" title="ocaml/ocamltest/ocaml_actions.mli:19">ocamlc_byte</a><br/></li>
<li></span><br/></li>
<li><a id="L434">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">setup_ocamlc_opt_build_env</span></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier"><a href="#L26" title="ocaml/ocamltest/ocaml_actions.ml:26">native_action</a><br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L420" title="ocaml/ocamltest/ocaml_actions.ml:420">mk_compiler_env_setup</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Constant">&quot;setup-<a href="ocaml_files.ml.html#L39" title="ocaml/ocamltest/ocaml_files.ml:39">ocamlc</a><a href="tsl_semantics.ml.html#L72" title="ocaml/ocamltest/tsl_semantics.ml:72">.</a>opt-build-<a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a>&quot;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="PreProc">Ocaml_compilers</span>.<span class="ocamlLCIdentifier"><a href="ocaml_actions.mli.html#L22" title="ocaml/ocamltest/ocaml_actions.mli:22">ocamlc_opt</a></span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li><a id="L440">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">setup_ocamlopt_byte_build_env</span></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier"><a href="#L26" title="ocaml/ocamltest/ocaml_actions.ml:26">native_action</a><br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L420" title="ocaml/ocamltest/ocaml_actions.ml:420">mk_compiler_env_setup</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Constant">&quot;setup-<a href="ocaml_files.ml.html#L48" title="ocaml/ocamltest/ocaml_files.ml:48">ocamlopt</a><a href="tsl_semantics.ml.html#L72" title="ocaml/ocamltest/tsl_semantics.ml:72">.</a>byte-build-<a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a>&quot;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="PreProc">Ocaml_compilers</span>.<span class="ocamlLCIdentifier"><a href="ocaml_actions.mli.html#L25" title="ocaml/ocamltest/ocaml_actions.mli:25">ocamlopt_byte</a></span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li><a id="L446">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">setup_ocamlopt_opt_build_env</span></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier"><a href="#L26" title="ocaml/ocamltest/ocaml_actions.ml:26">native_action</a><br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L420" title="ocaml/ocamltest/ocaml_actions.ml:420">mk_compiler_env_setup</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Constant">&quot;setup-<a href="ocaml_files.ml.html#L48" title="ocaml/ocamltest/ocaml_files.ml:48">ocamlopt</a><a href="tsl_semantics.ml.html#L72" title="ocaml/ocamltest/tsl_semantics.ml:72">.</a>opt-build-<a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a>&quot;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="PreProc">Ocaml_compilers</span>.<span class="ocamlLCIdentifier"><a href="ocaml_actions.mli.html#L28" title="ocaml/ocamltest/ocaml_actions.mli:28">ocamlopt_opt</a></span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li><a id="L452">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">setup_ocaml_build_env</span></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier"><a href="#L424" title="ocaml/ocamltest/ocaml_actions.ml:424">mk_toplevel_env_setup</a><br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">&quot;setup-<a href="ocaml_files.ml.html#L42" title="ocaml/ocamltest/ocaml_files.ml:42">ocaml</a>-build-<a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a>&quot;<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Ocaml_toplevels</span>.<span class="ocamlLCIdentifier"><a href="ocaml_files.ml.html#L42" title="ocaml/ocamltest/ocaml_files.ml:42">ocaml</a><br/></li>
<li></span><br/></li>
<li><a id="L457">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">setup_ocamlnat_build_env</span></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier"><a href="#L26" title="ocaml/ocamltest/ocaml_actions.ml:26">native_action</a><br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L424" title="ocaml/ocamltest/ocaml_actions.ml:424">mk_toplevel_env_setup</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Constant">&quot;setup-<a href="ocaml_files.ml.html#L54" title="ocaml/ocamltest/ocaml_files.ml:54">ocamlnat</a>-build-<a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a>&quot;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="PreProc">Ocaml_toplevels</span>.<span class="ocamlLCIdentifier"><a href="ocaml_files.ml.html#L54" title="ocaml/ocamltest/ocaml_files.ml:54">ocamlnat</a></span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li><a id="L463">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">compile</span></span> <span class="Statement">(</span><span class="ocamlLCIdentifier">compiler</span> : <span class="PreProc">Ocaml_compilers</span>.<span class="ocamlLCIdentifier">compiler</span><span class="Statement">)</span> <span class="ocamlLCIdentifier"><a href="main.ml.html#L166" title="ocaml/ocamltest/main.ml:166">log</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">match</span> <span class="PreProc">Environments</span>.<span class="ocamlLCIdentifier"><a href="environments.ml.html#L89" title="ocaml/ocamltest/environments.ml:89">lookup_nonempty</a></span> <span class="PreProc">Builtin_variables</span>.<span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L24" title="ocaml/ocamltest/builtin_variables.mli:24">commandline</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">with<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">None</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">begin<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">match</span><span class="ocamlEnd"> </span><span class="PreProc">Environments</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier"><a href="environments.ml.html#L89" title="ocaml/ocamltest/environments.ml:89">lookup_nonempty</a></span><span class="ocamlEnd"> </span><span class="PreProc">Ocaml_variables</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L73" title="ocaml/ocamltest/ocaml_variables.mli:73">module_</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="ocamlEnd"> </span><span class="Statement">with<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Constant">None</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L210" title="ocaml/ocamltest/ocaml_actions.ml:210">compile_program</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">compiler</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="main.ml.html#L166" title="ocaml/ocamltest/main.ml:166">log</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Constant">Some</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L73" title="ocaml/ocamltest/ocaml_variables.mli:73">module_</a></span><span class="ocamlEnd"> </span><span class="Statement">-&gt;</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L285" title="ocaml/ocamltest/ocaml_actions.ml:285">compile_module</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">compiler</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L73" title="ocaml/ocamltest/ocaml_variables.mli:73">module_</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="main.ml.html#L166" title="ocaml/ocamltest/main.ml:166">log</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="Statement">end<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Some</span> <span class="ocamlLCIdentifier">cmdline</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="ocaml_tools.ml.html#L50" title="ocaml/ocamltest/ocaml_tools.ml:50">expected_exit_status</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="PreProc">Ocaml_tools</span>.<span class="ocamlLCIdentifier"><a href="ocaml_tools.ml.html#L50" title="ocaml/ocamltest/ocaml_tools.ml:50">expected_exit_status</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">(</span><span class="ocamlLCIdentifier">compiler</span> :<span class="Statement">&gt;</span> <span class="PreProc">Ocaml_tools</span>.<span class="ocamlLCIdentifier"><a href="filecompare.ml.html#L27" title="ocaml/ocamltest/filecompare.ml:27">tool</a></span><span class="Statement">)</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="#L227" title="ocaml/ocamltest/ocaml_actions.ml:227">what</a></span> <span class="Statement">=</span> <span class="PreProc">Printf</span>.<span class="ocamlLCIdentifier">sprintf</span> <span class="Constant">&quot;Compiling using <a href="builtin_variables.mli.html#L24" title="ocaml/ocamltest/builtin_variables.mli:24">commandline</a> %s&quot;</span> <span class="ocamlLCIdentifier">cmdline</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Printf</span>.<span class="ocamlLCIdentifier">fprintf</span> <span class="ocamlLCIdentifier"><a href="main.ml.html#L166" title="ocaml/ocamltest/main.ml:166">log</a></span> <span class="Constant">&quot;%s\<a href="actions_helpers.ml.html#L174" title="ocaml/ocamltest/actions_helpers.ml:174">n</a>%!&quot;</span> <span class="ocamlLCIdentifier"><a href="#L227" title="ocaml/ocamltest/ocaml_actions.ml:227">what</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L24" title="ocaml/ocamltest/builtin_variables.mli:24">commandline</a></span> <span class="Statement">=</span> <span class="Statement">[</span><span class="ocamlLCIdentifier">compiler</span><span class="PreProc">#</span><span class="ocamlLCIdentifier"><a href="actions.mli.html#L22" title="ocaml/ocamltest/actions.mli:22">name</a></span><span class="Statement">;</span> <span class="ocamlLCIdentifier">cmdline</span><span class="Statement">]</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L28" title="ocaml/ocamltest/builtin_variables.mli:28">exit_status</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="PreProc">Actions_helpers</span>.<span class="ocamlLCIdentifier"><a href="actions_helpers.ml.html#L117" title="ocaml/ocamltest/actions_helpers.ml:117">run_cmd</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier"><a href="environments.ml.html#L199" title="ocaml/ocamltest/environments.ml:199">environment</a></span>:<span class="ocamlLCIdentifier"><a href="#L88" title="ocaml/ocamltest/ocaml_actions.ml:88">default_ocaml_env</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier">stdin_variable</span>: <span class="PreProc">Ocaml_variables</span>.<span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L51" title="ocaml/ocamltest/ocaml_variables.mli:51">compiler_stdin</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier">stdout_variable</span>:<span class="ocamlLCIdentifier">compiler</span><span class="PreProc">#</span><span class="ocamlLCIdentifier">output_variable<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier">stderr_variable</span>:<span class="ocamlLCIdentifier">compiler</span><span class="PreProc">#</span><span class="ocamlLCIdentifier">output_variable<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier"><a href="ocaml_modifiers.ml.html#L22" title="ocaml/ocamltest/ocaml_modifiers.ml:22">append</a></span>:<span class="Constant">true<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="main.ml.html#L166" title="ocaml/ocamltest/main.ml:166">log</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L24" title="ocaml/ocamltest/builtin_variables.mli:24">commandline</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L28" title="ocaml/ocamltest/builtin_variables.mli:28">exit_status</a></span><span class="Statement">=</span><span class="ocamlLCIdentifier"><a href="ocaml_tools.ml.html#L50" title="ocaml/ocamltest/ocaml_tools.ml:50">expected_exit_status</a><br/></li>
<li></span><span class="ocamlNone">&nbsp; &nbsp; </span><span class="Statement">then</span> <span class="Statement">(</span><span class="PreProc">Result</span>.<span class="ocamlLCIdentifier"><a href="builtin_actions.mli.html#L18" title="ocaml/ocamltest/builtin_actions.mli:18">pass</a></span>, <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">else</span> <span class="Statement">begin<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L47" title="ocaml/ocamltest/builtin_variables.mli:47">reason</a></span><span class="ocamlEnd"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">(</span><span class="PreProc">Actions_helpers</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier"><a href="actions_helpers.ml.html#L35" title="ocaml/ocamltest/actions_helpers.ml:35">mkreason</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="#L227" title="ocaml/ocamltest/ocaml_actions.ml:227">what</a></span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="PreProc">String</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">concat</span><span class="ocamlEnd"> </span><span class="Constant">&quot; &quot;</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L24" title="ocaml/ocamltest/builtin_variables.mli:24">commandline</a></span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L28" title="ocaml/ocamltest/builtin_variables.mli:28">exit_status</a></span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">(</span><span class="PreProc">Result</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier"><a href="result.ml.html#L39" title="ocaml/ocamltest/result.ml:39">fail_with_reason</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L47" title="ocaml/ocamltest/builtin_variables.mli:47">reason</a></span><span class="ocamlEnd">, </span><span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="Statement">)<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="Statement">end<br/></li>
<li></span><br/></li>
<li><span class="Comment">(* Compile <a href="actions.ml.html#L40" title="ocaml/ocamltest/actions.ml:40">actions</a> *)<br/></li>
<li></span><br/></li>
<li><span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="ocaml_actions.mli.html#L19" title="ocaml/ocamltest/ocaml_actions.mli:19">ocamlc_byte</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="PreProc">Actions</span>.<span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L34" title="ocaml/ocamltest/builtin_variables.mli:34">make</a><br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier"><a href="actions.mli.html#L22" title="ocaml/ocamltest/actions.mli:22">name</a></span>:<span class="Constant">&quot;<a href="ocaml_files.ml.html#L39" title="ocaml/ocamltest/ocaml_files.ml:39">ocamlc</a><a href="tsl_semantics.ml.html#L72" title="ocaml/ocamltest/tsl_semantics.ml:72">.</a>byte&quot;<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier"><a href="actions.mli.html#L24" title="ocaml/ocamltest/actions.mli:24">description</a></span>:<span class="Constant">&quot;Compile the <a href="builtin_variables.mli.html#L42" title="ocaml/ocamltest/builtin_variables.mli:42">program</a> using <a href="ocaml_files.ml.html#L39" title="ocaml/ocamltest/ocaml_files.ml:39">ocamlc</a><a href="tsl_semantics.ml.html#L72" title="ocaml/ocamltest/tsl_semantics.ml:72">.</a>byte&quot;<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L463" title="ocaml/ocamltest/ocaml_actions.ml:463">compile</a></span> <span class="PreProc">Ocaml_compilers</span>.<span class="ocamlLCIdentifier"><a href="ocaml_actions.mli.html#L19" title="ocaml/ocamltest/ocaml_actions.mli:19">ocamlc_byte</a></span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li><a id="L502">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">ocamlc_opt</span></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier"><a href="#L26" title="ocaml/ocamltest/ocaml_actions.ml:26">native_action</a><br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">(</span><span class="PreProc">Actions</span>.<span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L34" title="ocaml/ocamltest/builtin_variables.mli:34">make</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier"><a href="actions.mli.html#L22" title="ocaml/ocamltest/actions.mli:22">name</a></span>:<span class="Constant">&quot;<a href="ocaml_files.ml.html#L39" title="ocaml/ocamltest/ocaml_files.ml:39">ocamlc</a><a href="tsl_semantics.ml.html#L72" title="ocaml/ocamltest/tsl_semantics.ml:72">.</a>opt&quot;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier"><a href="actions.mli.html#L24" title="ocaml/ocamltest/actions.mli:24">description</a></span>:<span class="Constant">&quot;Compile the <a href="builtin_variables.mli.html#L42" title="ocaml/ocamltest/builtin_variables.mli:42">program</a> using <a href="ocaml_files.ml.html#L39" title="ocaml/ocamltest/ocaml_files.ml:39">ocamlc</a><a href="tsl_semantics.ml.html#L72" title="ocaml/ocamltest/tsl_semantics.ml:72">.</a>opt&quot;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L463" title="ocaml/ocamltest/ocaml_actions.ml:463">compile</a></span> <span class="PreProc">Ocaml_compilers</span>.<span class="ocamlLCIdentifier"><a href="ocaml_actions.mli.html#L22" title="ocaml/ocamltest/ocaml_actions.mli:22">ocamlc_opt</a></span><span class="Statement">))<br/></li>
<li></span><br/></li>
<li><a id="L509">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">ocamlopt_byte</span></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier"><a href="#L26" title="ocaml/ocamltest/ocaml_actions.ml:26">native_action</a><br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">(</span><span class="PreProc">Actions</span>.<span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L34" title="ocaml/ocamltest/builtin_variables.mli:34">make</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier"><a href="actions.mli.html#L22" title="ocaml/ocamltest/actions.mli:22">name</a></span>:<span class="Constant">&quot;<a href="ocaml_files.ml.html#L48" title="ocaml/ocamltest/ocaml_files.ml:48">ocamlopt</a><a href="tsl_semantics.ml.html#L72" title="ocaml/ocamltest/tsl_semantics.ml:72">.</a>byte&quot;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier"><a href="actions.mli.html#L24" title="ocaml/ocamltest/actions.mli:24">description</a></span>:<span class="Constant">&quot;Compile the <a href="builtin_variables.mli.html#L42" title="ocaml/ocamltest/builtin_variables.mli:42">program</a> using <a href="ocaml_files.ml.html#L48" title="ocaml/ocamltest/ocaml_files.ml:48">ocamlopt</a><a href="tsl_semantics.ml.html#L72" title="ocaml/ocamltest/tsl_semantics.ml:72">.</a>byte&quot;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L463" title="ocaml/ocamltest/ocaml_actions.ml:463">compile</a></span> <span class="PreProc">Ocaml_compilers</span>.<span class="ocamlLCIdentifier"><a href="ocaml_actions.mli.html#L25" title="ocaml/ocamltest/ocaml_actions.mli:25">ocamlopt_byte</a></span><span class="Statement">))<br/></li>
<li></span><br/></li>
<li><a id="L516">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">ocamlopt_opt</span></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier"><a href="#L26" title="ocaml/ocamltest/ocaml_actions.ml:26">native_action</a><br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">(</span><span class="PreProc">Actions</span>.<span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L34" title="ocaml/ocamltest/builtin_variables.mli:34">make</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier"><a href="actions.mli.html#L22" title="ocaml/ocamltest/actions.mli:22">name</a></span>:<span class="Constant">&quot;<a href="ocaml_files.ml.html#L48" title="ocaml/ocamltest/ocaml_files.ml:48">ocamlopt</a><a href="tsl_semantics.ml.html#L72" title="ocaml/ocamltest/tsl_semantics.ml:72">.</a>opt&quot;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier"><a href="actions.mli.html#L24" title="ocaml/ocamltest/actions.mli:24">description</a></span>:<span class="Constant">&quot;Compile the <a href="builtin_variables.mli.html#L42" title="ocaml/ocamltest/builtin_variables.mli:42">program</a> using <a href="ocaml_files.ml.html#L48" title="ocaml/ocamltest/ocaml_files.ml:48">ocamlopt</a><a href="tsl_semantics.ml.html#L72" title="ocaml/ocamltest/tsl_semantics.ml:72">.</a>opt&quot;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L463" title="ocaml/ocamltest/ocaml_actions.ml:463">compile</a></span> <span class="PreProc">Ocaml_compilers</span>.<span class="ocamlLCIdentifier"><a href="ocaml_actions.mli.html#L28" title="ocaml/ocamltest/ocaml_actions.mli:28">ocamlopt_opt</a></span><span class="Statement">))<br/></li>
<li></span><br/></li>
<li><a id="L523">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">env_with_lib_unix</span></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">libunixdir</span> <span class="Statement">=</span> <span class="PreProc">Ocaml_directories</span>.<span class="ocamlLCIdentifier"><a href="builtin_actions.mli.html#L25" title="ocaml/ocamltest/builtin_actions.mli:25">libunix</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">newlibs</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">match</span> <span class="PreProc">Environments</span>.<span class="ocamlLCIdentifier"><a href="environments.ml.html#L86" title="ocaml/ocamltest/environments.ml:86">lookup</a></span> <span class="PreProc">Ocaml_variables</span>.<span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L33" title="ocaml/ocamltest/ocaml_variables.mli:33">caml_ld_library_path</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">None</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier">libunixdir<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Some</span> <span class="ocamlLCIdentifier">libs</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier">libunixdir</span> <span class="Statement">^</span> <span class="Constant">&quot; &quot;</span> <span class="Statement">^</span> <span class="ocamlLCIdentifier">libs<br/></li>
<li></span>&nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="PreProc">Environments</span>.<span class="ocamlLCIdentifier"><a href="ocaml_modifiers.ml.html#L23" title="ocaml/ocamltest/ocaml_modifiers.ml:23">add</a></span> <span class="PreProc">Ocaml_variables</span>.<span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L33" title="ocaml/ocamltest/ocaml_variables.mli:33">caml_ld_library_path</a></span> <span class="ocamlLCIdentifier">newlibs</span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a><br/></li>
<li></span><br/></li>
<li><a id="L532">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">debug</span></span> <span class="ocamlLCIdentifier"><a href="main.ml.html#L166" title="ocaml/ocamltest/main.ml:166">log</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L42" title="ocaml/ocamltest/builtin_variables.mli:42">program</a></span> <span class="Statement">=</span> <span class="PreProc">Environments</span>.<span class="ocamlLCIdentifier"><a href="environments.mli.html#L29" title="ocaml/ocamltest/environments.mli:29">safe_lookup</a></span> <span class="PreProc">Builtin_variables</span>.<span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L42" title="ocaml/ocamltest/builtin_variables.mli:42">program</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="#L227" title="ocaml/ocamltest/ocaml_actions.ml:227">what</a></span> <span class="Statement">=</span> <span class="PreProc">Printf</span>.<span class="ocamlLCIdentifier">sprintf</span> <span class="Constant">&quot;Debugging <a href="builtin_variables.mli.html#L42" title="ocaml/ocamltest/builtin_variables.mli:42">program</a> %s&quot;</span> <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L42" title="ocaml/ocamltest/builtin_variables.mli:42">program</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="PreProc">Printf</span>.<span class="ocamlLCIdentifier">fprintf</span> <span class="ocamlLCIdentifier"><a href="main.ml.html#L166" title="ocaml/ocamltest/main.ml:166">log</a></span> <span class="Constant">&quot;%s\<a href="actions_helpers.ml.html#L174" title="ocaml/ocamltest/actions_helpers.ml:174">n</a>%!&quot;</span> <span class="ocamlLCIdentifier"><a href="#L227" title="ocaml/ocamltest/ocaml_actions.ml:227">what</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L24" title="ocaml/ocamltest/builtin_variables.mli:24">commandline</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">[<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Ocaml_commands</span>.<span class="ocamlLCIdentifier"><a href="ocaml_commands.ml.html#L35" title="ocaml/ocamltest/ocaml_commands.ml:35">ocamlrun_ocamldebug</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Ocaml_flags</span>.<span class="ocamlLCIdentifier"><a href="ocaml_flags.mli.html#L29" title="ocaml/ocamltest/ocaml_flags.mli:29">ocamldebug_default_flags</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L42" title="ocaml/ocamltest/builtin_variables.mli:42">program</a><br/></li>
<li></span>&nbsp; <span class="Statement">]</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="actions_helpers.ml.html#L162" title="ocaml/ocamltest/actions_helpers.ml:162">systemenv</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Environments</span>.<span class="ocamlLCIdentifier"><a href="environments.mli.html#L25" title="ocaml/ocamltest/environments.mli:25">append_to_system_env</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L88" title="ocaml/ocamltest/ocaml_actions.ml:88">default_ocaml_env</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L523" title="ocaml/ocamltest/ocaml_actions.ml:523">env_with_lib_unix</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="ocaml_tools.ml.html#L50" title="ocaml/ocamltest/ocaml_tools.ml:50">expected_exit_status</a></span> <span class="Statement">=</span> <span class="Constant">0</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L28" title="ocaml/ocamltest/builtin_variables.mli:28">exit_status</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Actions_helpers</span>.<span class="ocamlLCIdentifier"><a href="actions_helpers.ml.html#L117" title="ocaml/ocamltest/actions_helpers.ml:117">run_cmd</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier"><a href="environments.ml.html#L199" title="ocaml/ocamltest/environments.ml:199">environment</a></span>:<span class="ocamlLCIdentifier"><a href="actions_helpers.ml.html#L162" title="ocaml/ocamltest/actions_helpers.ml:162">systemenv</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier">stdin_variable</span>: <span class="PreProc">Ocaml_variables</span>.<span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L118" title="ocaml/ocamltest/ocaml_variables.mli:118">ocamldebug_script</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier">stdout_variable</span>:<span class="PreProc">Builtin_variables</span>.<span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L40" title="ocaml/ocamltest/builtin_variables.mli:40">output</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier">stderr_variable</span>:<span class="PreProc">Builtin_variables</span>.<span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L40" title="ocaml/ocamltest/builtin_variables.mli:40">output</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier"><a href="ocaml_modifiers.ml.html#L22" title="ocaml/ocamltest/ocaml_modifiers.ml:22">append</a></span>:<span class="Constant">true<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="main.ml.html#L166" title="ocaml/ocamltest/main.ml:166">log</a></span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L523" title="ocaml/ocamltest/ocaml_actions.ml:523">env_with_lib_unix</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="Statement">)</span> <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L24" title="ocaml/ocamltest/builtin_variables.mli:24">commandline</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L28" title="ocaml/ocamltest/builtin_variables.mli:28">exit_status</a></span><span class="Statement">=</span><span class="ocamlLCIdentifier"><a href="ocaml_tools.ml.html#L50" title="ocaml/ocamltest/ocaml_tools.ml:50">expected_exit_status</a><br/></li>
<li></span><span class="ocamlNone">&nbsp; </span><span class="Statement">then</span> <span class="Statement">(</span><span class="PreProc">Result</span>.<span class="ocamlLCIdentifier"><a href="builtin_actions.mli.html#L18" title="ocaml/ocamltest/builtin_actions.mli:18">pass</a></span>, <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">else</span> <span class="Statement">begin<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L47" title="ocaml/ocamltest/builtin_variables.mli:47">reason</a></span><span class="ocamlEnd"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">(</span><span class="PreProc">Actions_helpers</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier"><a href="actions_helpers.ml.html#L35" title="ocaml/ocamltest/actions_helpers.ml:35">mkreason</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="#L227" title="ocaml/ocamltest/ocaml_actions.ml:227">what</a></span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="PreProc">String</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">concat</span><span class="ocamlEnd"> </span><span class="Constant">&quot; &quot;</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L24" title="ocaml/ocamltest/builtin_variables.mli:24">commandline</a></span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L28" title="ocaml/ocamltest/builtin_variables.mli:28">exit_status</a></span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="Statement">(</span><span class="PreProc">Result</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier"><a href="result.ml.html#L39" title="ocaml/ocamltest/result.ml:39">fail_with_reason</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L47" title="ocaml/ocamltest/builtin_variables.mli:47">reason</a></span><span class="ocamlEnd">, </span><span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="Statement">)<br/></li>
<li></span><span class="ocamlEnd">&nbsp; </span><span class="Statement">end<br/></li>
<li></span><br/></li>
<li><span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="ocaml_files.ml.html#L78" title="ocaml/ocamltest/ocaml_files.ml:78">ocamldebug</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="PreProc">Actions</span>.<span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L34" title="ocaml/ocamltest/builtin_variables.mli:34">make</a></span> <span class="Statement">~</span><span class="Identifier"><a href="actions.mli.html#L22" title="ocaml/ocamltest/actions.mli:22">name</a></span>:<span class="Constant">&quot;<a href="ocaml_files.ml.html#L78" title="ocaml/ocamltest/ocaml_files.ml:78">ocamldebug</a>&quot;</span> <span class="Statement">~</span><span class="Identifier"><a href="actions.mli.html#L24" title="ocaml/ocamltest/actions.mli:24">description</a></span>:<span class="Constant">&quot;Run <a href="ocaml_files.ml.html#L78" title="ocaml/ocamltest/ocaml_files.ml:78">ocamldebug</a> on the <a href="builtin_variables.mli.html#L42" title="ocaml/ocamltest/builtin_variables.mli:42">program</a>&quot;<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L532" title="ocaml/ocamltest/ocaml_actions.ml:532">debug</a><br/></li>
<li></span><br/></li>
<li><a id="L569">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">objinfo</span></span> <span class="ocamlLCIdentifier"><a href="main.ml.html#L166" title="ocaml/ocamltest/main.ml:166">log</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">tools_directory</span> <span class="Statement">=</span> <span class="PreProc">Ocaml_directories</span>.<span class="ocamlLCIdentifier"><a href="ocaml_directories.ml.html#L35" title="ocaml/ocamltest/ocaml_directories.ml:35">tools</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L42" title="ocaml/ocamltest/builtin_variables.mli:42">program</a></span> <span class="Statement">=</span> <span class="PreProc">Environments</span>.<span class="ocamlLCIdentifier"><a href="environments.mli.html#L29" title="ocaml/ocamltest/environments.mli:29">safe_lookup</a></span> <span class="PreProc">Builtin_variables</span>.<span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L42" title="ocaml/ocamltest/builtin_variables.mli:42">program</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="#L227" title="ocaml/ocamltest/ocaml_actions.ml:227">what</a></span> <span class="Statement">=</span> <span class="PreProc">Printf</span>.<span class="ocamlLCIdentifier">sprintf</span> <span class="Constant">&quot;Running <a href="ocaml_files.ml.html#L82" title="ocaml/ocamltest/ocaml_files.ml:82">ocamlobjinfo</a> on %s&quot;</span> <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L42" title="ocaml/ocamltest/builtin_variables.mli:42">program</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="PreProc">Printf</span>.<span class="ocamlLCIdentifier">fprintf</span> <span class="ocamlLCIdentifier"><a href="main.ml.html#L166" title="ocaml/ocamltest/main.ml:166">log</a></span> <span class="Constant">&quot;%s\<a href="actions_helpers.ml.html#L174" title="ocaml/ocamltest/actions_helpers.ml:174">n</a>%!&quot;</span> <span class="ocamlLCIdentifier"><a href="#L227" title="ocaml/ocamltest/ocaml_actions.ml:227">what</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L24" title="ocaml/ocamltest/builtin_variables.mli:24">commandline</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">[<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Ocaml_commands</span>.<span class="ocamlLCIdentifier"><a href="ocaml_commands.ml.html#L38" title="ocaml/ocamltest/ocaml_commands.ml:38">ocamlrun_ocamlobjinfo</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Ocaml_flags</span>.<span class="ocamlLCIdentifier"><a href="ocaml_flags.mli.html#L31" title="ocaml/ocamltest/ocaml_flags.mli:31">ocamlobjinfo_default_flags</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L42" title="ocaml/ocamltest/builtin_variables.mli:42">program</a><br/></li>
<li></span>&nbsp; <span class="Statement">]</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">ocamllib</span> <span class="Statement">=</span> <span class="Statement">[|</span> <span class="Statement">(</span><span class="PreProc">Printf</span>.<span class="ocamlLCIdentifier">sprintf</span> <span class="Constant">&quot;OCAMLLIB=%s&quot;</span> <span class="ocamlLCIdentifier">tools_directory</span><span class="Statement">)</span> <span class="Statement">|]</span> <span class="Statement">in<br/></li>
<li><a id="L581">&#x200c;</a></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">systemenv</span></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Environments</span>.<span class="ocamlLCIdentifier"><a href="environments.mli.html#L25" title="ocaml/ocamltest/environments.mli:25">append_to_system_env</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="PreProc">Array</span>.<span class="ocamlLCIdentifier">concat<br/></li>
<li></span>&nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">[<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier"><a href="#L88" title="ocaml/ocamltest/ocaml_actions.ml:88">default_ocaml_env</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier">ocamllib</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">])<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L523" title="ocaml/ocamltest/ocaml_actions.ml:523">env_with_lib_unix</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">in<br/></li>
<li><a id="L590">&#x200c;</a></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">expected_exit_status</span></span> <span class="Statement">=</span> <span class="Constant">0</span> <span class="Statement">in<br/></li>
<li><a id="L591">&#x200c;</a></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">exit_status</span></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Actions_helpers</span>.<span class="ocamlLCIdentifier"><a href="actions_helpers.ml.html#L117" title="ocaml/ocamltest/actions_helpers.ml:117">run_cmd</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier"><a href="environments.ml.html#L199" title="ocaml/ocamltest/environments.ml:199">environment</a></span>:<span class="ocamlLCIdentifier"><a href="actions_helpers.ml.html#L162" title="ocaml/ocamltest/actions_helpers.ml:162">systemenv</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier">stdout_variable</span>:<span class="PreProc">Builtin_variables</span>.<span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L40" title="ocaml/ocamltest/builtin_variables.mli:40">output</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier">stderr_variable</span>:<span class="PreProc">Builtin_variables</span>.<span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L40" title="ocaml/ocamltest/builtin_variables.mli:40">output</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier"><a href="ocaml_modifiers.ml.html#L22" title="ocaml/ocamltest/ocaml_modifiers.ml:22">append</a></span>:<span class="Constant">true<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="main.ml.html#L166" title="ocaml/ocamltest/main.ml:166">log</a></span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L523" title="ocaml/ocamltest/ocaml_actions.ml:523">env_with_lib_unix</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="Statement">)</span> <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L24" title="ocaml/ocamltest/builtin_variables.mli:24">commandline</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L28" title="ocaml/ocamltest/builtin_variables.mli:28">exit_status</a></span><span class="Statement">=</span><span class="ocamlLCIdentifier"><a href="ocaml_tools.ml.html#L50" title="ocaml/ocamltest/ocaml_tools.ml:50">expected_exit_status</a><br/></li>
<li></span><span class="ocamlNone">&nbsp; </span><span class="Statement">then</span> <span class="Statement">(</span><span class="PreProc">Result</span>.<span class="ocamlLCIdentifier"><a href="builtin_actions.mli.html#L18" title="ocaml/ocamltest/builtin_actions.mli:18">pass</a></span>, <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">else</span> <span class="Statement">begin<br/></li>
<li><a id="L601">&#x200c;</a></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><span class="linkable">reason</span></span><span class="ocamlEnd"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">(</span><span class="PreProc">Actions_helpers</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier"><a href="actions_helpers.ml.html#L35" title="ocaml/ocamltest/actions_helpers.ml:35">mkreason</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="#L227" title="ocaml/ocamltest/ocaml_actions.ml:227">what</a></span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="PreProc">String</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">concat</span><span class="ocamlEnd"> </span><span class="Constant">&quot; &quot;</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L24" title="ocaml/ocamltest/builtin_variables.mli:24">commandline</a></span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L28" title="ocaml/ocamltest/builtin_variables.mli:28">exit_status</a></span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="Statement">(</span><span class="PreProc">Result</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier"><a href="result.ml.html#L39" title="ocaml/ocamltest/result.ml:39">fail_with_reason</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L47" title="ocaml/ocamltest/builtin_variables.mli:47">reason</a></span><span class="ocamlEnd">, </span><span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="Statement">)<br/></li>
<li></span><span class="ocamlEnd">&nbsp; </span><span class="Statement">end<br/></li>
<li></span><br/></li>
<li><a id="L607">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">ocamlobjinfo</span></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="PreProc">Actions</span>.<span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L34" title="ocaml/ocamltest/builtin_variables.mli:34">make</a></span> <span class="Statement">~</span><span class="Identifier"><a href="actions.mli.html#L22" title="ocaml/ocamltest/actions.mli:22">name</a></span>:<span class="Constant">&quot;<a href="ocaml_files.ml.html#L82" title="ocaml/ocamltest/ocaml_files.ml:82">ocamlobjinfo</a>&quot;<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier"><a href="actions.mli.html#L24" title="ocaml/ocamltest/actions.mli:24">description</a></span>:<span class="Constant">&quot;Run <a href="ocaml_files.ml.html#L82" title="ocaml/ocamltest/ocaml_files.ml:82">ocamlobjinfo</a> on the <a href="builtin_variables.mli.html#L42" title="ocaml/ocamltest/builtin_variables.mli:42">program</a>&quot;</span> <span class="ocamlLCIdentifier"><a href="#L569" title="ocaml/ocamltest/ocaml_actions.ml:569">objinfo</a><br/></li>
<li></span><br/></li>
<li><a id="L611">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">mklib</span></span> <span class="ocamlLCIdentifier"><a href="main.ml.html#L166" title="ocaml/ocamltest/main.ml:166">log</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L42" title="ocaml/ocamltest/builtin_variables.mli:42">program</a></span> <span class="Statement">=</span> <span class="PreProc">Environments</span>.<span class="ocamlLCIdentifier"><a href="environments.mli.html#L29" title="ocaml/ocamltest/environments.mli:29">safe_lookup</a></span> <span class="PreProc">Builtin_variables</span>.<span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L42" title="ocaml/ocamltest/builtin_variables.mli:42">program</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="#L227" title="ocaml/ocamltest/ocaml_actions.ml:227">what</a></span> <span class="Statement">=</span> <span class="PreProc">Printf</span>.<span class="ocamlLCIdentifier">sprintf</span> <span class="Constant">&quot;Running <a href="ocaml_files.ml.html#L86" title="ocaml/ocamltest/ocaml_files.ml:86">ocamlmklib</a> to produce %s&quot;</span> <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L42" title="ocaml/ocamltest/builtin_variables.mli:42">program</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="PreProc">Printf</span>.<span class="ocamlLCIdentifier">fprintf</span> <span class="ocamlLCIdentifier"><a href="main.ml.html#L166" title="ocaml/ocamltest/main.ml:166">log</a></span> <span class="Constant">&quot;%s\<a href="actions_helpers.ml.html#L174" title="ocaml/ocamltest/actions_helpers.ml:174">n</a>%!&quot;</span> <span class="ocamlLCIdentifier"><a href="#L227" title="ocaml/ocamltest/ocaml_actions.ml:227">what</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">ocamlc_command</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">String</span>.<span class="ocamlLCIdentifier">concat</span> <span class="Constant">&quot; &quot;<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">[<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="PreProc">Ocaml_commands</span>.<span class="ocamlLCIdentifier"><a href="ocaml_commands.ml.html#L21" title="ocaml/ocamltest/ocaml_commands.ml:21">ocamlrun_ocamlc</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="PreProc">Ocaml_flags</span>.<span class="ocamlLCIdentifier"><a href="ocaml_directories.ml.html#L23" title="ocaml/ocamltest/ocaml_directories.ml:23">stdlib</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">]<br/></li>
<li></span>&nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L24" title="ocaml/ocamltest/builtin_variables.mli:24">commandline</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">[<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Ocaml_commands</span>.<span class="ocamlLCIdentifier"><a href="ocaml_commands.ml.html#L41" title="ocaml/ocamltest/ocaml_commands.ml:41">ocamlrun_ocamlmklib</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">&quot;-<a href="ocaml_files.ml.html#L39" title="ocaml/ocamltest/ocaml_files.ml:39">ocamlc</a> '&quot;</span> <span class="Statement">^</span> <span class="ocamlLCIdentifier">ocamlc_command</span> <span class="Statement">^</span> <span class="Constant">&quot;'&quot;</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">&quot;-o &quot;</span> <span class="Statement">^</span> <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L42" title="ocaml/ocamltest/builtin_variables.mli:42">program</a><br/></li>
<li></span>&nbsp; <span class="Statement">]</span> @ <span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L75" title="ocaml/ocamltest/ocaml_variables.mli:75">modules</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="ocaml_tools.ml.html#L50" title="ocaml/ocamltest/ocaml_tools.ml:50">expected_exit_status</a></span> <span class="Statement">=</span> <span class="Constant">0</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L28" title="ocaml/ocamltest/builtin_variables.mli:28">exit_status</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Actions_helpers</span>.<span class="ocamlLCIdentifier"><a href="actions_helpers.ml.html#L117" title="ocaml/ocamltest/actions_helpers.ml:117">run_cmd</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier"><a href="environments.ml.html#L199" title="ocaml/ocamltest/environments.ml:199">environment</a></span>:<span class="ocamlLCIdentifier"><a href="#L88" title="ocaml/ocamltest/ocaml_actions.ml:88">default_ocaml_env</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier">stdout_variable</span>:<span class="PreProc">Ocaml_variables</span>.<span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L47" title="ocaml/ocamltest/ocaml_variables.mli:47">compiler_output</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier">stderr_variable</span>:<span class="PreProc">Ocaml_variables</span>.<span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L47" title="ocaml/ocamltest/ocaml_variables.mli:47">compiler_output</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier"><a href="ocaml_modifiers.ml.html#L22" title="ocaml/ocamltest/ocaml_modifiers.ml:22">append</a></span>:<span class="Constant">true<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="main.ml.html#L166" title="ocaml/ocamltest/main.ml:166">log</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L24" title="ocaml/ocamltest/builtin_variables.mli:24">commandline</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L28" title="ocaml/ocamltest/builtin_variables.mli:28">exit_status</a></span><span class="Statement">=</span><span class="ocamlLCIdentifier"><a href="ocaml_tools.ml.html#L50" title="ocaml/ocamltest/ocaml_tools.ml:50">expected_exit_status</a><br/></li>
<li></span><span class="ocamlNone">&nbsp; </span><span class="Statement">then</span> <span class="Statement">(</span><span class="PreProc">Result</span>.<span class="ocamlLCIdentifier"><a href="builtin_actions.mli.html#L18" title="ocaml/ocamltest/builtin_actions.mli:18">pass</a></span>, <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">else</span> <span class="Statement">begin<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L47" title="ocaml/ocamltest/builtin_variables.mli:47">reason</a></span><span class="ocamlEnd"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">(</span><span class="PreProc">Actions_helpers</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier"><a href="actions_helpers.ml.html#L35" title="ocaml/ocamltest/actions_helpers.ml:35">mkreason</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="#L227" title="ocaml/ocamltest/ocaml_actions.ml:227">what</a></span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="PreProc">String</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">concat</span><span class="ocamlEnd"> </span><span class="Constant">&quot; &quot;</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L24" title="ocaml/ocamltest/builtin_variables.mli:24">commandline</a></span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L28" title="ocaml/ocamltest/builtin_variables.mli:28">exit_status</a></span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="Statement">(</span><span class="PreProc">Result</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier"><a href="result.ml.html#L39" title="ocaml/ocamltest/result.ml:39">fail_with_reason</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L47" title="ocaml/ocamltest/builtin_variables.mli:47">reason</a></span><span class="ocamlEnd">, </span><span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="Statement">)<br/></li>
<li></span><span class="ocamlEnd">&nbsp; </span><span class="Statement">end<br/></li>
<li></span><br/></li>
<li><span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="ocaml_files.ml.html#L86" title="ocaml/ocamltest/ocaml_files.ml:86">ocamlmklib</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="PreProc">Actions</span>.<span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L34" title="ocaml/ocamltest/builtin_variables.mli:34">make</a></span> <span class="Statement">~</span><span class="Identifier"><a href="actions.mli.html#L22" title="ocaml/ocamltest/actions.mli:22">name</a></span>:<span class="Constant">&quot;<a href="ocaml_files.ml.html#L86" title="ocaml/ocamltest/ocaml_files.ml:86">ocamlmklib</a>&quot;<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier"><a href="actions.mli.html#L24" title="ocaml/ocamltest/actions.mli:24">description</a></span>:<span class="Constant">&quot;Run <a href="ocaml_files.ml.html#L86" title="ocaml/ocamltest/ocaml_files.ml:86">ocamlmklib</a> to produce the <a href="builtin_variables.mli.html#L42" title="ocaml/ocamltest/builtin_variables.mli:42">program</a>&quot;</span> <span class="ocamlLCIdentifier"><a href="#L611" title="ocaml/ocamltest/ocaml_actions.ml:611">mklib</a><br/></li>
<li></span><br/></li>
<li><a id="L649">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">finalise_codegen_cc</span></span> <span class="ocamlLCIdentifier"><a href="main.ml.html#L148" title="ocaml/ocamltest/main.ml:148">test_basename</a></span> <span class="ocamlLCIdentifier">_log</span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">test_module</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Filename</span>.<span class="ocamlLCIdentifier"><a href="ocaml_filetypes.ml.html#L106" title="ocaml/ocamltest/ocaml_filetypes.ml:106">make_filename</a></span> <span class="ocamlLCIdentifier"><a href="main.ml.html#L148" title="ocaml/ocamltest/main.ml:148">test_basename</a></span> <span class="Constant">&quot;s&quot;<br/></li>
<li></span>&nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">archmod</span> <span class="Statement">=</span> <span class="PreProc">Ocaml_files</span>.<span class="ocamlLCIdentifier"><a href="ocaml_files.ml.html#L94" title="ocaml/ocamltest/ocaml_files.ml:94">asmgen_archmod</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L75" title="ocaml/ocamltest/ocaml_variables.mli:75">modules</a></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">test_module</span> <span class="Statement">^</span> <span class="Constant">&quot; &quot;</span> <span class="Statement">^</span> <span class="ocamlLCIdentifier">archmod</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L42" title="ocaml/ocamltest/builtin_variables.mli:42">program</a></span> <span class="Statement">=</span> <span class="PreProc">Filename</span>.<span class="ocamlLCIdentifier"><a href="ocaml_filetypes.ml.html#L106" title="ocaml/ocamltest/ocaml_filetypes.ml:106">make_filename</a></span> <span class="ocamlLCIdentifier"><a href="main.ml.html#L148" title="ocaml/ocamltest/main.ml:148">test_basename</a></span> <span class="Constant">&quot;out&quot;</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">=</span> <span class="PreProc">Environments</span>.<span class="ocamlLCIdentifier"><a href="environments.ml.html#L127" title="ocaml/ocamltest/environments.ml:127">add_bindings</a><br/></li>
<li></span>&nbsp; <span class="Statement">[<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Ocaml_variables</span>.<span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L75" title="ocaml/ocamltest/ocaml_variables.mli:75">modules</a></span>, <span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L75" title="ocaml/ocamltest/ocaml_variables.mli:75">modules</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Builtin_variables</span>.<span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L42" title="ocaml/ocamltest/builtin_variables.mli:42">program</a></span>, <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L42" title="ocaml/ocamltest/builtin_variables.mli:42">program</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; <span class="Statement">]</span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">(</span><span class="PreProc">Result</span>.<span class="ocamlLCIdentifier"><a href="builtin_actions.mli.html#L18" title="ocaml/ocamltest/builtin_actions.mli:18">pass</a></span>, <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li><a id="L663">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">finalise_codegen_msvc</span></span> <span class="ocamlLCIdentifier"><a href="main.ml.html#L148" title="ocaml/ocamltest/main.ml:148">test_basename</a></span> <span class="ocamlLCIdentifier"><a href="main.ml.html#L166" title="ocaml/ocamltest/main.ml:166">log</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">obj</span> <span class="Statement">=</span> <span class="PreProc">Filename</span>.<span class="ocamlLCIdentifier"><a href="ocaml_filetypes.ml.html#L106" title="ocaml/ocamltest/ocaml_filetypes.ml:106">make_filename</a></span> <span class="ocamlLCIdentifier"><a href="main.ml.html#L148" title="ocaml/ocamltest/main.ml:148">test_basename</a></span> <span class="PreProc">Ocamltest_config</span>.<span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L80" title="ocaml/ocamltest/ocaml_variables.mli:80">objext</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L56" title="ocaml/ocamltest/builtin_variables.mli:56">src</a></span> <span class="Statement">=</span> <span class="PreProc">Filename</span>.<span class="ocamlLCIdentifier"><a href="ocaml_filetypes.ml.html#L106" title="ocaml/ocamltest/ocaml_filetypes.ml:106">make_filename</a></span> <span class="ocamlLCIdentifier"><a href="main.ml.html#L148" title="ocaml/ocamltest/main.ml:148">test_basename</a></span> <span class="Constant">&quot;s&quot;</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="#L227" title="ocaml/ocamltest/ocaml_actions.ml:227">what</a></span> <span class="Statement">=</span> <span class="Constant">&quot;Running Microsoft assembler&quot;</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="PreProc">Printf</span>.<span class="ocamlLCIdentifier">fprintf</span> <span class="ocamlLCIdentifier"><a href="main.ml.html#L166" title="ocaml/ocamltest/main.ml:166">log</a></span> <span class="Constant">&quot;%s\<a href="actions_helpers.ml.html#L174" title="ocaml/ocamltest/actions_helpers.ml:174">n</a>%!&quot;</span> <span class="ocamlLCIdentifier"><a href="#L227" title="ocaml/ocamltest/ocaml_actions.ml:227">what</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L24" title="ocaml/ocamltest/builtin_variables.mli:24">commandline</a></span> <span class="Statement">=</span> <span class="Statement">[</span><span class="PreProc">Ocamltest_config</span>.<span class="ocamlLCIdentifier"><a href="ocamltest_config.mli.html#L24" title="ocaml/ocamltest/ocamltest_config.mli:24">asm</a></span><span class="Statement">;</span> <span class="ocamlLCIdentifier">obj</span><span class="Statement">;</span> <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L56" title="ocaml/ocamltest/builtin_variables.mli:56">src</a></span><span class="Statement">]</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="ocaml_tools.ml.html#L50" title="ocaml/ocamltest/ocaml_tools.ml:50">expected_exit_status</a></span> <span class="Statement">=</span> <span class="Constant">0</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L28" title="ocaml/ocamltest/builtin_variables.mli:28">exit_status</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Actions_helpers</span>.<span class="ocamlLCIdentifier"><a href="actions_helpers.ml.html#L117" title="ocaml/ocamltest/actions_helpers.ml:117">run_cmd</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier"><a href="environments.ml.html#L199" title="ocaml/ocamltest/environments.ml:199">environment</a></span>:<span class="ocamlLCIdentifier"><a href="#L88" title="ocaml/ocamltest/ocaml_actions.ml:88">default_ocaml_env</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier">stdout_variable</span>:<span class="PreProc">Ocaml_variables</span>.<span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L47" title="ocaml/ocamltest/ocaml_variables.mli:47">compiler_output</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier">stderr_variable</span>:<span class="PreProc">Ocaml_variables</span>.<span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L47" title="ocaml/ocamltest/ocaml_variables.mli:47">compiler_output</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier"><a href="ocaml_modifiers.ml.html#L22" title="ocaml/ocamltest/ocaml_modifiers.ml:22">append</a></span>:<span class="Constant">true<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="main.ml.html#L166" title="ocaml/ocamltest/main.ml:166">log</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L24" title="ocaml/ocamltest/builtin_variables.mli:24">commandline</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L28" title="ocaml/ocamltest/builtin_variables.mli:28">exit_status</a></span><span class="Statement">=</span><span class="ocamlLCIdentifier"><a href="ocaml_tools.ml.html#L50" title="ocaml/ocamltest/ocaml_tools.ml:50">expected_exit_status</a><br/></li>
<li></span><span class="ocamlNone">&nbsp; </span><span class="Statement">then</span> <span class="Statement">begin<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">archmod</span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="PreProc">Ocaml_files</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier"><a href="ocaml_files.ml.html#L94" title="ocaml/ocamltest/ocaml_files.ml:94">asmgen_archmod</a></span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L75" title="ocaml/ocamltest/ocaml_variables.mli:75">modules</a></span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">obj</span><span class="ocamlEnd"> </span><span class="Statement">^</span><span class="ocamlEnd"> </span><span class="Constant">&quot; &quot;</span><span class="ocamlEnd"> </span><span class="Statement">^</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">archmod</span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L42" title="ocaml/ocamltest/builtin_variables.mli:42">program</a></span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="PreProc">Filename</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier"><a href="ocaml_filetypes.ml.html#L106" title="ocaml/ocamltest/ocaml_filetypes.ml:106">make_filename</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="main.ml.html#L148" title="ocaml/ocamltest/main.ml:148">test_basename</a></span><span class="ocamlEnd"> </span><span class="Constant">&quot;out&quot;</span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="PreProc">Environments</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier"><a href="environments.ml.html#L127" title="ocaml/ocamltest/environments.ml:127">add_bindings</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="Statement">[<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="PreProc">Ocaml_variables</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L75" title="ocaml/ocamltest/ocaml_variables.mli:75">modules</a></span><span class="ocamlEnd">, </span><span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L75" title="ocaml/ocamltest/ocaml_variables.mli:75">modules</a></span><span class="Statement">;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="PreProc">Builtin_variables</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L42" title="ocaml/ocamltest/builtin_variables.mli:42">program</a></span><span class="ocamlEnd">, </span><span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L42" title="ocaml/ocamltest/builtin_variables.mli:42">program</a></span><span class="Statement">;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="Statement">]</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="Statement">(</span><span class="PreProc">Result</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier"><a href="builtin_actions.mli.html#L18" title="ocaml/ocamltest/builtin_actions.mli:18">pass</a></span><span class="ocamlEnd">, </span><span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="Statement">)<br/></li>
<li></span><span class="ocamlEnd">&nbsp; </span><span class="Statement">end</span> <span class="Statement">else</span> <span class="Statement">begin<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L47" title="ocaml/ocamltest/builtin_variables.mli:47">reason</a></span><span class="ocamlEnd"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">(</span><span class="PreProc">Actions_helpers</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier"><a href="actions_helpers.ml.html#L35" title="ocaml/ocamltest/actions_helpers.ml:35">mkreason</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="#L227" title="ocaml/ocamltest/ocaml_actions.ml:227">what</a></span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="PreProc">String</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">concat</span><span class="ocamlEnd"> </span><span class="Constant">&quot; &quot;</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L24" title="ocaml/ocamltest/builtin_variables.mli:24">commandline</a></span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L28" title="ocaml/ocamltest/builtin_variables.mli:28">exit_status</a></span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="Statement">(</span><span class="PreProc">Result</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier"><a href="result.ml.html#L39" title="ocaml/ocamltest/result.ml:39">fail_with_reason</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L47" title="ocaml/ocamltest/builtin_variables.mli:47">reason</a></span><span class="ocamlEnd">, </span><span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="Statement">)<br/></li>
<li></span><span class="ocamlEnd">&nbsp; </span><span class="Statement">end<br/></li>
<li></span><br/></li>
<li><span class="Statement">let</span> <span class="ocamlLCIdentifier">run_codegen</span> <span class="ocamlLCIdentifier"><a href="main.ml.html#L166" title="ocaml/ocamltest/main.ml:166">log</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="actions_helpers.ml.html#L39" title="ocaml/ocamltest/actions_helpers.ml:39">testfile</a></span> <span class="Statement">=</span> <span class="PreProc">Actions_helpers</span>.<span class="ocamlLCIdentifier"><a href="actions_helpers.ml.html#L39" title="ocaml/ocamltest/actions_helpers.ml:39">testfile</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">testfile_basename</span> <span class="Statement">=</span> <span class="PreProc">Filename</span>.<span class="ocamlLCIdentifier">chop_extension</span> <span class="ocamlLCIdentifier"><a href="actions_helpers.ml.html#L39" title="ocaml/ocamltest/actions_helpers.ml:39">testfile</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="#L227" title="ocaml/ocamltest/ocaml_actions.ml:227">what</a></span> <span class="Statement">=</span> <span class="PreProc">Printf</span>.<span class="ocamlLCIdentifier">sprintf</span> <span class="Constant">&quot;Running <a href="ocaml_files.ml.html#L90" title="ocaml/ocamltest/ocaml_files.ml:90">codegen</a> on %s&quot;</span> <span class="ocamlLCIdentifier"><a href="actions_helpers.ml.html#L39" title="ocaml/ocamltest/actions_helpers.ml:39">testfile</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="PreProc">Printf</span>.<span class="ocamlLCIdentifier">fprintf</span> <span class="ocamlLCIdentifier"><a href="main.ml.html#L166" title="ocaml/ocamltest/main.ml:166">log</a></span> <span class="Constant">&quot;%s\<a href="actions_helpers.ml.html#L174" title="ocaml/ocamltest/actions_helpers.ml:174">n</a>%!&quot;</span> <span class="ocamlLCIdentifier"><a href="#L227" title="ocaml/ocamltest/ocaml_actions.ml:227">what</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L64" title="ocaml/ocamltest/builtin_variables.mli:64">test_build_directory</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Actions_helpers</span>.<span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L64" title="ocaml/ocamltest/builtin_variables.mli:64">test_build_directory</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L47" title="ocaml/ocamltest/ocaml_variables.mli:47">compiler_output</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Filename</span>.<span class="ocamlLCIdentifier">make_path</span> <span class="Statement">[</span><span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L64" title="ocaml/ocamltest/builtin_variables.mli:64">test_build_directory</a></span><span class="Statement">;</span> <span class="Constant">&quot;compiler-<a href="builtin_variables.mli.html#L40" title="ocaml/ocamltest/builtin_variables.mli:40">output</a>&quot;</span><span class="Statement">]<br/></li>
<li></span>&nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Environments</span>.<span class="ocamlLCIdentifier"><a href="environments.ml.html#L114" title="ocaml/ocamltest/environments.ml:114">add_if_undefined</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="PreProc">Ocaml_variables</span>.<span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L47" title="ocaml/ocamltest/ocaml_variables.mli:47">compiler_output</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L47" title="ocaml/ocamltest/ocaml_variables.mli:47">compiler_output</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a><br/></li>
<li></span>&nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">output_file</span> <span class="Statement">=</span> <span class="PreProc">Filename</span>.<span class="ocamlLCIdentifier"><a href="ocaml_filetypes.ml.html#L106" title="ocaml/ocamltest/ocaml_filetypes.ml:106">make_filename</a></span> <span class="ocamlLCIdentifier">testfile_basename</span> <span class="Constant">&quot;<a href="builtin_variables.mli.html#L40" title="ocaml/ocamltest/builtin_variables.mli:40">output</a>&quot;</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L40" title="ocaml/ocamltest/builtin_variables.mli:40">output</a></span> <span class="Statement">=</span> <span class="PreProc">Filename</span>.<span class="ocamlLCIdentifier">make_path</span> <span class="Statement">[</span><span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L64" title="ocaml/ocamltest/builtin_variables.mli:64">test_build_directory</a></span><span class="Statement">;</span> <span class="ocamlLCIdentifier">output_file</span><span class="Statement">]</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">=</span> <span class="PreProc">Environments</span>.<span class="ocamlLCIdentifier"><a href="ocaml_modifiers.ml.html#L23" title="ocaml/ocamltest/ocaml_modifiers.ml:23">add</a></span> <span class="PreProc">Builtin_variables</span>.<span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L40" title="ocaml/ocamltest/builtin_variables.mli:40">output</a></span> <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L40" title="ocaml/ocamltest/builtin_variables.mli:40">output</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L24" title="ocaml/ocamltest/builtin_variables.mli:24">commandline</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">[<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Ocaml_commands</span>.<span class="ocamlLCIdentifier"><a href="ocaml_commands.ml.html#L44" title="ocaml/ocamltest/ocaml_commands.ml:44">ocamlrun_codegen</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L61" title="ocaml/ocamltest/ocaml_variables.mli:61">flags</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">&quot;-S &quot;</span> <span class="Statement">^</span> <span class="ocamlLCIdentifier"><a href="actions_helpers.ml.html#L39" title="ocaml/ocamltest/actions_helpers.ml:39">testfile</a><br/></li>
<li></span>&nbsp; <span class="Statement">]</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="ocaml_tools.ml.html#L50" title="ocaml/ocamltest/ocaml_tools.ml:50">expected_exit_status</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Actions_helpers</span>.<span class="ocamlLCIdentifier"><a href="actions_helpers.ml.html#L56" title="ocaml/ocamltest/actions_helpers.ml:56">exit_status_of_variable</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="PreProc">Ocaml_variables</span>.<span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L35" title="ocaml/ocamltest/ocaml_variables.mli:35">codegen_exit_status</a><br/></li>
<li></span>&nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L28" title="ocaml/ocamltest/builtin_variables.mli:28">exit_status</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Actions_helpers</span>.<span class="ocamlLCIdentifier"><a href="actions_helpers.ml.html#L117" title="ocaml/ocamltest/actions_helpers.ml:117">run_cmd</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier"><a href="environments.ml.html#L199" title="ocaml/ocamltest/environments.ml:199">environment</a></span>:<span class="ocamlLCIdentifier"><a href="#L88" title="ocaml/ocamltest/ocaml_actions.ml:88">default_ocaml_env</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier">stdout_variable</span>:<span class="PreProc">Ocaml_variables</span>.<span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L47" title="ocaml/ocamltest/ocaml_variables.mli:47">compiler_output</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier">stderr_variable</span>:<span class="PreProc">Ocaml_variables</span>.<span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L47" title="ocaml/ocamltest/ocaml_variables.mli:47">compiler_output</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier"><a href="ocaml_modifiers.ml.html#L22" title="ocaml/ocamltest/ocaml_modifiers.ml:22">append</a></span>:<span class="Constant">true<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="main.ml.html#L166" title="ocaml/ocamltest/main.ml:166">log</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L24" title="ocaml/ocamltest/builtin_variables.mli:24">commandline</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L28" title="ocaml/ocamltest/builtin_variables.mli:28">exit_status</a></span><span class="Statement">=</span><span class="ocamlLCIdentifier"><a href="ocaml_tools.ml.html#L50" title="ocaml/ocamltest/ocaml_tools.ml:50">expected_exit_status</a><br/></li>
<li></span><span class="ocamlNone">&nbsp; </span><span class="Statement">then</span> <span class="Statement">begin<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L28" title="ocaml/ocamltest/builtin_variables.mli:28">exit_status</a></span><span class="Statement">=</span><span class="Constant">0<br/></li>
<li></span><span class="ocamlNone">&nbsp; &nbsp; </span><span class="Statement">then</span><span class="ocamlEnd"> </span><span class="Statement">begin<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">finalise</span><span class="ocamlEnd"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">if</span><span class="ocamlNone"> </span><span class="PreProc">Ocamltest_config</span><span class="ocamlNone">.</span><span class="ocamlLCIdentifier"><a href="ocamltest_config.mli.html#L33" title="ocaml/ocamltest/ocamltest_config.mli:33">ccomptype</a></span><span class="Statement">=</span><span class="Constant">&quot;msvc&quot;<br/></li>
<li></span><span class="ocamlNone">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">then</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L663" title="ocaml/ocamltest/ocaml_actions.ml:663">finalise_codegen_msvc</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">else</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L649" title="ocaml/ocamltest/ocaml_actions.ml:649">finalise_codegen_cc</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier">finalise</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">testfile_basename</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="main.ml.html#L166" title="ocaml/ocamltest/main.ml:166">log</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="Statement">end</span><span class="ocamlEnd"> </span><span class="Statement">else</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="PreProc">Result</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier"><a href="builtin_actions.mli.html#L18" title="ocaml/ocamltest/builtin_actions.mli:18">pass</a></span><span class="ocamlEnd">, </span><span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="Statement">)<br/></li>
<li></span><span class="ocamlEnd">&nbsp; </span><span class="Statement">end</span> <span class="Statement">else</span> <span class="Statement">begin<br/></li>
<li><a id="L743">&#x200c;</a></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><span class="linkable">reason</span></span><span class="ocamlEnd"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">(</span><span class="PreProc">Actions_helpers</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier"><a href="actions_helpers.ml.html#L35" title="ocaml/ocamltest/actions_helpers.ml:35">mkreason</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="#L227" title="ocaml/ocamltest/ocaml_actions.ml:227">what</a></span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="PreProc">String</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">concat</span><span class="ocamlEnd"> </span><span class="Constant">&quot; &quot;</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L24" title="ocaml/ocamltest/builtin_variables.mli:24">commandline</a></span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L28" title="ocaml/ocamltest/builtin_variables.mli:28">exit_status</a></span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="Statement">(</span><span class="PreProc">Result</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier"><a href="result.ml.html#L39" title="ocaml/ocamltest/result.ml:39">fail_with_reason</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L47" title="ocaml/ocamltest/builtin_variables.mli:47">reason</a></span><span class="ocamlEnd">, </span><span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="Statement">)<br/></li>
<li></span><span class="ocamlEnd">&nbsp; </span><span class="Statement">end<br/></li>
<li></span><br/></li>
<li><a id="L749">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">codegen</span></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="PreProc">Actions</span>.<span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L34" title="ocaml/ocamltest/builtin_variables.mli:34">make</a></span> <span class="Statement">~</span><span class="Identifier"><a href="actions.mli.html#L22" title="ocaml/ocamltest/actions.mli:22">name</a></span>:<span class="Constant">&quot;<a href="ocaml_files.ml.html#L90" title="ocaml/ocamltest/ocaml_files.ml:90">codegen</a>&quot;</span> <span class="Statement">~</span><span class="Identifier"><a href="actions.mli.html#L24" title="ocaml/ocamltest/actions.mli:24">description</a></span>:<span class="Constant">&quot;Run <a href="ocaml_files.ml.html#L90" title="ocaml/ocamltest/ocaml_files.ml:90">codegen</a> on the test <a href="builtin_variables.mli.html#L30" title="ocaml/ocamltest/builtin_variables.mli:30">file</a>&quot;<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier">run_codegen<br/></li>
<li></span><br/></li>
<li><a id="L753">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">run_cc</span></span> <span class="ocamlLCIdentifier"><a href="main.ml.html#L166" title="ocaml/ocamltest/main.ml:166">log</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L42" title="ocaml/ocamltest/builtin_variables.mli:42">program</a></span> <span class="Statement">=</span> <span class="PreProc">Environments</span>.<span class="ocamlLCIdentifier"><a href="environments.mli.html#L29" title="ocaml/ocamltest/environments.mli:29">safe_lookup</a></span> <span class="PreProc">Builtin_variables</span>.<span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L42" title="ocaml/ocamltest/builtin_variables.mli:42">program</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="#L227" title="ocaml/ocamltest/ocaml_actions.ml:227">what</a></span> <span class="Statement">=</span> <span class="PreProc">Printf</span>.<span class="ocamlLCIdentifier">sprintf</span> <span class="Constant">&quot;Running C compiler to build %s&quot;</span> <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L42" title="ocaml/ocamltest/builtin_variables.mli:42">program</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="PreProc">Printf</span>.<span class="ocamlLCIdentifier">fprintf</span> <span class="ocamlLCIdentifier"><a href="main.ml.html#L166" title="ocaml/ocamltest/main.ml:166">log</a></span> <span class="Constant">&quot;%s\<a href="actions_helpers.ml.html#L174" title="ocaml/ocamltest/actions_helpers.ml:174">n</a>%!&quot;</span> <span class="ocamlLCIdentifier"><a href="#L227" title="ocaml/ocamltest/ocaml_actions.ml:227">what</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">output_exe</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="PreProc">Ocamltest_config</span><span class="ocamlNone">.</span><span class="ocamlLCIdentifier"><a href="ocamltest_config.mli.html#L33" title="ocaml/ocamltest/ocamltest_config.mli:33">ccomptype</a></span><span class="Statement">=</span><span class="Constant">&quot;msvc&quot;</span><span class="ocamlNone"> </span><span class="Statement">then</span> <span class="Constant">&quot;/Fe&quot;</span> <span class="Statement">else</span> <span class="Constant">&quot;-o &quot;<br/></li>
<li></span>&nbsp; <span class="Statement">in<br/></li>
<li><a id="L760">&#x200c;</a></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">commandline</span></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">[<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Ocamltest_config</span>.<span class="ocamlLCIdentifier"><a href="ocaml_actions.mli.html#L57" title="ocaml/ocamltest/ocaml_actions.mli:57">cc</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Ocamltest_config</span>.<span class="ocamlLCIdentifier"><a href="ocamltest_config.mli.html#L30" title="ocaml/ocamltest/ocamltest_config.mli:30">cflags</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">&quot;-I&quot;</span> <span class="Statement">^</span> <span class="PreProc">Ocaml_directories</span>.<span class="ocamlLCIdentifier"><a href="ocaml_directories.ml.html#L32" title="ocaml/ocamltest/ocaml_directories.ml:32">runtime</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier">output_exe</span> <span class="Statement">^</span> <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L42" title="ocaml/ocamltest/builtin_variables.mli:42">program</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Environments</span>.<span class="ocamlLCIdentifier"><a href="environments.mli.html#L29" title="ocaml/ocamltest/environments.mli:29">safe_lookup</a></span> <span class="PreProc">Builtin_variables</span>.<span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L20" title="ocaml/ocamltest/builtin_variables.mli:20">arguments</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; <span class="Statement">]</span> @ <span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L75" title="ocaml/ocamltest/ocaml_variables.mli:75">modules</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">in<br/></li>
<li><a id="L768">&#x200c;</a></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">expected_exit_status</span></span> <span class="Statement">=</span> <span class="Constant">0</span> <span class="Statement">in<br/></li>
<li><a id="L769">&#x200c;</a></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">exit_status</span></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Actions_helpers</span>.<span class="ocamlLCIdentifier"><a href="actions_helpers.ml.html#L117" title="ocaml/ocamltest/actions_helpers.ml:117">run_cmd</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier"><a href="environments.ml.html#L199" title="ocaml/ocamltest/environments.ml:199">environment</a></span>:<span class="ocamlLCIdentifier"><a href="#L88" title="ocaml/ocamltest/ocaml_actions.ml:88">default_ocaml_env</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier">stdout_variable</span>:<span class="PreProc">Ocaml_variables</span>.<span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L47" title="ocaml/ocamltest/ocaml_variables.mli:47">compiler_output</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier">stderr_variable</span>:<span class="PreProc">Ocaml_variables</span>.<span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L47" title="ocaml/ocamltest/ocaml_variables.mli:47">compiler_output</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier"><a href="ocaml_modifiers.ml.html#L22" title="ocaml/ocamltest/ocaml_modifiers.ml:22">append</a></span>:<span class="Constant">true<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="main.ml.html#L166" title="ocaml/ocamltest/main.ml:166">log</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L24" title="ocaml/ocamltest/builtin_variables.mli:24">commandline</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L28" title="ocaml/ocamltest/builtin_variables.mli:28">exit_status</a></span><span class="Statement">=</span><span class="ocamlLCIdentifier"><a href="ocaml_tools.ml.html#L50" title="ocaml/ocamltest/ocaml_tools.ml:50">expected_exit_status</a><br/></li>
<li></span><span class="ocamlNone">&nbsp; </span><span class="Statement">then</span> <span class="Statement">(</span><span class="PreProc">Result</span>.<span class="ocamlLCIdentifier"><a href="builtin_actions.mli.html#L18" title="ocaml/ocamltest/builtin_actions.mli:18">pass</a></span>, <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">else</span> <span class="Statement">begin<br/></li>
<li><a id="L779">&#x200c;</a></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><span class="linkable">reason</span></span><span class="ocamlEnd"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">(</span><span class="PreProc">Actions_helpers</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier"><a href="actions_helpers.ml.html#L35" title="ocaml/ocamltest/actions_helpers.ml:35">mkreason</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="#L227" title="ocaml/ocamltest/ocaml_actions.ml:227">what</a></span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="PreProc">String</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">concat</span><span class="ocamlEnd"> </span><span class="Constant">&quot; &quot;</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L24" title="ocaml/ocamltest/builtin_variables.mli:24">commandline</a></span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L28" title="ocaml/ocamltest/builtin_variables.mli:28">exit_status</a></span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="Statement">(</span><span class="PreProc">Result</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier"><a href="result.ml.html#L39" title="ocaml/ocamltest/result.ml:39">fail_with_reason</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L47" title="ocaml/ocamltest/builtin_variables.mli:47">reason</a></span><span class="ocamlEnd">, </span><span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="Statement">)<br/></li>
<li></span><span class="ocamlEnd">&nbsp; </span><span class="Statement">end<br/></li>
<li></span><br/></li>
<li><a id="L785">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">cc</span></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="PreProc">Actions</span>.<span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L34" title="ocaml/ocamltest/builtin_variables.mli:34">make</a></span> <span class="Statement">~</span><span class="Identifier"><a href="actions.mli.html#L22" title="ocaml/ocamltest/actions.mli:22">name</a></span>:<span class="Constant">&quot;<a href="ocaml_actions.mli.html#L57" title="ocaml/ocamltest/ocaml_actions.mli:57">cc</a>&quot;</span> <span class="Statement">~</span><span class="Identifier"><a href="actions.mli.html#L24" title="ocaml/ocamltest/actions.mli:24">description</a></span>:<span class="Constant">&quot;Run C compiler to build the <a href="builtin_variables.mli.html#L42" title="ocaml/ocamltest/builtin_variables.mli:42">program</a>&quot;<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L753" title="ocaml/ocamltest/ocaml_actions.ml:753">run_cc</a><br/></li>
<li></span><br/></li>
<li><a id="L789">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">run_expect_once</span></span> <span class="ocamlLCIdentifier">input_file</span> <span class="ocamlLCIdentifier"><a href="ocaml_modifiers.ml.html#L25" title="ocaml/ocamltest/ocaml_modifiers.ml:25">principal</a></span> <span class="ocamlLCIdentifier"><a href="main.ml.html#L166" title="ocaml/ocamltest/main.ml:166">log</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">expect_flags</span> <span class="Statement">=</span> <span class="PreProc">Sys</span>.<span class="ocamlLCIdentifier"><a href="ocamltest_stdlib.ml.html#L223" title="ocaml/ocamltest/ocamltest_stdlib.ml:223">safe_getenv</a></span> <span class="Constant">&quot;EXPECT_FLAGS&quot;</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">repo_root</span> <span class="Statement">=</span> <span class="Constant">&quot;-repo-root &quot;</span> <span class="Statement">^</span> <span class="PreProc">Ocaml_directories</span>.<span class="ocamlLCIdentifier"><a href="ocaml_directories.ml.html#L20" title="ocaml/ocamltest/ocaml_directories.ml:20">srcdir</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">principal_flag</span> <span class="Statement">=</span> <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier"><a href="ocaml_modifiers.ml.html#L25" title="ocaml/ocamltest/ocaml_modifiers.ml:25">principal</a></span><span class="ocamlNone"> </span><span class="Statement">then</span> <span class="Constant">&quot;-<a href="ocaml_modifiers.ml.html#L25" title="ocaml/ocamltest/ocaml_modifiers.ml:25">principal</a>&quot;</span> <span class="Statement">else</span> <span class="Constant">&quot;&quot;</span> <span class="Statement">in<br/></li>
<li><a id="L793">&#x200c;</a></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">commandline</span></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">[<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Ocaml_commands</span>.<span class="ocamlLCIdentifier"><a href="ocaml_commands.ml.html#L27" title="ocaml/ocamltest/ocaml_commands.ml:27">ocamlrun_expect_test</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier">expect_flags</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L61" title="ocaml/ocamltest/ocaml_variables.mli:61">flags</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier">repo_root</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier">principal_flag</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier">input_file<br/></li>
<li></span>&nbsp; <span class="Statement">]</span> <span class="Statement">in<br/></li>
<li><a id="L802">&#x200c;</a></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">exit_status</span></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Actions_helpers</span>.<span class="ocamlLCIdentifier"><a href="actions_helpers.ml.html#L117" title="ocaml/ocamltest/actions_helpers.ml:117">run_cmd</a></span> <span class="Statement">~</span><span class="Identifier"><a href="environments.ml.html#L199" title="ocaml/ocamltest/environments.ml:199">environment</a></span>:<span class="ocamlLCIdentifier"><a href="#L88" title="ocaml/ocamltest/ocaml_actions.ml:88">default_ocaml_env</a></span> <span class="ocamlLCIdentifier"><a href="main.ml.html#L166" title="ocaml/ocamltest/main.ml:166">log</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L24" title="ocaml/ocamltest/builtin_variables.mli:24">commandline</a><br/></li>
<li></span>&nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L28" title="ocaml/ocamltest/builtin_variables.mli:28">exit_status</a></span><span class="Statement">=</span><span class="Constant">0</span><span class="ocamlNone"> </span><span class="Statement">then</span> <span class="Statement">(</span><span class="PreProc">Result</span>.<span class="ocamlLCIdentifier"><a href="builtin_actions.mli.html#L18" title="ocaml/ocamltest/builtin_actions.mli:18">pass</a></span>, <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">else</span> <span class="Statement">begin<br/></li>
<li><a id="L807">&#x200c;</a></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><span class="linkable">reason</span></span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="PreProc">Actions_helpers</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier"><a href="actions_helpers.ml.html#L35" title="ocaml/ocamltest/actions_helpers.ml:35">mkreason</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Constant">&quot;<a href="ocaml_tests.mli.html#L24" title="ocaml/ocamltest/ocaml_tests.mli:24">expect</a>&quot;</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="PreProc">String</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">concat</span><span class="ocamlEnd"> </span><span class="Constant">&quot; &quot;</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L24" title="ocaml/ocamltest/builtin_variables.mli:24">commandline</a></span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L28" title="ocaml/ocamltest/builtin_variables.mli:28">exit_status</a></span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="Statement">(</span><span class="PreProc">Result</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier"><a href="result.ml.html#L39" title="ocaml/ocamltest/result.ml:39">fail_with_reason</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L47" title="ocaml/ocamltest/builtin_variables.mli:47">reason</a></span><span class="ocamlEnd">, </span><span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="Statement">)<br/></li>
<li></span><span class="ocamlEnd">&nbsp; </span><span class="Statement">end<br/></li>
<li></span><br/></li>
<li><a id="L812">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">run_expect_twice</span></span> <span class="ocamlLCIdentifier">input_file</span> <span class="ocamlLCIdentifier"><a href="main.ml.html#L166" title="ocaml/ocamltest/main.ml:166">log</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">corrected</span> <span class="ocamlLCIdentifier"><a href="ocaml_compilers.ml.html#L57" title="ocaml/ocamltest/ocaml_compilers.ml:57">filename</a></span> <span class="Statement">=</span> <span class="PreProc">Filename</span>.<span class="ocamlLCIdentifier"><a href="ocaml_filetypes.ml.html#L106" title="ocaml/ocamltest/ocaml_filetypes.ml:106">make_filename</a></span> <span class="ocamlLCIdentifier"><a href="ocaml_compilers.ml.html#L57" title="ocaml/ocamltest/ocaml_compilers.ml:57">filename</a></span> <span class="Constant">&quot;corrected&quot;</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">result1</span>, <span class="ocamlLCIdentifier">env1</span><span class="Statement">)</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="#L789" title="ocaml/ocamltest/ocaml_actions.ml:789">run_expect_once</a></span> <span class="ocamlLCIdentifier">input_file</span> <span class="Constant">false</span> <span class="ocamlLCIdentifier"><a href="main.ml.html#L166" title="ocaml/ocamltest/main.ml:166">log</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="PreProc">Result</span><span class="ocamlNone">.</span><span class="ocamlLCIdentifier"><a href="result.ml.html#L53" title="ocaml/ocamltest/result.ml:53">is_pass</a></span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">result1</span><span class="ocamlNone"> </span><span class="Statement">then</span> <span class="Statement">begin<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">intermediate_file</span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">corrected</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">input_file</span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">result2</span><span class="ocamlEnd">, </span><span class="ocamlLCIdentifier">env2</span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="#L789" title="ocaml/ocamltest/ocaml_actions.ml:789">run_expect_once</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">intermediate_file</span><span class="ocamlEnd"> </span><span class="Constant">true</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="main.ml.html#L166" title="ocaml/ocamltest/main.ml:166">log</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">env1</span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="Statement">if</span><span class="ocamlNone"> </span><span class="PreProc">Result</span><span class="ocamlNone">.</span><span class="ocamlLCIdentifier"><a href="result.ml.html#L53" title="ocaml/ocamltest/result.ml:53">is_pass</a></span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">result2</span><span class="ocamlNone"> </span><span class="Statement">then</span><span class="ocamlEnd"> </span><span class="Statement">begin<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">output_file</span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">corrected</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">intermediate_file</span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">output_env</span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="PreProc">Environments</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier"><a href="environments.ml.html#L127" title="ocaml/ocamltest/environments.ml:127">add_bindings</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">[<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="PreProc">Builtin_variables</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L49" title="ocaml/ocamltest/builtin_variables.mli:49">reference</a></span><span class="ocamlEnd">, </span><span class="ocamlLCIdentifier">input_file</span><span class="Statement">;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="PreProc">Builtin_variables</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L40" title="ocaml/ocamltest/builtin_variables.mli:40">output</a></span><span class="ocamlEnd">, </span><span class="ocamlLCIdentifier">output_file<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">]</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">env2</span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">(</span><span class="PreProc">Result</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier"><a href="builtin_actions.mli.html#L18" title="ocaml/ocamltest/builtin_actions.mli:18">pass</a></span><span class="ocamlEnd">, </span><span class="ocamlLCIdentifier">output_env</span><span class="Statement">)<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="Statement">end</span><span class="ocamlEnd"> </span><span class="Statement">else</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">result2</span><span class="ocamlEnd">, </span><span class="ocamlLCIdentifier">env2</span><span class="Statement">)<br/></li>
<li></span><span class="ocamlEnd">&nbsp; </span><span class="Statement">end</span> <span class="Statement">else</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">result1</span>, <span class="ocamlLCIdentifier">env1</span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li><a id="L830">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">run_expect</span></span> <span class="ocamlLCIdentifier"><a href="main.ml.html#L166" title="ocaml/ocamltest/main.ml:166">log</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">input_file</span> <span class="Statement">=</span> <span class="PreProc">Actions_helpers</span>.<span class="ocamlLCIdentifier"><a href="actions_helpers.ml.html#L39" title="ocaml/ocamltest/actions_helpers.ml:39">testfile</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier"><a href="#L812" title="ocaml/ocamltest/ocaml_actions.ml:812">run_expect_twice</a></span> <span class="ocamlLCIdentifier">input_file</span> <span class="ocamlLCIdentifier"><a href="main.ml.html#L166" title="ocaml/ocamltest/main.ml:166">log</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a><br/></li>
<li></span><br/></li>
<li><a id="L834">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">run_expect</span></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="PreProc">Actions</span>.<span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L34" title="ocaml/ocamltest/builtin_variables.mli:34">make</a></span> <span class="Statement">~</span><span class="Identifier"><a href="actions.mli.html#L22" title="ocaml/ocamltest/actions.mli:22">name</a></span>:<span class="Constant">&quot;<a href="builtin_actions.mli.html#L46" title="ocaml/ocamltest/builtin_actions.mli:46">run</a>-<a href="ocaml_tests.mli.html#L24" title="ocaml/ocamltest/ocaml_tests.mli:24">expect</a>&quot;</span> <span class="Statement">~</span><span class="Identifier"><a href="actions.mli.html#L24" title="ocaml/ocamltest/actions.mli:24">description</a></span>:<span class="Constant">&quot;Run <a href="ocaml_tests.mli.html#L24" title="ocaml/ocamltest/ocaml_tests.mli:24">expect</a> test&quot;</span> <span class="ocamlLCIdentifier"><a href="ocaml_actions.mli.html#L30" title="ocaml/ocamltest/ocaml_actions.mli:30">run_expect</a><br/></li>
<li></span><br/></li>
<li><a id="L837">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">make_check_tool_output</span></span> <span class="ocamlLCIdentifier"><a href="actions.mli.html#L22" title="ocaml/ocamltest/actions.mli:22">name</a></span> <span class="ocamlLCIdentifier"><a href="filecompare.ml.html#L27" title="ocaml/ocamltest/filecompare.ml:27">tool</a></span> <span class="Statement">=</span> <span class="PreProc">Actions</span>.<span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L34" title="ocaml/ocamltest/builtin_variables.mli:34">make</a><br/></li>
<li></span>&nbsp; <span class="Statement">~</span><span class="Identifier"><a href="actions.mli.html#L22" title="ocaml/ocamltest/actions.mli:22">name</a><br/></li>
<li></span>&nbsp; <span class="Statement">~</span><span class="Identifier"><a href="actions.mli.html#L24" title="ocaml/ocamltest/actions.mli:24">description</a></span>:<span class="Statement">(</span><span class="PreProc">Printf</span>.<span class="ocamlLCIdentifier">sprintf</span> <span class="Constant">&quot;Check <a href="filecompare.ml.html#L27" title="ocaml/ocamltest/filecompare.ml:27">tool</a> <a href="builtin_variables.mli.html#L40" title="ocaml/ocamltest/builtin_variables.mli:40">output</a> (%s)&quot;</span> <span class="ocamlLCIdentifier"><a href="actions.mli.html#L22" title="ocaml/ocamltest/actions.mli:22">name</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">(</span><span class="PreProc">Actions_helpers</span>.<span class="ocamlLCIdentifier"><a href="actions_helpers.ml.html#L335" title="ocaml/ocamltest/actions_helpers.ml:335">check_output</a><br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="filecompare.ml.html#L27" title="ocaml/ocamltest/filecompare.ml:27">tool</a></span><span class="PreProc">#</span><span class="ocamlLCIdentifier">family<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="filecompare.ml.html#L27" title="ocaml/ocamltest/filecompare.ml:27">tool</a></span><span class="PreProc">#</span><span class="ocamlLCIdentifier">output_variable<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="filecompare.ml.html#L27" title="ocaml/ocamltest/filecompare.ml:27">tool</a></span><span class="PreProc">#</span><span class="ocamlLCIdentifier">reference_variable</span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li><a id="L845">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">check_ocamlc_byte_output</span></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="#L837" title="ocaml/ocamltest/ocaml_actions.ml:837">make_check_tool_output</a><br/></li>
<li></span>&nbsp; <span class="Constant">&quot;check-<a href="ocaml_files.ml.html#L39" title="ocaml/ocamltest/ocaml_files.ml:39">ocamlc</a><a href="tsl_semantics.ml.html#L72" title="ocaml/ocamltest/tsl_semantics.ml:72">.</a>byte-<a href="builtin_variables.mli.html#L40" title="ocaml/ocamltest/builtin_variables.mli:40">output</a>&quot;</span> <span class="PreProc">Ocaml_compilers</span>.<span class="ocamlLCIdentifier"><a href="ocaml_actions.mli.html#L19" title="ocaml/ocamltest/ocaml_actions.mli:19">ocamlc_byte</a><br/></li>
<li></span><br/></li>
<li><a id="L848">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">check_ocamlc_opt_output</span></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier"><a href="#L26" title="ocaml/ocamltest/ocaml_actions.ml:26">native_action</a><br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L837" title="ocaml/ocamltest/ocaml_actions.ml:837">make_check_tool_output</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Constant">&quot;check-<a href="ocaml_files.ml.html#L39" title="ocaml/ocamltest/ocaml_files.ml:39">ocamlc</a><a href="tsl_semantics.ml.html#L72" title="ocaml/ocamltest/tsl_semantics.ml:72">.</a>opt-<a href="builtin_variables.mli.html#L40" title="ocaml/ocamltest/builtin_variables.mli:40">output</a>&quot;</span> <span class="PreProc">Ocaml_compilers</span>.<span class="ocamlLCIdentifier"><a href="ocaml_actions.mli.html#L22" title="ocaml/ocamltest/ocaml_actions.mli:22">ocamlc_opt</a></span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li><a id="L853">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">check_ocamlopt_byte_output</span></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier"><a href="#L26" title="ocaml/ocamltest/ocaml_actions.ml:26">native_action</a><br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L837" title="ocaml/ocamltest/ocaml_actions.ml:837">make_check_tool_output</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Constant">&quot;check-<a href="ocaml_files.ml.html#L48" title="ocaml/ocamltest/ocaml_files.ml:48">ocamlopt</a><a href="tsl_semantics.ml.html#L72" title="ocaml/ocamltest/tsl_semantics.ml:72">.</a>byte-<a href="builtin_variables.mli.html#L40" title="ocaml/ocamltest/builtin_variables.mli:40">output</a>&quot;</span> <span class="PreProc">Ocaml_compilers</span>.<span class="ocamlLCIdentifier"><a href="ocaml_actions.mli.html#L25" title="ocaml/ocamltest/ocaml_actions.mli:25">ocamlopt_byte</a></span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li><a id="L858">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">check_ocamlopt_opt_output</span></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier"><a href="#L26" title="ocaml/ocamltest/ocaml_actions.ml:26">native_action</a><br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L837" title="ocaml/ocamltest/ocaml_actions.ml:837">make_check_tool_output</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Constant">&quot;check-<a href="ocaml_files.ml.html#L48" title="ocaml/ocamltest/ocaml_files.ml:48">ocamlopt</a><a href="tsl_semantics.ml.html#L72" title="ocaml/ocamltest/tsl_semantics.ml:72">.</a>opt-<a href="builtin_variables.mli.html#L40" title="ocaml/ocamltest/builtin_variables.mli:40">output</a>&quot;</span> <span class="PreProc">Ocaml_compilers</span>.<span class="ocamlLCIdentifier"><a href="ocaml_actions.mli.html#L28" title="ocaml/ocamltest/ocaml_actions.mli:28">ocamlopt_opt</a></span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li><a id="L863">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">really_compare_programs</span></span> <span class="ocamlLCIdentifier"><a href="ocaml_tools.ml.html#L66" title="ocaml/ocamltest/ocaml_tools.ml:66">backend</a></span> <span class="ocamlLCIdentifier">comparison_tool</span> <span class="ocamlLCIdentifier"><a href="main.ml.html#L166" title="ocaml/ocamltest/main.ml:166">log</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L42" title="ocaml/ocamltest/builtin_variables.mli:42">program</a></span> <span class="Statement">=</span> <span class="PreProc">Environments</span>.<span class="ocamlLCIdentifier"><a href="environments.mli.html#L29" title="ocaml/ocamltest/environments.mli:29">safe_lookup</a></span> <span class="PreProc">Builtin_variables</span>.<span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L42" title="ocaml/ocamltest/builtin_variables.mli:42">program</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L43" title="ocaml/ocamltest/builtin_variables.mli:43">program2</a></span> <span class="Statement">=</span> <span class="PreProc">Environments</span>.<span class="ocamlLCIdentifier"><a href="environments.mli.html#L29" title="ocaml/ocamltest/environments.mli:29">safe_lookup</a></span> <span class="PreProc">Builtin_variables</span>.<span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L43" title="ocaml/ocamltest/builtin_variables.mli:43">program2</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="#L227" title="ocaml/ocamltest/ocaml_actions.ml:227">what</a></span> <span class="Statement">=</span> <span class="PreProc">Printf</span>.<span class="ocamlLCIdentifier">sprintf</span> <span class="Constant">&quot;Comparing %s programs %s and %s&quot;<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">(</span><span class="PreProc">Ocaml_backends</span>.<span class="ocamlLCIdentifier"><a href="ocaml_backends.ml.html#L24" title="ocaml/ocamltest/ocaml_backends.ml:24">string_of_backend</a></span> <span class="ocamlLCIdentifier"><a href="ocaml_tools.ml.html#L66" title="ocaml/ocamltest/ocaml_tools.ml:66">backend</a></span><span class="Statement">)</span> <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L42" title="ocaml/ocamltest/builtin_variables.mli:42">program</a></span> <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L43" title="ocaml/ocamltest/builtin_variables.mli:43">program2</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="PreProc">Printf</span>.<span class="ocamlLCIdentifier">fprintf</span> <span class="ocamlLCIdentifier"><a href="main.ml.html#L166" title="ocaml/ocamltest/main.ml:166">log</a></span> <span class="Constant">&quot;%s\<a href="actions_helpers.ml.html#L174" title="ocaml/ocamltest/actions_helpers.ml:174">n</a>%!&quot;</span> <span class="ocamlLCIdentifier"><a href="#L227" title="ocaml/ocamltest/ocaml_actions.ml:227">what</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="filecompare.ml.html#L56" title="ocaml/ocamltest/filecompare.ml:56">files</a></span> <span class="Statement">=</span> <span class="Statement">{<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Filecompare</span>.<span class="ocamlLCIdentifier"><a href="filecompare.ml.html#L54" title="ocaml/ocamltest/filecompare.ml:54">filetype</a></span> <span class="Statement">=</span> <span class="PreProc">Filecompare</span>.<span class="Constant">Binary</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Filecompare</span>.<span class="ocamlLCIdentifier"><a href="main.ml.html#L182" title="ocaml/ocamltest/main.ml:182">reference_filename</a></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L42" title="ocaml/ocamltest/builtin_variables.mli:42">program</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Filecompare</span>.<span class="ocamlLCIdentifier">output_filename</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L43" title="ocaml/ocamltest/builtin_variables.mli:43">program2</a><br/></li>
<li></span>&nbsp; <span class="Statement">}</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">match</span> <span class="PreProc">Filecompare</span>.<span class="ocamlLCIdentifier"><a href="filecompare.ml.html#L197" title="ocaml/ocamltest/filecompare.ml:197">compare_files</a></span> <span class="Statement">~</span><span class="Identifier"><a href="filecompare.ml.html#L27" title="ocaml/ocamltest/filecompare.ml:27">tool</a></span>:<span class="ocamlLCIdentifier">comparison_tool</span> <span class="ocamlLCIdentifier"><a href="filecompare.ml.html#L56" title="ocaml/ocamltest/filecompare.ml:56">files</a></span> <span class="Statement">with<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="PreProc">Filecompare</span>.<span class="Constant">Same</span> <span class="Statement">-&gt;</span> <span class="Statement">(</span><span class="PreProc">Result</span>.<span class="ocamlLCIdentifier"><a href="builtin_actions.mli.html#L18" title="ocaml/ocamltest/builtin_actions.mli:18">pass</a></span>, <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="PreProc">Filecompare</span>.<span class="Constant">Different</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L47" title="ocaml/ocamltest/builtin_variables.mli:47">reason</a></span> <span class="Statement">=</span> <span class="PreProc">Printf</span>.<span class="ocamlLCIdentifier">sprintf</span> <span class="Constant">&quot;Files %s and %s are different&quot;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L42" title="ocaml/ocamltest/builtin_variables.mli:42">program</a></span> <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L43" title="ocaml/ocamltest/builtin_variables.mli:43">program2</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">(</span><span class="PreProc">Result</span>.<span class="ocamlLCIdentifier"><a href="result.ml.html#L39" title="ocaml/ocamltest/result.ml:39">fail_with_reason</a></span> <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L47" title="ocaml/ocamltest/builtin_variables.mli:47">reason</a></span>, <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="PreProc">Filecompare</span>.<span class="Constant">Unexpected_output</span> <span class="Statement">-&gt;</span> <span class="Statement">assert</span> <span class="Constant">false<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="PreProc">Filecompare</span>.<span class="Constant">Error</span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L24" title="ocaml/ocamltest/builtin_variables.mli:24">commandline</a></span>, <span class="ocamlLCIdentifier">exitcode</span><span class="Statement">)</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L47" title="ocaml/ocamltest/builtin_variables.mli:47">reason</a></span> <span class="Statement">=</span> <span class="PreProc">Actions_helpers</span>.<span class="ocamlLCIdentifier"><a href="actions_helpers.ml.html#L35" title="ocaml/ocamltest/actions_helpers.ml:35">mkreason</a></span> <span class="ocamlLCIdentifier"><a href="#L227" title="ocaml/ocamltest/ocaml_actions.ml:227">what</a></span> <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L24" title="ocaml/ocamltest/builtin_variables.mli:24">commandline</a></span> <span class="ocamlLCIdentifier">exitcode</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">(</span><span class="PreProc">Result</span>.<span class="ocamlLCIdentifier"><a href="result.ml.html#L39" title="ocaml/ocamltest/result.ml:39">fail_with_reason</a></span> <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L47" title="ocaml/ocamltest/builtin_variables.mli:47">reason</a></span>, <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li><a id="L885">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">compare_programs</span></span> <span class="ocamlLCIdentifier"><a href="ocaml_tools.ml.html#L66" title="ocaml/ocamltest/ocaml_tools.ml:66">backend</a></span> <span class="ocamlLCIdentifier">comparison_tool</span> <span class="ocamlLCIdentifier"><a href="main.ml.html#L166" title="ocaml/ocamltest/main.ml:166">log</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L37" title="ocaml/ocamltest/ocaml_variables.mli:37">compare_programs</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Environments</span>.<span class="ocamlLCIdentifier"><a href="environments.ml.html#L93" title="ocaml/ocamltest/environments.ml:93">lookup_as_bool</a></span> <span class="PreProc">Ocaml_variables</span>.<span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L37" title="ocaml/ocamltest/ocaml_variables.mli:37">compare_programs</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L37" title="ocaml/ocamltest/ocaml_variables.mli:37">compare_programs</a></span><span class="ocamlNone"> </span><span class="Statement">=</span><span class="ocamlNone"> </span><span class="Constant">Some</span><span class="ocamlNone"> </span><span class="Constant">false</span><span class="ocamlNone"> </span><span class="Statement">then</span> <span class="Statement">begin<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L47" title="ocaml/ocamltest/builtin_variables.mli:47">reason</a></span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="Constant">&quot;<a href="builtin_variables.mli.html#L42" title="ocaml/ocamltest/builtin_variables.mli:42">program</a> comparison disabled&quot;</span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="Statement">(</span><span class="PreProc">Result</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier"><a href="result.ml.html#L35" title="ocaml/ocamltest/result.ml:35">pass_with_reason</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L47" title="ocaml/ocamltest/builtin_variables.mli:47">reason</a></span><span class="ocamlEnd">, </span><span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="Statement">)<br/></li>
<li></span><span class="ocamlEnd">&nbsp; </span><span class="Statement">end</span> <span class="Statement">else</span> <span class="ocamlLCIdentifier"><a href="#L863" title="ocaml/ocamltest/ocaml_actions.ml:863">really_compare_programs</a></span> <span class="ocamlLCIdentifier"><a href="ocaml_tools.ml.html#L66" title="ocaml/ocamltest/ocaml_tools.ml:66">backend</a></span> <span class="ocamlLCIdentifier">comparison_tool</span> <span class="ocamlLCIdentifier"><a href="main.ml.html#L166" title="ocaml/ocamltest/main.ml:166">log</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a><br/></li>
<li></span><br/></li>
<li><a id="L893">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">make_bytecode_programs_comparison_tool</span></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="ocaml_commands.ml.html#L18" title="ocaml/ocamltest/ocaml_commands.ml:18">ocamlrun</a></span> <span class="Statement">=</span> <span class="PreProc">Ocaml_files</span>.<span class="ocamlLCIdentifier"><a href="ocaml_commands.ml.html#L18" title="ocaml/ocamltest/ocaml_commands.ml:18">ocamlrun</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="ocaml_files.ml.html#L57" title="ocaml/ocamltest/ocaml_files.ml:57">cmpbyt</a></span> <span class="Statement">=</span> <span class="PreProc">Ocaml_files</span>.<span class="ocamlLCIdentifier"><a href="ocaml_files.ml.html#L57" title="ocaml/ocamltest/ocaml_files.ml:57">cmpbyt</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">tool_name</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="ocaml_commands.ml.html#L18" title="ocaml/ocamltest/ocaml_commands.ml:18">ocamlrun</a></span> <span class="Statement">^</span> <span class="Constant">&quot; &quot;</span> <span class="Statement">^</span> <span class="ocamlLCIdentifier"><a href="ocaml_files.ml.html#L57" title="ocaml/ocamltest/ocaml_files.ml:57">cmpbyt</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="PreProc">Filecompare</span>.<span class="ocamlLCIdentifier"><a href="filecompare.ml.html#L43" title="ocaml/ocamltest/filecompare.ml:43">make_comparison_tool</a></span> <span class="ocamlLCIdentifier">tool_name</span> <span class="Constant">&quot;&quot;<br/></li>
<li></span><br/></li>
<li><a id="L899">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">native_programs_comparison_tool</span></span> <span class="Statement">=</span> <span class="PreProc">Filecompare</span>.<span class="ocamlLCIdentifier"><a href="filecompare.ml.html#L52" title="ocaml/ocamltest/filecompare.ml:52">default_comparison_tool</a><br/></li>
<li></span><br/></li>
<li><a id="L901">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">compare_bytecode_programs_code</span></span> <span class="ocamlLCIdentifier"><a href="main.ml.html#L166" title="ocaml/ocamltest/main.ml:166">log</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">bytecode_programs_comparison_tool</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L893" title="ocaml/ocamltest/ocaml_actions.ml:893">make_bytecode_programs_comparison_tool</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L37" title="ocaml/ocamltest/ocaml_variables.mli:37">compare_programs</a><br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Ocaml_backends</span>.<span class="Constant">Bytecode</span> <span class="ocamlLCIdentifier">bytecode_programs_comparison_tool</span> <span class="ocamlLCIdentifier"><a href="main.ml.html#L166" title="ocaml/ocamltest/main.ml:166">log</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a><br/></li>
<li></span><br/></li>
<li><a id="L907">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">compare_bytecode_programs</span></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier"><a href="#L26" title="ocaml/ocamltest/ocaml_actions.ml:26">native_action</a><br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">(</span><span class="PreProc">Actions</span>.<span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L34" title="ocaml/ocamltest/builtin_variables.mli:34">make</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier"><a href="actions.mli.html#L22" title="ocaml/ocamltest/actions.mli:22">name</a></span>:<span class="Constant">&quot;<a href="actions.mli.html#L32" title="ocaml/ocamltest/actions.mli:32">compare</a>-<a href="ocaml_tests.mli.html#L18" title="ocaml/ocamltest/ocaml_tests.mli:18">bytecode</a>-programs&quot;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier"><a href="actions.mli.html#L24" title="ocaml/ocamltest/actions.mli:24">description</a></span>:<span class="Constant">&quot;Compare the <a href="ocaml_tests.mli.html#L18" title="ocaml/ocamltest/ocaml_tests.mli:18">bytecode</a> programs generated by <a href="ocaml_files.ml.html#L39" title="ocaml/ocamltest/ocaml_files.ml:39">ocamlc</a><a href="tsl_semantics.ml.html#L72" title="ocaml/ocamltest/tsl_semantics.ml:72">.</a>byte and \<br/></li>
<li></span><span class="Constant">&nbsp; &nbsp; &nbsp; &nbsp; <a href="ocaml_files.ml.html#L39" title="ocaml/ocamltest/ocaml_files.ml:39">ocamlc</a><a href="tsl_semantics.ml.html#L72" title="ocaml/ocamltest/tsl_semantics.ml:72">.</a>opt&quot;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L901" title="ocaml/ocamltest/ocaml_actions.ml:901">compare_bytecode_programs_code</a></span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li><a id="L915">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">compare_binary_files</span></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier"><a href="#L26" title="ocaml/ocamltest/ocaml_actions.ml:26">native_action</a><br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">(</span><span class="PreProc">Actions</span>.<span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L34" title="ocaml/ocamltest/builtin_variables.mli:34">make</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier"><a href="actions.mli.html#L22" title="ocaml/ocamltest/actions.mli:22">name</a></span>:<span class="Constant">&quot;<a href="actions.mli.html#L32" title="ocaml/ocamltest/actions.mli:32">compare</a>-binary-<a href="filecompare.ml.html#L56" title="ocaml/ocamltest/filecompare.ml:56">files</a>&quot;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier"><a href="actions.mli.html#L24" title="ocaml/ocamltest/actions.mli:24">description</a></span>:<span class="Constant">&quot;Compare the <a href="ocaml_tests.mli.html#L20" title="ocaml/ocamltest/ocaml_tests.mli:20">native</a> programs generated by <a href="ocaml_files.ml.html#L48" title="ocaml/ocamltest/ocaml_files.ml:48">ocamlopt</a><a href="tsl_semantics.ml.html#L72" title="ocaml/ocamltest/tsl_semantics.ml:72">.</a>byte and \<br/></li>
<li></span><span class="Constant">&nbsp; &nbsp; &nbsp; &nbsp; <a href="ocaml_files.ml.html#L48" title="ocaml/ocamltest/ocaml_files.ml:48">ocamlopt</a><a href="tsl_semantics.ml.html#L72" title="ocaml/ocamltest/tsl_semantics.ml:72">.</a>opt&quot;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L37" title="ocaml/ocamltest/ocaml_variables.mli:37">compare_programs</a></span> <span class="PreProc">Ocaml_backends</span>.<span class="Constant">Native</span> <span class="ocamlLCIdentifier"><a href="#L899" title="ocaml/ocamltest/ocaml_actions.ml:899">native_programs_comparison_tool</a></span><span class="Statement">))<br/></li>
<li></span><br/></li>
<li><a id="L923">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">compile_module</span></span> <span class="ocamlLCIdentifier">compiler</span> <span class="ocamlLCIdentifier">compilername</span> <span class="ocamlLCIdentifier">compileroutput</span> <span class="ocamlLCIdentifier"><a href="main.ml.html#L166" title="ocaml/ocamltest/main.ml:166">log</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a><br/></li>
<li></span>&nbsp; <span class="Statement">(</span><span class="ocamlLCIdentifier">module_basename</span>, <span class="ocamlLCIdentifier">module_filetype</span><span class="Statement">)</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="ocaml_tools.ml.html#L66" title="ocaml/ocamltest/ocaml_tools.ml:66">backend</a></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">compiler</span><span class="PreProc">#</span><span class="ocamlLCIdentifier">target</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="ocaml_compilers.ml.html#L57" title="ocaml/ocamltest/ocaml_compilers.ml:57">filename</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Ocaml_filetypes</span>.<span class="ocamlLCIdentifier"><a href="ocaml_filetypes.ml.html#L106" title="ocaml/ocamltest/ocaml_filetypes.ml:106">make_filename</a></span> <span class="Statement">(</span><span class="ocamlLCIdentifier">module_basename</span>, <span class="ocamlLCIdentifier">module_filetype</span><span class="Statement">)</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="ocaml_tools.ml.html#L50" title="ocaml/ocamltest/ocaml_tools.ml:50">expected_exit_status</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Ocaml_tools</span>.<span class="ocamlLCIdentifier"><a href="ocaml_tools.ml.html#L50" title="ocaml/ocamltest/ocaml_tools.ml:50">expected_exit_status</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">(</span><span class="ocamlLCIdentifier">compiler</span> :<span class="Statement">&gt;</span> <span class="PreProc">Ocaml_tools</span>.<span class="ocamlLCIdentifier"><a href="filecompare.ml.html#L27" title="ocaml/ocamltest/filecompare.ml:27">tool</a></span><span class="Statement">)</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="#L227" title="ocaml/ocamltest/ocaml_actions.ml:227">what</a></span> <span class="Statement">=</span> <span class="PreProc">Printf</span>.<span class="ocamlLCIdentifier">sprintf</span> <span class="Constant">&quot;%s for <a href="builtin_variables.mli.html#L30" title="ocaml/ocamltest/builtin_variables.mli:30">file</a> %s (expected exit <a href="result.ml.html#L18" title="ocaml/ocamltest/result.ml:18">status</a>: %d)&quot;<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">(</span><span class="PreProc">Ocaml_filetypes</span>.<span class="ocamlLCIdentifier"><a href="ocaml_filetypes.ml.html#L110" title="ocaml/ocamltest/ocaml_filetypes.ml:110">action_of_filetype</a></span> <span class="ocamlLCIdentifier">module_filetype</span><span class="Statement">)</span> <span class="ocamlLCIdentifier"><a href="ocaml_compilers.ml.html#L57" title="ocaml/ocamltest/ocaml_compilers.ml:57">filename</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="ocaml_tools.ml.html#L50" title="ocaml/ocamltest/ocaml_tools.ml:50">expected_exit_status</a></span><span class="Statement">)</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">compile_commandline</span> <span class="ocamlLCIdentifier">input_file</span> <span class="ocamlLCIdentifier">output_file</span> <span class="ocamlLCIdentifier">optional_flags</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="#L463" title="ocaml/ocamltest/ocaml_actions.ml:463">compile</a></span> <span class="Statement">=</span> <span class="Constant">&quot;-c &quot;</span> <span class="Statement">^</span> <span class="ocamlLCIdentifier">input_file</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L40" title="ocaml/ocamltest/builtin_variables.mli:40">output</a></span> <span class="Statement">=</span> <span class="Statement">match</span> <span class="ocamlLCIdentifier">output_file</span> <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">None</span> <span class="Statement">-&gt;</span> <span class="Constant">&quot;&quot;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Some</span> <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L30" title="ocaml/ocamltest/builtin_variables.mli:30">file</a></span> <span class="Statement">-&gt;</span> <span class="Constant">&quot;-o &quot;</span> <span class="Statement">^</span> <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L30" title="ocaml/ocamltest/builtin_variables.mli:30">file</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">[<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">compilername</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="PreProc">Ocaml_flags</span>.<span class="ocamlLCIdentifier"><a href="ocaml_directories.ml.html#L23" title="ocaml/ocamltest/ocaml_directories.ml:23">stdlib</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L61" title="ocaml/ocamltest/ocaml_variables.mli:61">flags</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L78" title="ocaml/ocamltest/ocaml_actions.ml:78">backend_flags</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="ocamlLCIdentifier"><a href="ocaml_tools.ml.html#L66" title="ocaml/ocamltest/ocaml_tools.ml:66">backend</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">optional_flags</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L463" title="ocaml/ocamltest/ocaml_actions.ml:463">compile</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L40" title="ocaml/ocamltest/builtin_variables.mli:40">output</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">]</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">exec</span> <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L24" title="ocaml/ocamltest/builtin_variables.mli:24">commandline</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Printf</span>.<span class="ocamlLCIdentifier">fprintf</span> <span class="ocamlLCIdentifier"><a href="main.ml.html#L166" title="ocaml/ocamltest/main.ml:166">log</a></span> <span class="Constant">&quot;%s\<a href="actions_helpers.ml.html#L174" title="ocaml/ocamltest/actions_helpers.ml:174">n</a>%!&quot;</span> <span class="ocamlLCIdentifier"><a href="#L227" title="ocaml/ocamltest/ocaml_actions.ml:227">what</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L28" title="ocaml/ocamltest/builtin_variables.mli:28">exit_status</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="PreProc">Actions_helpers</span>.<span class="ocamlLCIdentifier"><a href="actions_helpers.ml.html#L117" title="ocaml/ocamltest/actions_helpers.ml:117">run_cmd</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier">stdin_variable</span>: <span class="PreProc">Ocaml_variables</span>.<span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L51" title="ocaml/ocamltest/ocaml_variables.mli:51">compiler_stdin</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier">stdout_variable</span>:<span class="ocamlLCIdentifier">compileroutput<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier">stderr_variable</span>:<span class="ocamlLCIdentifier">compileroutput<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier"><a href="ocaml_modifiers.ml.html#L22" title="ocaml/ocamltest/ocaml_modifiers.ml:22">append</a></span>:<span class="Constant">true</span> <span class="ocamlLCIdentifier"><a href="main.ml.html#L166" title="ocaml/ocamltest/main.ml:166">log</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L24" title="ocaml/ocamltest/builtin_variables.mli:24">commandline</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L28" title="ocaml/ocamltest/builtin_variables.mli:28">exit_status</a></span><span class="Statement">=</span><span class="ocamlLCIdentifier"><a href="ocaml_tools.ml.html#L50" title="ocaml/ocamltest/ocaml_tools.ml:50">expected_exit_status</a><br/></li>
<li></span><span class="ocamlNone">&nbsp; &nbsp; </span><span class="Statement">then</span> <span class="Statement">(</span><span class="PreProc">Result</span>.<span class="ocamlLCIdentifier"><a href="builtin_actions.mli.html#L18" title="ocaml/ocamltest/builtin_actions.mli:18">pass</a></span>, <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">else</span> <span class="Statement">begin<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L47" title="ocaml/ocamltest/builtin_variables.mli:47">reason</a></span><span class="ocamlEnd"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">(</span><span class="PreProc">Actions_helpers</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier"><a href="actions_helpers.ml.html#L35" title="ocaml/ocamltest/actions_helpers.ml:35">mkreason</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="#L227" title="ocaml/ocamltest/ocaml_actions.ml:227">what</a></span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="PreProc">String</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">concat</span><span class="ocamlEnd"> </span><span class="Constant">&quot; &quot;</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L24" title="ocaml/ocamltest/builtin_variables.mli:24">commandline</a></span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L28" title="ocaml/ocamltest/builtin_variables.mli:28">exit_status</a></span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">(</span><span class="PreProc">Result</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier"><a href="result.ml.html#L39" title="ocaml/ocamltest/result.ml:39">fail_with_reason</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L47" title="ocaml/ocamltest/builtin_variables.mli:47">reason</a></span><span class="ocamlEnd">, </span><span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="Statement">)<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="Statement">end</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">match</span> <span class="ocamlLCIdentifier">module_filetype</span> <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="PreProc">Ocaml_filetypes</span>.<span class="Constant">Interface</span> <span class="Statement">-&gt;<br/></li>
<li><a id="L965">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">interface_name</span></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="PreProc">Ocaml_filetypes</span>.<span class="ocamlLCIdentifier"><a href="ocaml_filetypes.ml.html#L106" title="ocaml/ocamltest/ocaml_filetypes.ml:106">make_filename</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="ocamlLCIdentifier">module_basename</span>, <span class="PreProc">Ocaml_filetypes</span>.<span class="Constant">Interface</span><span class="Statement">)</span> <span class="Statement">in<br/></li>
<li><a id="L968">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">commandline</span></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">compile_commandline</span> <span class="ocamlLCIdentifier"><a href="#L965" title="ocaml/ocamltest/ocaml_actions.ml:965">interface_name</a></span> <span class="Constant">None</span> <span class="Constant">&quot;&quot;</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">exec</span> <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L24" title="ocaml/ocamltest/builtin_variables.mli:24">commandline</a><br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="PreProc">Ocaml_filetypes</span>.<span class="Constant">Implementation</span> <span class="Statement">-&gt;<br/></li>
<li><a id="L971">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">module_extension</span></span> <span class="Statement">=</span> <span class="PreProc">Ocaml_backends</span>.<span class="ocamlLCIdentifier"><span class="linkable">module_extension</span></span> <span class="ocamlLCIdentifier"><a href="ocaml_tools.ml.html#L66" title="ocaml/ocamltest/ocaml_tools.ml:66">backend</a></span> <span class="Statement">in<br/></li>
<li><a id="L972">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">module_output_name</span></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="PreProc">Filename</span>.<span class="ocamlLCIdentifier"><a href="ocaml_filetypes.ml.html#L106" title="ocaml/ocamltest/ocaml_filetypes.ml:106">make_filename</a></span> <span class="ocamlLCIdentifier">module_basename</span> <span class="ocamlLCIdentifier"><a href="ocaml_backends.ml.html#L34" title="ocaml/ocamltest/ocaml_backends.ml:34">module_extension</a></span> <span class="Statement">in<br/></li>
<li><a id="L974">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">commandline</span></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">compile_commandline</span> <span class="ocamlLCIdentifier"><a href="ocaml_compilers.ml.html#L57" title="ocaml/ocamltest/ocaml_compilers.ml:57">filename</a></span> <span class="Statement">(</span><span class="Constant">Some</span> <span class="ocamlLCIdentifier"><a href="#L972" title="ocaml/ocamltest/ocaml_actions.ml:972">module_output_name</a></span><span class="Statement">)</span> <span class="Constant">&quot;&quot;</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">exec</span> <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L24" title="ocaml/ocamltest/builtin_variables.mli:24">commandline</a><br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="PreProc">Ocaml_filetypes</span>.<span class="Constant">C</span> <span class="Statement">-&gt;<br/></li>
<li><a id="L978">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">object_extension</span></span> <span class="Statement">=</span> <span class="PreProc">Config</span>.<span class="ocamlLCIdentifier">ext_obj</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">_object_filename</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">module_basename</span> <span class="Statement">^</span> <span class="ocamlLCIdentifier"><a href="#L978" title="ocaml/ocamltest/ocaml_actions.ml:978">object_extension</a></span> <span class="Statement">in<br/></li>
<li><a id="L980">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">commandline</span></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">compile_commandline</span> <span class="ocamlLCIdentifier"><a href="ocaml_compilers.ml.html#L57" title="ocaml/ocamltest/ocaml_compilers.ml:57">filename</a></span> <span class="Constant">None<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="PreProc">Ocaml_flags</span>.<span class="ocamlLCIdentifier"><a href="ocaml_flags.mli.html#L22" title="ocaml/ocamltest/ocaml_flags.mli:22">c_includes</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">exec</span> <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L24" title="ocaml/ocamltest/builtin_variables.mli:24">commandline</a><br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Statement">_</span> <span class="Statement">-&gt;<br/></li>
<li><a id="L985">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">reason</span></span> <span class="Statement">=</span> <span class="PreProc">Printf</span>.<span class="ocamlLCIdentifier">sprintf</span> <span class="Constant">&quot;File %s of type %s not supported yet&quot;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="ocaml_compilers.ml.html#L57" title="ocaml/ocamltest/ocaml_compilers.ml:57">filename</a></span> <span class="Statement">(</span><span class="PreProc">Ocaml_filetypes</span>.<span class="ocamlLCIdentifier"><a href="ocaml_filetypes.ml.html#L37" title="ocaml/ocamltest/ocaml_filetypes.ml:37">string_of_filetype</a></span> <span class="ocamlLCIdentifier">module_filetype</span><span class="Statement">)</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="PreProc">Result</span>.<span class="ocamlLCIdentifier"><a href="result.ml.html#L39" title="ocaml/ocamltest/result.ml:39">fail_with_reason</a></span> <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L47" title="ocaml/ocamltest/builtin_variables.mli:47">reason</a></span>, <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li><a id="L989">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">compile_modules</span></span> <span class="ocamlLCIdentifier">compiler</span> <span class="ocamlLCIdentifier">compilername</span> <span class="ocamlLCIdentifier">compileroutput<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier">modules_with_filetypes</span> <span class="ocamlLCIdentifier"><a href="main.ml.html#L166" title="ocaml/ocamltest/main.ml:166">log</a></span> <span class="ocamlLCIdentifier">initial_env<br/></li>
<li></span>&nbsp; <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">compile_mod</span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="ocamlLCIdentifier">mod_</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L285" title="ocaml/ocamltest/ocaml_actions.ml:285">compile_module</a></span> <span class="ocamlLCIdentifier">compiler</span> <span class="ocamlLCIdentifier">compilername</span> <span class="ocamlLCIdentifier">compileroutput<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="main.ml.html#L166" title="ocaml/ocamltest/main.ml:166">log</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="ocamlLCIdentifier">mod_</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="Statement">rec</span> <span class="ocamlLCIdentifier">compile_mods</span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">=</span> <span class="Statement">function<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">[]</span> <span class="Statement">-&gt;</span> <span class="Statement">(</span><span class="PreProc">Result</span>.<span class="ocamlLCIdentifier"><a href="builtin_actions.mli.html#L18" title="ocaml/ocamltest/builtin_actions.mli:18">pass</a></span>, <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="ocamlLCIdentifier"><a href="ocamltest_stdlib.ml.html#L183" title="ocaml/ocamltest/ocamltest_stdlib.ml:183">m</a></span><span class="Statement">::</span><span class="ocamlLCIdentifier">ms</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">(let</span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="filecompare.ml.html#L20" title="ocaml/ocamltest/filecompare.ml:20">result</a></span>, <span class="ocamlLCIdentifier">newenv</span><span class="Statement">)</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">compile_mod</span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="ocamlLCIdentifier"><a href="ocamltest_stdlib.ml.html#L183" title="ocaml/ocamltest/ocamltest_stdlib.ml:183">m</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="PreProc">Result</span><span class="ocamlNone">.</span><span class="ocamlLCIdentifier"><a href="result.ml.html#L53" title="ocaml/ocamltest/result.ml:53">is_pass</a></span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier"><a href="filecompare.ml.html#L20" title="ocaml/ocamltest/filecompare.ml:20">result</a></span><span class="ocamlNone"> </span><span class="Statement">then</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">compile_mods</span> <span class="ocamlLCIdentifier">newenv</span> <span class="ocamlLCIdentifier">ms</span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">else</span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="filecompare.ml.html#L20" title="ocaml/ocamltest/filecompare.ml:20">result</a></span>, <span class="ocamlLCIdentifier">newenv</span><span class="Statement">))</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier">compile_mods</span> <span class="ocamlLCIdentifier">initial_env</span> <span class="ocamlLCIdentifier">modules_with_filetypes<br/></li>
<li></span><br/></li>
<li><a id="L1003">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">run_test_program_in_toplevel</span></span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="ocaml_directories.ml.html#L29" title="ocaml/ocamltest/ocaml_directories.ml:29">toplevel</a></span> : <span class="PreProc">Ocaml_toplevels</span>.<span class="ocamlLCIdentifier"><a href="ocaml_directories.ml.html#L29" title="ocaml/ocamltest/ocaml_directories.ml:29">toplevel</a></span><span class="Statement">)</span> <span class="ocamlLCIdentifier"><a href="main.ml.html#L166" title="ocaml/ocamltest/main.ml:166">log</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="ocaml_tools.ml.html#L66" title="ocaml/ocamltest/ocaml_tools.ml:66">backend</a></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="ocaml_directories.ml.html#L29" title="ocaml/ocamltest/ocaml_directories.ml:29">toplevel</a></span><span class="PreProc">#</span><span class="ocamlLCIdentifier"><a href="ocaml_tools.ml.html#L66" title="ocaml/ocamltest/ocaml_tools.ml:66">backend</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L65" title="ocaml/ocamltest/ocaml_variables.mli:65">libraries</a></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L65" title="ocaml/ocamltest/ocaml_variables.mli:65">libraries</a></span> <span class="ocamlLCIdentifier"><a href="ocaml_tools.ml.html#L66" title="ocaml/ocamltest/ocaml_tools.ml:66">backend</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Comment">(* This is a sub-optimal check - <a href="builtin_actions.mli.html#L19" title="ocaml/ocamltest/builtin_actions.mli:19">skip</a> the test if any <a href="ocaml_variables.mli.html#L65" title="ocaml/ocamltest/ocaml_variables.mli:65">libraries</a> requiring<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; C stubs are loaded. It would be better at this point to build a custom<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; <a href="ocaml_directories.ml.html#L29" title="ocaml/ocamltest/ocaml_directories.ml:29">toplevel</a>. *)<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">toplevel_supports_dynamic_loading</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Config</span>.<span class="ocamlLCIdentifier">supports_shared_libraries</span> <span class="Statement">||</span> <span class="ocamlLCIdentifier"><a href="ocaml_tools.ml.html#L66" title="ocaml/ocamltest/ocaml_tools.ml:66">backend</a></span> <span class="Statement">&lt;&gt;</span> <span class="PreProc">Ocaml_backends</span>.<span class="Constant">Bytecode<br/></li>
<li></span>&nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">match</span> <span class="ocamlLCIdentifier"><a href="#L188" title="ocaml/ocamltest/ocaml_actions.ml:188">cmas_need_dynamic_loading</a></span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L59" title="ocaml/ocamltest/ocaml_variables.mli:59">directories</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="Statement">)</span> <span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L65" title="ocaml/ocamltest/ocaml_variables.mli:65">libraries</a></span> <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Some</span> <span class="Statement">(</span><span class="Constant">Error</span> <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L47" title="ocaml/ocamltest/builtin_variables.mli:47">reason</a></span><span class="Statement">)</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="PreProc">Result</span>.<span class="ocamlLCIdentifier"><a href="result.ml.html#L39" title="ocaml/ocamltest/result.ml:39">fail_with_reason</a></span> <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L47" title="ocaml/ocamltest/builtin_variables.mli:47">reason</a></span>, <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Some</span> <span class="Statement">(</span><span class="Constant">Ok</span> <span class="Constant">()</span><span class="Statement">)</span> <span class="Statement">when</span> <span class="Statement">not</span> <span class="ocamlLCIdentifier">toplevel_supports_dynamic_loading</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="PreProc">Result</span>.<span class="ocamlLCIdentifier"><a href="builtin_actions.mli.html#L19" title="ocaml/ocamltest/builtin_actions.mli:19">skip</a></span>, <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Statement">_</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="actions_helpers.ml.html#L39" title="ocaml/ocamltest/actions_helpers.ml:39">testfile</a></span> <span class="Statement">=</span> <span class="PreProc">Actions_helpers</span>.<span class="ocamlLCIdentifier"><a href="actions_helpers.ml.html#L39" title="ocaml/ocamltest/actions_helpers.ml:39">testfile</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="ocaml_tools.ml.html#L50" title="ocaml/ocamltest/ocaml_tools.ml:50">expected_exit_status</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="PreProc">Ocaml_tools</span>.<span class="ocamlLCIdentifier"><a href="ocaml_tools.ml.html#L50" title="ocaml/ocamltest/ocaml_tools.ml:50">expected_exit_status</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="ocaml_directories.ml.html#L29" title="ocaml/ocamltest/ocaml_directories.ml:29">toplevel</a></span> :<span class="Statement">&gt;</span> <span class="PreProc">Ocaml_tools</span>.<span class="ocamlLCIdentifier"><a href="filecompare.ml.html#L27" title="ocaml/ocamltest/filecompare.ml:27">tool</a></span><span class="Statement">)</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">compiler_output_variable</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="ocaml_directories.ml.html#L29" title="ocaml/ocamltest/ocaml_directories.ml:29">toplevel</a></span><span class="PreProc">#</span><span class="ocamlLCIdentifier">output_variable</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">compiler</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="ocaml_directories.ml.html#L29" title="ocaml/ocamltest/ocaml_directories.ml:29">toplevel</a></span><span class="PreProc">#</span><span class="ocamlLCIdentifier">compiler</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">compiler_name</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">compiler</span><span class="PreProc">#</span><span class="ocamlLCIdentifier"><a href="actions.mli.html#L22" title="ocaml/ocamltest/actions.mli:22">name</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">modules_with_filetypes</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="PreProc">List</span>.<span class="ocamlLCIdentifier">map</span> <span class="PreProc">Ocaml_filetypes</span>.<span class="ocamlLCIdentifier"><a href="filecompare.ml.html#L54" title="ocaml/ocamltest/filecompare.ml:54">filetype</a></span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L75" title="ocaml/ocamltest/ocaml_variables.mli:75">modules</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="Statement">)</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="filecompare.ml.html#L20" title="ocaml/ocamltest/filecompare.ml:20">result</a></span>, <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="Statement">)</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="#L989" title="ocaml/ocamltest/ocaml_actions.ml:989">compile_modules</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">compiler</span> <span class="ocamlLCIdentifier">compiler_name</span> <span class="ocamlLCIdentifier">compiler_output_variable<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">modules_with_filetypes</span> <span class="ocamlLCIdentifier"><a href="main.ml.html#L166" title="ocaml/ocamltest/main.ml:166">log</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="PreProc">Result</span><span class="ocamlNone">.</span><span class="ocamlLCIdentifier"><a href="result.ml.html#L53" title="ocaml/ocamltest/result.ml:53">is_pass</a></span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier"><a href="filecompare.ml.html#L20" title="ocaml/ocamltest/filecompare.ml:20">result</a></span><span class="ocamlNone"> </span><span class="Statement">then</span> <span class="Statement">begin<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L227" title="ocaml/ocamltest/ocaml_actions.ml:227">what</a></span><span class="ocamlEnd"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="PreProc">Printf</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">sprintf</span><span class="ocamlEnd"> </span><span class="Constant">&quot;Running %s in %s <a href="ocaml_directories.ml.html#L29" title="ocaml/ocamltest/ocaml_directories.ml:29">toplevel</a> \<br/></li>
<li></span><span class="Constant">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (expected exit <a href="result.ml.html#L18" title="ocaml/ocamltest/result.ml:18">status</a>: %d)&quot;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="actions_helpers.ml.html#L39" title="ocaml/ocamltest/actions_helpers.ml:39">testfile</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">(</span><span class="PreProc">Ocaml_backends</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier"><a href="ocaml_backends.ml.html#L24" title="ocaml/ocamltest/ocaml_backends.ml:24">string_of_backend</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="ocaml_tools.ml.html#L66" title="ocaml/ocamltest/ocaml_tools.ml:66">backend</a></span><span class="Statement">)<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="ocaml_tools.ml.html#L50" title="ocaml/ocamltest/ocaml_tools.ml:50">expected_exit_status</a></span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="PreProc">Printf</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">fprintf</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="main.ml.html#L166" title="ocaml/ocamltest/main.ml:166">log</a></span><span class="ocamlEnd"> </span><span class="Constant">&quot;%s\<a href="actions_helpers.ml.html#L174" title="ocaml/ocamltest/actions_helpers.ml:174">n</a>%!&quot;</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L227" title="ocaml/ocamltest/ocaml_actions.ml:227">what</a></span><span class="Statement">;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">toplevel_name</span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="ocaml_directories.ml.html#L29" title="ocaml/ocamltest/ocaml_directories.ml:29">toplevel</a></span><span class="PreProc">#</span><span class="ocamlLCIdentifier"><a href="actions.mli.html#L22" title="ocaml/ocamltest/actions.mli:22">name</a></span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L128" title="ocaml/ocamltest/ocaml_variables.mli:128">ocaml_script_as_argument</a></span><span class="ocamlEnd"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">match<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="PreProc">Environments</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier"><a href="environments.ml.html#L93" title="ocaml/ocamltest/environments.ml:93">lookup_as_bool</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="PreProc">Ocaml_variables</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L128" title="ocaml/ocamltest/ocaml_variables.mli:128">ocaml_script_as_argument</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">with<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Constant">None</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;</span><span class="ocamlEnd"> </span><span class="Constant">false<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Constant">Some</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="environments.ml.html#L37" title="ocaml/ocamltest/environments.ml:37">b</a></span><span class="ocamlEnd"> </span><span class="Statement">-&gt;</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="environments.ml.html#L37" title="ocaml/ocamltest/environments.ml:37">b</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L24" title="ocaml/ocamltest/builtin_variables.mli:24">commandline</a></span><span class="ocamlEnd"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">[<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier">toplevel_name</span><span class="Statement">;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="PreProc">Ocaml_flags</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier"><a href="ocaml_flags.mli.html#L27" title="ocaml/ocamltest/ocaml_flags.mli:27">toplevel_default_flags</a></span><span class="Statement">;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="ocaml_directories.ml.html#L29" title="ocaml/ocamltest/ocaml_directories.ml:29">toplevel</a></span><span class="PreProc">#</span><span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L61" title="ocaml/ocamltest/ocaml_variables.mli:61">flags</a></span><span class="Statement">;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="PreProc">Ocaml_flags</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier"><a href="ocaml_directories.ml.html#L23" title="ocaml/ocamltest/ocaml_directories.ml:23">stdlib</a></span><span class="Statement">;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="#L44" title="ocaml/ocamltest/ocaml_actions.ml:44">directory_flags</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="Statement">;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="PreProc">Ocaml_flags</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier"><a href="ocaml_flags.mli.html#L20" title="ocaml/ocamltest/ocaml_flags.mli:20">include_toplevel_directory</a></span><span class="Statement">;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L61" title="ocaml/ocamltest/ocaml_variables.mli:61">flags</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="Statement">;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L65" title="ocaml/ocamltest/ocaml_variables.mli:65">libraries</a></span><span class="Statement">;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L24" title="ocaml/ocamltest/ocaml_variables.mli:24">binary_modules</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="ocaml_tools.ml.html#L66" title="ocaml/ocamltest/ocaml_tools.ml:66">backend</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="Statement">;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L128" title="ocaml/ocamltest/ocaml_variables.mli:128">ocaml_script_as_argument</a></span><span class="ocamlNone"> </span><span class="Statement">then</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="actions_helpers.ml.html#L39" title="ocaml/ocamltest/actions_helpers.ml:39">testfile</a></span><span class="ocamlEnd"> </span><span class="Statement">else</span><span class="ocamlEnd"> </span><span class="Constant">&quot;&quot;</span><span class="Statement">;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="PreProc">Environments</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier"><a href="environments.mli.html#L29" title="ocaml/ocamltest/environments.mli:29">safe_lookup</a></span><span class="ocamlEnd"> </span><span class="PreProc">Builtin_variables</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L20" title="ocaml/ocamltest/builtin_variables.mli:20">arguments</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">]</span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L28" title="ocaml/ocamltest/builtin_variables.mli:28">exit_status</a></span><span class="ocamlEnd"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L128" title="ocaml/ocamltest/ocaml_variables.mli:128">ocaml_script_as_argument</a><br/></li>
<li></span><span class="ocamlNone">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">then</span><span class="ocamlEnd"> </span><span class="PreProc">Actions_helpers</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier"><a href="actions_helpers.ml.html#L117" title="ocaml/ocamltest/actions_helpers.ml:117">run_cmd</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">~</span><span class="Identifier"><a href="environments.ml.html#L199" title="ocaml/ocamltest/environments.ml:199">environment</a></span><span class="ocamlEnd">:</span><span class="ocamlLCIdentifier"><a href="#L88" title="ocaml/ocamltest/ocaml_actions.ml:88">default_ocaml_env</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">~</span><span class="Identifier">stdout_variable</span><span class="ocamlEnd">:</span><span class="ocamlLCIdentifier">compiler_output_variable<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">~</span><span class="Identifier">stderr_variable</span><span class="ocamlEnd">:</span><span class="ocamlLCIdentifier">compiler_output_variable<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="main.ml.html#L166" title="ocaml/ocamltest/main.ml:166">log</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L24" title="ocaml/ocamltest/builtin_variables.mli:24">commandline</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">else</span><span class="ocamlEnd"> </span><span class="PreProc">Actions_helpers</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier"><a href="actions_helpers.ml.html#L117" title="ocaml/ocamltest/actions_helpers.ml:117">run_cmd</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">~</span><span class="Identifier"><a href="environments.ml.html#L199" title="ocaml/ocamltest/environments.ml:199">environment</a></span><span class="ocamlEnd">:</span><span class="ocamlLCIdentifier"><a href="#L88" title="ocaml/ocamltest/ocaml_actions.ml:88">default_ocaml_env</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">~</span><span class="Identifier">stdin_variable</span><span class="ocamlEnd">:</span><span class="PreProc">Builtin_variables</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L67" title="ocaml/ocamltest/builtin_variables.mli:67">test_file</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">~</span><span class="Identifier">stdout_variable</span><span class="ocamlEnd">:</span><span class="ocamlLCIdentifier">compiler_output_variable<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">~</span><span class="Identifier">stderr_variable</span><span class="ocamlEnd">:</span><span class="ocamlLCIdentifier">compiler_output_variable<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="main.ml.html#L166" title="ocaml/ocamltest/main.ml:166">log</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L24" title="ocaml/ocamltest/builtin_variables.mli:24">commandline</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L28" title="ocaml/ocamltest/builtin_variables.mli:28">exit_status</a></span><span class="Statement">=</span><span class="ocamlLCIdentifier"><a href="ocaml_tools.ml.html#L50" title="ocaml/ocamltest/ocaml_tools.ml:50">expected_exit_status</a><br/></li>
<li></span><span class="ocamlNone">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">then</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="PreProc">Result</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier"><a href="builtin_actions.mli.html#L18" title="ocaml/ocamltest/builtin_actions.mli:18">pass</a></span><span class="ocamlEnd">, </span><span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="Statement">)<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">else</span><span class="ocamlEnd"> </span><span class="Statement">begin<br/></li>
<li><a id="L1077">&#x200c;</a></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><span class="linkable">reason</span></span><span class="ocamlEnd"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">(</span><span class="PreProc">Actions_helpers</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier"><a href="actions_helpers.ml.html#L35" title="ocaml/ocamltest/actions_helpers.ml:35">mkreason</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="#L227" title="ocaml/ocamltest/ocaml_actions.ml:227">what</a></span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="PreProc">String</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">concat</span><span class="ocamlEnd"> </span><span class="Constant">&quot; &quot;</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L24" title="ocaml/ocamltest/builtin_variables.mli:24">commandline</a></span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L28" title="ocaml/ocamltest/builtin_variables.mli:28">exit_status</a></span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">(</span><span class="PreProc">Result</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier"><a href="result.ml.html#L39" title="ocaml/ocamltest/result.ml:39">fail_with_reason</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L47" title="ocaml/ocamltest/builtin_variables.mli:47">reason</a></span><span class="ocamlEnd">, </span><span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="Statement">)<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">end<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">end</span> <span class="Statement">else</span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="filecompare.ml.html#L20" title="ocaml/ocamltest/filecompare.ml:20">result</a></span>, <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li><a id="L1084">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">ocaml</span></span> <span class="Statement">=</span> <span class="PreProc">Actions</span>.<span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L34" title="ocaml/ocamltest/builtin_variables.mli:34">make</a><br/></li>
<li></span>&nbsp; <span class="Statement">~</span><span class="Identifier"><a href="actions.mli.html#L22" title="ocaml/ocamltest/actions.mli:22">name</a></span>:<span class="Constant">&quot;<a href="ocaml_files.ml.html#L42" title="ocaml/ocamltest/ocaml_files.ml:42">ocaml</a>&quot;<br/></li>
<li></span>&nbsp; <span class="Statement">~</span><span class="Identifier"><a href="actions.mli.html#L24" title="ocaml/ocamltest/actions.mli:24">description</a></span>:<span class="Constant">&quot;Run the test <a href="builtin_variables.mli.html#L42" title="ocaml/ocamltest/builtin_variables.mli:42">program</a> in the <a href="ocaml_directories.ml.html#L29" title="ocaml/ocamltest/ocaml_directories.ml:29">toplevel</a>&quot;<br/></li>
<li></span>&nbsp; <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L1003" title="ocaml/ocamltest/ocaml_actions.ml:1003">run_test_program_in_toplevel</a></span> <span class="PreProc">Ocaml_toplevels</span>.<span class="ocamlLCIdentifier"><a href="ocaml_files.ml.html#L42" title="ocaml/ocamltest/ocaml_files.ml:42">ocaml</a></span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li><a id="L1089">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">ocamlnat</span></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier"><a href="#L26" title="ocaml/ocamltest/ocaml_actions.ml:26">native_action</a><br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">(</span><span class="PreProc">Actions</span>.<span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L34" title="ocaml/ocamltest/builtin_variables.mli:34">make</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier"><a href="actions.mli.html#L22" title="ocaml/ocamltest/actions.mli:22">name</a></span>:<span class="Constant">&quot;<a href="ocaml_files.ml.html#L54" title="ocaml/ocamltest/ocaml_files.ml:54">ocamlnat</a>&quot;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier"><a href="actions.mli.html#L24" title="ocaml/ocamltest/actions.mli:24">description</a></span>:<span class="Constant">&quot;Run the test <a href="builtin_variables.mli.html#L42" title="ocaml/ocamltest/builtin_variables.mli:42">program</a> in the <a href="ocaml_tests.mli.html#L20" title="ocaml/ocamltest/ocaml_tests.mli:20">native</a> <a href="ocaml_directories.ml.html#L29" title="ocaml/ocamltest/ocaml_directories.ml:29">toplevel</a> <a href="ocaml_files.ml.html#L54" title="ocaml/ocamltest/ocaml_files.ml:54">ocamlnat</a>&quot;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L1003" title="ocaml/ocamltest/ocaml_actions.ml:1003">run_test_program_in_toplevel</a></span> <span class="PreProc">Ocaml_toplevels</span>.<span class="ocamlLCIdentifier"><a href="ocaml_files.ml.html#L54" title="ocaml/ocamltest/ocaml_files.ml:54">ocamlnat</a></span><span class="Statement">))<br/></li>
<li></span><br/></li>
<li><a id="L1096">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">check_ocaml_output</span></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="#L837" title="ocaml/ocamltest/ocaml_actions.ml:837">make_check_tool_output</a><br/></li>
<li></span>&nbsp; <span class="Constant">&quot;check-<a href="ocaml_files.ml.html#L42" title="ocaml/ocamltest/ocaml_files.ml:42">ocaml</a>-<a href="builtin_variables.mli.html#L40" title="ocaml/ocamltest/builtin_variables.mli:40">output</a>&quot;</span> <span class="PreProc">Ocaml_toplevels</span>.<span class="ocamlLCIdentifier"><a href="ocaml_files.ml.html#L42" title="ocaml/ocamltest/ocaml_files.ml:42">ocaml</a><br/></li>
<li></span><br/></li>
<li><a id="L1099">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">check_ocamlnat_output</span></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier"><a href="#L26" title="ocaml/ocamltest/ocaml_actions.ml:26">native_action</a><br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L837" title="ocaml/ocamltest/ocaml_actions.ml:837">make_check_tool_output</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Constant">&quot;check-<a href="ocaml_files.ml.html#L54" title="ocaml/ocamltest/ocaml_files.ml:54">ocamlnat</a>-<a href="builtin_variables.mli.html#L40" title="ocaml/ocamltest/builtin_variables.mli:40">output</a>&quot;</span> <span class="PreProc">Ocaml_toplevels</span>.<span class="ocamlLCIdentifier"><a href="ocaml_files.ml.html#L54" title="ocaml/ocamltest/ocaml_files.ml:54">ocamlnat</a></span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li><a id="L1104">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">config_variables</span></span> <span class="ocamlLCIdentifier">_log</span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="PreProc">Environments</span>.<span class="ocamlLCIdentifier"><a href="environments.ml.html#L127" title="ocaml/ocamltest/environments.ml:127">add_bindings</a><br/></li>
<li></span>&nbsp; <span class="Statement">[<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Ocaml_variables</span>.<span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L22" title="ocaml/ocamltest/ocaml_variables.mli:22">arch</a></span>, <span class="PreProc">Ocamltest_config</span>.<span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L22" title="ocaml/ocamltest/ocaml_variables.mli:22">arch</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Ocaml_variables</span>.<span class="ocamlLCIdentifier"><a href="ocaml_commands.ml.html#L18" title="ocaml/ocamltest/ocaml_commands.ml:18">ocamlrun</a></span>, <span class="PreProc">Ocaml_files</span>.<span class="ocamlLCIdentifier"><a href="ocaml_commands.ml.html#L18" title="ocaml/ocamltest/ocaml_commands.ml:18">ocamlrun</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Ocaml_variables</span>.<span class="ocamlLCIdentifier"><a href="ocaml_actions.mli.html#L19" title="ocaml/ocamltest/ocaml_actions.mli:19">ocamlc_byte</a></span>, <span class="PreProc">Ocaml_files</span>.<span class="ocamlLCIdentifier"><a href="ocaml_files.ml.html#L39" title="ocaml/ocamltest/ocaml_files.ml:39">ocamlc</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Ocaml_variables</span>.<span class="ocamlLCIdentifier"><a href="ocaml_actions.mli.html#L25" title="ocaml/ocamltest/ocaml_actions.mli:25">ocamlopt_byte</a></span>, <span class="PreProc">Ocaml_files</span>.<span class="ocamlLCIdentifier"><a href="ocaml_files.ml.html#L48" title="ocaml/ocamltest/ocaml_files.ml:48">ocamlopt</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Ocaml_variables</span>.<span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L26" title="ocaml/ocamltest/ocaml_variables.mli:26">bytecc_libs</a></span>, <span class="PreProc">Ocamltest_config</span>.<span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L26" title="ocaml/ocamltest/ocaml_variables.mli:26">bytecc_libs</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Ocaml_variables</span>.<span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L77" title="ocaml/ocamltest/ocaml_variables.mli:77">nativecc_libs</a></span>, <span class="PreProc">Ocamltest_config</span>.<span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L77" title="ocaml/ocamltest/ocaml_variables.mli:77">nativecc_libs</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Ocaml_variables</span>.<span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L67" title="ocaml/ocamltest/ocaml_variables.mli:67">mkdll</a></span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="PreProc">Sys</span>.<span class="ocamlLCIdentifier">getenv_with_default_value</span> <span class="Constant">&quot;MKDLL&quot;</span> <span class="PreProc">Ocamltest_config</span>.<span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L67" title="ocaml/ocamltest/ocaml_variables.mli:67">mkdll</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Ocaml_variables</span>.<span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L70" title="ocaml/ocamltest/ocaml_variables.mli:70">mkexe</a></span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="PreProc">Sys</span>.<span class="ocamlLCIdentifier">getenv_with_default_value</span> <span class="Constant">&quot;MKEXE&quot;</span> <span class="PreProc">Ocamltest_config</span>.<span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L70" title="ocaml/ocamltest/ocaml_variables.mli:70">mkexe</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Ocaml_variables</span>.<span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L29" title="ocaml/ocamltest/ocaml_variables.mli:29">c_preprocessor</a></span>, <span class="PreProc">Ocamltest_config</span>.<span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L29" title="ocaml/ocamltest/ocaml_variables.mli:29">c_preprocessor</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Ocaml_variables</span>.<span class="ocamlLCIdentifier"><a href="ocaml_actions.mli.html#L57" title="ocaml/ocamltest/ocaml_actions.mli:57">cc</a></span>, <span class="PreProc">Ocamltest_config</span>.<span class="ocamlLCIdentifier"><a href="ocaml_actions.mli.html#L57" title="ocaml/ocamltest/ocaml_actions.mli:57">cc</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Ocaml_variables</span>.<span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L55" title="ocaml/ocamltest/ocaml_variables.mli:55">csc</a></span>, <span class="PreProc">Ocamltest_config</span>.<span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L55" title="ocaml/ocamltest/ocaml_variables.mli:55">csc</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Ocaml_variables</span>.<span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L57" title="ocaml/ocamltest/ocaml_variables.mli:57">csc_flags</a></span>, <span class="PreProc">Ocamltest_config</span>.<span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L57" title="ocaml/ocamltest/ocaml_variables.mli:57">csc_flags</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Ocaml_variables</span>.<span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L132" title="ocaml/ocamltest/ocaml_variables.mli:132">shared_library_cflags</a></span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="PreProc">Ocamltest_config</span>.<span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L132" title="ocaml/ocamltest/ocaml_variables.mli:132">shared_library_cflags</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Ocaml_variables</span>.<span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L80" title="ocaml/ocamltest/ocaml_variables.mli:80">objext</a></span>, <span class="PreProc">Ocamltest_config</span>.<span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L80" title="ocaml/ocamltest/ocaml_variables.mli:80">objext</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Ocaml_variables</span>.<span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L81" title="ocaml/ocamltest/ocaml_variables.mli:81">libext</a></span>, <span class="PreProc">Ocamltest_config</span>.<span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L81" title="ocaml/ocamltest/ocaml_variables.mli:81">libext</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Ocaml_variables</span>.<span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L82" title="ocaml/ocamltest/ocaml_variables.mli:82">asmext</a></span>, <span class="PreProc">Ocamltest_config</span>.<span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L82" title="ocaml/ocamltest/ocaml_variables.mli:82">asmext</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Ocaml_variables</span>.<span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L134" title="ocaml/ocamltest/ocaml_variables.mli:134">sharedobjext</a></span>, <span class="PreProc">Ocamltest_config</span>.<span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L134" title="ocaml/ocamltest/ocaml_variables.mli:134">sharedobjext</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Ocaml_variables</span>.<span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L89" title="ocaml/ocamltest/ocaml_variables.mli:89">ocamlc_default_flags</a></span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="PreProc">Ocamltest_config</span>.<span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L89" title="ocaml/ocamltest/ocaml_variables.mli:89">ocamlc_default_flags</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Ocaml_variables</span>.<span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L94" title="ocaml/ocamltest/ocaml_variables.mli:94">ocamlopt_default_flags</a></span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="PreProc">Ocamltest_config</span>.<span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L94" title="ocaml/ocamltest/ocaml_variables.mli:94">ocamlopt_default_flags</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Ocaml_variables</span>.<span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L112" title="ocaml/ocamltest/ocaml_variables.mli:112">ocamlrunparam</a></span>, <span class="PreProc">Sys</span>.<span class="ocamlLCIdentifier"><a href="ocamltest_stdlib.ml.html#L223" title="ocaml/ocamltest/ocamltest_stdlib.ml:223">safe_getenv</a></span> <span class="Constant">&quot;OCAMLRUNPARAM&quot;</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Ocaml_variables</span>.<span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L114" title="ocaml/ocamltest/ocaml_variables.mli:114">ocamlsrcdir</a></span>, <span class="PreProc">Ocaml_directories</span>.<span class="ocamlLCIdentifier"><a href="ocaml_directories.ml.html#L20" title="ocaml/ocamltest/ocaml_directories.ml:20">srcdir</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Ocaml_variables</span>.<span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L120" title="ocaml/ocamltest/ocaml_variables.mli:120">os_type</a></span>, <span class="PreProc">Sys</span>.<span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L120" title="ocaml/ocamltest/ocaml_variables.mli:120">os_type</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; <span class="Statement">]</span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a><br/></li>
<li></span><br/></li>
<li><a id="L1136">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">flat_float_array</span></span> <span class="Statement">=</span> <span class="PreProc">Actions</span>.<span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L34" title="ocaml/ocamltest/builtin_variables.mli:34">make</a><br/></li>
<li></span>&nbsp; <span class="Statement">~</span><span class="Identifier"><a href="actions.mli.html#L22" title="ocaml/ocamltest/actions.mli:22">name</a></span>:<span class="Constant">&quot;flat-float-array&quot;<br/></li>
<li></span>&nbsp; <span class="Statement">~</span><span class="Identifier"><a href="actions.mli.html#L24" title="ocaml/ocamltest/actions.mli:24">description</a></span>:<span class="Constant">&quot;Passes if the compiler is configured with \<br/></li>
<li></span><span class="Constant">&nbsp; &nbsp; --enable-flat-float-array&quot;<br/></li>
<li></span>&nbsp; <span class="Statement">(</span><span class="PreProc">Actions_helpers</span>.<span class="ocamlLCIdentifier"><a href="actions_helpers.ml.html#L27" title="ocaml/ocamltest/actions_helpers.ml:27">pass_or_skip</a></span> <span class="PreProc">Ocamltest_config</span>.<span class="ocamlLCIdentifier"><a href="ocaml_actions.mli.html#L44" title="ocaml/ocamltest/ocaml_actions.mli:44">flat_float_array</a><br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">&quot;compiler configured with --enable-flat-float-array&quot;<br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">&quot;compiler configured with --disable-flat-float-array&quot;</span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li><a id="L1144">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">no_flat_float_array</span></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L34" title="ocaml/ocamltest/builtin_variables.mli:34">make</a><br/></li>
<li></span>&nbsp; <span class="Statement">~</span><span class="Identifier"><a href="actions.mli.html#L22" title="ocaml/ocamltest/actions.mli:22">name</a></span>:<span class="Constant">&quot;no-flat-float-array&quot;<br/></li>
<li></span>&nbsp; <span class="Statement">~</span><span class="Identifier"><a href="actions.mli.html#L24" title="ocaml/ocamltest/actions.mli:24">description</a></span>:<span class="Constant">&quot;Passes if the compiler is configured with \<br/></li>
<li></span><span class="Constant">&nbsp; &nbsp; --disable-flat-float-array&quot;<br/></li>
<li></span>&nbsp; <span class="Statement">(</span><span class="PreProc">Actions_helpers</span>.<span class="ocamlLCIdentifier"><a href="actions_helpers.ml.html#L27" title="ocaml/ocamltest/actions_helpers.ml:27">pass_or_skip</a></span> <span class="Statement">(not</span> <span class="PreProc">Ocamltest_config</span>.<span class="ocamlLCIdentifier"><a href="ocaml_actions.mli.html#L44" title="ocaml/ocamltest/ocaml_actions.mli:44">flat_float_array</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">&quot;compiler configured with --disable-flat-float-array&quot;<br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">&quot;compiler configured with --enable-flat-float&quot;</span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li><a id="L1152">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">flambda</span></span> <span class="Statement">=</span> <span class="PreProc">Actions</span>.<span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L34" title="ocaml/ocamltest/builtin_variables.mli:34">make</a><br/></li>
<li></span>&nbsp; <span class="Statement">~</span><span class="Identifier"><a href="actions.mli.html#L22" title="ocaml/ocamltest/actions.mli:22">name</a></span>:<span class="Constant">&quot;<a href="ocamltest_config.mli.html#L79" title="ocaml/ocamltest/ocamltest_config.mli:79">flambda</a>&quot;<br/></li>
<li></span>&nbsp; <span class="Statement">~</span><span class="Identifier"><a href="actions.mli.html#L24" title="ocaml/ocamltest/actions.mli:24">description</a></span>:<span class="Constant">&quot;Passes if the compiler is configured with <a href="ocamltest_config.mli.html#L79" title="ocaml/ocamltest/ocamltest_config.mli:79">flambda</a> enabled&quot;<br/></li>
<li></span>&nbsp; <span class="Statement">(</span><span class="PreProc">Actions_helpers</span>.<span class="ocamlLCIdentifier"><a href="actions_helpers.ml.html#L27" title="ocaml/ocamltest/actions_helpers.ml:27">pass_or_skip</a></span> <span class="PreProc">Ocamltest_config</span>.<span class="ocamlLCIdentifier"><a href="ocamltest_config.mli.html#L79" title="ocaml/ocamltest/ocamltest_config.mli:79">flambda</a><br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">&quot;support for <a href="ocamltest_config.mli.html#L79" title="ocaml/ocamltest/ocamltest_config.mli:79">flambda</a> enabled&quot;<br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">&quot;support for <a href="ocamltest_config.mli.html#L79" title="ocaml/ocamltest/ocamltest_config.mli:79">flambda</a> disabled&quot;</span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li><a id="L1159">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">no_flambda</span></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L34" title="ocaml/ocamltest/builtin_variables.mli:34">make</a><br/></li>
<li></span>&nbsp; <span class="Statement">~</span><span class="Identifier"><a href="actions.mli.html#L22" title="ocaml/ocamltest/actions.mli:22">name</a></span>:<span class="Constant">&quot;no-<a href="ocamltest_config.mli.html#L79" title="ocaml/ocamltest/ocamltest_config.mli:79">flambda</a>&quot;<br/></li>
<li></span>&nbsp; <span class="Statement">~</span><span class="Identifier"><a href="actions.mli.html#L24" title="ocaml/ocamltest/actions.mli:24">description</a></span>:<span class="Constant">&quot;Passes if the compiler is NOT configured with <a href="ocamltest_config.mli.html#L79" title="ocaml/ocamltest/ocamltest_config.mli:79">flambda</a> enabled&quot;<br/></li>
<li></span>&nbsp; <span class="Statement">(</span><span class="PreProc">Actions_helpers</span>.<span class="ocamlLCIdentifier"><a href="actions_helpers.ml.html#L27" title="ocaml/ocamltest/actions_helpers.ml:27">pass_or_skip</a></span> <span class="Statement">(not</span> <span class="PreProc">Ocamltest_config</span>.<span class="ocamlLCIdentifier"><a href="ocamltest_config.mli.html#L79" title="ocaml/ocamltest/ocamltest_config.mli:79">flambda</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">&quot;support for <a href="ocamltest_config.mli.html#L79" title="ocaml/ocamltest/ocamltest_config.mli:79">flambda</a> disabled&quot;<br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">&quot;support for <a href="ocamltest_config.mli.html#L79" title="ocaml/ocamltest/ocamltest_config.mli:79">flambda</a> enabled&quot;</span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li><a id="L1166">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">shared_libraries</span></span> <span class="Statement">=</span> <span class="PreProc">Actions</span>.<span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L34" title="ocaml/ocamltest/builtin_variables.mli:34">make</a><br/></li>
<li></span>&nbsp; <span class="Statement">~</span><span class="Identifier"><a href="actions.mli.html#L22" title="ocaml/ocamltest/actions.mli:22">name</a></span>:<span class="Constant">&quot;shared-<a href="ocaml_variables.mli.html#L65" title="ocaml/ocamltest/ocaml_variables.mli:65">libraries</a>&quot;<br/></li>
<li></span>&nbsp; <span class="Statement">~</span><span class="Identifier"><a href="actions.mli.html#L24" title="ocaml/ocamltest/actions.mli:24">description</a></span>:<span class="Constant">&quot;Passes if shared <a href="ocaml_variables.mli.html#L65" title="ocaml/ocamltest/ocaml_variables.mli:65">libraries</a> are supported&quot;<br/></li>
<li></span>&nbsp; <span class="Statement">(</span><span class="PreProc">Actions_helpers</span>.<span class="ocamlLCIdentifier"><a href="actions_helpers.ml.html#L27" title="ocaml/ocamltest/actions_helpers.ml:27">pass_or_skip</a></span> <span class="PreProc">Ocamltest_config</span>.<span class="ocamlLCIdentifier"><a href="ocaml_actions.mli.html#L47" title="ocaml/ocamltest/ocaml_actions.mli:47">shared_libraries</a><br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">&quot;Shared <a href="ocaml_variables.mli.html#L65" title="ocaml/ocamltest/ocaml_variables.mli:65">libraries</a> are supported.&quot;<br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">&quot;Shared <a href="ocaml_variables.mli.html#L65" title="ocaml/ocamltest/ocaml_variables.mli:65">libraries</a> are not supported.&quot;</span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li><a id="L1173">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">no_shared_libraries</span></span> <span class="Statement">=</span> <span class="PreProc">Actions</span>.<span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L34" title="ocaml/ocamltest/builtin_variables.mli:34">make</a><br/></li>
<li></span>&nbsp; <span class="Statement">~</span><span class="Identifier"><a href="actions.mli.html#L22" title="ocaml/ocamltest/actions.mli:22">name</a></span>:<span class="Constant">&quot;no-shared-<a href="ocaml_variables.mli.html#L65" title="ocaml/ocamltest/ocaml_variables.mli:65">libraries</a>&quot;<br/></li>
<li></span>&nbsp; <span class="Statement">~</span><span class="Identifier"><a href="actions.mli.html#L24" title="ocaml/ocamltest/actions.mli:24">description</a></span>:<span class="Constant">&quot;Passes if shared <a href="ocaml_variables.mli.html#L65" title="ocaml/ocamltest/ocaml_variables.mli:65">libraries</a> are NOT supported&quot;<br/></li>
<li></span>&nbsp; <span class="Statement">(</span><span class="PreProc">Actions_helpers</span>.<span class="ocamlLCIdentifier"><a href="actions_helpers.ml.html#L27" title="ocaml/ocamltest/actions_helpers.ml:27">pass_or_skip</a></span> <span class="Statement">(not</span> <span class="PreProc">Ocamltest_config</span>.<span class="ocamlLCIdentifier"><a href="ocaml_actions.mli.html#L47" title="ocaml/ocamltest/ocaml_actions.mli:47">shared_libraries</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">&quot;Shared <a href="ocaml_variables.mli.html#L65" title="ocaml/ocamltest/ocaml_variables.mli:65">libraries</a> are not supported.&quot;<br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">&quot;Shared <a href="ocaml_variables.mli.html#L65" title="ocaml/ocamltest/ocaml_variables.mli:65">libraries</a> are supported.&quot;</span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li><a id="L1180">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">native_compiler</span></span> <span class="Statement">=</span> <span class="PreProc">Actions</span>.<span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L34" title="ocaml/ocamltest/builtin_variables.mli:34">make</a><br/></li>
<li></span>&nbsp; <span class="Statement">~</span><span class="Identifier"><a href="actions.mli.html#L22" title="ocaml/ocamltest/actions.mli:22">name</a></span>:<span class="Constant">&quot;<a href="ocaml_tests.mli.html#L20" title="ocaml/ocamltest/ocaml_tests.mli:20">native</a>-compiler&quot;<br/></li>
<li></span>&nbsp; <span class="Statement">~</span><span class="Identifier"><a href="actions.mli.html#L24" title="ocaml/ocamltest/actions.mli:24">description</a></span>:<span class="Constant">&quot;Passes if the <a href="ocaml_tests.mli.html#L20" title="ocaml/ocamltest/ocaml_tests.mli:20">native</a> compiler is available&quot;<br/></li>
<li></span>&nbsp; <span class="Statement">(</span><span class="PreProc">Actions_helpers</span>.<span class="ocamlLCIdentifier"><a href="actions_helpers.ml.html#L27" title="ocaml/ocamltest/actions_helpers.ml:27">pass_or_skip</a></span> <span class="PreProc">Ocamltest_config</span>.<span class="ocamlLCIdentifier"><a href="ocaml_actions.mli.html#L50" title="ocaml/ocamltest/ocaml_actions.mli:50">native_compiler</a><br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">&quot;<a href="ocaml_tests.mli.html#L20" title="ocaml/ocamltest/ocaml_tests.mli:20">native</a> compiler available&quot;<br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">&quot;<a href="ocaml_tests.mli.html#L20" title="ocaml/ocamltest/ocaml_tests.mli:20">native</a> compiler not available&quot;</span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li><a id="L1187">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">native_dynlink</span></span> <span class="Statement">=</span> <span class="PreProc">Actions</span>.<span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L34" title="ocaml/ocamltest/builtin_variables.mli:34">make</a><br/></li>
<li></span>&nbsp; <span class="Statement">~</span><span class="Identifier"><a href="actions.mli.html#L22" title="ocaml/ocamltest/actions.mli:22">name</a></span>:<span class="Constant">&quot;<a href="ocaml_tests.mli.html#L20" title="ocaml/ocamltest/ocaml_tests.mli:20">native</a>-<a href="ocaml_modifiers.ml.html#L87" title="ocaml/ocamltest/ocaml_modifiers.ml:87">dynlink</a>&quot;<br/></li>
<li></span>&nbsp; <span class="Statement">~</span><span class="Identifier"><a href="actions.mli.html#L24" title="ocaml/ocamltest/actions.mli:24">description</a></span>:<span class="Constant">&quot;Passes if <a href="ocaml_tests.mli.html#L20" title="ocaml/ocamltest/ocaml_tests.mli:20">native</a> <a href="ocaml_modifiers.ml.html#L87" title="ocaml/ocamltest/ocaml_modifiers.ml:87">dynlink</a> support is available&quot;<br/></li>
<li></span>&nbsp; <span class="Statement">(</span><span class="PreProc">Actions_helpers</span>.<span class="ocamlLCIdentifier"><a href="actions_helpers.ml.html#L27" title="ocaml/ocamltest/actions_helpers.ml:27">pass_or_skip</a></span> <span class="Statement">(</span><span class="PreProc">Ocamltest_config</span>.<span class="ocamlLCIdentifier"><a href="ocamltest_config.mli.html#L94" title="ocaml/ocamltest/ocamltest_config.mli:94">native_dynlink</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">&quot;<a href="ocaml_tests.mli.html#L20" title="ocaml/ocamltest/ocaml_tests.mli:20">native</a> <a href="ocaml_modifiers.ml.html#L87" title="ocaml/ocamltest/ocaml_modifiers.ml:87">dynlink</a> support available&quot;<br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">&quot;<a href="ocaml_tests.mli.html#L20" title="ocaml/ocamltest/ocaml_tests.mli:20">native</a> <a href="ocaml_modifiers.ml.html#L87" title="ocaml/ocamltest/ocaml_modifiers.ml:87">dynlink</a> support not available&quot;</span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li><a id="L1194">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">debugger</span></span> <span class="Statement">=</span> <span class="PreProc">Actions</span>.<span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L34" title="ocaml/ocamltest/builtin_variables.mli:34">make</a><br/></li>
<li></span>&nbsp; <span class="Statement">~</span><span class="Identifier"><a href="actions.mli.html#L22" title="ocaml/ocamltest/actions.mli:22">name</a></span>:<span class="Constant">&quot;<a href="ocaml_modifiers.ml.html#L126" title="ocaml/ocamltest/ocaml_modifiers.ml:126">debugger</a>&quot;<br/></li>
<li></span>&nbsp; <span class="Statement">~</span><span class="Identifier"><a href="actions.mli.html#L24" title="ocaml/ocamltest/actions.mli:24">description</a></span>:<span class="Constant">&quot;Passes if the <a href="ocaml_modifiers.ml.html#L126" title="ocaml/ocamltest/ocaml_modifiers.ml:126">debugger</a> is available&quot;<br/></li>
<li></span>&nbsp; <span class="Statement">(</span><span class="PreProc">Actions_helpers</span>.<span class="ocamlLCIdentifier"><a href="actions_helpers.ml.html#L27" title="ocaml/ocamltest/actions_helpers.ml:27">pass_or_skip</a></span> <span class="PreProc">Ocamltest_config</span>.<span class="ocamlLCIdentifier"><a href="ocaml_files.ml.html#L78" title="ocaml/ocamltest/ocaml_files.ml:78">ocamldebug</a><br/></li>
<li></span>&nbsp; &nbsp;&nbsp; <span class="Constant">&quot;<a href="ocaml_modifiers.ml.html#L126" title="ocaml/ocamltest/ocaml_modifiers.ml:126">debugger</a> available&quot;<br/></li>
<li></span>&nbsp; &nbsp;&nbsp; <span class="Constant">&quot;<a href="ocaml_modifiers.ml.html#L126" title="ocaml/ocamltest/ocaml_modifiers.ml:126">debugger</a> not available&quot;</span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li><a id="L1201">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">instrumented_runtime</span></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L34" title="ocaml/ocamltest/builtin_variables.mli:34">make</a><br/></li>
<li></span>&nbsp; <span class="Statement">~</span><span class="Identifier"><a href="actions.mli.html#L22" title="ocaml/ocamltest/actions.mli:22">name</a></span>:<span class="Constant">&quot;instrumented-<a href="ocaml_directories.ml.html#L32" title="ocaml/ocamltest/ocaml_directories.ml:32">runtime</a>&quot;<br/></li>
<li></span>&nbsp; <span class="Statement">~</span><span class="Identifier"><a href="actions.mli.html#L24" title="ocaml/ocamltest/actions.mli:24">description</a></span>:<span class="Constant">&quot;Passes if the instrumented <a href="ocaml_directories.ml.html#L32" title="ocaml/ocamltest/ocaml_directories.ml:32">runtime</a> is available&quot;<br/></li>
<li></span>&nbsp; <span class="Statement">(</span><span class="PreProc">Actions_helpers</span>.<span class="ocamlLCIdentifier"><a href="actions_helpers.ml.html#L27" title="ocaml/ocamltest/actions_helpers.ml:27">pass_or_skip</a></span> <span class="Statement">(</span><span class="PreProc">Ocamltest_config</span>.<span class="ocamlLCIdentifier"><a href="ocamltest_config.mli.html#L125" title="ocaml/ocamltest/ocamltest_config.mli:125">instrumented_runtime</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">&quot;instrumented <a href="ocaml_directories.ml.html#L32" title="ocaml/ocamltest/ocaml_directories.ml:32">runtime</a> available&quot;<br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">&quot;instrumented <a href="ocaml_directories.ml.html#L32" title="ocaml/ocamltest/ocaml_directories.ml:32">runtime</a> not available&quot;</span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li><a id="L1208">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">csharp_compiler</span></span> <span class="Statement">=</span> <span class="PreProc">Actions</span>.<span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L34" title="ocaml/ocamltest/builtin_variables.mli:34">make</a><br/></li>
<li></span>&nbsp; <span class="Statement">~</span><span class="Identifier"><a href="actions.mli.html#L22" title="ocaml/ocamltest/actions.mli:22">name</a></span>:<span class="Constant">&quot;csharp-compiler&quot;<br/></li>
<li></span>&nbsp; <span class="Statement">~</span><span class="Identifier"><a href="actions.mli.html#L24" title="ocaml/ocamltest/actions.mli:24">description</a></span>:<span class="Constant">&quot;Passes if the C# compiler is available&quot;<br/></li>
<li></span>&nbsp; <span class="Statement">(</span><span class="PreProc">Actions_helpers</span>.<span class="ocamlLCIdentifier"><a href="actions_helpers.ml.html#L27" title="ocaml/ocamltest/actions_helpers.ml:27">pass_or_skip</a></span> <span class="Statement">(</span><span class="PreProc">Ocamltest_config</span>.<span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L55" title="ocaml/ocamltest/ocaml_variables.mli:55">csc</a></span><span class="Statement">&lt;&gt;</span><span class="Constant">&quot;&quot;</span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">&quot;C# compiler available&quot;<br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">&quot;C# compiler not available&quot;</span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li><a id="L1215">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">windows_unicode</span></span> <span class="Statement">=</span> <span class="PreProc">Actions</span>.<span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L34" title="ocaml/ocamltest/builtin_variables.mli:34">make</a><br/></li>
<li></span>&nbsp; <span class="Statement">~</span><span class="Identifier"><a href="actions.mli.html#L22" title="ocaml/ocamltest/actions.mli:22">name</a></span>:<span class="Constant">&quot;<a href="builtin_actions.mli.html#L28" title="ocaml/ocamltest/builtin_actions.mli:28">windows</a>-unicode&quot;<br/></li>
<li></span>&nbsp; <span class="Statement">~</span><span class="Identifier"><a href="actions.mli.html#L24" title="ocaml/ocamltest/actions.mli:24">description</a></span>:<span class="Constant">&quot;Passes if Windows unicode support is available&quot;<br/></li>
<li></span>&nbsp; <span class="Statement">(</span><span class="PreProc">Actions_helpers</span>.<span class="ocamlLCIdentifier"><a href="actions_helpers.ml.html#L27" title="ocaml/ocamltest/actions_helpers.ml:27">pass_or_skip</a></span> <span class="Statement">(</span><span class="PreProc">Ocamltest_config</span>.<span class="ocamlLCIdentifier"><a href="ocamltest_config.mli.html#L119" title="ocaml/ocamltest/ocamltest_config.mli:119">windows_unicode</a></span> <span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">&quot;Windows Unicode support available&quot;<br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">&quot;Windows Unicode support not available&quot;</span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li><a id="L1222">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">afl_instrument</span></span> <span class="Statement">=</span> <span class="PreProc">Actions</span>.<span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L34" title="ocaml/ocamltest/builtin_variables.mli:34">make</a><br/></li>
<li></span>&nbsp; <span class="Statement">~</span><span class="Identifier"><a href="actions.mli.html#L22" title="ocaml/ocamltest/actions.mli:22">name</a></span>:<span class="Constant">&quot;afl-instrument&quot;<br/></li>
<li></span>&nbsp; <span class="Statement">~</span><span class="Identifier"><a href="actions.mli.html#L24" title="ocaml/ocamltest/actions.mli:24">description</a></span>:<span class="Constant">&quot;Passes if AFL instrumentation is enabled&quot;<br/></li>
<li></span>&nbsp; <span class="Statement">(</span><span class="PreProc">Actions_helpers</span>.<span class="ocamlLCIdentifier"><a href="actions_helpers.ml.html#L27" title="ocaml/ocamltest/actions_helpers.ml:27">pass_or_skip</a></span> <span class="PreProc">Ocamltest_config</span>.<span class="ocamlLCIdentifier"><a href="ocaml_actions.mli.html#L52" title="ocaml/ocamltest/ocaml_actions.mli:52">afl_instrument</a><br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">&quot;AFL instrumentation enabled&quot;<br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">&quot;AFL instrumentation disabled&quot;</span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li><a id="L1229">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">no_afl_instrument</span></span> <span class="Statement">=</span> <span class="PreProc">Actions</span>.<span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L34" title="ocaml/ocamltest/builtin_variables.mli:34">make</a><br/></li>
<li></span>&nbsp; <span class="Statement">~</span><span class="Identifier"><a href="actions.mli.html#L22" title="ocaml/ocamltest/actions.mli:22">name</a></span>:<span class="Constant">&quot;no-afl-instrument&quot;<br/></li>
<li></span>&nbsp; <span class="Statement">~</span><span class="Identifier"><a href="actions.mli.html#L24" title="ocaml/ocamltest/actions.mli:24">description</a></span>:<span class="Constant">&quot;Passes if AFL instrumentation is NOT enabled&quot;<br/></li>
<li></span>&nbsp; <span class="Statement">(</span><span class="PreProc">Actions_helpers</span>.<span class="ocamlLCIdentifier"><a href="actions_helpers.ml.html#L27" title="ocaml/ocamltest/actions_helpers.ml:27">pass_or_skip</a></span> <span class="Statement">(not</span> <span class="PreProc">Ocamltest_config</span>.<span class="ocamlLCIdentifier"><a href="ocaml_actions.mli.html#L52" title="ocaml/ocamltest/ocaml_actions.mli:52">afl_instrument</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">&quot;AFL instrumentation disabled&quot;<br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">&quot;AFL instrumentation enabled&quot;</span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li><a id="L1236">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">ocamldoc</span></span> <span class="Statement">=</span> <span class="PreProc">Ocaml_tools</span>.<span class="ocamlLCIdentifier"><span class="linkable">ocamldoc</span><br/></li>
<li></span><br/></li>
<li><a id="L1238">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">ocamldoc_output_file</span></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="ocamlLCIdentifier">prefix</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="ocaml_tools.ml.html#L66" title="ocaml/ocamltest/ocaml_tools.ml:66">backend</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Environments</span>.<span class="ocamlLCIdentifier"><a href="environments.mli.html#L29" title="ocaml/ocamltest/environments.mli:29">safe_lookup</a></span> <span class="PreProc">Ocaml_variables</span>.<span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L123" title="ocaml/ocamltest/ocaml_variables.mli:123">ocamldoc_backend</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="ocaml_compilers.ml.html#L55" title="ocaml/ocamltest/ocaml_compilers.ml:55">suffix</a></span> <span class="Statement">=</span> <span class="Statement">match</span> <span class="ocamlLCIdentifier"><a href="ocaml_tools.ml.html#L66" title="ocaml/ocamltest/ocaml_tools.ml:66">backend</a></span> <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">&quot;<a href="ocaml_modifiers.ml.html#L32" title="ocaml/ocamltest/ocaml_modifiers.ml:32">latex</a>&quot;</span> <span class="Statement">-&gt;</span> <span class="Constant">&quot;.tex&quot;<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">&quot;<a href="ocaml_modifiers.ml.html#L46" title="ocaml/ocamltest/ocaml_modifiers.ml:46">html</a>&quot;</span> <span class="Statement">-&gt;</span> <span class="Constant">&quot;.<a href="ocaml_modifiers.ml.html#L46" title="ocaml/ocamltest/ocaml_modifiers.ml:46">html</a>&quot;<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">&quot;<a href="ocaml_modifiers.ml.html#L52" title="ocaml/ocamltest/ocaml_modifiers.ml:52">man</a>&quot;</span> <span class="Statement">-&gt;</span> <span class="Constant">&quot;.3o&quot;<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Statement">_</span> <span class="Statement">-&gt;</span> <span class="Constant">&quot;.<a href="filecompare.ml.html#L20" title="ocaml/ocamltest/filecompare.ml:20">result</a>&quot;</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier">prefix</span> <span class="Statement">^</span> <span class="ocamlLCIdentifier"><a href="ocaml_compilers.ml.html#L55" title="ocaml/ocamltest/ocaml_compilers.ml:55">suffix</a><br/></li>
<li></span><br/></li>
<li><a id="L1248">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">check_ocamldoc_output</span></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="#L837" title="ocaml/ocamltest/ocaml_actions.ml:837">make_check_tool_output</a><br/></li>
<li></span>&nbsp; <span class="Constant">&quot;check-<a href="ocaml_files.ml.html#L74" title="ocaml/ocamltest/ocaml_files.ml:74">ocamldoc</a>-<a href="builtin_variables.mli.html#L40" title="ocaml/ocamltest/builtin_variables.mli:40">output</a>&quot;</span> <span class="ocamlLCIdentifier"><a href="ocaml_files.ml.html#L74" title="ocaml/ocamltest/ocaml_files.ml:74">ocamldoc</a><br/></li>
<li></span><br/></li>
<li><a id="L1251">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">ocamldoc_flags</span></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="PreProc">Environments</span>.<span class="ocamlLCIdentifier"><a href="environments.mli.html#L29" title="ocaml/ocamltest/environments.mli:29">safe_lookup</a></span> <span class="PreProc">Ocaml_variables</span>.<span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L122" title="ocaml/ocamltest/ocaml_variables.mli:122">ocamldoc_flags</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a><br/></li>
<li></span><br/></li>
<li><a id="L1254">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">compiled_doc_name</span></span> <span class="ocamlLCIdentifier">input</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">input</span> <span class="Statement">^</span> <span class="Constant">&quot;.odoc&quot;<br/></li>
<li></span><br/></li>
<li><span class="Comment">(* The compiler used for compiling both cmi <a href="builtin_variables.mli.html#L30" title="ocaml/ocamltest/builtin_variables.mli:30">file</a><br/></li>
<li></span><span class="Comment">&nbsp;&nbsp; and <a href="ocaml_variables.mli.html#L130" title="ocaml/ocamltest/ocaml_variables.mli:130">plugins</a> *)<br/></li>
<li><a id="L1258">&#x200c;</a></span><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">compiler_for_ocamldoc</span></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">compiler</span> <span class="Statement">=</span> <span class="PreProc">Ocaml_compilers</span>.<span class="ocamlLCIdentifier"><a href="ocaml_actions.mli.html#L19" title="ocaml/ocamltest/ocaml_actions.mli:19">ocamlc_byte</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier"><a href="#L989" title="ocaml/ocamltest/ocaml_actions.ml:989">compile_modules</a></span> <span class="ocamlLCIdentifier">compiler</span> <span class="ocamlLCIdentifier">compiler</span><span class="PreProc">#</span><span class="ocamlLCIdentifier"><a href="actions.mli.html#L22" title="ocaml/ocamltest/actions.mli:22">name</a><br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier">compiler</span><span class="PreProc">#</span><span class="ocamlLCIdentifier">output_variable<br/></li>
<li></span><br/></li>
<li><span class="Comment">(* Within <a href="ocaml_files.ml.html#L74" title="ocaml/ocamltest/ocaml_files.ml:74">ocamldoc</a> <a href="tests.ml.html#L27" title="ocaml/ocamltest/tests.ml:27">tests</a>,<br/></li>
<li></span><span class="Comment">&nbsp;&nbsp; <a href="ocaml_variables.mli.html#L75" title="ocaml/ocamltest/ocaml_variables.mli:75">modules</a>=&quot;a<a href="tsl_semantics.ml.html#L72" title="ocaml/ocamltest/tsl_semantics.ml:72">.</a>ml <a href="environments.ml.html#L37" title="ocaml/ocamltest/environments.ml:37">b</a><a href="tsl_semantics.ml.html#L72" title="ocaml/ocamltest/tsl_semantics.ml:72">.</a>ml&quot; is interpreted as a list of<br/></li>
<li></span><span class="Comment">&nbsp;&nbsp; secondaries documentation <a href="ocaml_variables.mli.html#L75" title="ocaml/ocamltest/ocaml_variables.mli:75">modules</a> that need to be<br/></li>
<li></span><span class="Comment">&nbsp;&nbsp; compiled into cmi <a href="filecompare.ml.html#L56" title="ocaml/ocamltest/filecompare.ml:56">files</a> and odoc <a href="builtin_variables.mli.html#L30" title="ocaml/ocamltest/builtin_variables.mli:30">file</a> (serialized <a href="ocaml_files.ml.html#L74" title="ocaml/ocamltest/ocaml_files.ml:74">ocamldoc</a> information)<br/></li>
<li></span><span class="Comment">&nbsp;&nbsp; before the main documentation is generated *)<br/></li>
<li><a id="L1268">&#x200c;</a></span><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">compile_ocamldoc</span></span> <span class="Statement">(</span><span class="ocamlLCIdentifier">basename</span>,<span class="ocamlLCIdentifier"><a href="filecompare.ml.html#L54" title="ocaml/ocamltest/filecompare.ml:54">filetype</a></span> <span class="Statement">as</span> <span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L73" title="ocaml/ocamltest/ocaml_variables.mli:73">module_</a></span><span class="Statement">)</span> <span class="ocamlLCIdentifier"><a href="main.ml.html#L166" title="ocaml/ocamltest/main.ml:166">log</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="ocaml_tools.ml.html#L50" title="ocaml/ocamltest/ocaml_tools.ml:50">expected_exit_status</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Ocaml_tools</span>.<span class="ocamlLCIdentifier"><a href="ocaml_tools.ml.html#L50" title="ocaml/ocamltest/ocaml_tools.ml:50">expected_exit_status</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="ocaml_files.ml.html#L74" title="ocaml/ocamltest/ocaml_files.ml:74">ocamldoc</a></span> :<span class="Statement">&gt;</span> <span class="PreProc">Ocaml_tools</span>.<span class="ocamlLCIdentifier"><a href="filecompare.ml.html#L27" title="ocaml/ocamltest/filecompare.ml:27">tool</a></span><span class="Statement">)</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="#L227" title="ocaml/ocamltest/ocaml_actions.ml:227">what</a></span> <span class="Statement">=</span> <span class="PreProc">Printf</span>.<span class="ocamlLCIdentifier">sprintf</span> <span class="Constant">&quot;Compiling documentation for module %s&quot;</span> <span class="ocamlLCIdentifier">basename</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="PreProc">Printf</span>.<span class="ocamlLCIdentifier">fprintf</span> <span class="ocamlLCIdentifier"><a href="main.ml.html#L166" title="ocaml/ocamltest/main.ml:166">log</a></span> <span class="Constant">&quot;%s\<a href="actions_helpers.ml.html#L174" title="ocaml/ocamltest/actions_helpers.ml:174">n</a>%!&quot;</span> <span class="ocamlLCIdentifier"><a href="#L227" title="ocaml/ocamltest/ocaml_actions.ml:227">what</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="ocaml_compilers.ml.html#L57" title="ocaml/ocamltest/ocaml_compilers.ml:57">filename</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Ocaml_filetypes</span>.<span class="ocamlLCIdentifier"><a href="ocaml_filetypes.ml.html#L106" title="ocaml/ocamltest/ocaml_filetypes.ml:106">make_filename</a></span> <span class="Statement">(</span><span class="ocamlLCIdentifier">basename</span>, <span class="ocamlLCIdentifier"><a href="filecompare.ml.html#L54" title="ocaml/ocamltest/filecompare.ml:54">filetype</a></span><span class="Statement">)</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">r</span>,<span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="Statement">)</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="#L1258" title="ocaml/ocamltest/ocaml_actions.ml:1258">compiler_for_ocamldoc</a></span> <span class="Statement">[</span><span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L73" title="ocaml/ocamltest/ocaml_variables.mli:73">module_</a></span><span class="Statement">]</span> <span class="ocamlLCIdentifier"><a href="main.ml.html#L166" title="ocaml/ocamltest/main.ml:166">log</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="Statement">not</span><span class="ocamlNone"> </span><span class="Statement">(</span><span class="PreProc">Result</span><span class="ocamlNone">.</span><span class="ocamlLCIdentifier"><a href="result.ml.html#L53" title="ocaml/ocamltest/result.ml:53">is_pass</a></span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">r</span><span class="Statement">)</span><span class="ocamlNone"> </span><span class="Statement">then</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">r</span>,<span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="Statement">)</span> <span class="Statement">else<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L24" title="ocaml/ocamltest/builtin_variables.mli:24">commandline</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="Comment">(* currently, we are ignoring the global <a href="ocaml_variables.mli.html#L122" title="ocaml/ocamltest/ocaml_variables.mli:122">ocamldoc_flags</a>, since we<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp;&nbsp; don'<a href="environments.ml.html#L22" title="ocaml/ocamltest/environments.ml:22">t</a> have per-module <a href="ocaml_variables.mli.html#L61" title="ocaml/ocamltest/ocaml_variables.mli:61">flags</a> *)<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">[<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Ocaml_commands</span>.<span class="ocamlLCIdentifier"><a href="ocaml_commands.ml.html#L32" title="ocaml/ocamltest/ocaml_commands.ml:32">ocamlrun_ocamldoc</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Ocaml_flags</span>.<span class="ocamlLCIdentifier"><a href="ocaml_directories.ml.html#L23" title="ocaml/ocamltest/ocaml_directories.ml:23">stdlib</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">&quot;-<a href="environments.ml.html#L139" title="ocaml/ocamltest/environments.ml:139">dump</a> &quot;</span> <span class="Statement">^</span> <span class="ocamlLCIdentifier"><a href="#L1254" title="ocaml/ocamltest/ocaml_actions.ml:1254">compiled_doc_name</a></span> <span class="ocamlLCIdentifier">basename</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier"><a href="ocaml_compilers.ml.html#L57" title="ocaml/ocamltest/ocaml_compilers.ml:57">filename</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; <span class="Statement">]</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L28" title="ocaml/ocamltest/builtin_variables.mli:28">exit_status</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Actions_helpers</span>.<span class="ocamlLCIdentifier"><a href="actions_helpers.ml.html#L117" title="ocaml/ocamltest/actions_helpers.ml:117">run_cmd</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier"><a href="environments.ml.html#L199" title="ocaml/ocamltest/environments.ml:199">environment</a></span>:<span class="Statement">(</span><span class="PreProc">Environments</span>.<span class="ocamlLCIdentifier"><a href="environments.ml.html#L83" title="ocaml/ocamltest/environments.ml:83">to_system_env</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier">stdin_variable</span>: <span class="PreProc">Ocaml_variables</span>.<span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L51" title="ocaml/ocamltest/ocaml_variables.mli:51">compiler_stdin</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier">stdout_variable</span>:<span class="ocamlLCIdentifier"><a href="ocaml_files.ml.html#L74" title="ocaml/ocamltest/ocaml_files.ml:74">ocamldoc</a></span><span class="PreProc">#</span><span class="ocamlLCIdentifier">output_variable<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier">stderr_variable</span>:<span class="ocamlLCIdentifier"><a href="ocaml_files.ml.html#L74" title="ocaml/ocamltest/ocaml_files.ml:74">ocamldoc</a></span><span class="PreProc">#</span><span class="ocamlLCIdentifier">output_variable<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier"><a href="ocaml_modifiers.ml.html#L22" title="ocaml/ocamltest/ocaml_modifiers.ml:22">append</a></span>:<span class="Constant">true<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="main.ml.html#L166" title="ocaml/ocamltest/main.ml:166">log</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L24" title="ocaml/ocamltest/builtin_variables.mli:24">commandline</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L28" title="ocaml/ocamltest/builtin_variables.mli:28">exit_status</a></span><span class="Statement">=</span><span class="ocamlLCIdentifier"><a href="ocaml_tools.ml.html#L50" title="ocaml/ocamltest/ocaml_tools.ml:50">expected_exit_status</a><br/></li>
<li></span><span class="ocamlNone">&nbsp; </span><span class="Statement">then</span> <span class="Statement">(</span><span class="PreProc">Result</span>.<span class="ocamlLCIdentifier"><a href="builtin_actions.mli.html#L18" title="ocaml/ocamltest/builtin_actions.mli:18">pass</a></span>, <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">else</span> <span class="Statement">begin<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L47" title="ocaml/ocamltest/builtin_variables.mli:47">reason</a></span><span class="ocamlEnd"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">(</span><span class="PreProc">Actions_helpers</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier"><a href="actions_helpers.ml.html#L35" title="ocaml/ocamltest/actions_helpers.ml:35">mkreason</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="#L227" title="ocaml/ocamltest/ocaml_actions.ml:227">what</a></span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="PreProc">String</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">concat</span><span class="ocamlEnd"> </span><span class="Constant">&quot; &quot;</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L24" title="ocaml/ocamltest/builtin_variables.mli:24">commandline</a></span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L28" title="ocaml/ocamltest/builtin_variables.mli:28">exit_status</a></span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="Statement">(</span><span class="PreProc">Result</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier"><a href="result.ml.html#L39" title="ocaml/ocamltest/result.ml:39">fail_with_reason</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L47" title="ocaml/ocamltest/builtin_variables.mli:47">reason</a></span><span class="ocamlEnd">, </span><span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="Statement">)<br/></li>
<li></span><span class="ocamlEnd">&nbsp; </span><span class="Statement">end<br/></li>
<li></span><br/></li>
<li><span class="Statement">let</span> <span class="Statement">rec</span> <span class="ocamlLCIdentifier">ocamldoc_compile_all</span> <span class="ocamlLCIdentifier"><a href="main.ml.html#L166" title="ocaml/ocamltest/main.ml:166">log</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">=</span> <span class="Statement">function<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">[]</span> <span class="Statement">-&gt;</span> <span class="Statement">(</span><span class="PreProc">Result</span>.<span class="ocamlLCIdentifier"><a href="builtin_actions.mli.html#L18" title="ocaml/ocamltest/builtin_actions.mli:18">pass</a></span>, <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="ocamlLCIdentifier">a</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier">q</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">r</span>,<span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="Statement">)</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="#L1268" title="ocaml/ocamltest/ocaml_actions.ml:1268">compile_ocamldoc</a></span> <span class="ocamlLCIdentifier">a</span> <span class="ocamlLCIdentifier"><a href="main.ml.html#L166" title="ocaml/ocamltest/main.ml:166">log</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="PreProc">Result</span><span class="ocamlNone">.</span><span class="ocamlLCIdentifier"><a href="result.ml.html#L53" title="ocaml/ocamltest/result.ml:53">is_pass</a></span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">r</span><span class="ocamlNone"> </span><span class="Statement">then<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">ocamldoc_compile_all</span> <span class="ocamlLCIdentifier"><a href="main.ml.html#L166" title="ocaml/ocamltest/main.ml:166">log</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="ocamlLCIdentifier">q<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="ocamlLCIdentifier">r</span>,<span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li><a id="L1312">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">setup_ocamldoc_build_env</span></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="PreProc">Actions</span>.<span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L34" title="ocaml/ocamltest/builtin_variables.mli:34">make</a></span> <span class="Statement">~</span><span class="Identifier"><a href="actions.mli.html#L22" title="ocaml/ocamltest/actions.mli:22">name</a></span>:<span class="Constant">&quot;<a href="ocaml_actions.mli.html#L40" title="ocaml/ocamltest/ocaml_actions.mli:40">setup_ocamldoc_build_env</a>&quot;<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier"><a href="actions.mli.html#L24" title="ocaml/ocamltest/actions.mli:24">description</a></span>:<span class="Constant">&quot;Setup <a href="ocaml_files.ml.html#L74" title="ocaml/ocamltest/ocaml_files.ml:74">ocamldoc</a> build <a href="environments.ml.html#L199" title="ocaml/ocamltest/environments.ml:199">environment</a>&quot;</span> @@ <span class="Statement">fun</span> <span class="ocamlLCIdentifier"><a href="main.ml.html#L166" title="ocaml/ocamltest/main.ml:166">log</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">r</span>,<span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="Statement">)</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="#L357" title="ocaml/ocamltest/ocaml_actions.ml:357">setup_tool_build_env</a></span> <span class="ocamlLCIdentifier"><a href="ocaml_files.ml.html#L74" title="ocaml/ocamltest/ocaml_files.ml:74">ocamldoc</a></span> <span class="ocamlLCIdentifier"><a href="main.ml.html#L166" title="ocaml/ocamltest/main.ml:166">log</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="Statement">not</span><span class="ocamlNone"> </span><span class="Statement">(</span><span class="PreProc">Result</span><span class="ocamlNone">.</span><span class="ocamlLCIdentifier"><a href="result.ml.html#L53" title="ocaml/ocamltest/result.ml:53">is_pass</a></span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">r</span><span class="Statement">)</span><span class="ocamlNone"> </span><span class="Statement">then</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">r</span>,<span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="Statement">)</span> <span class="Statement">else<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">source_directory</span> <span class="Statement">=</span> <span class="PreProc">Actions_helpers</span>.<span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L69" title="ocaml/ocamltest/builtin_variables.mli:69">test_source_directory</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">root_file</span> <span class="Statement">=</span> <span class="PreProc">Filename</span>.<span class="ocamlLCIdentifier">chop_extension</span> <span class="Statement">(</span><span class="PreProc">Actions_helpers</span>.<span class="ocamlLCIdentifier"><a href="actions_helpers.ml.html#L39" title="ocaml/ocamltest/actions_helpers.ml:39">testfile</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="Statement">)</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">reference_prefix</span> <span class="Statement">=</span> <span class="PreProc">Filename</span>.<span class="ocamlLCIdentifier">make_path</span> <span class="Statement">[</span><span class="ocamlLCIdentifier">source_directory</span><span class="Statement">;</span> <span class="ocamlLCIdentifier">root_file</span><span class="Statement">]</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L40" title="ocaml/ocamltest/builtin_variables.mli:40">output</a></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="#L1238" title="ocaml/ocamltest/ocaml_actions.ml:1238">ocamldoc_output_file</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="ocamlLCIdentifier">root_file</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L49" title="ocaml/ocamltest/builtin_variables.mli:49">reference</a></span><span class="Statement">=</span> <span class="ocamlLCIdentifier">reference_prefix</span> <span class="Statement">^</span> <span class="ocamlLCIdentifier"><a href="ocaml_files.ml.html#L74" title="ocaml/ocamltest/ocaml_files.ml:74">ocamldoc</a></span><span class="PreProc">#</span><span class="ocamlLCIdentifier">reference_filename_suffix</span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="ocaml_tools.ml.html#L66" title="ocaml/ocamltest/ocaml_tools.ml:66">backend</a></span> <span class="Statement">=</span> <span class="PreProc">Environments</span>.<span class="ocamlLCIdentifier"><a href="environments.mli.html#L29" title="ocaml/ocamltest/environments.mli:29">safe_lookup</a></span> <span class="PreProc">Ocaml_variables</span>.<span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L123" title="ocaml/ocamltest/ocaml_variables.mli:123">ocamldoc_backend</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Environments</span>.<span class="ocamlLCIdentifier"><a href="tsl_semantics.mli.html#L20" title="ocaml/ocamltest/tsl_semantics.mli:20">apply_modifiers</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span>&nbsp; <span class="PreProc">Ocaml_modifiers</span>.<span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="ocaml_modifiers.ml.html#L92" title="ocaml/ocamltest/ocaml_modifiers.ml:92">str</a></span> @ <span class="ocamlLCIdentifier"><a href="ocaml_modifiers.ml.html#L84" title="ocaml/ocamltest/ocaml_modifiers.ml:84">unix</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|&gt;</span> <span class="PreProc">Environments</span>.<span class="ocamlLCIdentifier"><a href="ocaml_modifiers.ml.html#L23" title="ocaml/ocamltest/ocaml_modifiers.ml:23">add</a></span> <span class="PreProc">Builtin_variables</span>.<span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L49" title="ocaml/ocamltest/builtin_variables.mli:49">reference</a></span> <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L49" title="ocaml/ocamltest/builtin_variables.mli:49">reference</a><br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|&gt;</span> <span class="PreProc">Environments</span>.<span class="ocamlLCIdentifier"><a href="ocaml_modifiers.ml.html#L23" title="ocaml/ocamltest/ocaml_modifiers.ml:23">add</a></span> <span class="PreProc">Builtin_variables</span>.<span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L40" title="ocaml/ocamltest/builtin_variables.mli:40">output</a></span> <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L40" title="ocaml/ocamltest/builtin_variables.mli:40">output</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier"><a href="ocaml_tools.ml.html#L66" title="ocaml/ocamltest/ocaml_tools.ml:66">backend</a></span><span class="ocamlNone"> </span><span class="Statement">=</span><span class="ocamlNone"> </span><span class="Constant">&quot;<a href="ocaml_modifiers.ml.html#L52" title="ocaml/ocamltest/ocaml_modifiers.ml:52">man</a>&quot;</span><span class="ocamlNone"> </span><span class="Statement">then</span> <span class="PreProc">Environments</span>.<span class="ocamlLCIdentifier"><a href="environments.ml.html#L114" title="ocaml/ocamltest/environments.ml:114">add_if_undefined</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="PreProc">Builtin_variables</span>.<span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L51" title="ocaml/ocamltest/builtin_variables.mli:51">skip_header_lines</a></span> <span class="Constant">&quot;1&quot;</span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a><br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">else</span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="PreProc">Result</span>.<span class="ocamlLCIdentifier"><a href="builtin_actions.mli.html#L18" title="ocaml/ocamltest/builtin_actions.mli:18">pass</a></span>, <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a><br/></li>
<li></span><br/></li>
<li><a id="L1333">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">ocamldoc_plugin</span></span> <span class="ocamlLCIdentifier"><a href="actions.mli.html#L22" title="ocaml/ocamltest/actions.mli:22">name</a></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="actions.mli.html#L22" title="ocaml/ocamltest/actions.mli:22">name</a></span> <span class="Statement">^</span> <span class="Constant">&quot;.cmo&quot;<br/></li>
<li></span><br/></li>
<li><a id="L1335">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">ocamldoc_backend_flag</span></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="ocaml_tools.ml.html#L66" title="ocaml/ocamltest/ocaml_tools.ml:66">backend</a></span> <span class="Statement">=</span> <span class="PreProc">Environments</span>.<span class="ocamlLCIdentifier"><a href="environments.mli.html#L29" title="ocaml/ocamltest/environments.mli:29">safe_lookup</a></span> <span class="PreProc">Ocaml_variables</span>.<span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L123" title="ocaml/ocamltest/ocaml_variables.mli:123">ocamldoc_backend</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier"><a href="ocaml_tools.ml.html#L66" title="ocaml/ocamltest/ocaml_tools.ml:66">backend</a></span><span class="ocamlNone"> </span><span class="Statement">=</span><span class="ocamlNone"> </span><span class="Constant">&quot;&quot;</span><span class="ocamlNone"> </span><span class="Statement">then</span> <span class="Constant">&quot;&quot;</span> <span class="Statement">else</span> <span class="Constant">&quot;-&quot;</span> <span class="Statement">^</span> <span class="ocamlLCIdentifier"><a href="ocaml_tools.ml.html#L66" title="ocaml/ocamltest/ocaml_tools.ml:66">backend</a><br/></li>
<li></span><br/></li>
<li><a id="L1339">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">ocamldoc_o_flag</span></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L40" title="ocaml/ocamltest/builtin_variables.mli:40">output</a></span> <span class="Statement">=</span>&nbsp; <span class="PreProc">Environments</span>.<span class="ocamlLCIdentifier"><a href="environments.mli.html#L29" title="ocaml/ocamltest/environments.mli:29">safe_lookup</a></span> <span class="PreProc">Builtin_variables</span>.<span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L40" title="ocaml/ocamltest/builtin_variables.mli:40">output</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">match</span> <span class="PreProc">Environments</span>.<span class="ocamlLCIdentifier"><a href="environments.mli.html#L29" title="ocaml/ocamltest/environments.mli:29">safe_lookup</a></span> <span class="PreProc">Ocaml_variables</span>.<span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L123" title="ocaml/ocamltest/ocaml_variables.mli:123">ocamldoc_backend</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">with<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">&quot;<a href="ocaml_modifiers.ml.html#L46" title="ocaml/ocamltest/ocaml_modifiers.ml:46">html</a>&quot;</span> <span class="Statement">|</span> <span class="Constant">&quot;manual&quot;</span> <span class="Statement">-&gt;</span> <span class="Constant">&quot;index&quot;<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Statement">_</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L40" title="ocaml/ocamltest/builtin_variables.mli:40">output</a><br/></li>
<li></span><br/></li>
<li><a id="L1345">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">run_ocamldoc</span></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="PreProc">Actions</span>.<span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L34" title="ocaml/ocamltest/builtin_variables.mli:34">make</a></span> <span class="Statement">~</span><span class="Identifier"><a href="actions.mli.html#L22" title="ocaml/ocamltest/actions.mli:22">name</a></span>:<span class="Constant">&quot;<a href="ocaml_files.ml.html#L74" title="ocaml/ocamltest/ocaml_files.ml:74">ocamldoc</a>&quot;</span> <span class="Statement">~</span><span class="Identifier"><a href="actions.mli.html#L24" title="ocaml/ocamltest/actions.mli:24">description</a></span>:<span class="Constant">&quot;Run <a href="ocaml_files.ml.html#L74" title="ocaml/ocamltest/ocaml_files.ml:74">ocamldoc</a> on the test <a href="builtin_variables.mli.html#L30" title="ocaml/ocamltest/builtin_variables.mli:30">file</a>&quot;</span> @@<br/></li>
<li>&nbsp; <span class="Statement">fun</span> <span class="ocamlLCIdentifier"><a href="main.ml.html#L166" title="ocaml/ocamltest/main.ml:166">log</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; <span class="Comment">(* <a href="ocaml_variables.mli.html#L75" title="ocaml/ocamltest/ocaml_variables.mli:75">modules</a> corresponds to secondaries <a href="ocaml_variables.mli.html#L75" title="ocaml/ocamltest/ocaml_variables.mli:75">modules</a> of which the<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; documentation and cmi <a href="filecompare.ml.html#L56" title="ocaml/ocamltest/filecompare.ml:56">files</a> need to be build before the main<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; module documentation *)<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L75" title="ocaml/ocamltest/ocaml_variables.mli:75">modules</a></span> <span class="Statement">=</span>&nbsp; <span class="PreProc">List</span>.<span class="ocamlLCIdentifier">map</span> <span class="PreProc">Ocaml_filetypes</span>.<span class="ocamlLCIdentifier"><a href="filecompare.ml.html#L54" title="ocaml/ocamltest/filecompare.ml:54">filetype</a></span> @@ <span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L75" title="ocaml/ocamltest/ocaml_variables.mli:75">modules</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Comment">(* <a href="ocaml_variables.mli.html#L130" title="ocaml/ocamltest/ocaml_variables.mli:130">plugins</a> are used for custom documentation generators *)<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L130" title="ocaml/ocamltest/ocaml_variables.mli:130">plugins</a></span> <span class="Statement">=</span> <span class="PreProc">List</span>.<span class="ocamlLCIdentifier">map</span> <span class="PreProc">Ocaml_filetypes</span>.<span class="ocamlLCIdentifier"><a href="filecompare.ml.html#L54" title="ocaml/ocamltest/filecompare.ml:54">filetype</a></span> @@ <span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L130" title="ocaml/ocamltest/ocaml_variables.mli:130">plugins</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">r</span>,<span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="Statement">)</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="#L1258" title="ocaml/ocamltest/ocaml_actions.ml:1258">compiler_for_ocamldoc</a></span> <span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L130" title="ocaml/ocamltest/ocaml_variables.mli:130">plugins</a></span> <span class="ocamlLCIdentifier"><a href="main.ml.html#L166" title="ocaml/ocamltest/main.ml:166">log</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="Statement">not</span><span class="ocamlNone"> </span><span class="Statement">(</span><span class="PreProc">Result</span><span class="ocamlNone">.</span><span class="ocamlLCIdentifier"><a href="result.ml.html#L53" title="ocaml/ocamltest/result.ml:53">is_pass</a></span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">r</span><span class="Statement">)</span><span class="ocamlNone"> </span><span class="Statement">then</span> <span class="ocamlLCIdentifier">r</span>, <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">else<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">r</span>,<span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="Statement">)</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">ocamldoc_compile_all</span> <span class="ocamlLCIdentifier"><a href="main.ml.html#L166" title="ocaml/ocamltest/main.ml:166">log</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L75" title="ocaml/ocamltest/ocaml_variables.mli:75">modules</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="Statement">not</span><span class="ocamlNone"> </span><span class="Statement">(</span><span class="PreProc">Result</span><span class="ocamlNone">.</span><span class="ocamlLCIdentifier"><a href="result.ml.html#L53" title="ocaml/ocamltest/result.ml:53">is_pass</a></span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">r</span><span class="Statement">)</span><span class="ocamlNone"> </span><span class="Statement">then</span> <span class="ocamlLCIdentifier">r</span>, <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">else<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">input_file</span> <span class="Statement">=</span> <span class="PreProc">Actions_helpers</span>.<span class="ocamlLCIdentifier"><a href="actions_helpers.ml.html#L39" title="ocaml/ocamltest/actions_helpers.ml:39">testfile</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="PreProc">Printf</span>.<span class="ocamlLCIdentifier">fprintf</span> <span class="ocamlLCIdentifier"><a href="main.ml.html#L166" title="ocaml/ocamltest/main.ml:166">log</a></span> <span class="Constant">&quot;Generating documentation for %s\<a href="actions_helpers.ml.html#L174" title="ocaml/ocamltest/actions_helpers.ml:174">n</a>%!&quot;</span> <span class="ocamlLCIdentifier">input_file</span><span class="Statement">;<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">load_all</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">List</span>.<span class="ocamlLCIdentifier">map</span> <span class="Statement">(fun</span> <span class="ocamlLCIdentifier"><a href="actions.mli.html#L22" title="ocaml/ocamltest/actions.mli:22">name</a></span> <span class="Statement">-&gt;</span> <span class="Constant">&quot;-load &quot;</span> <span class="Statement">^</span> <span class="ocamlLCIdentifier"><a href="#L1254" title="ocaml/ocamltest/ocaml_actions.ml:1254">compiled_doc_name</a></span> <span class="Statement">(</span><span class="ocamlLCIdentifier">fst</span> <span class="ocamlLCIdentifier"><a href="actions.mli.html#L22" title="ocaml/ocamltest/actions.mli:22">name</a></span><span class="Statement">))<br/></li>
<li></span>&nbsp; &nbsp; @@ <span class="Comment">(* sort module in alphabetical order *)<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">List</span>.<span class="ocamlLCIdentifier">sort</span> <span class="PreProc">Stdlib</span>.<span class="ocamlLCIdentifier"><a href="actions.mli.html#L32" title="ocaml/ocamltest/actions.mli:32">compare</a></span> <span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L75" title="ocaml/ocamltest/ocaml_variables.mli:75">modules</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">with_plugins</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">List</span>.<span class="ocamlLCIdentifier">map</span> <span class="Statement">(fun</span> <span class="ocamlLCIdentifier"><a href="actions.mli.html#L22" title="ocaml/ocamltest/actions.mli:22">name</a></span> <span class="Statement">-&gt;</span> <span class="Constant">&quot;-g &quot;</span> <span class="Statement">^</span> <span class="ocamlLCIdentifier"><a href="#L1333" title="ocaml/ocamltest/ocaml_actions.ml:1333">ocamldoc_plugin</a></span> <span class="Statement">(</span><span class="ocamlLCIdentifier">fst</span> <span class="ocamlLCIdentifier"><a href="actions.mli.html#L22" title="ocaml/ocamltest/actions.mli:22">name</a></span><span class="Statement">))</span> <span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L130" title="ocaml/ocamltest/ocaml_variables.mli:130">plugins</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L24" title="ocaml/ocamltest/builtin_variables.mli:24">commandline</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">[<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Ocaml_commands</span>.<span class="ocamlLCIdentifier"><a href="ocaml_commands.ml.html#L32" title="ocaml/ocamltest/ocaml_commands.ml:32">ocamlrun_ocamldoc</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L1335" title="ocaml/ocamltest/ocaml_actions.ml:1335">ocamldoc_backend_flag</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Ocaml_flags</span>.<span class="ocamlLCIdentifier"><a href="ocaml_directories.ml.html#L23" title="ocaml/ocamltest/ocaml_directories.ml:23">stdlib</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L122" title="ocaml/ocamltest/ocaml_variables.mli:122">ocamldoc_flags</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="Statement">]<br/></li>
<li></span>&nbsp; @ <span class="ocamlLCIdentifier">load_all</span> @ <span class="ocamlLCIdentifier">with_plugins</span> @<br/></li>
<li>&nbsp;&nbsp; <span class="Statement">[</span> <span class="ocamlLCIdentifier">input_file</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp;&nbsp; <span class="Constant">&quot;-o&quot;</span><span class="Statement">;</span> <span class="ocamlLCIdentifier"><a href="#L1339" title="ocaml/ocamltest/ocaml_actions.ml:1339">ocamldoc_o_flag</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a><br/></li>
<li></span>&nbsp;&nbsp; <span class="Statement">]</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L28" title="ocaml/ocamltest/builtin_variables.mli:28">exit_status</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Actions_helpers</span>.<span class="ocamlLCIdentifier"><a href="actions_helpers.ml.html#L117" title="ocaml/ocamltest/actions_helpers.ml:117">run_cmd</a></span> <span class="Statement">~</span><span class="Identifier"><a href="environments.ml.html#L199" title="ocaml/ocamltest/environments.ml:199">environment</a></span>:<span class="Statement">(</span><span class="PreProc">Environments</span>.<span class="ocamlLCIdentifier"><a href="environments.ml.html#L83" title="ocaml/ocamltest/environments.ml:83">to_system_env</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier">stdin_variable</span>: <span class="PreProc">Ocaml_variables</span>.<span class="ocamlLCIdentifier"><a href="ocaml_variables.mli.html#L51" title="ocaml/ocamltest/ocaml_variables.mli:51">compiler_stdin</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier">stdout_variable</span>:<span class="ocamlLCIdentifier"><a href="ocaml_files.ml.html#L74" title="ocaml/ocamltest/ocaml_files.ml:74">ocamldoc</a></span><span class="PreProc">#</span><span class="ocamlLCIdentifier">output_variable<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier">stderr_variable</span>:<span class="ocamlLCIdentifier"><a href="ocaml_files.ml.html#L74" title="ocaml/ocamltest/ocaml_files.ml:74">ocamldoc</a></span><span class="PreProc">#</span><span class="ocamlLCIdentifier">output_variable<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier"><a href="ocaml_modifiers.ml.html#L22" title="ocaml/ocamltest/ocaml_modifiers.ml:22">append</a></span>:<span class="Constant">true<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="main.ml.html#L166" title="ocaml/ocamltest/main.ml:166">log</a></span> <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span> <span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L24" title="ocaml/ocamltest/builtin_variables.mli:24">commandline</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L28" title="ocaml/ocamltest/builtin_variables.mli:28">exit_status</a></span><span class="Statement">=</span><span class="Constant">0</span><span class="ocamlNone"> </span><span class="Statement">then<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">(</span><span class="PreProc">Result</span>.<span class="ocamlLCIdentifier"><a href="builtin_actions.mli.html#L18" title="ocaml/ocamltest/builtin_actions.mli:18">pass</a></span>, <span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">else</span> <span class="Statement">begin<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L47" title="ocaml/ocamltest/builtin_variables.mli:47">reason</a></span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="PreProc">Actions_helpers</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier"><a href="actions_helpers.ml.html#L35" title="ocaml/ocamltest/actions_helpers.ml:35">mkreason</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Constant">&quot;<a href="ocaml_files.ml.html#L74" title="ocaml/ocamltest/ocaml_files.ml:74">ocamldoc</a>&quot;</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="PreProc">String</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">concat</span><span class="ocamlEnd"> </span><span class="Constant">&quot; &quot;</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L24" title="ocaml/ocamltest/builtin_variables.mli:24">commandline</a></span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L28" title="ocaml/ocamltest/builtin_variables.mli:28">exit_status</a></span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="Statement">(</span><span class="PreProc">Result</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier"><a href="result.ml.html#L39" title="ocaml/ocamltest/result.ml:39">fail_with_reason</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="builtin_variables.mli.html#L47" title="ocaml/ocamltest/builtin_variables.mli:47">reason</a></span><span class="ocamlEnd">, </span><span class="ocamlLCIdentifier"><a href="environments.ml.html#L52" title="ocaml/ocamltest/environments.ml:52">env</a></span><span class="Statement">)<br/></li>
<li></span><span class="ocamlEnd">&nbsp; </span><span class="Statement">end<br/></li>
<li></span><br/></li>
<li><span class="Statement">let</span> <span class="Statement">_</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="PreProc">Environments</span>.<span class="ocamlLCIdentifier"><a href="environments.ml.html#L160" title="ocaml/ocamltest/environments.ml:160">register_initializer</a></span> <span class="PreProc">Environments</span>.<span class="Constant">Post<br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">&quot;<a href="#L341" title="ocaml/ocamltest/ocaml_actions.ml:341">find_source_modules</a>&quot;</span> <span class="ocamlLCIdentifier"><a href="#L341" title="ocaml/ocamltest/ocaml_actions.ml:341">find_source_modules</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; <span class="PreProc">Environments</span>.<span class="ocamlLCIdentifier"><a href="environments.ml.html#L160" title="ocaml/ocamltest/environments.ml:160">register_initializer</a></span> <span class="PreProc">Environments</span>.<span class="Constant">Pre<br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">&quot;<a href="#L1104" title="ocaml/ocamltest/ocaml_actions.ml:1104">config_variables</a>&quot;</span> <span class="ocamlLCIdentifier"><a href="#L1104" title="ocaml/ocamltest/ocaml_actions.ml:1104">config_variables</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; <span class="PreProc">List</span>.<span class="ocamlLCIdentifier">iter</span> <span class="ocamlLCIdentifier"><a href="actions.mli.html#L34" title="ocaml/ocamltest/actions.mli:34">register</a><br/></li>
<li></span>&nbsp; <span class="Statement">[<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="ocaml_actions.mli.html#L18" title="ocaml/ocamltest/ocaml_actions.mli:18">setup_ocamlc_byte_build_env</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="ocaml_actions.mli.html#L19" title="ocaml/ocamltest/ocaml_actions.mli:19">ocamlc_byte</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="ocaml_actions.mli.html#L20" title="ocaml/ocamltest/ocaml_actions.mli:20">check_ocamlc_byte_output</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="ocaml_actions.mli.html#L21" title="ocaml/ocamltest/ocaml_actions.mli:21">setup_ocamlc_opt_build_env</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="ocaml_actions.mli.html#L22" title="ocaml/ocamltest/ocaml_actions.mli:22">ocamlc_opt</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="ocaml_actions.mli.html#L23" title="ocaml/ocamltest/ocaml_actions.mli:23">check_ocamlc_opt_output</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="ocaml_actions.mli.html#L24" title="ocaml/ocamltest/ocaml_actions.mli:24">setup_ocamlopt_byte_build_env</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="ocaml_actions.mli.html#L25" title="ocaml/ocamltest/ocaml_actions.mli:25">ocamlopt_byte</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="ocaml_actions.mli.html#L26" title="ocaml/ocamltest/ocaml_actions.mli:26">check_ocamlopt_byte_output</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="ocaml_actions.mli.html#L27" title="ocaml/ocamltest/ocaml_actions.mli:27">setup_ocamlopt_opt_build_env</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="ocaml_actions.mli.html#L28" title="ocaml/ocamltest/ocaml_actions.mli:28">ocamlopt_opt</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="ocaml_actions.mli.html#L29" title="ocaml/ocamltest/ocaml_actions.mli:29">check_ocamlopt_opt_output</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="ocaml_actions.mli.html#L30" title="ocaml/ocamltest/ocaml_actions.mli:30">run_expect</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="ocaml_actions.mli.html#L31" title="ocaml/ocamltest/ocaml_actions.mli:31">compare_bytecode_programs</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="filecompare.ml.html#L179" title="ocaml/ocamltest/filecompare.ml:179">compare_binary_files</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="ocaml_actions.mli.html#L33" title="ocaml/ocamltest/ocaml_actions.mli:33">setup_ocaml_build_env</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="ocaml_files.ml.html#L42" title="ocaml/ocamltest/ocaml_files.ml:42">ocaml</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="ocaml_actions.mli.html#L35" title="ocaml/ocamltest/ocaml_actions.mli:35">check_ocaml_output</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="ocaml_actions.mli.html#L36" title="ocaml/ocamltest/ocaml_actions.mli:36">setup_ocamlnat_build_env</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="ocaml_files.ml.html#L54" title="ocaml/ocamltest/ocaml_files.ml:54">ocamlnat</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="ocaml_actions.mli.html#L38" title="ocaml/ocamltest/ocaml_actions.mli:38">check_ocamlnat_output</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="ocaml_actions.mli.html#L44" title="ocaml/ocamltest/ocaml_actions.mli:44">flat_float_array</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="ocaml_actions.mli.html#L45" title="ocaml/ocamltest/ocaml_actions.mli:45">no_flat_float_array</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="ocamltest_config.mli.html#L79" title="ocaml/ocamltest/ocamltest_config.mli:79">flambda</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L1159" title="ocaml/ocamltest/ocaml_actions.ml:1159">no_flambda</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="ocaml_actions.mli.html#L47" title="ocaml/ocamltest/ocaml_actions.mli:47">shared_libraries</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="ocaml_actions.mli.html#L48" title="ocaml/ocamltest/ocaml_actions.mli:48">no_shared_libraries</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="ocaml_actions.mli.html#L50" title="ocaml/ocamltest/ocaml_actions.mli:50">native_compiler</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="ocamltest_config.mli.html#L94" title="ocaml/ocamltest/ocamltest_config.mli:94">native_dynlink</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="ocaml_modifiers.ml.html#L126" title="ocaml/ocamltest/ocaml_modifiers.ml:126">debugger</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="ocamltest_config.mli.html#L125" title="ocaml/ocamltest/ocamltest_config.mli:125">instrumented_runtime</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L1208" title="ocaml/ocamltest/ocaml_actions.ml:1208">csharp_compiler</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="ocamltest_config.mli.html#L119" title="ocaml/ocamltest/ocamltest_config.mli:119">windows_unicode</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="ocaml_actions.mli.html#L52" title="ocaml/ocamltest/ocaml_actions.mli:52">afl_instrument</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="ocaml_actions.mli.html#L53" title="ocaml/ocamltest/ocaml_actions.mli:53">no_afl_instrument</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="ocaml_actions.mli.html#L40" title="ocaml/ocamltest/ocaml_actions.mli:40">setup_ocamldoc_build_env</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="ocaml_actions.mli.html#L41" title="ocaml/ocamltest/ocaml_actions.mli:41">run_ocamldoc</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="ocaml_actions.mli.html#L42" title="ocaml/ocamltest/ocaml_actions.mli:42">check_ocamldoc_output</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="ocaml_files.ml.html#L78" title="ocaml/ocamltest/ocaml_files.ml:78">ocamldebug</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="ocaml_files.ml.html#L86" title="ocaml/ocamltest/ocaml_files.ml:86">ocamlmklib</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="ocaml_files.ml.html#L90" title="ocaml/ocamltest/ocaml_files.ml:90">codegen</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="ocaml_actions.mli.html#L57" title="ocaml/ocamltest/ocaml_actions.mli:57">cc</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="ocaml_files.ml.html#L82" title="ocaml/ocamltest/ocaml_files.ml:82">ocamlobjinfo</a><br/></li>
<li></span>&nbsp; <span class="Statement">]<br/></li>
</ol></span></code>
 <p class="nav-bar">
  <span class="nav-link"><a href="./index.html">One Level Up</a></span>
  <span class="nav-link"><a href="index.html">Top Level</a></span>
 </p>

 </body>
</html>
