<!-- generated by the vscode.pl tool from vscoded.-->

<html>
 <head>
  <title>ocaml/yacc/lr0.c - ocaml</title>
  <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
  <style>
body {
    text-align: left;
    text-align-last: left;
}

.nav-bar {
    font-size: 120%;
    margin-top: 5px;
    margin-bottom: 5px;
}

.nav-link {
    padding-left: 5em;
    padding-right: 5em;
}

ul.toc {
    line-height: 200%;
    font-size: 150%;
}

code {
    font-family: consolas, monospace;
    line-height: 130%;
}

span.Constant {
    color: DarkGreen;
}

span.Special {
    color: #c06000;
}

span.Comment {
    color: DarkRed;
    font-style: italic;
}

span.Identifier {
    color: DarkCyan;
}

span.PreProc {
    color: DarkMagenta;
}

span.Statement, span.Type, span.Keyword, span.Repeat, span.Conditional,
    span.Operator, span.Exception
{
    color: DarkBlue;
}

span.Todo {
    color: DarkRed;
    background-color: Gold;
    font-style: italic;
}

span.Underlined {
    text-decoration: underline;
}

span.linkable {
    font-weight: bold;
}

code ol {
    counter-reset: item;
    list-style-type: none;
    margin-left: 0;
    padding-left: 0;
    list-style-position: inside;
}

code li {
    display: block;
}

code li:before {
    content: counter(item) "  ";
    counter-increment: item;
    color: #999;
    padding-right: 0.5em;
    padding-left: 0.4em;
    list-style-position: inside;
    text-align: right
}

  </style>
 </head>
 <body>
 <p class="nav-bar">
  <span class="nav-link"><a href="./index.html">One Level Up</a></span>
  <span class="nav-link"><a href="index.html">Top Level</a></span>
 </p>

  <h1>ocaml/yacc/lr0.c - ocaml</h1>
 <h2>Global variables defined</h2>
 <ul class="toc">
<li><a href="#L27">first_reduction</a></li>
<li><a href="#L26">first_shift</a></li>
<li><a href="#L25">first_state</a></li>
<li><a href="#L44">kernel_base</a></li>
<li><a href="#L45">kernel_end</a></li>
<li><a href="#L46">kernel_items</a></li>
<li><a href="#L36">last_reduction</a></li>
<li><a href="#L35">last_shift</a></li>
<li><a href="#L34">last_state</a></li>
<li><a href="#L38">nshifts</a></li>
<li><a href="#L24">nstates</a></li>
<li><a href="#L41">redset</a></li>
<li><a href="#L39">shift_symbol</a></li>
<li><a href="#L42">shiftset</a></li>
<li><a href="#L32">state_set</a></li>
<li><a href="#L33">this_state</a></li>
</ul>
 <h2>Functions defined</h2>
 <ul class="toc">
<li><a href="#L57">allocate_itemsets</a></li>
<li><a href="#L99">allocate_storage</a></li>
<li><a href="#L108">append_states</a></li>
<li><a href="#L137">free_storage</a></li>
<li><a href="#L150">generate_states</a></li>
<li><a href="#L178">get_state</a></li>
<li><a href="#L241">initialize_states</a></li>
<li><a href="#L604">lr0</a></li>
<li><a href="#L268">new_itemsets</a></li>
<li><a href="#L305">new_state</a></li>
<li><a href="#L533">print_derives</a></li>
<li><a href="#L453">save_reductions</a></li>
<li><a href="#L419">save_shifts</a></li>
<li><a href="#L502">set_derives</a></li>
<li><a href="#L555">set_nullable</a></li>
<li><a href="#L344">show_cores</a></li>
<li><a href="#L379">show_ritems</a></li>
<li><a href="#L390">show_rrhs</a></li>
<li><a href="#L401">show_shifts</a></li>
</ul>
 <h2>Source code</h2>

  <code><ol><li><span class="Comment">/**************************************************************************/<br/></li>
<li></span><span class="Comment">/*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */<br/></li>
<li></span><span class="Comment">/*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; OCaml&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */<br/></li>
<li></span><span class="Comment">/*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */<br/></li>
<li></span><span class="Comment">/*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; Xavier Leroy, projet Cristal, INRIA Rocquencourt&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; */<br/></li>
<li></span><span class="Comment">/*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */<br/></li>
<li></span><span class="Comment">/*&nbsp;&nbsp; Copyright 1996 Institut National de Recherche en Informatique et&nbsp; &nbsp;&nbsp; */<br/></li>
<li></span><span class="Comment">/*&nbsp; &nbsp;&nbsp; en Automatique.&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */<br/></li>
<li></span><span class="Comment">/*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */<br/></li>
<li></span><span class="Comment">/*&nbsp;&nbsp; All rights reserved.&nbsp; This file is distributed under the terms of&nbsp; &nbsp; */<br/></li>
<li></span><span class="Comment">/*&nbsp;&nbsp; the GNU Lesser General Public License version 2.1, with the&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */<br/></li>
<li></span><span class="Comment">/*&nbsp;&nbsp; special exception on linking described in the file LICENSE.&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */<br/></li>
<li></span><span class="Comment">/*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */<br/></li>
<li></span><span class="Comment">/**************************************************************************/<br/></li>
<li></span><br/></li>
<li><span class="Comment">/* Based on public-domain code from Berkeley Yacc */<br/></li>
<li></span><br/></li>
<li><span class="PreProc">#include </span><span class="Constant">&quot;defs.h&quot;<br/></li>
<li></span><br/></li>
<li><span class="Type">extern</span> <span class="Type">short</span> *<a href="closure.c.html#L20" title="ocaml/yacc/closure.c:20">itemset</a>;<br/></li>
<li><span class="Type">extern</span> <span class="Type">short</span> *<a href="closure.c.html#L21" title="ocaml/yacc/closure.c:21">itemsetend</a>;<br/></li>
<li><span class="Type">extern</span> <span class="Type">unsigned</span> *<a href="closure.c.html#L22" title="ocaml/yacc/closure.c:22">ruleset</a>;<br/></li>
<li><br/></li>
<li><a id="L24">&#x200c;</a><span class="Type">int</span> <span class="linkable">nstates</span>;<br/></li>
<li><a id="L25">&#x200c;</a><a href="defs.h.html#L164" title="ocaml/yacc/defs.h:164">core</a> *<span class="linkable">first_state</span>;<br/></li>
<li><a id="L26">&#x200c;</a><a href="defs.h.html#L178" title="ocaml/yacc/defs.h:178">shifts</a> *<span class="linkable">first_shift</span>;<br/></li>
<li><a id="L27">&#x200c;</a><a href="defs.h.html#L190" title="ocaml/yacc/defs.h:190">reductions</a> *<span class="linkable">first_reduction</span>;<br/></li>
<li><br/></li>
<li><span class="Type">int</span> <a href="#L178" title="ocaml/yacc/lr0.c:178">get_state</a>(<span class="Type">int</span> symbol);<br/></li>
<li><a href="defs.h.html#L164" title="ocaml/yacc/defs.h:164">core</a> *<a href="#L305" title="ocaml/yacc/lr0.c:305">new_state</a>(<span class="Type">int</span> symbol);<br/></li>
<li><br/></li>
<li><a id="L32">&#x200c;</a><span class="Type">static</span> <a href="defs.h.html#L164" title="ocaml/yacc/defs.h:164">core</a> **<span class="linkable">state_set</span>;<br/></li>
<li><a id="L33">&#x200c;</a><span class="Type">static</span> <a href="defs.h.html#L164" title="ocaml/yacc/defs.h:164">core</a> *<span class="linkable">this_state</span>;<br/></li>
<li><a id="L34">&#x200c;</a><span class="Type">static</span> <a href="defs.h.html#L164" title="ocaml/yacc/defs.h:164">core</a> *<span class="linkable">last_state</span>;<br/></li>
<li><a id="L35">&#x200c;</a><span class="Type">static</span> <a href="defs.h.html#L178" title="ocaml/yacc/defs.h:178">shifts</a> *<span class="linkable">last_shift</span>;<br/></li>
<li><a id="L36">&#x200c;</a><span class="Type">static</span> <a href="defs.h.html#L190" title="ocaml/yacc/defs.h:190">reductions</a> *<span class="linkable">last_reduction</span>;<br/></li>
<li><br/></li>
<li><a id="L38">&#x200c;</a><span class="Type">static</span> <span class="Type">int</span> <span class="linkable">nshifts</span>;<br/></li>
<li><a id="L39">&#x200c;</a><span class="Type">static</span> <span class="Type">short</span> *<span class="linkable">shift_symbol</span>;<br/></li>
<li><br/></li>
<li><a id="L41">&#x200c;</a><span class="Type">static</span> <span class="Type">short</span> *<span class="linkable">redset</span>;<br/></li>
<li><a id="L42">&#x200c;</a><span class="Type">static</span> <span class="Type">short</span> *<span class="linkable">shiftset</span>;<br/></li>
<li><br/></li>
<li><a id="L44">&#x200c;</a><span class="Type">static</span> <span class="Type">short</span> **<span class="linkable">kernel_base</span>;<br/></li>
<li><a id="L45">&#x200c;</a><span class="Type">static</span> <span class="Type">short</span> **<span class="linkable">kernel_end</span>;<br/></li>
<li><a id="L46">&#x200c;</a><span class="Type">static</span> <span class="Type">short</span> *<span class="linkable">kernel_items</span>;<br/></li>
<li><br/></li>
<li><br/></li>
<li><br/></li>
<li><span class="Type">void</span> <a href="#L241" title="ocaml/yacc/lr0.c:241">initialize_states</a> (<span class="Type">void</span>);<br/></li>
<li><span class="Type">void</span> <a href="#L453" title="ocaml/yacc/lr0.c:453">save_reductions</a> (<span class="Type">void</span>);<br/></li>
<li><span class="Type">void</span> <a href="#L268" title="ocaml/yacc/lr0.c:268">new_itemsets</a> (<span class="Type">void</span>);<br/></li>
<li><span class="Type">void</span> <a href="#L419" title="ocaml/yacc/lr0.c:419">save_shifts</a> (<span class="Type">void</span>);<br/></li>
<li><span class="Type">void</span> <a href="#L533" title="ocaml/yacc/lr0.c:533">print_derives</a> (<span class="Type">void</span>);<br/></li>
<li><span class="Type">void</span> <a href="#L344" title="ocaml/yacc/lr0.c:344">show_cores</a> (<span class="Type">void</span>), <a href="#L379" title="ocaml/yacc/lr0.c:379">show_ritems</a> (<span class="Type">void</span>), <a href="#L390" title="ocaml/yacc/lr0.c:390">show_rrhs</a> (<span class="Type">void</span>), <a href="#L401" title="ocaml/yacc/lr0.c:401">show_shifts</a> (<span class="Type">void</span>);<br/></li>
<li><br/></li>
<li><a id="L57">&#x200c;</a><span class="Type">static</span> <span class="Type">void</span> <span class="linkable">allocate_itemsets</span>(<span class="Type">void</span>)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <span class="Type">short</span> *itemp;<br/></li>
<li>&nbsp; &nbsp; <span class="Type">short</span> *item_end;<br/></li>
<li>&nbsp; &nbsp; <span class="Type">int</span> symbol;<br/></li>
<li>&nbsp; &nbsp; <span class="Type">int</span> i;<br/></li>
<li>&nbsp; &nbsp; <span class="Type">int</span> count;<br/></li>
<li>&nbsp; &nbsp; <span class="Type">int</span> max;<br/></li>
<li>&nbsp; &nbsp; <span class="Type">short</span> *symbol_count;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; count = <span class="Constant">0</span>;<br/></li>
<li>&nbsp; &nbsp; symbol_count = <a href="defs.h.html#L126" title="ocaml/yacc/defs.h:126">NEW2</a>(<a href="main.c.html#L81" title="ocaml/yacc/main.c:81">nsyms</a>, <span class="Type">short</span>);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; item_end = <a href="main.c.html#L93" title="ocaml/yacc/main.c:93">ritem</a> + <a href="main.c.html#L78" title="ocaml/yacc/main.c:78">nitems</a>;<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">for</span> (itemp = <a href="main.c.html#L93" title="ocaml/yacc/main.c:93">ritem</a>; itemp &lt; item_end; itemp++)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; symbol = *itemp;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (symbol &gt;= <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; count++;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; symbol_count[symbol]++;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="#L44" title="ocaml/yacc/lr0.c:44">kernel_base</a> = <a href="defs.h.html#L126" title="ocaml/yacc/defs.h:126">NEW2</a>(<a href="main.c.html#L81" title="ocaml/yacc/main.c:81">nsyms</a>, <span class="Type">short</span> *);<br/></li>
<li>&nbsp; &nbsp; <a href="#L46" title="ocaml/yacc/lr0.c:46">kernel_items</a> = <a href="defs.h.html#L126" title="ocaml/yacc/defs.h:126">NEW2</a>(count, <span class="Type">short</span>);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; count = <span class="Constant">0</span>;<br/></li>
<li>&nbsp; &nbsp; max = <span class="Constant">0</span>;<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">for</span> (i = <span class="Constant">0</span>; i &lt; <a href="main.c.html#L81" title="ocaml/yacc/main.c:81">nsyms</a>; i++)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L44" title="ocaml/yacc/lr0.c:44">kernel_base</a>[i] = <a href="#L46" title="ocaml/yacc/lr0.c:46">kernel_items</a> + count;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; count += symbol_count[i];<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (max &lt; symbol_count[i])<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; max = symbol_count[i];<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="#L39" title="ocaml/yacc/lr0.c:39">shift_symbol</a> = symbol_count;<br/></li>
<li>&nbsp; &nbsp; <a href="#L45" title="ocaml/yacc/lr0.c:45">kernel_end</a> = <a href="defs.h.html#L126" title="ocaml/yacc/defs.h:126">NEW2</a>(<a href="main.c.html#L81" title="ocaml/yacc/main.c:81">nsyms</a>, <span class="Type">short</span> *);<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><br/></li>
<li><a id="L99">&#x200c;</a><span class="Type">static</span> <span class="Type">void</span> <span class="linkable">allocate_storage</span>(<span class="Type">void</span>)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <a href="#L57" title="ocaml/yacc/lr0.c:57">allocate_itemsets</a>();<br/></li>
<li>&nbsp; &nbsp; <a href="#L42" title="ocaml/yacc/lr0.c:42">shiftset</a> = <a href="defs.h.html#L126" title="ocaml/yacc/defs.h:126">NEW2</a>(<a href="main.c.html#L81" title="ocaml/yacc/main.c:81">nsyms</a>, <span class="Type">short</span>);<br/></li>
<li>&nbsp; &nbsp; <a href="#L41" title="ocaml/yacc/lr0.c:41">redset</a> = <a href="defs.h.html#L126" title="ocaml/yacc/defs.h:126">NEW2</a>(<a href="main.c.html#L79" title="ocaml/yacc/main.c:79">nrules</a> + <span class="Constant">1</span>, <span class="Type">short</span>);<br/></li>
<li>&nbsp; &nbsp; <a href="#L32" title="ocaml/yacc/lr0.c:32">state_set</a> = <a href="defs.h.html#L126" title="ocaml/yacc/defs.h:126">NEW2</a>(<a href="main.c.html#L78" title="ocaml/yacc/main.c:78">nitems</a>, <a href="defs.h.html#L164" title="ocaml/yacc/defs.h:164">core</a> *);<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><br/></li>
<li><a id="L108">&#x200c;</a><span class="Type">static</span> <span class="Type">void</span> <span class="linkable">append_states</span>(<span class="Type">void</span>)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <span class="Type">int</span> i;<br/></li>
<li>&nbsp; &nbsp; <span class="Type">int</span> j;<br/></li>
<li>&nbsp; &nbsp; <span class="Type">int</span> symbol;<br/></li>
<li><br/></li>
<li><span class="PreProc">#ifdef&nbsp; &nbsp; &nbsp; &nbsp; TRACE<br/></li>
<li></span>&nbsp; &nbsp; fprintf(<span class="Constant">stderr</span>, <span class="Constant">&quot;Entering <a href="#L108" title="ocaml/yacc/lr0.c:108">append_states</a>()</span><span class="Special">\n</span><span class="Constant">&quot;</span>);<br/></li>
<li><span class="PreProc">#endif<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">for</span> (i = <span class="Constant">1</span>; i &lt; <a href="#L38" title="ocaml/yacc/lr0.c:38">nshifts</a>; i++)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; symbol = <a href="#L39" title="ocaml/yacc/lr0.c:39">shift_symbol</a>[i];<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; j = i;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">while</span> (j &gt; <span class="Constant">0</span> &amp;&amp; <a href="#L39" title="ocaml/yacc/lr0.c:39">shift_symbol</a>[j - <span class="Constant">1</span>] &gt; symbol)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L39" title="ocaml/yacc/lr0.c:39">shift_symbol</a>[j] = <a href="#L39" title="ocaml/yacc/lr0.c:39">shift_symbol</a>[j - <span class="Constant">1</span>];<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; j--;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L39" title="ocaml/yacc/lr0.c:39">shift_symbol</a>[j] = symbol;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">for</span> (i = <span class="Constant">0</span>; i &lt; <a href="#L38" title="ocaml/yacc/lr0.c:38">nshifts</a>; i++)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; symbol = <a href="#L39" title="ocaml/yacc/lr0.c:39">shift_symbol</a>[i];<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L42" title="ocaml/yacc/lr0.c:42">shiftset</a>[i] = <a href="#L178" title="ocaml/yacc/lr0.c:178">get_state</a>(symbol);<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><br/></li>
<li><a id="L137">&#x200c;</a><span class="Type">static</span> <span class="Type">void</span> <span class="linkable">free_storage</span>(<span class="Type">void</span>)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <a href="defs.h.html#L123" title="ocaml/yacc/defs.h:123">FREE</a>(<a href="#L39" title="ocaml/yacc/lr0.c:39">shift_symbol</a>);<br/></li>
<li>&nbsp; &nbsp; <a href="defs.h.html#L123" title="ocaml/yacc/defs.h:123">FREE</a>(<a href="#L41" title="ocaml/yacc/lr0.c:41">redset</a>);<br/></li>
<li>&nbsp; &nbsp; <a href="defs.h.html#L123" title="ocaml/yacc/defs.h:123">FREE</a>(<a href="#L42" title="ocaml/yacc/lr0.c:42">shiftset</a>);<br/></li>
<li>&nbsp; &nbsp; <a href="defs.h.html#L123" title="ocaml/yacc/defs.h:123">FREE</a>(<a href="#L44" title="ocaml/yacc/lr0.c:44">kernel_base</a>);<br/></li>
<li>&nbsp; &nbsp; <a href="defs.h.html#L123" title="ocaml/yacc/defs.h:123">FREE</a>(<a href="#L45" title="ocaml/yacc/lr0.c:45">kernel_end</a>);<br/></li>
<li>&nbsp; &nbsp; <a href="defs.h.html#L123" title="ocaml/yacc/defs.h:123">FREE</a>(<a href="#L46" title="ocaml/yacc/lr0.c:46">kernel_items</a>);<br/></li>
<li>&nbsp; &nbsp; <a href="defs.h.html#L123" title="ocaml/yacc/defs.h:123">FREE</a>(<a href="#L32" title="ocaml/yacc/lr0.c:32">state_set</a>);<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><br/></li>
<li><br/></li>
<li><a id="L150">&#x200c;</a><span class="Type">static</span> <span class="Type">void</span> <span class="linkable">generate_states</span>(<span class="Type">void</span>)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <a href="#L99" title="ocaml/yacc/lr0.c:99">allocate_storage</a>();<br/></li>
<li>&nbsp; &nbsp; <a href="closure.c.html#L20" title="ocaml/yacc/closure.c:20">itemset</a> = <a href="defs.h.html#L126" title="ocaml/yacc/defs.h:126">NEW2</a>(<a href="main.c.html#L78" title="ocaml/yacc/main.c:78">nitems</a>, <span class="Type">short</span>);<br/></li>
<li>&nbsp; &nbsp; <a href="closure.c.html#L22" title="ocaml/yacc/closure.c:22">ruleset</a> = <a href="defs.h.html#L126" title="ocaml/yacc/defs.h:126">NEW2</a>(<a href="defs.h.html#L53" title="ocaml/yacc/defs.h:53">WORDSIZE</a>(<a href="main.c.html#L79" title="ocaml/yacc/main.c:79">nrules</a>), <span class="Type">unsigned</span>);<br/></li>
<li>&nbsp; &nbsp; <a href="closure.c.html#L69" title="ocaml/yacc/closure.c:69">set_first_derives</a>();<br/></li>
<li>&nbsp; &nbsp; <a href="#L241" title="ocaml/yacc/lr0.c:241">initialize_states</a>();<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">while</span> (<a href="#L33" title="ocaml/yacc/lr0.c:33">this_state</a>)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="closure.c.html#L126" title="ocaml/yacc/closure.c:126">closure</a>(<a href="#L33" title="ocaml/yacc/lr0.c:33">this_state</a>-&gt;items, <a href="#L33" title="ocaml/yacc/lr0.c:33">this_state</a>-&gt;<a href="main.c.html#L78" title="ocaml/yacc/main.c:78">nitems</a>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L453" title="ocaml/yacc/lr0.c:453">save_reductions</a>();<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L268" title="ocaml/yacc/lr0.c:268">new_itemsets</a>();<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L108" title="ocaml/yacc/lr0.c:108">append_states</a>();<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (<a href="#L38" title="ocaml/yacc/lr0.c:38">nshifts</a> &gt; <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L419" title="ocaml/yacc/lr0.c:419">save_shifts</a>();<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L33" title="ocaml/yacc/lr0.c:33">this_state</a> = <a href="#L33" title="ocaml/yacc/lr0.c:33">this_state</a>-&gt;next;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="closure.c.html#L199" title="ocaml/yacc/closure.c:199">finalize_closure</a>();<br/></li>
<li>&nbsp; &nbsp; <a href="#L137" title="ocaml/yacc/lr0.c:137">free_storage</a>();<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><br/></li>
<li><br/></li>
<li><span class="Type">int<br/></li>
<li><a id="L178">&#x200c;</a></span><span class="linkable">get_state</span>(<span class="Type">int</span> symbol)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <span class="Type">int</span> key;<br/></li>
<li>&nbsp; &nbsp; <span class="Type">short</span> *isp1;<br/></li>
<li>&nbsp; &nbsp; <span class="Type">short</span> *isp2;<br/></li>
<li>&nbsp; &nbsp; <span class="Type">short</span> *iend;<br/></li>
<li>&nbsp; &nbsp; <a href="defs.h.html#L164" title="ocaml/yacc/defs.h:164">core</a> *sp;<br/></li>
<li>&nbsp; &nbsp; <span class="Type">int</span> found;<br/></li>
<li>&nbsp; &nbsp; <span class="Type">int</span> n;<br/></li>
<li><br/></li>
<li><span class="PreProc">#ifdef&nbsp; &nbsp; &nbsp; &nbsp; TRACE<br/></li>
<li></span>&nbsp; &nbsp; fprintf(<span class="Constant">stderr</span>, <span class="Constant">&quot;Entering <a href="#L178" title="ocaml/yacc/lr0.c:178">get_state</a>(</span><span class="Special">%d</span><span class="Constant">)</span><span class="Special">\n</span><span class="Constant">&quot;</span>, symbol);<br/></li>
<li><span class="PreProc">#endif<br/></li>
<li></span><br/></li>
<li>&nbsp; &nbsp; isp1 = <a href="#L44" title="ocaml/yacc/lr0.c:44">kernel_base</a>[symbol];<br/></li>
<li>&nbsp; &nbsp; iend = <a href="#L45" title="ocaml/yacc/lr0.c:45">kernel_end</a>[symbol];<br/></li>
<li>&nbsp; &nbsp; n = iend - isp1;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; key = *isp1;<br/></li>
<li>&nbsp; &nbsp; assert(<span class="Constant">0</span> &lt;= key &amp;&amp; key &lt; <a href="main.c.html#L78" title="ocaml/yacc/main.c:78">nitems</a>);<br/></li>
<li>&nbsp; &nbsp; sp = <a href="#L32" title="ocaml/yacc/lr0.c:32">state_set</a>[key];<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (sp)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; found = <span class="Constant">0</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">while</span> (!found)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (sp-&gt;<a href="main.c.html#L78" title="ocaml/yacc/main.c:78">nitems</a> == n)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; found = <span class="Constant">1</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; isp1 = <a href="#L44" title="ocaml/yacc/lr0.c:44">kernel_base</a>[symbol];<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; isp2 = sp-&gt;items;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">while</span> (found &amp;&amp; isp1 &lt; iend)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (*isp1++ != *isp2++)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; found = <span class="Constant">0</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (!found)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (sp-&gt;link)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sp = sp-&gt;link;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sp = sp-&gt;link = <a href="#L305" title="ocaml/yacc/lr0.c:305">new_state</a>(symbol);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; found = <span class="Constant">1</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L32" title="ocaml/yacc/lr0.c:32">state_set</a>[key] = sp = <a href="#L305" title="ocaml/yacc/lr0.c:305">new_state</a>(symbol);<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">return</span> (sp-&gt;number);<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><br/></li>
<li><br/></li>
<li><a id="L241">&#x200c;</a><span class="Type">void</span> <span class="linkable">initialize_states</span>(<span class="Type">void</span>)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <span class="Type">int</span> i;<br/></li>
<li>&nbsp; &nbsp; <span class="Type">short</span> *start_derives;<br/></li>
<li>&nbsp; &nbsp; <a href="defs.h.html#L164" title="ocaml/yacc/defs.h:164">core</a> *p;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; start_derives = <a href="main.c.html#L98" title="ocaml/yacc/main.c:98">derives</a>[<a href="main.c.html#L85" title="ocaml/yacc/main.c:85">start_symbol</a>];<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">for</span> (i = <span class="Constant">0</span>; start_derives[i] &gt;= <span class="Constant">0</span>; ++i)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">continue</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; p = (<a href="defs.h.html#L164" title="ocaml/yacc/defs.h:164">core</a> *) <a href="defs.h.html#L124" title="ocaml/yacc/defs.h:124">MALLOC</a>(<span class="Statement">sizeof</span>(<a href="defs.h.html#L164" title="ocaml/yacc/defs.h:164">core</a>) + i*<span class="Statement">sizeof</span>(<span class="Type">short</span>));<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (p == <span class="Constant">0</span>) <a href="error.c.html#L32" title="ocaml/yacc/error.c:32">no_space</a>();<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; p-&gt;next = <span class="Constant">0</span>;<br/></li>
<li>&nbsp; &nbsp; p-&gt;link = <span class="Constant">0</span>;<br/></li>
<li>&nbsp; &nbsp; p-&gt;number = <span class="Constant">0</span>;<br/></li>
<li>&nbsp; &nbsp; p-&gt;<a href="lalr.c.html#L32" title="ocaml/yacc/lalr.c:32">accessing_symbol</a> = <span class="Constant">0</span>;<br/></li>
<li>&nbsp; &nbsp; p-&gt;<a href="main.c.html#L78" title="ocaml/yacc/main.c:78">nitems</a> = i;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">for</span> (i = <span class="Constant">0</span>;&nbsp; start_derives[i] &gt;= <span class="Constant">0</span>; ++i)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; p-&gt;items[i] = <a href="main.c.html#L95" title="ocaml/yacc/main.c:95">rrhs</a>[start_derives[i]];<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="#L25" title="ocaml/yacc/lr0.c:25">first_state</a> = <a href="#L34" title="ocaml/yacc/lr0.c:34">last_state</a> = <a href="#L33" title="ocaml/yacc/lr0.c:33">this_state</a> = p;<br/></li>
<li>&nbsp; &nbsp; <a href="#L24" title="ocaml/yacc/lr0.c:24">nstates</a> = <span class="Constant">1</span>;<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><br/></li>
<li><a id="L268">&#x200c;</a><span class="Type">void</span> <span class="linkable">new_itemsets</span>(<span class="Type">void</span>)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <span class="Type">int</span> i;<br/></li>
<li>&nbsp; &nbsp; <span class="Type">int</span> shiftcount;<br/></li>
<li>&nbsp; &nbsp; <span class="Type">short</span> *isp;<br/></li>
<li>&nbsp; &nbsp; <span class="Type">short</span> *ksp;<br/></li>
<li>&nbsp; &nbsp; <span class="Type">int</span> symbol;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">for</span> (i = <span class="Constant">0</span>; i &lt; <a href="main.c.html#L81" title="ocaml/yacc/main.c:81">nsyms</a>; i++)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L45" title="ocaml/yacc/lr0.c:45">kernel_end</a>[i] = <span class="Constant">0</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; shiftcount = <span class="Constant">0</span>;<br/></li>
<li>&nbsp; &nbsp; isp = <a href="closure.c.html#L20" title="ocaml/yacc/closure.c:20">itemset</a>;<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">while</span> (isp &lt; <a href="closure.c.html#L21" title="ocaml/yacc/closure.c:21">itemsetend</a>)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; i = *isp++;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; symbol = <a href="main.c.html#L93" title="ocaml/yacc/main.c:93">ritem</a>[i];<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (symbol &gt; <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ksp = <a href="#L45" title="ocaml/yacc/lr0.c:45">kernel_end</a>[symbol];<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (!ksp)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L39" title="ocaml/yacc/lr0.c:39">shift_symbol</a>[shiftcount++] = symbol;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ksp = <a href="#L44" title="ocaml/yacc/lr0.c:44">kernel_base</a>[symbol];<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *ksp++ = i + <span class="Constant">1</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L45" title="ocaml/yacc/lr0.c:45">kernel_end</a>[symbol] = ksp;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="#L38" title="ocaml/yacc/lr0.c:38">nshifts</a> = shiftcount;<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><br/></li>
<li><br/></li>
<li><a href="defs.h.html#L164" title="ocaml/yacc/defs.h:164">core</a> *<br/></li>
<li><a id="L305">&#x200c;</a><span class="linkable">new_state</span>(<span class="Type">int</span> symbol)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <span class="Type">int</span> n;<br/></li>
<li>&nbsp; &nbsp; <a href="defs.h.html#L164" title="ocaml/yacc/defs.h:164">core</a> *p;<br/></li>
<li>&nbsp; &nbsp; <span class="Type">short</span> *isp1;<br/></li>
<li>&nbsp; &nbsp; <span class="Type">short</span> *isp2;<br/></li>
<li>&nbsp; &nbsp; <span class="Type">short</span> *iend;<br/></li>
<li><br/></li>
<li><span class="PreProc">#ifdef&nbsp; &nbsp; &nbsp; &nbsp; TRACE<br/></li>
<li></span>&nbsp; &nbsp; fprintf(<span class="Constant">stderr</span>, <span class="Constant">&quot;Entering <a href="#L305" title="ocaml/yacc/lr0.c:305">new_state</a>(</span><span class="Special">%d</span><span class="Constant">)</span><span class="Special">\n</span><span class="Constant">&quot;</span>, symbol);<br/></li>
<li><span class="PreProc">#endif<br/></li>
<li></span><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (<a href="#L24" title="ocaml/yacc/lr0.c:24">nstates</a> &gt;= <a href="defs.h.html#L48" title="ocaml/yacc/defs.h:48">MAXSHORT</a>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="error.c.html#L25" title="ocaml/yacc/error.c:25">fatal</a>(<span class="Constant">&quot;too many states&quot;</span>);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; isp1 = <a href="#L44" title="ocaml/yacc/lr0.c:44">kernel_base</a>[symbol];<br/></li>
<li>&nbsp; &nbsp; iend = <a href="#L45" title="ocaml/yacc/lr0.c:45">kernel_end</a>[symbol];<br/></li>
<li>&nbsp; &nbsp; n = iend - isp1;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; p = (<a href="defs.h.html#L164" title="ocaml/yacc/defs.h:164">core</a> *) <a href="main.c.html#L270" title="ocaml/yacc/main.c:270">allocate</a>((<span class="Type">unsigned</span>) (<span class="Statement">sizeof</span>(<a href="defs.h.html#L164" title="ocaml/yacc/defs.h:164">core</a>) + (n - <span class="Constant">1</span>) * <span class="Statement">sizeof</span>(<span class="Type">short</span>)));<br/></li>
<li>&nbsp; &nbsp; p-&gt;<a href="lalr.c.html#L32" title="ocaml/yacc/lalr.c:32">accessing_symbol</a> = symbol;<br/></li>
<li>&nbsp; &nbsp; p-&gt;number = <a href="#L24" title="ocaml/yacc/lr0.c:24">nstates</a>;<br/></li>
<li>&nbsp; &nbsp; p-&gt;<a href="main.c.html#L78" title="ocaml/yacc/main.c:78">nitems</a> = n;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; isp2 = p-&gt;items;<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">while</span> (isp1 &lt; iend)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; *isp2++ = *isp1++;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="#L34" title="ocaml/yacc/lr0.c:34">last_state</a>-&gt;next = p;<br/></li>
<li>&nbsp; &nbsp; <a href="#L34" title="ocaml/yacc/lr0.c:34">last_state</a> = p;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="#L24" title="ocaml/yacc/lr0.c:24">nstates</a>++;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">return</span> (p);<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><br/></li>
<li><span class="Comment">/* <a href="#L344" title="ocaml/yacc/lr0.c:344">show_cores</a> is used for debugging */<br/></li>
<li></span><br/></li>
<li><a id="L344">&#x200c;</a><span class="Type">void</span> <span class="linkable">show_cores</span>(<span class="Type">void</span>)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <a href="defs.h.html#L164" title="ocaml/yacc/defs.h:164">core</a> *p;<br/></li>
<li>&nbsp; &nbsp; <span class="Type">int</span> i, j, k, n;<br/></li>
<li>&nbsp; &nbsp; <span class="Type">int</span> itemno;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; k = <span class="Constant">0</span>;<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">for</span> (p = <a href="#L25" title="ocaml/yacc/lr0.c:25">first_state</a>; p; ++k, p = p-&gt;next)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (k) printf(<span class="Constant">&quot;</span><span class="Special">\n</span><span class="Constant">&quot;</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; printf(<span class="Constant">&quot;state </span><span class="Special">%d</span><span class="Constant">, number = </span><span class="Special">%d</span><span class="Constant">, accessing symbol = </span><span class="Special">%s\n</span><span class="Constant">&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; k, p-&gt;number, <a href="main.c.html#L86" title="ocaml/yacc/main.c:86">symbol_name</a>[p-&gt;<a href="lalr.c.html#L32" title="ocaml/yacc/lalr.c:32">accessing_symbol</a>]);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; n = p-&gt;<a href="main.c.html#L78" title="ocaml/yacc/main.c:78">nitems</a>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">for</span> (i = <span class="Constant">0</span>; i &lt; n; ++i)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; itemno = p-&gt;items[i];<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; printf(<span class="Constant">&quot;</span><span class="Special">%4d</span><span class="Constant">&nbsp; &quot;</span>, itemno);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; j = itemno;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">while</span> (<a href="main.c.html#L93" title="ocaml/yacc/main.c:93">ritem</a>[j] &gt;= <span class="Constant">0</span>) ++j;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; printf(<span class="Constant">&quot;</span><span class="Special">%s</span><span class="Constant"> :&quot;</span>, <a href="main.c.html#L86" title="ocaml/yacc/main.c:86">symbol_name</a>[<a href="main.c.html#L94" title="ocaml/yacc/main.c:94">rlhs</a>[-<a href="main.c.html#L93" title="ocaml/yacc/main.c:93">ritem</a>[j]]]);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; j = <a href="main.c.html#L95" title="ocaml/yacc/main.c:95">rrhs</a>[-<a href="main.c.html#L93" title="ocaml/yacc/main.c:93">ritem</a>[j]];<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">while</span> (j &lt; itemno)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; printf(<span class="Constant">&quot; </span><span class="Special">%s</span><span class="Constant">&quot;</span>, <a href="main.c.html#L86" title="ocaml/yacc/main.c:86">symbol_name</a>[<a href="main.c.html#L93" title="ocaml/yacc/main.c:93">ritem</a>[j++]]);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; printf(<span class="Constant">&quot; .&quot;</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">while</span> (<a href="main.c.html#L93" title="ocaml/yacc/main.c:93">ritem</a>[j] &gt;= <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; printf(<span class="Constant">&quot; </span><span class="Special">%s</span><span class="Constant">&quot;</span>, <a href="main.c.html#L86" title="ocaml/yacc/main.c:86">symbol_name</a>[<a href="main.c.html#L93" title="ocaml/yacc/main.c:93">ritem</a>[j++]]);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; printf(<span class="Constant">&quot;</span><span class="Special">\n</span><span class="Constant">&quot;</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; fflush(<span class="Constant">stdout</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><br/></li>
<li><span class="Comment">/* <a href="#L379" title="ocaml/yacc/lr0.c:379">show_ritems</a> is used for debugging */<br/></li>
<li></span><br/></li>
<li><a id="L379">&#x200c;</a><span class="Type">void</span> <span class="linkable">show_ritems</span>(<span class="Type">void</span>)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <span class="Type">int</span> i;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">for</span> (i = <span class="Constant">0</span>; i &lt; <a href="main.c.html#L78" title="ocaml/yacc/main.c:78">nitems</a>; ++i)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; printf(<span class="Constant">&quot;<a href="main.c.html#L93" title="ocaml/yacc/main.c:93">ritem</a>[</span><span class="Special">%d</span><span class="Constant">] = </span><span class="Special">%d\n</span><span class="Constant">&quot;</span>, i, <a href="main.c.html#L93" title="ocaml/yacc/main.c:93">ritem</a>[i]);<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><br/></li>
<li><span class="Comment">/* <a href="#L390" title="ocaml/yacc/lr0.c:390">show_rrhs</a> is used for debugging */<br/></li>
<li></span><br/></li>
<li><a id="L390">&#x200c;</a><span class="Type">void</span> <span class="linkable">show_rrhs</span>(<span class="Type">void</span>)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <span class="Type">int</span> i;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">for</span> (i = <span class="Constant">0</span>; i &lt; <a href="main.c.html#L79" title="ocaml/yacc/main.c:79">nrules</a>; ++i)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; printf(<span class="Constant">&quot;<a href="main.c.html#L95" title="ocaml/yacc/main.c:95">rrhs</a>[</span><span class="Special">%d</span><span class="Constant">] = </span><span class="Special">%d\n</span><span class="Constant">&quot;</span>, i, <a href="main.c.html#L95" title="ocaml/yacc/main.c:95">rrhs</a>[i]);<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><br/></li>
<li><span class="Comment">/* <a href="#L401" title="ocaml/yacc/lr0.c:401">show_shifts</a> is used for debugging */<br/></li>
<li></span><br/></li>
<li><a id="L401">&#x200c;</a><span class="Type">void</span> <span class="linkable">show_shifts</span>(<span class="Type">void</span>)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <a href="defs.h.html#L178" title="ocaml/yacc/defs.h:178">shifts</a> *p;<br/></li>
<li>&nbsp; &nbsp; <span class="Type">int</span> i, j, k;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; k = <span class="Constant">0</span>;<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">for</span> (p = <a href="#L26" title="ocaml/yacc/lr0.c:26">first_shift</a>; p; ++k, p = p-&gt;next)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (k) printf(<span class="Constant">&quot;</span><span class="Special">\n</span><span class="Constant">&quot;</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; printf(<span class="Constant">&quot;shift </span><span class="Special">%d</span><span class="Constant">, number = </span><span class="Special">%d</span><span class="Constant">, <a href="#L38" title="ocaml/yacc/lr0.c:38">nshifts</a> = </span><span class="Special">%d\n</span><span class="Constant">&quot;</span>, k, p-&gt;number,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p-&gt;<a href="#L38" title="ocaml/yacc/lr0.c:38">nshifts</a>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; j = p-&gt;<a href="#L38" title="ocaml/yacc/lr0.c:38">nshifts</a>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">for</span> (i = <span class="Constant">0</span>; i &lt; j; ++i)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; printf(<span class="Constant">&quot;</span><span class="Special">\t%d\n</span><span class="Constant">&quot;</span>, p-&gt;shift[i]);<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><br/></li>
<li><a id="L419">&#x200c;</a><span class="Type">void</span> <span class="linkable">save_shifts</span>(<span class="Type">void</span>)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <a href="defs.h.html#L178" title="ocaml/yacc/defs.h:178">shifts</a> *p;<br/></li>
<li>&nbsp; &nbsp; <span class="Type">short</span> *sp1;<br/></li>
<li>&nbsp; &nbsp; <span class="Type">short</span> *sp2;<br/></li>
<li>&nbsp; &nbsp; <span class="Type">short</span> *send;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; p = (<a href="defs.h.html#L178" title="ocaml/yacc/defs.h:178">shifts</a> *) <a href="main.c.html#L270" title="ocaml/yacc/main.c:270">allocate</a>((<span class="Type">unsigned</span>) (<span class="Statement">sizeof</span>(<a href="defs.h.html#L178" title="ocaml/yacc/defs.h:178">shifts</a>) +<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (<a href="#L38" title="ocaml/yacc/lr0.c:38">nshifts</a> - <span class="Constant">1</span>) * <span class="Statement">sizeof</span>(<span class="Type">short</span>)));<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; p-&gt;number = <a href="#L33" title="ocaml/yacc/lr0.c:33">this_state</a>-&gt;number;<br/></li>
<li>&nbsp; &nbsp; p-&gt;<a href="#L38" title="ocaml/yacc/lr0.c:38">nshifts</a> = <a href="#L38" title="ocaml/yacc/lr0.c:38">nshifts</a>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; sp1 = <a href="#L42" title="ocaml/yacc/lr0.c:42">shiftset</a>;<br/></li>
<li>&nbsp; &nbsp; sp2 = p-&gt;shift;<br/></li>
<li>&nbsp; &nbsp; send = <a href="#L42" title="ocaml/yacc/lr0.c:42">shiftset</a> + <a href="#L38" title="ocaml/yacc/lr0.c:38">nshifts</a>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">while</span> (sp1 &lt; send)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; *sp2++ = *sp1++;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (<a href="#L35" title="ocaml/yacc/lr0.c:35">last_shift</a>)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L35" title="ocaml/yacc/lr0.c:35">last_shift</a>-&gt;next = p;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L35" title="ocaml/yacc/lr0.c:35">last_shift</a> = p;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L26" title="ocaml/yacc/lr0.c:26">first_shift</a> = p;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L35" title="ocaml/yacc/lr0.c:35">last_shift</a> = p;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><br/></li>
<li><br/></li>
<li><a id="L453">&#x200c;</a><span class="Type">void</span> <span class="linkable">save_reductions</span>(<span class="Type">void</span>)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <span class="Type">short</span> *isp;<br/></li>
<li>&nbsp; &nbsp; <span class="Type">short</span> *rp1;<br/></li>
<li>&nbsp; &nbsp; <span class="Type">short</span> *rp2;<br/></li>
<li>&nbsp; &nbsp; <span class="Type">int</span> item;<br/></li>
<li>&nbsp; &nbsp; <span class="Type">int</span> count;<br/></li>
<li>&nbsp; &nbsp; <a href="defs.h.html#L190" title="ocaml/yacc/defs.h:190">reductions</a> *p;<br/></li>
<li>&nbsp; &nbsp; <span class="Type">short</span> *rend;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; count = <span class="Constant">0</span>;<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">for</span> (isp = <a href="closure.c.html#L20" title="ocaml/yacc/closure.c:20">itemset</a>; isp &lt; <a href="closure.c.html#L21" title="ocaml/yacc/closure.c:21">itemsetend</a>; isp++)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; item = <a href="main.c.html#L93" title="ocaml/yacc/main.c:93">ritem</a>[*isp];<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (item &lt; <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L41" title="ocaml/yacc/lr0.c:41">redset</a>[count++] = -item;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (count)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; p = (<a href="defs.h.html#L190" title="ocaml/yacc/defs.h:190">reductions</a> *) <a href="main.c.html#L270" title="ocaml/yacc/main.c:270">allocate</a>((<span class="Type">unsigned</span>) (<span class="Statement">sizeof</span>(<a href="defs.h.html#L190" title="ocaml/yacc/defs.h:190">reductions</a>) +<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (count - <span class="Constant">1</span>) * <span class="Statement">sizeof</span>(<span class="Type">short</span>)));<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; p-&gt;number = <a href="#L33" title="ocaml/yacc/lr0.c:33">this_state</a>-&gt;number;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; p-&gt;nreds = count;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; rp1 = <a href="#L41" title="ocaml/yacc/lr0.c:41">redset</a>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; rp2 = p-&gt;rules;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; rend = rp1 + count;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">while</span> (rp1 &lt; rend)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *rp2++ = *rp1++;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (<a href="#L36" title="ocaml/yacc/lr0.c:36">last_reduction</a>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L36" title="ocaml/yacc/lr0.c:36">last_reduction</a>-&gt;next = p;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L36" title="ocaml/yacc/lr0.c:36">last_reduction</a> = p;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L27" title="ocaml/yacc/lr0.c:27">first_reduction</a> = p;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L36" title="ocaml/yacc/lr0.c:36">last_reduction</a> = p;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><br/></li>
<li><a id="L502">&#x200c;</a><span class="Type">static</span> <span class="Type">void</span> <span class="linkable">set_derives</span>(<span class="Type">void</span>)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <span class="Type">int</span> i, k;<br/></li>
<li>&nbsp; &nbsp; <span class="Type">int</span> lhs;<br/></li>
<li>&nbsp; &nbsp; <span class="Type">short</span> *rules;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="main.c.html#L98" title="ocaml/yacc/main.c:98">derives</a> = <a href="defs.h.html#L126" title="ocaml/yacc/defs.h:126">NEW2</a>(<a href="main.c.html#L81" title="ocaml/yacc/main.c:81">nsyms</a>, <span class="Type">short</span> *);<br/></li>
<li>&nbsp; &nbsp; rules = <a href="defs.h.html#L126" title="ocaml/yacc/defs.h:126">NEW2</a>(<a href="main.c.html#L83" title="ocaml/yacc/main.c:83">nvars</a> + <a href="main.c.html#L79" title="ocaml/yacc/main.c:79">nrules</a>, <span class="Type">short</span>);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; k = <span class="Constant">0</span>;<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">for</span> (lhs = <a href="main.c.html#L85" title="ocaml/yacc/main.c:85">start_symbol</a>; lhs &lt; <a href="main.c.html#L81" title="ocaml/yacc/main.c:81">nsyms</a>; lhs++)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="main.c.html#L98" title="ocaml/yacc/main.c:98">derives</a>[lhs] = rules + k;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">for</span> (i = <span class="Constant">0</span>; i &lt; <a href="main.c.html#L79" title="ocaml/yacc/main.c:79">nrules</a>; i++)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (<a href="main.c.html#L94" title="ocaml/yacc/main.c:94">rlhs</a>[i] == lhs)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; rules[k] = i;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; k++;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; rules[k] = -<span class="Constant">1</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; k++;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li><span class="PreProc">#ifdef&nbsp; &nbsp; &nbsp; &nbsp; DEBUG<br/></li>
<li></span>&nbsp; &nbsp; <a href="#L533" title="ocaml/yacc/lr0.c:533">print_derives</a>();<br/></li>
<li><span class="PreProc">#endif<br/></li>
<li></span>}<br/></li>
<li><br/></li>
<li><span class="PreProc">#ifdef&nbsp; &nbsp; &nbsp; &nbsp; DEBUG<br/></li>
<li><a id="L533">&#x200c;</a></span><span class="Type">void</span> <span class="linkable">print_derives</span>(<span class="Type">void</span>)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <span class="Type">int</span> i;<br/></li>
<li>&nbsp; &nbsp; <span class="Type">short</span> *sp;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; printf(<span class="Constant">&quot;</span><span class="Special">\n</span><span class="Constant">DERIVES</span><span class="Special">\n\n</span><span class="Constant">&quot;</span>);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">for</span> (i = <a href="main.c.html#L85" title="ocaml/yacc/main.c:85">start_symbol</a>; i &lt; <a href="main.c.html#L81" title="ocaml/yacc/main.c:81">nsyms</a>; i++)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; printf(<span class="Constant">&quot;</span><span class="Special">%s</span><span class="Constant"> <a href="main.c.html#L98" title="ocaml/yacc/main.c:98">derives</a> &quot;</span>, <a href="main.c.html#L86" title="ocaml/yacc/main.c:86">symbol_name</a>[i]);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">for</span> (sp = <a href="main.c.html#L98" title="ocaml/yacc/main.c:98">derives</a>[i]; *sp &gt;= <span class="Constant">0</span>; sp++)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; printf(<span class="Constant">&quot;&nbsp; </span><span class="Special">%d</span><span class="Constant">&quot;</span>, *sp);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; putchar(<span class="Special">'\n'</span>);<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; putchar(<span class="Special">'\n'</span>);<br/></li>
<li>}<br/></li>
<li><span class="PreProc">#endif<br/></li>
<li></span><br/></li>
<li><br/></li>
<li><a id="L555">&#x200c;</a><span class="Type">static</span> <span class="Type">void</span> <span class="linkable">set_nullable</span>(<span class="Type">void</span>)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <span class="Type">int</span> i, j;<br/></li>
<li>&nbsp; &nbsp; <span class="Type">int</span> empty;<br/></li>
<li>&nbsp; &nbsp; <span class="Type">int</span> <a href="main.c.html#L102" title="ocaml/yacc/main.c:102">done</a>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="main.c.html#L99" title="ocaml/yacc/main.c:99">nullable</a> = <a href="defs.h.html#L124" title="ocaml/yacc/defs.h:124">MALLOC</a>(<a href="main.c.html#L81" title="ocaml/yacc/main.c:81">nsyms</a>);<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (<a href="main.c.html#L99" title="ocaml/yacc/main.c:99">nullable</a> == <span class="Constant">0</span>) <a href="error.c.html#L32" title="ocaml/yacc/error.c:32">no_space</a>();<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">for</span> (i = <span class="Constant">0</span>; i &lt; <a href="main.c.html#L81" title="ocaml/yacc/main.c:81">nsyms</a>; ++i)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="main.c.html#L99" title="ocaml/yacc/main.c:99">nullable</a>[i] = <span class="Constant">0</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="main.c.html#L102" title="ocaml/yacc/main.c:102">done</a> = <span class="Constant">0</span>;<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">while</span> (!<a href="main.c.html#L102" title="ocaml/yacc/main.c:102">done</a>)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="main.c.html#L102" title="ocaml/yacc/main.c:102">done</a> = <span class="Constant">1</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">for</span> (i = <span class="Constant">1</span>; i &lt; <a href="main.c.html#L78" title="ocaml/yacc/main.c:78">nitems</a>; i++)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; empty = <span class="Constant">1</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">while</span> ((j = <a href="main.c.html#L93" title="ocaml/yacc/main.c:93">ritem</a>[i]) &gt;= <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (!<a href="main.c.html#L99" title="ocaml/yacc/main.c:99">nullable</a>[j])<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; empty = <span class="Constant">0</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ++i;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (empty)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; j = <a href="main.c.html#L94" title="ocaml/yacc/main.c:94">rlhs</a>[-j];<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (!<a href="main.c.html#L99" title="ocaml/yacc/main.c:99">nullable</a>[j])<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="main.c.html#L99" title="ocaml/yacc/main.c:99">nullable</a>[j] = <span class="Constant">1</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="main.c.html#L102" title="ocaml/yacc/main.c:102">done</a> = <span class="Constant">0</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li><span class="PreProc">#ifdef DEBUG<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">for</span> (i = <span class="Constant">0</span>; i &lt; <a href="main.c.html#L81" title="ocaml/yacc/main.c:81">nsyms</a>; i++)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (<a href="main.c.html#L99" title="ocaml/yacc/main.c:99">nullable</a>[i])<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; printf(<span class="Constant">&quot;</span><span class="Special">%s</span><span class="Constant"> is <a href="main.c.html#L99" title="ocaml/yacc/main.c:99">nullable</a></span><span class="Special">\n</span><span class="Constant">&quot;</span>, <a href="main.c.html#L86" title="ocaml/yacc/main.c:86">symbol_name</a>[i]);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; printf(<span class="Constant">&quot;</span><span class="Special">%s</span><span class="Constant"> is not <a href="main.c.html#L99" title="ocaml/yacc/main.c:99">nullable</a></span><span class="Special">\n</span><span class="Constant">&quot;</span>, <a href="main.c.html#L86" title="ocaml/yacc/main.c:86">symbol_name</a>[i]);<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><span class="PreProc">#endif<br/></li>
<li></span>}<br/></li>
<li><br/></li>
<li><br/></li>
<li><a id="L604">&#x200c;</a><span class="Type">void</span> <span class="linkable">lr0</span>(<span class="Type">void</span>)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <a href="#L502" title="ocaml/yacc/lr0.c:502">set_derives</a>();<br/></li>
<li>&nbsp; &nbsp; <a href="#L555" title="ocaml/yacc/lr0.c:555">set_nullable</a>();<br/></li>
<li>&nbsp; &nbsp; <a href="#L150" title="ocaml/yacc/lr0.c:150">generate_states</a>();<br/></li>
<li>}<br/></li>
</ol></code>
 <p class="nav-bar">
  <span class="nav-link"><a href="./index.html">One Level Up</a></span>
  <span class="nav-link"><a href="index.html">Top Level</a></span>
 </p>

 </body>
</html>
