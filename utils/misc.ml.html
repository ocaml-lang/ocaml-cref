<!-- generated by the vscode.pl tool from vscoded.-->

<html>
 <head>
  <title>ocaml/utils/misc.ml - ocaml</title>
  <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
  <style>
body {
    text-align: left;
    text-align-last: left;
}

.nav-bar {
    font-size: 120%;
    margin-top: 5px;
    margin-bottom: 5px;
}

.nav-link {
    padding-left: 5em;
    padding-right: 5em;
}

ul.toc {
    line-height: 200%;
    font-size: 150%;
}

code {
    font-family: consolas, monospace;
    line-height: 130%;
}

span.Constant {
    color: DarkGreen;
}

span.Special {
    color: #c06000;
}

span.Comment {
    color: DarkRed;
    font-style: italic;
}

span.Identifier {
    color: DarkCyan;
}

span.PreProc {
    color: DarkMagenta;
}

span.Statement, span.Type, span.Keyword, span.Repeat, span.Conditional,
    span.Operator, span.Exception
{
    color: DarkBlue;
}

span.Todo {
    color: DarkRed;
    background-color: Gold;
    font-style: italic;
}

span.Underlined {
    text-decoration: underline;
}

span.linkable {
    font-weight: bold;
}

code ol {
    counter-reset: item;
    list-style-type: none;
    margin-left: 0;
    padding-left: 0;
    list-style-position: inside;
}

code li {
    display: block;
}

code li:before {
    content: counter(item) "  ";
    counter-increment: item;
    color: #999;
    padding-right: 0.5em;
    padding-left: 0.4em;
    list-style-position: inside;
    text-align: right
}

  </style>
 </head>
 <body>
 <p class="nav-bar">
  <span class="nav-link"><a href="./index.html">One Level Up</a></span>
  <span class="nav-link"><a href="index.html">Top Level</a></span>
 </p>

  <h1>ocaml/utils/misc.ml - ocaml</h1>
 <h2>Global variables defined</h2>
 <ul class="toc">
<li><a href="#L1153">actual</a></li>
<li><a href="#L575">best</a></li>
<li><a href="#L579">best</a></li>
<li><a href="#L1148">check_current</a></li>
<li><a href="#L437">chop_extensions</a></li>
<li><a href="#L433">concat_null_terminated</a></li>
<li><a href="#L313">copy</a></li>
<li><a href="#L318">copy_file_chunk</a></li>
<li><a href="#L304">create_hashtable</a></li>
<li><a href="#L1092">current_raw</a></li>
<li><a href="#L1128">current_version</a></li>
<li><a href="#L633">cut_at</a></li>
<li><a href="#L885">debug_prefix_map_flags</a></li>
<li><a href="#L795">delete_eol_spaces</a></li>
<li><a href="#L618">did_you_mean</a></li>
<li><a href="#L553">edit_distance</a></li>
<li><a href="#L287">expand_directory</a></li>
<li><a href="#L1138">explain_unexpected_error</a></li>
<li><a href="#L20">fatal_errorf</a></li>
<li><a href="#L237">find_in_path</a></li>
<li><a href="#L265">find_in_path_uncap</a></li>
<li><a href="#L498">for4</a></li>
<li><a href="#L221">for_all</a></li>
<li><a href="#L77">for_all2</a></li>
<li><a href="#L491">fst3</a></li>
<li><a href="#L495">fst4</a></li>
<li><a href="#L867">get_build_path_prefix_map</a></li>
<li><a href="#L482">get_ref</a></li>
<li><a href="#L1117">len</a></li>
<li><a href="#L86">list_remove</a></li>
<li><a href="#L73">map_left_right</a></li>
<li><a href="#L788">normalise_eol</a></li>
<li><a href="#L637">ordinal_suffix</a></li>
<li><a href="#L336">output_to_file_via_temporary</a></li>
<li><a href="#L293">path_separator</a></li>
<li><a href="#L827">pp_two_columns</a></li>
<li><a href="#L228">print</a></li>
<li><a href="#L59">protect_refs</a></li>
<li><a href="#L361">protect_writing_to_file</a></li>
<li><a href="#L1089">raw</a></li>
<li><a href="#L1116">raw_kind</a></li>
<li><a href="#L1163">read_current_info</a></li>
<li><a href="#L1081">read_info</a></li>
<li><a href="#L1113">reference</a></li>
<li><a href="#L277">remove_file</a></li>
<li><a href="#L456">replace_substring</a></li>
<li><a href="#L83">replicate_list</a></li>
<li><a href="#L592">result</a></li>
<li><a href="#L467">rev_split_words</a></li>
<li><a href="#L448">search_substring</a></li>
<li><a href="#L486">set_or_ignore</a></li>
<li><a href="#L849">show_config_and_exit</a></li>
<li><a href="#L853">show_config_variable_and_exit</a></li>
<li><a href="#L492">snd3</a></li>
<li><a href="#L496">snd4</a></li>
<li><a href="#L598">spellcheck</a></li>
<li><a href="#L91">split_last</a></li>
<li><a href="#L426">split_null_terminated</a></li>
<li><a href="#L298">split_path_contents</a></li>
<li><a href="#L1074">starts_as</a></li>
<li><a href="#L824">stop</a></li>
<li><a href="#L327">string_of_file</a></li>
<li><a href="#L1073">sub_length</a></li>
<li><a href="#L493">thd3</a></li>
<li><a href="#L497">thd4</a></li>
</ul>
 <h2>Data types defined</h2>
 <ul class="toc">
<li><a href="#L919">alerts</a></li>
<li><a href="#L917">crcs</a></li>
<li><a href="#L1159">error</a></li>
<li><a href="#L915">filepath</a></li>
<li><a href="#L916">modname</a></li>
<li><a href="#L57">ref_and_value</a></li>
<li><a href="#L1133">unexpected</a></li>
<li><a href="#L1134">unexpected_error</a></li>
</ul>
 <h2>Functions defined</h2>
 <ul class="toc">
<li><a href="#L1167">~</a></li>
</ul>
 <h2>Source code</h2>

  <code><ol><li><span class="Comment">(**************************************************************************)<br/></li>
<li></span><span class="Comment">(*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *)<br/></li>
<li></span><span class="Comment">(*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; OCaml&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *)<br/></li>
<li></span><span class="Comment">(*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *)<br/></li>
<li></span><span class="Comment">(*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; Xavier Leroy, projet Cristal, INRIA Rocquencourt&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; *)<br/></li>
<li></span><span class="Comment">(*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *)<br/></li>
<li></span><span class="Comment">(*&nbsp;&nbsp; Copyright 1996 Institut National de Recherche en Informatique et&nbsp; &nbsp;&nbsp; *)<br/></li>
<li></span><span class="Comment">(*&nbsp; &nbsp;&nbsp; en Automatique.&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *)<br/></li>
<li></span><span class="Comment">(*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *)<br/></li>
<li></span><span class="Comment">(*&nbsp;&nbsp; All rights reserved.&nbsp; This <a href="profile.mli.html#L23" title="ocaml/utils/profile.mli:23">file</a> is distributed under the terms of&nbsp; &nbsp; *)<br/></li>
<li></span><span class="Comment">(*&nbsp;&nbsp; the GNU Lesser General Public License <a href="config.common.ml.html#L20" title="ocaml/utils/config.common.ml:20">version</a> 2.1, with the&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *)<br/></li>
<li></span><span class="Comment">(*&nbsp;&nbsp; special exception on linking described in the <a href="profile.mli.html#L23" title="ocaml/utils/profile.mli:23">file</a> LICENSE.&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *)<br/></li>
<li></span><span class="Comment">(*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *)<br/></li>
<li></span><span class="Comment">(**************************************************************************)<br/></li>
<li></span><br/></li>
<li><span class="Comment">(* Errors *)<br/></li>
<li></span><br/></li>
<li><span class="Statement">exception</span> <span class="Constant">Fatal_error<br/></li>
<li></span><br/></li>
<li><a id="L20">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">fatal_errorf</span></span> <span class="ocamlLCIdentifier">fmt</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="PreProc">Format</span>.<span class="ocamlLCIdentifier">kfprintf<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">(fun</span> <span class="Statement">_</span> <span class="Statement">-&gt;</span> <span class="Statement">raise</span> <span class="Constant">Fatal_error</span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Format</span>.<span class="ocamlLCIdentifier">err_formatter<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">(</span><span class="Constant">&quot;@?&gt;&gt; Fatal <a href="binutils.mli.html#L16" title="ocaml/utils/binutils.mli:16">error</a>: &quot;</span> <span class="Statement">^^</span> <span class="ocamlLCIdentifier">fmt</span> <span class="Statement">^^</span> <span class="Constant">&quot;@.&quot;</span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li><span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="misc.mli.html#L25" title="ocaml/utils/misc.mli:25">fatal_error</a></span> <span class="ocamlLCIdentifier">msg</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="#L20" title="ocaml/utils/misc.ml:20">fatal_errorf</a></span> <span class="Constant">&quot;%<a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a>&quot;</span> <span class="ocamlLCIdentifier">msg<br/></li>
<li></span><br/></li>
<li><span class="Comment">(* Exceptions *)<br/></li>
<li></span><br/></li>
<li><span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="misc.mli.html#L36" title="ocaml/utils/misc.mli:36">try_finally</a></span> <span class="Statement">?(</span><span class="Identifier">always</span><span class="Statement">=(fun</span> <span class="Constant">()</span> <span class="Statement">-&gt;</span> <span class="Constant">()</span><span class="Statement">))</span> <span class="Statement">?(</span><span class="Identifier">exceptionally</span><span class="Statement">=(fun</span> <span class="Constant">()</span> <span class="Statement">-&gt;</span> <span class="Constant">()</span><span class="Statement">))</span> <span class="ocamlLCIdentifier">work</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">match</span> <span class="ocamlLCIdentifier">work</span> <span class="Constant">()</span> <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="ocamlLCIdentifier"><a href="#L592" title="ocaml/utils/misc.ml:592">result</a></span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">begin</span><span class="ocamlEnd"> </span><span class="Statement">match</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">always</span><span class="ocamlEnd"> </span><span class="Constant">()</span><span class="ocamlEnd"> </span><span class="Statement">with<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Constant">()</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L592" title="ocaml/utils/misc.ml:592">result</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Statement">exception</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">always_exn</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">always_bt</span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="PreProc">Printexc</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">get_raw_backtrace</span><span class="ocamlEnd"> </span><span class="Constant">()</span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier">exceptionally</span><span class="ocamlEnd"> </span><span class="Constant">()</span><span class="Statement">;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="PreProc">Printexc</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">raise_with_backtrace</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">always_exn</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">always_bt<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">end<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Statement">exception</span> <span class="ocamlLCIdentifier">work_exn</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">work_bt</span> <span class="Statement">=</span> <span class="PreProc">Printexc</span>.<span class="ocamlLCIdentifier">get_raw_backtrace</span> <span class="Constant">()</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">begin</span><span class="ocamlEnd"> </span><span class="Statement">match</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">always</span><span class="ocamlEnd"> </span><span class="Constant">()</span><span class="ocamlEnd"> </span><span class="Statement">with<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Constant">()</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier">exceptionally</span><span class="ocamlEnd"> </span><span class="Constant">()</span><span class="Statement">;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="PreProc">Printexc</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">raise_with_backtrace</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">work_exn</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">work_bt<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Statement">exception</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">always_exn</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">always_bt</span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="PreProc">Printexc</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">get_raw_backtrace</span><span class="ocamlEnd"> </span><span class="Constant">()</span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier">exceptionally</span><span class="ocamlEnd"> </span><span class="Constant">()</span><span class="Statement">;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="PreProc">Printexc</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">raise_with_backtrace</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">always_exn</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">always_bt<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">end<br/></li>
<li></span><br/></li>
<li><span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="misc.mli.html#L71" title="ocaml/utils/misc.mli:71">reraise_preserving_backtrace</a></span> <span class="ocamlLCIdentifier">e</span> <span class="ocamlLCIdentifier">f</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">bt</span> <span class="Statement">=</span> <span class="PreProc">Printexc</span>.<span class="ocamlLCIdentifier">get_raw_backtrace</span> <span class="Constant">()</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier">f</span> <span class="Constant">()</span><span class="Statement">;<br/></li>
<li></span>&nbsp; <span class="PreProc">Printexc</span>.<span class="ocamlLCIdentifier">raise_with_backtrace</span> <span class="ocamlLCIdentifier">e</span> <span class="ocamlLCIdentifier">bt<br/></li>
<li></span><br/></li>
<li><a id="L57">&#x200c;</a><span class="Statement">type</span> <span class="ocamlLCIdentifier"><span class="linkable">ref_and_value</span></span> <span class="Statement">=</span> <span class="Constant">R</span> : '<span class="ocamlLCIdentifier">a</span> <span class="ocamlLCIdentifier">ref</span> <span class="Statement">*</span> '<span class="ocamlLCIdentifier">a</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier"><span class="linkable">ref_and_value</span><br/></li>
<li></span><br/></li>
<li><a id="L59">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">protect_refs</span></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">set_refs</span> <span class="ocamlLCIdentifier">l</span> <span class="Statement">=</span> <span class="PreProc">List</span>.<span class="ocamlLCIdentifier">iter</span> <span class="Statement">(fun</span> <span class="Statement">(</span><span class="Constant">R</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">r</span>, <span class="ocamlLCIdentifier">v</span><span class="Statement">))</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier">r</span> <span class="Statement">:=</span> <span class="ocamlLCIdentifier">v</span><span class="Statement">)</span> <span class="ocamlLCIdentifier">l</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">fun</span> <span class="ocamlLCIdentifier">refs</span> <span class="ocamlLCIdentifier">f</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="terminfo.mli.html#L30" title="ocaml/utils/terminfo.mli:30">backup</a></span> <span class="Statement">=</span> <span class="PreProc">List</span>.<span class="ocamlLCIdentifier"><a href="identifiable.ml.html#L37" title="ocaml/utils/identifiable.ml:37">map</a></span> <span class="Statement">(fun</span> <span class="Statement">(</span><span class="Constant">R</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">r</span>, <span class="Statement">_))</span> <span class="Statement">-&gt;</span> <span class="Constant">R</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">r</span>, <span class="Statement">!</span><span class="ocamlLCIdentifier">r</span><span class="Statement">))</span> <span class="ocamlLCIdentifier">refs</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier">set_refs</span> <span class="ocamlLCIdentifier">refs</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Fun</span>.<span class="ocamlLCIdentifier">protect</span> <span class="Statement">~</span><span class="Identifier">finally</span>:<span class="Statement">(fun</span> <span class="Constant">()</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier">set_refs</span> <span class="ocamlLCIdentifier"><a href="terminfo.mli.html#L30" title="ocaml/utils/terminfo.mli:30">backup</a></span><span class="Statement">)</span> <span class="ocamlLCIdentifier">f<br/></li>
<li></span><br/></li>
<li><span class="Comment">(* List functions *)<br/></li>
<li></span><br/></li>
<li><span class="Statement">let</span> <span class="Statement">rec</span> <span class="ocamlLCIdentifier"><a href="misc.mli.html#L77" title="ocaml/utils/misc.mli:77">map_end</a></span> <span class="ocamlLCIdentifier">f</span> <span class="ocamlLCIdentifier">l1</span> <span class="ocamlLCIdentifier">l2</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">match</span> <span class="ocamlLCIdentifier">l1</span> <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">[]</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier">l2<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="ocamlLCIdentifier">hd</span><span class="Statement">::</span><span class="ocamlLCIdentifier">tl</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier">f</span> <span class="ocamlLCIdentifier">hd</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier"><a href="misc.mli.html#L77" title="ocaml/utils/misc.mli:77">map_end</a></span> <span class="ocamlLCIdentifier">f</span> <span class="ocamlLCIdentifier">tl</span> <span class="ocamlLCIdentifier">l2<br/></li>
<li></span><br/></li>
<li><a id="L73">&#x200c;</a><span class="Statement">let</span> <span class="Statement">rec</span> <span class="ocamlLCIdentifier"><span class="linkable">map_left_right</span></span> <span class="ocamlLCIdentifier">f</span> <span class="Statement">=</span> <span class="Statement">function<br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">[]</span> <span class="Statement">-&gt;</span> <span class="Constant">[]<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="ocamlLCIdentifier">hd</span><span class="Statement">::</span><span class="ocamlLCIdentifier">tl</span> <span class="Statement">-&gt;</span> <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="diffing.ml.html#L250" title="ocaml/utils/diffing.ml:250">res</a></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">f</span> <span class="ocamlLCIdentifier">hd</span> <span class="Statement">in</span> <span class="ocamlLCIdentifier"><a href="diffing.ml.html#L250" title="ocaml/utils/diffing.ml:250">res</a></span> <span class="Statement">::</span> <span class="ocamlLCIdentifier"><a href="#L73" title="ocaml/utils/misc.ml:73">map_left_right</a></span> <span class="ocamlLCIdentifier">f</span> <span class="ocamlLCIdentifier">tl<br/></li>
<li></span><br/></li>
<li><a id="L77">&#x200c;</a><span class="Statement">let</span> <span class="Statement">rec</span> <span class="ocamlLCIdentifier"><span class="linkable">for_all2</span></span> <span class="ocamlLCIdentifier"><a href="targetint.mli.html#L81" title="ocaml/utils/targetint.mli:81">pred</a></span> <span class="ocamlLCIdentifier">l1</span> <span class="ocamlLCIdentifier">l2</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">match</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">l1</span>, <span class="ocamlLCIdentifier">l2</span><span class="Statement">)</span> <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">(</span><span class="Constant">[]</span>, <span class="Constant">[]</span><span class="Statement">)</span> <span class="Statement">-&gt;</span> <span class="Constant">true<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">hd1</span><span class="Statement">::</span><span class="ocamlLCIdentifier">tl1</span>, <span class="ocamlLCIdentifier">hd2</span><span class="Statement">::</span><span class="ocamlLCIdentifier">tl2</span><span class="Statement">)</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier"><a href="targetint.mli.html#L81" title="ocaml/utils/targetint.mli:81">pred</a></span> <span class="ocamlLCIdentifier">hd1</span> <span class="ocamlLCIdentifier">hd2</span> <span class="Statement">&amp;&amp;</span> <span class="ocamlLCIdentifier"><a href="#L77" title="ocaml/utils/misc.ml:77">for_all2</a></span> <span class="ocamlLCIdentifier"><a href="targetint.mli.html#L81" title="ocaml/utils/targetint.mli:81">pred</a></span> <span class="ocamlLCIdentifier">tl1</span> <span class="ocamlLCIdentifier">tl2<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Statement">(_</span>, <span class="Statement">_)</span> <span class="Statement">-&gt;</span> <span class="Constant">false<br/></li>
<li></span><br/></li>
<li><a id="L83">&#x200c;</a><span class="Statement">let</span> <span class="Statement">rec</span> <span class="ocamlLCIdentifier"><span class="linkable">replicate_list</span></span> <span class="ocamlLCIdentifier">elem</span> <span class="ocamlLCIdentifier">n</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">n</span><span class="ocamlNone"> </span><span class="Statement">&lt;=</span><span class="ocamlNone"> </span><span class="Constant">0</span><span class="ocamlNone"> </span><span class="Statement">then</span> <span class="Constant">[]</span> <span class="Statement">else</span> <span class="ocamlLCIdentifier">elem</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier"><a href="#L83" title="ocaml/utils/misc.ml:83">replicate_list</a></span> <span class="ocamlLCIdentifier">elem</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">n</span>-<span class="Constant">1</span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li><a id="L86">&#x200c;</a><span class="Statement">let</span> <span class="Statement">rec</span> <span class="ocamlLCIdentifier"><span class="linkable">list_remove</span></span> <span class="ocamlLCIdentifier">x</span> <span class="Statement">=</span> <span class="Statement">function<br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">[]</span> <span class="Statement">-&gt;</span> <span class="Constant">[]<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="ocamlLCIdentifier">hd</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier">tl</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">hd</span><span class="ocamlNone"> </span><span class="Statement">=</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">x</span><span class="ocamlNone"> </span><span class="Statement">then</span> <span class="ocamlLCIdentifier">tl</span> <span class="Statement">else</span> <span class="ocamlLCIdentifier">hd</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier"><a href="#L86" title="ocaml/utils/misc.ml:86">list_remove</a></span> <span class="ocamlLCIdentifier">x</span> <span class="ocamlLCIdentifier">tl<br/></li>
<li></span><br/></li>
<li><a id="L91">&#x200c;</a><span class="Statement">let</span> <span class="Statement">rec</span> <span class="ocamlLCIdentifier"><span class="linkable">split_last</span></span> <span class="Statement">=</span> <span class="Statement">function<br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">[]</span> <span class="Statement">-&gt;</span> <span class="Statement">assert</span> <span class="Constant">false<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Statement">[</span><span class="ocamlLCIdentifier">x</span><span class="Statement">]</span> <span class="Statement">-&gt;</span> <span class="Statement">(</span><span class="Constant">[]</span>, <span class="ocamlLCIdentifier">x</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="ocamlLCIdentifier">hd</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier">tl</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">lst</span>, <span class="ocamlLCIdentifier">last</span><span class="Statement">)</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="#L91" title="ocaml/utils/misc.ml:91">split_last</a></span> <span class="ocamlLCIdentifier">tl</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="ocamlLCIdentifier">hd</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier">lst</span>, <span class="ocamlLCIdentifier">last</span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li><span class="Statement">module</span><span class="PreProc"> Stdlib</span><span class="ocamlPreDef"> </span><span class="Statement">=</span> <span class="PreProc">struct<br/></li>
<li></span><span class="ocamlStruct">&nbsp; </span><span class="Statement">module</span><span class="PreProc"> List</span><span class="ocamlPreDef"> </span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="PreProc">struct<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">type</span><span class="ocamlStruct"> '</span><span class="ocamlLCIdentifier">a</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="lazy_backtrack.mli.html#L16" title="ocaml/utils/lazy_backtrack.mli:16">t</a></span><span class="ocamlStruct"> </span><span class="Statement">=</span><span class="ocamlStruct"> '</span><span class="ocamlLCIdentifier">a</span><span class="ocamlStruct"> </span><span class="Type">list<br/></li>
<li></span><br/></li>
<li><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="Statement">rec</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="identifiable.ml.html#L90" title="ocaml/utils/identifiable.ml:90">compare</a></span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">cmp</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">l1</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">l2</span><span class="ocamlStruct"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; </span><span class="Statement">match</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">l1</span><span class="ocamlStruct">, </span><span class="ocamlLCIdentifier">l2</span><span class="ocamlStruct"> </span><span class="Statement">with<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">[]</span><span class="ocamlStruct">, </span><span class="Constant">[]</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="Constant">0<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">[]</span><span class="ocamlStruct">, </span><span class="Statement">_::_</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> -</span><span class="Constant">1<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Statement">_::_</span><span class="ocamlStruct">, </span><span class="Constant">[]</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="Constant">1<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">h1</span><span class="Statement">::</span><span class="ocamlLCIdentifier">t1</span><span class="ocamlStruct">, </span><span class="ocamlLCIdentifier">h2</span><span class="Statement">::</span><span class="ocamlLCIdentifier">t2</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">c</span><span class="ocamlStruct"> </span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">cmp</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">h1</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">h2</span><span class="ocamlStruct"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">c</span><span class="ocamlNone"> </span><span class="Statement">&lt;&gt;</span><span class="ocamlNone"> </span><span class="Constant">0</span><span class="ocamlNone"> </span><span class="Statement">then</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">c<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">else</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="identifiable.ml.html#L90" title="ocaml/utils/identifiable.ml:90">compare</a></span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">cmp</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">t1</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">t2<br/></li>
<li></span><br/></li>
<li><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="Statement">rec</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="identifiable.ml.html#L97" title="ocaml/utils/identifiable.ml:97">equal</a></span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">eq</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">l1</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">l2</span><span class="ocamlStruct"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; </span><span class="Statement">match</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">l1</span><span class="ocamlStruct">, </span><span class="ocamlLCIdentifier">l2</span><span class="ocamlStruct"> </span><span class="Statement">with<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Statement">(</span><span class="Constant">[]</span><span class="ocamlStruct">, </span><span class="Constant">[]</span><span class="Statement">)</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="Constant">true<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">hd1</span><span class="ocamlStruct"> </span><span class="Statement">::</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">tl1</span><span class="ocamlStruct">, </span><span class="ocamlLCIdentifier">hd2</span><span class="ocamlStruct"> </span><span class="Statement">::</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">tl2</span><span class="Statement">)</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">eq</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">hd1</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">hd2</span><span class="ocamlStruct"> </span><span class="Statement">&amp;&amp;</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="identifiable.ml.html#L97" title="ocaml/utils/identifiable.ml:97">equal</a></span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">eq</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">tl1</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">tl2<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Statement">(_</span><span class="ocamlStruct">, </span><span class="Statement">_)</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="Constant">false<br/></li>
<li></span><br/></li>
<li><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">map2_prefix</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">f</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">l1</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">l2</span><span class="ocamlStruct"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="Statement">rec</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="strongly_connected_components.ml.html#L44" title="ocaml/utils/strongly_connected_components.ml:44">aux</a></span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="arg_helper.ml.html#L95" title="ocaml/utils/arg_helper.ml:95">acc</a></span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">l1</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">l2</span><span class="ocamlStruct"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">match</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">l1</span><span class="ocamlStruct">, </span><span class="ocamlLCIdentifier">l2</span><span class="ocamlStruct"> </span><span class="Statement">with<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">[]</span><span class="ocamlStruct">, </span><span class="Statement">_</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="Statement">(</span><span class="PreProc">List</span><span class="ocamlStruct">.</span><span class="ocamlLCIdentifier">rev</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="arg_helper.ml.html#L95" title="ocaml/utils/arg_helper.ml:95">acc</a></span><span class="ocamlStruct">, </span><span class="ocamlLCIdentifier">l2</span><span class="Statement">)<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Statement">_</span><span class="ocamlStruct"> </span><span class="Statement">::</span><span class="ocamlStruct"> </span><span class="Statement">_</span><span class="ocamlStruct">, </span><span class="Constant">[]</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="Statement">raise</span><span class="ocamlStruct"> </span><span class="Statement">(</span><span class="Constant">Invalid_argument</span><span class="ocamlStruct"> </span><span class="Constant">&quot;map2_prefix&quot;</span><span class="Statement">)<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">h1</span><span class="Statement">::</span><span class="ocamlLCIdentifier">t1</span><span class="ocamlStruct">, </span><span class="ocamlLCIdentifier">h2</span><span class="Statement">::</span><span class="ocamlLCIdentifier">t2</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">h</span><span class="ocamlStruct"> </span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">f</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">h1</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">h2</span><span class="ocamlStruct"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="strongly_connected_components.ml.html#L44" title="ocaml/utils/strongly_connected_components.ml:44">aux</a></span><span class="ocamlStruct"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">h</span><span class="ocamlStruct"> </span><span class="Statement">::</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="arg_helper.ml.html#L95" title="ocaml/utils/arg_helper.ml:95">acc</a></span><span class="Statement">)</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">t1</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">t2<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="strongly_connected_components.ml.html#L44" title="ocaml/utils/strongly_connected_components.ml:44">aux</a></span><span class="ocamlStruct"> </span><span class="Constant">[]</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">l1</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">l2<br/></li>
<li></span><br/></li>
<li><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">some_if_all_elements_are_some</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">l</span><span class="ocamlStruct"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="Statement">rec</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="strongly_connected_components.ml.html#L44" title="ocaml/utils/strongly_connected_components.ml:44">aux</a></span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="arg_helper.ml.html#L95" title="ocaml/utils/arg_helper.ml:95">acc</a></span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">l</span><span class="ocamlStruct"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">match</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">l</span><span class="ocamlStruct"> </span><span class="Statement">with<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">[]</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="Constant">Some</span><span class="ocamlStruct"> </span><span class="Statement">(</span><span class="PreProc">List</span><span class="ocamlStruct">.</span><span class="ocamlLCIdentifier">rev</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="arg_helper.ml.html#L95" title="ocaml/utils/arg_helper.ml:95">acc</a></span><span class="Statement">)<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">None</span><span class="ocamlStruct"> </span><span class="Statement">::</span><span class="ocamlStruct"> </span><span class="Statement">_</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="Constant">None<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Some</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">h</span><span class="ocamlStruct"> </span><span class="Statement">::</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="lazy_backtrack.mli.html#L16" title="ocaml/utils/lazy_backtrack.mli:16">t</a></span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="strongly_connected_components.ml.html#L44" title="ocaml/utils/strongly_connected_components.ml:44">aux</a></span><span class="ocamlStruct"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">h</span><span class="ocamlStruct"> </span><span class="Statement">::</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="arg_helper.ml.html#L95" title="ocaml/utils/arg_helper.ml:95">acc</a></span><span class="Statement">)</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="lazy_backtrack.mli.html#L16" title="ocaml/utils/lazy_backtrack.mli:16">t</a><br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="strongly_connected_components.ml.html#L44" title="ocaml/utils/strongly_connected_components.ml:44">aux</a></span><span class="ocamlStruct"> </span><span class="Constant">[]</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">l<br/></li>
<li></span><br/></li>
<li><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">split_at</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">n</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">l</span><span class="ocamlStruct"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="Statement">rec</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="strongly_connected_components.ml.html#L44" title="ocaml/utils/strongly_connected_components.ml:44">aux</a></span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">n</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="arg_helper.ml.html#L95" title="ocaml/utils/arg_helper.ml:95">acc</a></span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">l</span><span class="ocamlStruct"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">n</span><span class="ocamlNone"> </span><span class="Statement">=</span><span class="ocamlNone"> </span><span class="Constant">0<br/></li>
<li></span><span class="ocamlNone">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">then</span><span class="ocamlStruct"> </span><span class="PreProc">List</span><span class="ocamlStruct">.</span><span class="ocamlLCIdentifier">rev</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="arg_helper.ml.html#L95" title="ocaml/utils/arg_helper.ml:95">acc</a></span><span class="ocamlStruct">, </span><span class="ocamlLCIdentifier">l<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">else<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">match</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">l</span><span class="ocamlStruct"> </span><span class="Statement">with<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">[]</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="Statement">raise</span><span class="ocamlStruct"> </span><span class="Statement">(</span><span class="Constant">Invalid_argument</span><span class="ocamlStruct"> </span><span class="Constant">&quot;split_at&quot;</span><span class="Statement">)<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="lazy_backtrack.mli.html#L16" title="ocaml/utils/lazy_backtrack.mli:16">t</a></span><span class="Statement">::</span><span class="ocamlLCIdentifier">q</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="strongly_connected_components.ml.html#L44" title="ocaml/utils/strongly_connected_components.ml:44">aux</a></span><span class="ocamlStruct"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">n</span><span class="ocamlStruct">-</span><span class="Constant">1</span><span class="Statement">)</span><span class="ocamlStruct"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="lazy_backtrack.mli.html#L16" title="ocaml/utils/lazy_backtrack.mli:16">t</a></span><span class="Statement">::</span><span class="ocamlLCIdentifier"><a href="arg_helper.ml.html#L95" title="ocaml/utils/arg_helper.ml:95">acc</a></span><span class="Statement">)</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">q<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="strongly_connected_components.ml.html#L44" title="ocaml/utils/strongly_connected_components.ml:44">aux</a></span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">n</span><span class="ocamlStruct"> </span><span class="Constant">[]</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">l<br/></li>
<li></span><br/></li>
<li><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="Statement">rec</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">is_prefix</span><span class="ocamlStruct"> </span><span class="Statement">~</span><span class="Identifier"><a href="identifiable.ml.html#L97" title="ocaml/utils/identifiable.ml:97">equal</a></span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="lazy_backtrack.mli.html#L16" title="ocaml/utils/lazy_backtrack.mli:16">t</a></span><span class="ocamlStruct"> </span><span class="Statement">~</span><span class="Identifier">of_</span><span class="ocamlStruct"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; </span><span class="Statement">match</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="lazy_backtrack.mli.html#L16" title="ocaml/utils/lazy_backtrack.mli:16">t</a></span><span class="ocamlStruct">, </span><span class="ocamlLCIdentifier">of_</span><span class="ocamlStruct"> </span><span class="Statement">with<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">[]</span><span class="ocamlStruct">, </span><span class="Constant">[]</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="Constant">true<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Statement">_::_</span><span class="ocamlStruct">, </span><span class="Constant">[]</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="Constant">false<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">[]</span><span class="ocamlStruct">, </span><span class="Statement">_::_</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="Constant">true<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">x1</span><span class="Statement">::</span><span class="ocamlLCIdentifier"><a href="lazy_backtrack.mli.html#L16" title="ocaml/utils/lazy_backtrack.mli:16">t</a></span><span class="ocamlStruct">, </span><span class="ocamlLCIdentifier">x2</span><span class="Statement">::</span><span class="ocamlLCIdentifier">of_</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="identifiable.ml.html#L97" title="ocaml/utils/identifiable.ml:97">equal</a></span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">x1</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">x2</span><span class="ocamlStruct"> </span><span class="Statement">&amp;&amp;</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">is_prefix</span><span class="ocamlStruct"> </span><span class="Statement">~</span><span class="Identifier"><a href="identifiable.ml.html#L97" title="ocaml/utils/identifiable.ml:97">equal</a></span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="lazy_backtrack.mli.html#L16" title="ocaml/utils/lazy_backtrack.mli:16">t</a></span><span class="ocamlStruct"> </span><span class="Statement">~</span><span class="Identifier">of_<br/></li>
<li></span><br/></li>
<li><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">type</span><span class="ocamlStruct"> '</span><span class="ocamlLCIdentifier">a</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">longest_common_prefix_result</span><span class="ocamlStruct"> </span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="Statement">{<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier">longest_common_prefix</span><span class="ocamlStruct"> : '</span><span class="ocamlLCIdentifier">a</span><span class="ocamlStruct"> </span><span class="Type">list</span><span class="Statement">;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier">first_without_longest_common_prefix</span><span class="ocamlStruct"> : '</span><span class="ocamlLCIdentifier">a</span><span class="ocamlStruct"> </span><span class="Type">list</span><span class="Statement">;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier">second_without_longest_common_prefix</span><span class="ocamlStruct"> : '</span><span class="ocamlLCIdentifier">a</span><span class="ocamlStruct"> </span><span class="Type">list</span><span class="Statement">;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">}<br/></li>
<li></span><br/></li>
<li><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">find_and_chop_longest_common_prefix</span><span class="ocamlStruct"> </span><span class="Statement">~</span><span class="Identifier"><a href="identifiable.ml.html#L97" title="ocaml/utils/identifiable.ml:97">equal</a></span><span class="ocamlStruct"> </span><span class="Statement">~</span><span class="Identifier">first</span><span class="ocamlStruct"> </span><span class="Statement">~</span><span class="Identifier">second</span><span class="ocamlStruct"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="Statement">rec</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">find_prefix</span><span class="ocamlStruct"> </span><span class="Statement">~</span><span class="Identifier">longest_common_prefix_rev</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">l1</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">l2</span><span class="ocamlStruct"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">match</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">l1</span><span class="ocamlStruct">, </span><span class="ocamlLCIdentifier">l2</span><span class="ocamlStruct"> </span><span class="Statement">with<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">elt1</span><span class="ocamlStruct"> </span><span class="Statement">::</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">l1</span><span class="ocamlStruct">, </span><span class="ocamlLCIdentifier">elt2</span><span class="ocamlStruct"> </span><span class="Statement">::</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">l2</span><span class="ocamlStruct"> </span><span class="Statement">when</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="identifiable.ml.html#L97" title="ocaml/utils/identifiable.ml:97">equal</a></span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">elt1</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">elt2</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">longest_common_prefix_rev</span><span class="ocamlStruct"> </span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">elt1</span><span class="ocamlStruct"> </span><span class="Statement">::</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">longest_common_prefix_rev</span><span class="ocamlStruct"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier">find_prefix</span><span class="ocamlStruct"> </span><span class="Statement">~</span><span class="Identifier">longest_common_prefix_rev</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">l1</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">l2<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">l1</span><span class="ocamlStruct">, </span><span class="ocamlLCIdentifier">l2</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">{</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">longest_common_prefix</span><span class="ocamlStruct"> </span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="PreProc">List</span><span class="ocamlStruct">.</span><span class="ocamlLCIdentifier">rev</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">longest_common_prefix_rev</span><span class="Statement">;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier">first_without_longest_common_prefix</span><span class="ocamlStruct"> </span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">l1</span><span class="Statement">;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier">second_without_longest_common_prefix</span><span class="ocamlStruct"> </span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">l2</span><span class="Statement">;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">}<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier">find_prefix</span><span class="ocamlStruct"> </span><span class="Statement">~</span><span class="Identifier">longest_common_prefix_rev</span><span class="ocamlStruct">:</span><span class="Constant">[]</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">first</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">second<br/></li>
<li></span><span class="ocamlStruct">&nbsp; </span><span class="PreProc">end<br/></li>
<li></span><br/></li>
<li><span class="ocamlStruct">&nbsp; </span><span class="Statement">module</span><span class="PreProc"> Option</span><span class="ocamlPreDef"> </span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="PreProc">struct<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">type</span><span class="ocamlStruct"> '</span><span class="ocamlLCIdentifier">a</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="lazy_backtrack.mli.html#L16" title="ocaml/utils/lazy_backtrack.mli:16">t</a></span><span class="ocamlStruct"> </span><span class="Statement">=</span><span class="ocamlStruct"> '</span><span class="ocamlLCIdentifier">a</span><span class="ocamlStruct"> </span><span class="Type">option<br/></li>
<li></span><br/></li>
<li><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="identifiable.ml.html#L24" title="ocaml/utils/identifiable.ml:24">print</a></span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">print_contents</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">ppf</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="lazy_backtrack.mli.html#L16" title="ocaml/utils/lazy_backtrack.mli:16">t</a></span><span class="ocamlStruct"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; </span><span class="Statement">match</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="lazy_backtrack.mli.html#L16" title="ocaml/utils/lazy_backtrack.mli:16">t</a></span><span class="ocamlStruct"> </span><span class="Statement">with<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">None</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="PreProc">Format</span><span class="ocamlStruct">.</span><span class="ocamlLCIdentifier">pp_print_string</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">ppf</span><span class="ocamlStruct"> </span><span class="Constant">&quot;None&quot;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Some</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">contents</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="PreProc">Format</span><span class="ocamlStruct">.</span><span class="ocamlLCIdentifier">fprintf</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">ppf</span><span class="ocamlStruct"> </span><span class="Constant">&quot;@[(Some@ %a)@]&quot;</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">print_contents</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">contents<br/></li>
<li></span><span class="ocamlStruct">&nbsp; </span><span class="PreProc">end<br/></li>
<li></span><br/></li>
<li><span class="ocamlStruct">&nbsp; </span><span class="Statement">module</span><span class="PreProc"> Array</span><span class="ocamlPreDef"> </span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="PreProc">struct<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">exists2</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">p</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">a1</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">a2</span><span class="ocamlStruct"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">n</span><span class="ocamlStruct"> </span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="PreProc">Array</span><span class="ocamlStruct">.</span><span class="ocamlLCIdentifier"><a href="arg_helper.ml.html#L77" title="ocaml/utils/arg_helper.ml:77">length</a></span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">a1</span><span class="ocamlStruct"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; </span><span class="Statement">if</span><span class="ocamlNone"> </span><span class="PreProc">Array</span><span class="ocamlNone">.</span><span class="ocamlLCIdentifier"><a href="arg_helper.ml.html#L77" title="ocaml/utils/arg_helper.ml:77">length</a></span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">a2</span><span class="ocamlNone"> </span><span class="Statement">&lt;&gt;</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">n</span><span class="ocamlNone"> </span><span class="Statement">then</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">invalid_arg</span><span class="ocamlStruct"> </span><span class="Constant">&quot;Misc.Stdlib.Array.exists2&quot;</span><span class="Statement">;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="Statement">rec</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="profile.ml.html#L290" title="ocaml/utils/profile.ml:290">loop</a></span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">i</span><span class="ocamlStruct"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">i</span><span class="ocamlNone"> </span><span class="Statement">=</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">n</span><span class="ocamlNone"> </span><span class="Statement">then</span><span class="ocamlStruct"> </span><span class="Constant">false<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">else</span><span class="ocamlStruct"> </span><span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">p</span><span class="ocamlNone"> </span><span class="Statement">(</span><span class="PreProc">Array</span><span class="ocamlNone">.</span><span class="ocamlLCIdentifier">unsafe_get</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">a1</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">i</span><span class="Statement">)</span><span class="ocamlNone"> </span><span class="Statement">(</span><span class="PreProc">Array</span><span class="ocamlNone">.</span><span class="ocamlLCIdentifier">unsafe_get</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">a2</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">i</span><span class="Statement">)</span><span class="ocamlNone"> </span><span class="Statement">then</span><span class="ocamlStruct"> </span><span class="Constant">true<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">else</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="profile.ml.html#L290" title="ocaml/utils/profile.ml:290">loop</a></span><span class="ocamlStruct"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="targetint.mli.html#L77" title="ocaml/utils/targetint.mli:77">succ</a></span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">i</span><span class="Statement">)</span><span class="ocamlStruct"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="profile.ml.html#L290" title="ocaml/utils/profile.ml:290">loop</a></span><span class="ocamlStruct"> </span><span class="Constant">0<br/></li>
<li></span><br/></li>
<li><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">for_alli</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">p</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">a</span><span class="ocamlStruct"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">n</span><span class="ocamlStruct"> </span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="PreProc">Array</span><span class="ocamlStruct">.</span><span class="ocamlLCIdentifier"><a href="arg_helper.ml.html#L77" title="ocaml/utils/arg_helper.ml:77">length</a></span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">a</span><span class="ocamlStruct"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="Statement">rec</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="profile.ml.html#L290" title="ocaml/utils/profile.ml:290">loop</a></span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">i</span><span class="ocamlStruct"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">i</span><span class="ocamlNone"> </span><span class="Statement">=</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">n</span><span class="ocamlNone"> </span><span class="Statement">then</span><span class="ocamlStruct"> </span><span class="Constant">true<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">else</span><span class="ocamlStruct"> </span><span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">p</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">i</span><span class="ocamlNone"> </span><span class="Statement">(</span><span class="PreProc">Array</span><span class="ocamlNone">.</span><span class="ocamlLCIdentifier">unsafe_get</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">a</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">i</span><span class="Statement">)</span><span class="ocamlNone"> </span><span class="Statement">then</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="profile.ml.html#L290" title="ocaml/utils/profile.ml:290">loop</a></span><span class="ocamlStruct"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="targetint.mli.html#L77" title="ocaml/utils/targetint.mli:77">succ</a></span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">i</span><span class="Statement">)<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">else</span><span class="ocamlStruct"> </span><span class="Constant">false</span><span class="ocamlStruct"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="profile.ml.html#L290" title="ocaml/utils/profile.ml:290">loop</a></span><span class="ocamlStruct"> </span><span class="Constant">0<br/></li>
<li></span><br/></li>
<li><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">all_somes</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">a</span><span class="ocamlStruct"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; </span><span class="Statement">try<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Constant">Some</span><span class="ocamlStruct"> </span><span class="Statement">(</span><span class="PreProc">Array</span><span class="ocamlStruct">.</span><span class="ocamlLCIdentifier"><a href="identifiable.ml.html#L37" title="ocaml/utils/identifiable.ml:37">map</a></span><span class="ocamlStruct"> </span><span class="Statement">(function</span><span class="ocamlStruct"> </span><span class="Constant">None</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">raise_notrace</span><span class="ocamlStruct"> </span><span class="Constant">Exit</span><span class="ocamlStruct"> </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Some</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">x</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">x</span><span class="Statement">)</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">a</span><span class="Statement">)<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; </span><span class="Statement">with<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Exit</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="Constant">None<br/></li>
<li></span><span class="ocamlStruct">&nbsp; </span><span class="PreProc">end<br/></li>
<li></span><br/></li>
<li><span class="ocamlStruct">&nbsp; </span><span class="Statement">module</span><span class="PreProc"> String</span><span class="ocamlPreDef"> </span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="PreProc">struct<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">include</span><span class="ocamlStruct"> </span><span class="PreProc">String<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">module</span><span class="PreProc"> Set</span><span class="ocamlPreDef"> </span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="PreProc">Set.Make</span><span class="ocamlFuncWith">(</span><span class="PreProc">String</span><span class="ocamlFuncWith">)<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">module</span><span class="PreProc"> Map</span><span class="ocamlPreDef"> </span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="PreProc">Map.Make</span><span class="ocamlFuncWith">(</span><span class="PreProc">String</span><span class="ocamlFuncWith">)<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">module</span><span class="PreProc"> Tbl</span><span class="ocamlPreDef"> </span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="PreProc">Hashtbl.Make</span><span class="ocamlFuncWith">(</span><span class="PreProc">struct<br/></li>
<li></span><span class="ocamlFuncStruct">&nbsp; &nbsp; &nbsp; </span><span class="Statement">include</span><span class="ocamlFuncStruct"> </span><span class="PreProc">String<br/></li>
<li></span><span class="ocamlFuncStruct">&nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlFuncStruct"> </span><span class="ocamlLCIdentifier"><a href="identifiable.ml.html#L96" title="ocaml/utils/identifiable.ml:96">hash</a></span><span class="ocamlFuncStruct"> </span><span class="Statement">=</span><span class="ocamlFuncStruct"> </span><span class="PreProc">Hashtbl</span><span class="ocamlFuncStruct">.</span><span class="ocamlLCIdentifier"><a href="identifiable.ml.html#L96" title="ocaml/utils/identifiable.ml:96">hash</a><br/></li>
<li></span><span class="ocamlFuncStruct">&nbsp; &nbsp; </span><span class="PreProc">end</span><span class="ocamlFuncWith">)<br/></li>
<li></span><br/></li>
<li><a id="L221">&#x200c;</a><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><span class="linkable">for_all</span></span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">f</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="lazy_backtrack.mli.html#L16" title="ocaml/utils/lazy_backtrack.mli:16">t</a></span><span class="ocamlStruct"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="#L1117" title="ocaml/utils/misc.ml:1117">len</a></span><span class="ocamlStruct"> </span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="PreProc">String</span><span class="ocamlStruct">.</span><span class="ocamlLCIdentifier"><a href="arg_helper.ml.html#L77" title="ocaml/utils/arg_helper.ml:77">length</a></span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="lazy_backtrack.mli.html#L16" title="ocaml/utils/lazy_backtrack.mli:16">t</a></span><span class="ocamlStruct"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="Statement">rec</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="profile.ml.html#L290" title="ocaml/utils/profile.ml:290">loop</a></span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">i</span><span class="ocamlStruct"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier">i</span><span class="ocamlStruct"> </span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="#L1117" title="ocaml/utils/misc.ml:1117">len</a></span><span class="ocamlStruct"> </span><span class="Statement">||</span><span class="ocamlStruct"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">f</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="lazy_backtrack.mli.html#L16" title="ocaml/utils/lazy_backtrack.mli:16">t</a></span><span class="ocamlStruct">.</span><span class="Statement">[</span><span class="ocamlLCIdentifier">i</span><span class="Statement">]</span><span class="ocamlStruct"> </span><span class="Statement">&amp;&amp;</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="profile.ml.html#L290" title="ocaml/utils/profile.ml:290">loop</a></span><span class="ocamlStruct"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">i</span><span class="ocamlStruct"> + </span><span class="Constant">1</span><span class="Statement">))<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="profile.ml.html#L290" title="ocaml/utils/profile.ml:290">loop</a></span><span class="ocamlStruct"> </span><span class="Constant">0<br/></li>
<li></span><br/></li>
<li><a id="L228">&#x200c;</a><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><span class="linkable">print</span></span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">ppf</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="lazy_backtrack.mli.html#L16" title="ocaml/utils/lazy_backtrack.mli:16">t</a></span><span class="ocamlStruct"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; </span><span class="PreProc">Format</span><span class="ocamlStruct">.</span><span class="ocamlLCIdentifier">pp_print_string</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">ppf</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="lazy_backtrack.mli.html#L16" title="ocaml/utils/lazy_backtrack.mli:16">t</a><br/></li>
<li></span><span class="ocamlStruct">&nbsp; </span><span class="PreProc">end<br/></li>
<li></span><br/></li>
<li><span class="ocamlStruct">&nbsp; </span><span class="Statement">external</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="identifiable.ml.html#L90" title="ocaml/utils/identifiable.ml:90">compare</a></span><span class="ocamlStruct"> : '</span><span class="ocamlLCIdentifier">a</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> '</span><span class="ocamlLCIdentifier">a</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="Type">int</span><span class="ocamlStruct"> </span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="Constant">&quot;%<a href="identifiable.ml.html#L90" title="ocaml/utils/identifiable.ml:90">compare</a>&quot;<br/></li>
<li></span><span class="PreProc">end<br/></li>
<li></span><br/></li>
<li><span class="Comment">(* File functions *)<br/></li>
<li></span><br/></li>
<li><a id="L237">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">find_in_path</span></span> <span class="ocamlLCIdentifier"><a href="build_path_prefix_map.ml.html#L16" title="ocaml/utils/build_path_prefix_map.ml:16">path</a></span> <span class="ocamlLCIdentifier">name</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="Statement">not</span><span class="ocamlNone"> </span><span class="Statement">(</span><span class="PreProc">Filename</span><span class="ocamlNone">.</span><span class="ocamlLCIdentifier">is_implicit</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">name</span><span class="Statement">)</span><span class="ocamlNone"> </span><span class="Statement">then<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="PreProc">Sys</span><span class="ocamlNone">.</span><span class="ocamlLCIdentifier">file_exists</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">name</span><span class="ocamlNone"> </span><span class="Statement">then</span> <span class="ocamlLCIdentifier">name</span> <span class="Statement">else</span> <span class="Statement">raise</span> <span class="Constant">Not_found<br/></li>
<li></span>&nbsp; <span class="Statement">else</span> <span class="Statement">begin<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="Statement">rec</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">try_dir</span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="Statement">function<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Constant">[]</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;</span><span class="ocamlEnd"> </span><span class="Statement">raise</span><span class="ocamlEnd"> </span><span class="Constant">Not_found<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">dir</span><span class="Statement">::</span><span class="ocamlLCIdentifier"><a href="targetint.mli.html#L65" title="ocaml/utils/targetint.mli:65">rem</a></span><span class="ocamlEnd"> </span><span class="Statement">-&gt;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">fullname</span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="PreProc">Filename</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">concat</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">dir</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">name</span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">if</span><span class="ocamlNone"> </span><span class="PreProc">Sys</span><span class="ocamlNone">.</span><span class="ocamlLCIdentifier">file_exists</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">fullname</span><span class="ocamlNone"> </span><span class="Statement">then</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">fullname</span><span class="ocamlEnd"> </span><span class="Statement">else</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">try_dir</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="targetint.mli.html#L65" title="ocaml/utils/targetint.mli:65">rem</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="Statement">in</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">try_dir</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="build_path_prefix_map.ml.html#L16" title="ocaml/utils/build_path_prefix_map.ml:16">path</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; </span><span class="Statement">end<br/></li>
<li></span><br/></li>
<li><span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="misc.mli.html#L204" title="ocaml/utils/misc.mli:204">find_in_path_rel</a></span> <span class="ocamlLCIdentifier"><a href="build_path_prefix_map.ml.html#L16" title="ocaml/utils/build_path_prefix_map.ml:16">path</a></span> <span class="ocamlLCIdentifier">name</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="Statement">rec</span> <span class="ocamlLCIdentifier">simplify</span> <span class="ocamlLCIdentifier"><a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">let</span> <span class="Statement">open</span><span class="ocamlNone"> </span><span class="PreProc">Filename</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">base</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">basename</span> <span class="ocamlLCIdentifier"><a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">dir</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">dirname</span> <span class="ocamlLCIdentifier"><a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">dir</span><span class="ocamlNone"> </span><span class="Statement">=</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier"><a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a></span><span class="ocamlNone"> </span><span class="Statement">then</span> <span class="ocamlLCIdentifier">dir<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">else</span> <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">base</span><span class="ocamlNone"> </span><span class="Statement">=</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">current_dir_name</span><span class="ocamlNone"> </span><span class="Statement">then</span> <span class="ocamlLCIdentifier">simplify</span> <span class="ocamlLCIdentifier">dir<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">else</span> <span class="ocamlLCIdentifier">concat</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">simplify</span> <span class="ocamlLCIdentifier">dir</span><span class="Statement">)</span> <span class="ocamlLCIdentifier">base<br/></li>
<li></span>&nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="Statement">rec</span> <span class="ocamlLCIdentifier">try_dir</span> <span class="Statement">=</span> <span class="Statement">function<br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">[]</span> <span class="Statement">-&gt;</span> <span class="Statement">raise</span> <span class="Constant">Not_found<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="ocamlLCIdentifier">dir</span><span class="Statement">::</span><span class="ocamlLCIdentifier"><a href="targetint.mli.html#L65" title="ocaml/utils/targetint.mli:65">rem</a></span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">fullname</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">simplify</span> <span class="Statement">(</span><span class="PreProc">Filename</span>.<span class="ocamlLCIdentifier">concat</span> <span class="ocamlLCIdentifier">dir</span> <span class="ocamlLCIdentifier">name</span><span class="Statement">)</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="PreProc">Sys</span><span class="ocamlNone">.</span><span class="ocamlLCIdentifier">file_exists</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">fullname</span><span class="ocamlNone"> </span><span class="Statement">then</span> <span class="ocamlLCIdentifier">fullname</span> <span class="Statement">else</span> <span class="ocamlLCIdentifier">try_dir</span> <span class="ocamlLCIdentifier"><a href="targetint.mli.html#L65" title="ocaml/utils/targetint.mli:65">rem</a><br/></li>
<li></span>&nbsp; <span class="Statement">in</span> <span class="ocamlLCIdentifier">try_dir</span> <span class="ocamlLCIdentifier"><a href="build_path_prefix_map.ml.html#L16" title="ocaml/utils/build_path_prefix_map.ml:16">path</a><br/></li>
<li></span><br/></li>
<li><a id="L265">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">find_in_path_uncap</span></span> <span class="ocamlLCIdentifier"><a href="build_path_prefix_map.ml.html#L16" title="ocaml/utils/build_path_prefix_map.ml:16">path</a></span> <span class="ocamlLCIdentifier">name</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">uname</span> <span class="Statement">=</span> <span class="PreProc">String</span>.<span class="ocamlLCIdentifier">uncapitalize_ascii</span> <span class="ocamlLCIdentifier">name</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="Statement">rec</span> <span class="ocamlLCIdentifier">try_dir</span> <span class="Statement">=</span> <span class="Statement">function<br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">[]</span> <span class="Statement">-&gt;</span> <span class="Statement">raise</span> <span class="Constant">Not_found<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="ocamlLCIdentifier">dir</span><span class="Statement">::</span><span class="ocamlLCIdentifier"><a href="targetint.mli.html#L65" title="ocaml/utils/targetint.mli:65">rem</a></span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">fullname</span> <span class="Statement">=</span> <span class="PreProc">Filename</span>.<span class="ocamlLCIdentifier">concat</span> <span class="ocamlLCIdentifier">dir</span> <span class="ocamlLCIdentifier">name<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">and</span> <span class="ocamlLCIdentifier">ufullname</span> <span class="Statement">=</span> <span class="PreProc">Filename</span>.<span class="ocamlLCIdentifier">concat</span> <span class="ocamlLCIdentifier">dir</span> <span class="ocamlLCIdentifier">uname</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="PreProc">Sys</span><span class="ocamlNone">.</span><span class="ocamlLCIdentifier">file_exists</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">ufullname</span><span class="ocamlNone"> </span><span class="Statement">then</span> <span class="ocamlLCIdentifier">ufullname<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">else</span> <span class="Statement">if</span><span class="ocamlNone"> </span><span class="PreProc">Sys</span><span class="ocamlNone">.</span><span class="ocamlLCIdentifier">file_exists</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">fullname</span><span class="ocamlNone"> </span><span class="Statement">then</span> <span class="ocamlLCIdentifier">fullname<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">else</span> <span class="ocamlLCIdentifier">try_dir</span> <span class="ocamlLCIdentifier"><a href="targetint.mli.html#L65" title="ocaml/utils/targetint.mli:65">rem</a><br/></li>
<li></span>&nbsp; <span class="Statement">in</span> <span class="ocamlLCIdentifier">try_dir</span> <span class="ocamlLCIdentifier"><a href="build_path_prefix_map.ml.html#L16" title="ocaml/utils/build_path_prefix_map.ml:16">path</a><br/></li>
<li></span><br/></li>
<li><a id="L277">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">remove_file</span></span> <span class="ocamlLCIdentifier">filename</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">try<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="PreProc">Sys</span><span class="ocamlNone">.</span><span class="ocamlLCIdentifier">is_regular_file</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">filename<br/></li>
<li></span><span class="ocamlNone">&nbsp; &nbsp; </span><span class="Statement">then</span> <span class="PreProc">Sys</span>.<span class="ocamlLCIdentifier">remove</span> <span class="ocamlLCIdentifier">filename<br/></li>
<li></span>&nbsp; <span class="Statement">with</span> <span class="Constant">Sys_error</span> <span class="ocamlLCIdentifier">_msg</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">()<br/></li>
<li></span><br/></li>
<li><span class="Comment">(* Expand a -I option: if it starts with +, <a href="profile.ml.html#L238" title="ocaml/utils/profile.ml:238">make</a> it relative to the standard<br/></li>
<li></span><span class="Comment">&nbsp;&nbsp; library directory *)<br/></li>
<li></span><br/></li>
<li><a id="L287">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">expand_directory</span></span> <span class="ocamlLCIdentifier">alt</span> <span class="ocamlLCIdentifier"><a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="PreProc">String</span><span class="ocamlNone">.</span><span class="ocamlLCIdentifier"><a href="arg_helper.ml.html#L77" title="ocaml/utils/arg_helper.ml:77">length</a></span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier"><a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a></span><span class="ocamlNone"> </span><span class="Statement">&gt;</span><span class="ocamlNone"> </span><span class="Constant">0</span><span class="ocamlNone"> </span><span class="Statement">&amp;&amp;</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier"><a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a></span><span class="ocamlNone">.</span><span class="Statement">[</span><span class="Constant">0</span><span class="Statement">]</span><span class="ocamlNone"> </span><span class="Statement">=</span><span class="ocamlNone"> </span><span class="Constant">'+'<br/></li>
<li></span><span class="ocamlNone">&nbsp; </span><span class="Statement">then</span> <span class="PreProc">Filename</span>.<span class="ocamlLCIdentifier">concat</span> <span class="ocamlLCIdentifier">alt<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">(</span><span class="PreProc">String</span>.<span class="ocamlLCIdentifier"><a href="targetint.mli.html#L50" title="ocaml/utils/targetint.mli:50">sub</a></span> <span class="ocamlLCIdentifier"><a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a></span> <span class="Constant">1</span> <span class="Statement">(</span><span class="PreProc">String</span>.<span class="ocamlLCIdentifier"><a href="arg_helper.ml.html#L77" title="ocaml/utils/arg_helper.ml:77">length</a></span> <span class="ocamlLCIdentifier"><a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a></span> - <span class="Constant">1</span><span class="Statement">))<br/></li>
<li></span>&nbsp; <span class="Statement">else</span> <span class="ocamlLCIdentifier"><a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a><br/></li>
<li></span><br/></li>
<li><a id="L293">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">path_separator</span></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">match</span> <span class="PreProc">Sys</span>.<span class="ocamlLCIdentifier">os_type</span> <span class="Statement">with<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">&quot;Win32&quot;</span> <span class="Statement">-&gt;</span> <span class="Constant">';'<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Statement">_</span> <span class="Statement">-&gt;</span> <span class="Constant">':'<br/></li>
<li></span><br/></li>
<li><a id="L298">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">split_path_contents</span></span> <span class="Statement">?(</span><span class="Identifier">sep</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="#L293" title="ocaml/utils/misc.ml:293">path_separator</a></span><span class="Statement">)</span> <span class="Statement">=</span> <span class="Statement">function<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">&quot;&quot;</span> <span class="Statement">-&gt;</span> <span class="Constant">[]<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="ocamlLCIdentifier"><a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a></span> <span class="Statement">-&gt;</span> <span class="PreProc">String</span>.<span class="ocamlLCIdentifier">split_on_char</span> <span class="ocamlLCIdentifier">sep</span> <span class="ocamlLCIdentifier"><a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a><br/></li>
<li></span><br/></li>
<li><span class="Comment">(* Hashtable functions *)<br/></li>
<li></span><br/></li>
<li><a id="L304">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">create_hashtable</span></span> <span class="ocamlLCIdentifier"><a href="targetint.ml.html#L64" title="ocaml/utils/targetint.ml:64">size</a></span> <span class="ocamlLCIdentifier"><a href="load_path.mli.html#L62" title="ocaml/utils/load_path.mli:62">init</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">tbl</span> <span class="Statement">=</span> <span class="PreProc">Hashtbl</span>.<span class="ocamlLCIdentifier"><a href="lazy_backtrack.mli.html#L21" title="ocaml/utils/lazy_backtrack.mli:21">create</a></span> <span class="ocamlLCIdentifier"><a href="targetint.ml.html#L64" title="ocaml/utils/targetint.ml:64">size</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="PreProc">List</span>.<span class="ocamlLCIdentifier">iter</span> <span class="Statement">(fun</span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="identifiable.ml.html#L75" title="ocaml/utils/identifiable.ml:75">key</a></span>, <span class="ocamlLCIdentifier"><a href="identifiable.ml.html#L60" title="ocaml/utils/identifiable.ml:60">data</a></span><span class="Statement">)</span> <span class="Statement">-&gt;</span> <span class="PreProc">Hashtbl</span>.<span class="ocamlLCIdentifier"><a href="load_path.ml.html#L109" title="ocaml/utils/load_path.ml:109">add</a></span> <span class="ocamlLCIdentifier">tbl</span> <span class="ocamlLCIdentifier"><a href="identifiable.ml.html#L75" title="ocaml/utils/identifiable.ml:75">key</a></span> <span class="ocamlLCIdentifier"><a href="identifiable.ml.html#L60" title="ocaml/utils/identifiable.ml:60">data</a></span><span class="Statement">)</span> <span class="ocamlLCIdentifier"><a href="load_path.mli.html#L62" title="ocaml/utils/load_path.mli:62">init</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier">tbl<br/></li>
<li></span><br/></li>
<li><span class="Comment">(* File <a href="#L313" title="ocaml/utils/misc.ml:313">copy</a> *)<br/></li>
<li></span><br/></li>
<li><span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="misc.mli.html#L229" title="ocaml/utils/misc.mli:229">copy_file</a></span> <span class="ocamlLCIdentifier">ic</span> <span class="ocamlLCIdentifier">oc</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">buff</span> <span class="Statement">=</span> <span class="PreProc">Bytes</span>.<span class="ocamlLCIdentifier"><a href="lazy_backtrack.mli.html#L21" title="ocaml/utils/lazy_backtrack.mli:21">create</a></span> <span class="Constant">0x1000</span> <span class="Statement">in<br/></li>
<li><a id="L313">&#x200c;</a></span>&nbsp; <span class="Statement">let</span> <span class="Statement">rec</span> <span class="ocamlLCIdentifier"><span class="linkable">copy</span></span> <span class="Constant">()</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">n</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">input</span> <span class="ocamlLCIdentifier">ic</span> <span class="ocamlLCIdentifier">buff</span> <span class="Constant">0</span> <span class="Constant">0x1000</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">n</span><span class="ocamlNone"> </span><span class="Statement">=</span><span class="ocamlNone"> </span><span class="Constant">0</span><span class="ocamlNone"> </span><span class="Statement">then</span> <span class="Constant">()</span> <span class="Statement">else</span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="identifiable.ml.html#L23" title="ocaml/utils/identifiable.ml:23">output</a></span> <span class="ocamlLCIdentifier">oc</span> <span class="ocamlLCIdentifier">buff</span> <span class="Constant">0</span> <span class="ocamlLCIdentifier">n</span><span class="Statement">;</span> <span class="ocamlLCIdentifier"><a href="#L313" title="ocaml/utils/misc.ml:313">copy</a></span><span class="Constant">()</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">in</span> <span class="ocamlLCIdentifier"><a href="#L313" title="ocaml/utils/misc.ml:313">copy</a></span><span class="Constant">()<br/></li>
<li></span><br/></li>
<li><a id="L318">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">copy_file_chunk</span></span> <span class="ocamlLCIdentifier">ic</span> <span class="ocamlLCIdentifier">oc</span> <span class="ocamlLCIdentifier"><a href="#L1117" title="ocaml/utils/misc.ml:1117">len</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">buff</span> <span class="Statement">=</span> <span class="PreProc">Bytes</span>.<span class="ocamlLCIdentifier"><a href="lazy_backtrack.mli.html#L21" title="ocaml/utils/lazy_backtrack.mli:21">create</a></span> <span class="Constant">0x1000</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="Statement">rec</span> <span class="ocamlLCIdentifier"><a href="#L313" title="ocaml/utils/misc.ml:313">copy</a></span> <span class="ocamlLCIdentifier">n</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">n</span><span class="ocamlNone"> </span><span class="Statement">&lt;=</span><span class="ocamlNone"> </span><span class="Constant">0</span><span class="ocamlNone"> </span><span class="Statement">then</span> <span class="Constant">()</span> <span class="Statement">else</span> <span class="Statement">begin<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">r</span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">input</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">ic</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">buff</span><span class="ocamlEnd"> </span><span class="Constant">0</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="PreProc">Int</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">min</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">n</span><span class="ocamlEnd"> </span><span class="Constant">0x1000</span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">r</span><span class="ocamlNone"> </span><span class="Statement">=</span><span class="ocamlNone"> </span><span class="Constant">0</span><span class="ocamlNone"> </span><span class="Statement">then</span><span class="ocamlEnd"> </span><span class="Statement">raise</span><span class="ocamlEnd"> </span><span class="Constant">End_of_file</span><span class="ocamlEnd"> </span><span class="Statement">else</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="identifiable.ml.html#L23" title="ocaml/utils/identifiable.ml:23">output</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">oc</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">buff</span><span class="ocamlEnd"> </span><span class="Constant">0</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">r</span><span class="Statement">;</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L313" title="ocaml/utils/misc.ml:313">copy</a></span><span class="Statement">(</span><span class="ocamlLCIdentifier">n</span><span class="ocamlEnd">-</span><span class="ocamlLCIdentifier">r</span><span class="Statement">))<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="Statement">end<br/></li>
<li></span>&nbsp; <span class="Statement">in</span> <span class="ocamlLCIdentifier"><a href="#L313" title="ocaml/utils/misc.ml:313">copy</a></span> <span class="ocamlLCIdentifier"><a href="#L1117" title="ocaml/utils/misc.ml:1117">len</a><br/></li>
<li></span><br/></li>
<li><a id="L327">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">string_of_file</span></span> <span class="ocamlLCIdentifier">ic</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">b</span> <span class="Statement">=</span> <span class="PreProc">Buffer</span>.<span class="ocamlLCIdentifier"><a href="lazy_backtrack.mli.html#L21" title="ocaml/utils/lazy_backtrack.mli:21">create</a></span> <span class="Constant">0x10000</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">buff</span> <span class="Statement">=</span> <span class="PreProc">Bytes</span>.<span class="ocamlLCIdentifier"><a href="lazy_backtrack.mli.html#L21" title="ocaml/utils/lazy_backtrack.mli:21">create</a></span> <span class="Constant">0x1000</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="Statement">rec</span> <span class="ocamlLCIdentifier"><a href="#L313" title="ocaml/utils/misc.ml:313">copy</a></span> <span class="Constant">()</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">n</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">input</span> <span class="ocamlLCIdentifier">ic</span> <span class="ocamlLCIdentifier">buff</span> <span class="Constant">0</span> <span class="Constant">0x1000</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">n</span><span class="ocamlNone"> </span><span class="Statement">=</span><span class="ocamlNone"> </span><span class="Constant">0</span><span class="ocamlNone"> </span><span class="Statement">then</span> <span class="PreProc">Buffer</span>.<span class="ocamlLCIdentifier">contents</span> <span class="ocamlLCIdentifier">b</span> <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="PreProc">Buffer</span>.<span class="ocamlLCIdentifier">add_subbytes</span> <span class="ocamlLCIdentifier">b</span> <span class="ocamlLCIdentifier">buff</span> <span class="Constant">0</span> <span class="ocamlLCIdentifier">n</span><span class="Statement">;</span> <span class="ocamlLCIdentifier"><a href="#L313" title="ocaml/utils/misc.ml:313">copy</a></span><span class="Constant">()</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">in</span> <span class="ocamlLCIdentifier"><a href="#L313" title="ocaml/utils/misc.ml:313">copy</a></span><span class="Constant">()<br/></li>
<li></span><br/></li>
<li><a id="L336">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">output_to_file_via_temporary</span></span> <span class="Statement">?(</span><span class="Identifier">mode</span> <span class="Statement">=</span> <span class="Statement">[</span><span class="Constant">Open_text</span><span class="Statement">])</span> <span class="ocamlLCIdentifier">filename</span> <span class="ocamlLCIdentifier">fn</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">temp_filename</span>, <span class="ocamlLCIdentifier">oc</span><span class="Statement">)</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Filename</span>.<span class="ocamlLCIdentifier">open_temp_file<br/></li>
<li></span>&nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">~</span><span class="Identifier">mode</span> <span class="Statement">~</span><span class="Identifier">perms</span>:<span class="Constant">0o666</span> <span class="Statement">~</span><span class="Identifier">temp_dir</span>:<span class="Statement">(</span><span class="PreProc">Filename</span>.<span class="ocamlLCIdentifier">dirname</span> <span class="ocamlLCIdentifier">filename</span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">(</span><span class="PreProc">Filename</span>.<span class="ocamlLCIdentifier">basename</span> <span class="ocamlLCIdentifier">filename</span><span class="Statement">)</span> <span class="Constant">&quot;.tmp&quot;</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; <span class="Comment">(* The 0o666 permissions will be modified by the umask.&nbsp; It'<a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a> just<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp;&nbsp; like what [open_out] and [open_out_bin] do.<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp;&nbsp; With temp_dir = dirname filename, we ensure that the returned<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp;&nbsp; temp <a href="profile.mli.html#L23" title="ocaml/utils/profile.mli:23">file</a> is in the same directory as filename itself, making<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp;&nbsp; it safe to <a href="identifiable.ml.html#L57" title="ocaml/utils/identifiable.ml:57">rename</a> temp_filename to filename later.<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp;&nbsp; With <a href="diffing_with_keys.mli.html#L49" title="ocaml/utils/diffing_with_keys.mli:49">prefix</a> = basename filename, we are almost certain that<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp;&nbsp; the first generated name will be unique.&nbsp; A fixed <a href="diffing_with_keys.mli.html#L49" title="ocaml/utils/diffing_with_keys.mli:49">prefix</a><br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp;&nbsp; would work too but might <a href="profile.mli.html#L47" title="ocaml/utils/profile.mli:47">generate</a> more collisions if many<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp;&nbsp; files are being produced simultaneously in the same directory. *)<br/></li>
<li></span>&nbsp; <span class="Statement">match</span> <span class="ocamlLCIdentifier">fn</span> <span class="ocamlLCIdentifier">temp_filename</span> <span class="ocamlLCIdentifier">oc</span> <span class="Statement">with<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="ocamlLCIdentifier"><a href="diffing.ml.html#L250" title="ocaml/utils/diffing.ml:250">res</a></span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">close_out</span> <span class="ocamlLCIdentifier">oc</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">begin</span><span class="ocamlEnd"> </span><span class="Statement">try<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="PreProc">Sys</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier"><a href="identifiable.ml.html#L57" title="ocaml/utils/identifiable.ml:57">rename</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">temp_filename</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">filename</span><span class="Statement">;</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="diffing.ml.html#L250" title="ocaml/utils/diffing.ml:250">res</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">with</span><span class="ocamlEnd"> </span><span class="Type">exn</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="#L277" title="ocaml/utils/misc.ml:277">remove_file</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">temp_filename</span><span class="Statement">;</span><span class="ocamlEnd"> </span><span class="Statement">raise</span><span class="ocamlEnd"> </span><span class="Type">exn<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">end<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Statement">exception</span> <span class="Type">exn</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">close_out</span> <span class="ocamlLCIdentifier">oc</span><span class="Statement">;</span> <span class="ocamlLCIdentifier"><a href="#L277" title="ocaml/utils/misc.ml:277">remove_file</a></span> <span class="ocamlLCIdentifier">temp_filename</span><span class="Statement">;</span> <span class="Statement">raise</span> <span class="Type">exn<br/></li>
<li></span><br/></li>
<li><a id="L361">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">protect_writing_to_file</span></span> <span class="Statement">~</span><span class="Identifier">filename</span> <span class="Statement">~</span><span class="Identifier">f</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">outchan</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">open_out_bin</span> <span class="ocamlLCIdentifier">filename</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier"><a href="misc.mli.html#L36" title="ocaml/utils/misc.mli:36">try_finally</a></span> <span class="Statement">~</span><span class="Identifier">always</span>:<span class="Statement">(fun</span> <span class="Constant">()</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier">close_out</span> <span class="ocamlLCIdentifier">outchan</span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier">exceptionally</span>:<span class="Statement">(fun</span> <span class="Constant">()</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier"><a href="#L277" title="ocaml/utils/misc.ml:277">remove_file</a></span> <span class="ocamlLCIdentifier">filename</span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">(fun</span> <span class="Constant">()</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier">f</span> <span class="ocamlLCIdentifier">outchan</span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li><span class="Comment">(* Integer operations *)<br/></li>
<li></span><br/></li>
<li><span class="Statement">let</span> <span class="Statement">rec</span> <span class="ocamlLCIdentifier"><a href="misc.mli.html#L277" title="ocaml/utils/misc.mli:277">log2</a></span> <span class="ocamlLCIdentifier">n</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">n</span><span class="ocamlNone"> </span><span class="Statement">&lt;=</span><span class="ocamlNone"> </span><span class="Constant">1</span><span class="ocamlNone"> </span><span class="Statement">then</span> <span class="Constant">0</span> <span class="Statement">else</span> <span class="Constant">1</span> + <span class="ocamlLCIdentifier"><a href="misc.mli.html#L277" title="ocaml/utils/misc.mli:277">log2</a></span><span class="Statement">(</span><span class="ocamlLCIdentifier">n</span> <span class="Statement">asr</span> <span class="Constant">1</span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li><span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="misc.mli.html#L281" title="ocaml/utils/misc.mli:281">align</a></span> <span class="ocamlLCIdentifier">n</span> <span class="ocamlLCIdentifier">a</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">n</span><span class="ocamlNone"> </span><span class="Statement">&gt;=</span><span class="ocamlNone"> </span><span class="Constant">0</span><span class="ocamlNone"> </span><span class="Statement">then</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">n</span> + <span class="ocamlLCIdentifier">a</span> - <span class="Constant">1</span><span class="Statement">)</span> <span class="Statement">land</span> <span class="Statement">(</span>-<span class="ocamlLCIdentifier">a</span><span class="Statement">)</span> <span class="Statement">else</span> <span class="ocamlLCIdentifier">n</span> <span class="Statement">land</span> <span class="Statement">(</span>-<span class="ocamlLCIdentifier">a</span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li><span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="misc.mli.html#L285" title="ocaml/utils/misc.mli:285">no_overflow_add</a></span> <span class="ocamlLCIdentifier">a</span> <span class="ocamlLCIdentifier">b</span> <span class="Statement">=</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">a</span> <span class="Statement">lxor</span> <span class="ocamlLCIdentifier">b</span><span class="Statement">)</span> <span class="Statement">lor</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">a</span> <span class="Statement">lxor</span> <span class="Statement">(lnot</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">a</span>+<span class="ocamlLCIdentifier">b</span><span class="Statement">)))</span> <span class="Statement">&lt;</span> <span class="Constant">0<br/></li>
<li></span><br/></li>
<li><span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="misc.mli.html#L289" title="ocaml/utils/misc.mli:289">no_overflow_sub</a></span> <span class="ocamlLCIdentifier">a</span> <span class="ocamlLCIdentifier">b</span> <span class="Statement">=</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">a</span> <span class="Statement">lxor</span> <span class="Statement">(lnot</span> <span class="ocamlLCIdentifier">b</span><span class="Statement">))</span> <span class="Statement">lor</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">b</span> <span class="Statement">lxor</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">a</span>-<span class="ocamlLCIdentifier">b</span><span class="Statement">))</span> <span class="Statement">&lt;</span> <span class="Constant">0<br/></li>
<li></span><br/></li>
<li><span class="Comment">(* Taken from Hacker'<a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a> Delight, chapter &quot;Overflow Detection&quot; *)<br/></li>
<li></span><span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="misc.mli.html#L293" title="ocaml/utils/misc.mli:293">no_overflow_mul</a></span> <span class="ocamlLCIdentifier">a</span> <span class="ocamlLCIdentifier">b</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">not</span> <span class="Statement">((</span><span class="ocamlLCIdentifier">a</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="targetint.mli.html#L97" title="ocaml/utils/targetint.mli:97">min_int</a></span> <span class="Statement">&amp;&amp;</span> <span class="ocamlLCIdentifier">b</span> <span class="Statement">&lt;</span> <span class="Constant">0</span><span class="Statement">)</span> <span class="Statement">||</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">b</span> <span class="Statement">&lt;&gt;</span> <span class="Constant">0</span> <span class="Statement">&amp;&amp;</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">a</span> <span class="Statement">*</span> <span class="ocamlLCIdentifier">b</span><span class="Statement">)</span> / <span class="ocamlLCIdentifier">b</span> <span class="Statement">&lt;&gt;</span> <span class="ocamlLCIdentifier">a</span><span class="Statement">))<br/></li>
<li></span><br/></li>
<li><span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="misc.mli.html#L297" title="ocaml/utils/misc.mli:297">no_overflow_lsl</a></span> <span class="ocamlLCIdentifier">a</span> <span class="ocamlLCIdentifier">k</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Constant">0</span> <span class="Statement">&lt;=</span> <span class="ocamlLCIdentifier">k</span> <span class="Statement">&amp;&amp;</span> <span class="ocamlLCIdentifier">k</span> <span class="Statement">&lt;</span> <span class="PreProc">Sys</span>.<span class="ocamlLCIdentifier"><a href="binutils.ml.html#L97" title="ocaml/utils/binutils.ml:97">word_size</a></span> - <span class="Constant">1</span> <span class="Statement">&amp;&amp;</span> <span class="ocamlLCIdentifier"><a href="targetint.mli.html#L97" title="ocaml/utils/targetint.mli:97">min_int</a></span> <span class="Statement">asr</span> <span class="ocamlLCIdentifier">k</span> <span class="Statement">&lt;=</span> <span class="ocamlLCIdentifier">a</span> <span class="Statement">&amp;&amp;</span> <span class="ocamlLCIdentifier">a</span> <span class="Statement">&lt;=</span> <span class="ocamlLCIdentifier"><a href="targetint.mli.html#L92" title="ocaml/utils/targetint.mli:92">max_int</a></span> <span class="Statement">asr</span> <span class="ocamlLCIdentifier">k<br/></li>
<li></span><br/></li>
<li><span class="Statement">module</span><span class="PreProc"> Int_literal_converter</span><span class="ocamlPreDef"> </span><span class="Statement">=</span> <span class="PreProc">struct<br/></li>
<li></span><span class="ocamlStruct">&nbsp; </span><span class="Comment">(* To convert integer literals, allowing <a href="targetint.mli.html#L92" title="ocaml/utils/targetint.mli:92">max_int</a> + 1 (PR#4210) *)<br/></li>
<li></span><span class="ocamlStruct">&nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">cvt_int_aux</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">str</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="targetint.mli.html#L44" title="ocaml/utils/targetint.mli:44">neg</a></span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="targetint.mli.html#L175" title="ocaml/utils/targetint.mli:175">of_string</a></span><span class="ocamlStruct"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">if</span><span class="ocamlNone"> </span><span class="PreProc">String</span><span class="ocamlNone">.</span><span class="ocamlLCIdentifier"><a href="arg_helper.ml.html#L77" title="ocaml/utils/arg_helper.ml:77">length</a></span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">str</span><span class="ocamlNone"> </span><span class="Statement">=</span><span class="ocamlNone"> </span><span class="Constant">0</span><span class="ocamlNone"> </span><span class="Statement">||</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">str</span><span class="ocamlNone">.</span><span class="Statement">[</span><span class="Constant">0</span><span class="Statement">]=</span><span class="ocamlNone"> </span><span class="Constant">'-'<br/></li>
<li></span><span class="ocamlNone">&nbsp; &nbsp; </span><span class="Statement">then</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="targetint.mli.html#L175" title="ocaml/utils/targetint.mli:175">of_string</a></span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">str<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">else</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="targetint.mli.html#L44" title="ocaml/utils/targetint.mli:44">neg</a></span><span class="ocamlStruct"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="targetint.mli.html#L175" title="ocaml/utils/targetint.mli:175">of_string</a></span><span class="ocamlStruct"> </span><span class="Statement">(</span><span class="Constant">&quot;-&quot;</span><span class="ocamlStruct"> </span><span class="Statement">^</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">str</span><span class="Statement">))<br/></li>
<li></span><span class="ocamlStruct">&nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="Type">int</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a></span><span class="ocamlStruct"> </span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">cvt_int_aux</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a></span><span class="ocamlStruct"> </span><span class="Statement">(~</span><span class="ocamlStruct">-</span><span class="Statement">)</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">int_of_string<br/></li>
<li></span><span class="ocamlStruct">&nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="Type">int32</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a></span><span class="ocamlStruct"> </span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">cvt_int_aux</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a></span><span class="ocamlStruct"> </span><span class="PreProc">Int32</span><span class="ocamlStruct">.</span><span class="ocamlLCIdentifier"><a href="targetint.mli.html#L44" title="ocaml/utils/targetint.mli:44">neg</a></span><span class="ocamlStruct"> </span><span class="PreProc">Int32</span><span class="ocamlStruct">.</span><span class="ocamlLCIdentifier"><a href="targetint.mli.html#L175" title="ocaml/utils/targetint.mli:175">of_string</a><br/></li>
<li></span><span class="ocamlStruct">&nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="Type">int64</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a></span><span class="ocamlStruct"> </span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">cvt_int_aux</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a></span><span class="ocamlStruct"> </span><span class="PreProc">Int64</span><span class="ocamlStruct">.</span><span class="ocamlLCIdentifier"><a href="targetint.mli.html#L44" title="ocaml/utils/targetint.mli:44">neg</a></span><span class="ocamlStruct"> </span><span class="PreProc">Int64</span><span class="ocamlStruct">.</span><span class="ocamlLCIdentifier"><a href="targetint.mli.html#L175" title="ocaml/utils/targetint.mli:175">of_string</a><br/></li>
<li></span><span class="ocamlStruct">&nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="Type">nativeint</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a></span><span class="ocamlStruct"> </span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">cvt_int_aux</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a></span><span class="ocamlStruct"> </span><span class="PreProc">Nativeint</span><span class="ocamlStruct">.</span><span class="ocamlLCIdentifier"><a href="targetint.mli.html#L44" title="ocaml/utils/targetint.mli:44">neg</a></span><span class="ocamlStruct"> </span><span class="PreProc">Nativeint</span><span class="ocamlStruct">.</span><span class="ocamlLCIdentifier"><a href="targetint.mli.html#L175" title="ocaml/utils/targetint.mli:175">of_string</a><br/></li>
<li></span><span class="PreProc">end<br/></li>
<li></span><br/></li>
<li><span class="Comment">(* [<a href="misc.mli.html#L318" title="ocaml/utils/misc.mli:318">find_first_mono</a> p] assumes that there exists a natural <a href="warnings.ml.html#L121" title="ocaml/utils/warnings.ml:121">number</a><br/></li>
<li></span><span class="Comment">&nbsp;&nbsp; N such that [p] is false on [0; N[ and true on [N; <a href="targetint.mli.html#L92" title="ocaml/utils/targetint.mli:92">max_int</a>], and<br/></li>
<li></span><span class="Comment">&nbsp;&nbsp; returns this N. (See misc.mli for the detailed specification.) *)<br/></li>
<li></span><span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="misc.mli.html#L318" title="ocaml/utils/misc.mli:318">find_first_mono</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="Statement">rec</span> <span class="ocamlLCIdentifier"><a href="load_path.ml.html#L157" title="ocaml/utils/load_path.ml:157">find</a></span> <span class="ocamlLCIdentifier">p</span> <span class="Statement">~</span><span class="Identifier">low</span> <span class="Statement">~</span><span class="Identifier">jump</span> <span class="Statement">~</span><span class="Identifier">high</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="Comment">(* Invariants:<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp;&nbsp; [low, jump, high] are non-negative with [low &lt; high],<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp;&nbsp; [p low = false],<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp;&nbsp; [p high = true]. *)<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">low</span><span class="ocamlNone"> + </span><span class="Constant">1</span><span class="ocamlNone"> </span><span class="Statement">=</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">high</span><span class="ocamlNone"> </span><span class="Statement">then</span> <span class="ocamlLCIdentifier">high<br/></li>
<li></span>&nbsp; &nbsp; <span class="Comment">(* ensure that [low + jump] is in ]low; high[ *)<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">else</span> <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">jump</span><span class="ocamlNone"> </span><span class="Statement">&lt;</span><span class="ocamlNone"> </span><span class="Constant">1</span><span class="ocamlNone"> </span><span class="Statement">then</span> <span class="ocamlLCIdentifier"><a href="load_path.ml.html#L157" title="ocaml/utils/load_path.ml:157">find</a></span> <span class="ocamlLCIdentifier">p</span> <span class="Statement">~</span><span class="Identifier">low</span> <span class="Statement">~</span><span class="Identifier">jump</span>:<span class="Constant">1</span> <span class="Statement">~</span><span class="Identifier">high<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">else</span> <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">jump</span><span class="ocamlNone"> </span><span class="Statement">&gt;=</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">high</span><span class="ocamlNone"> - </span><span class="ocamlLCIdentifier">low</span><span class="ocamlNone"> </span><span class="Statement">then</span> <span class="ocamlLCIdentifier"><a href="load_path.ml.html#L157" title="ocaml/utils/load_path.ml:157">find</a></span> <span class="ocamlLCIdentifier">p</span> <span class="Statement">~</span><span class="Identifier">low</span> <span class="Statement">~</span><span class="Identifier">jump</span>:<span class="Statement">((</span><span class="ocamlLCIdentifier">high</span> - <span class="ocamlLCIdentifier">low</span><span class="Statement">)</span> / <span class="Constant">2</span><span class="Statement">)</span> <span class="Statement">~</span><span class="Identifier">high<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">else</span> <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">p</span><span class="ocamlNone"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">low</span><span class="ocamlNone"> + </span><span class="ocamlLCIdentifier">jump</span><span class="Statement">)</span><span class="ocamlNone"> </span><span class="Statement">then<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Comment">(* We jumped too high: continue with a smaller jump and lower limit *)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="load_path.ml.html#L157" title="ocaml/utils/load_path.ml:157">find</a></span> <span class="ocamlLCIdentifier">p</span> <span class="Statement">~</span><span class="Identifier">low</span>:<span class="ocamlLCIdentifier">low</span> <span class="Statement">~</span><span class="Identifier">jump</span>:<span class="Statement">(</span><span class="ocamlLCIdentifier">jump</span> / <span class="Constant">2</span><span class="Statement">)</span> <span class="Statement">~</span><span class="Identifier">high</span>:<span class="Statement">(</span><span class="ocamlLCIdentifier">low</span> + <span class="ocamlLCIdentifier">jump</span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Comment">(* we jumped too low:<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; continue from [low + jump] with a larger jump *)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">next_jump</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">max</span> <span class="ocamlLCIdentifier">jump</span> <span class="Statement">(</span><span class="Constant">2</span> <span class="Statement">*</span> <span class="ocamlLCIdentifier">jump</span><span class="Statement">)</span> <span class="Comment">(* avoid overflows *)</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="load_path.ml.html#L157" title="ocaml/utils/load_path.ml:157">find</a></span> <span class="ocamlLCIdentifier">p</span> <span class="Statement">~</span><span class="Identifier">low</span>:<span class="Statement">(</span><span class="ocamlLCIdentifier">low</span> + <span class="ocamlLCIdentifier">jump</span><span class="Statement">)</span> <span class="Statement">~</span><span class="Identifier">jump</span>:<span class="ocamlLCIdentifier">next_jump</span> <span class="Statement">~</span><span class="Identifier">high<br/></li>
<li></span>&nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">fun</span> <span class="ocamlLCIdentifier">p</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">p</span><span class="ocamlNone"> </span><span class="Constant">0</span><span class="ocamlNone"> </span><span class="Statement">then</span> <span class="Constant">0<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">else</span> <span class="ocamlLCIdentifier"><a href="load_path.ml.html#L157" title="ocaml/utils/load_path.ml:157">find</a></span> <span class="ocamlLCIdentifier">p</span> <span class="Statement">~</span><span class="Identifier">low</span>:<span class="Constant">0</span> <span class="Statement">~</span><span class="Identifier">jump</span>:<span class="Constant">1</span> <span class="Statement">~</span><span class="Identifier">high</span>:<span class="ocamlLCIdentifier"><a href="targetint.mli.html#L92" title="ocaml/utils/targetint.mli:92">max_int</a><br/></li>
<li></span><br/></li>
<li><span class="Comment">(* String operations *)<br/></li>
<li></span><br/></li>
<li><a id="L426">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">split_null_terminated</span></span> <span class="ocamlLCIdentifier"><a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let[</span>@<span class="ocamlLCIdentifier">tail_mod_cons</span><span class="Statement">]</span> <span class="Statement">rec</span> <span class="ocamlLCIdentifier">discard_last_sep</span> <span class="Statement">=</span> <span class="Statement">function<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">[]</span> <span class="Statement">|</span> <span class="Statement">[</span><span class="Constant">&quot;&quot;</span><span class="Statement">]</span> <span class="Statement">-&gt;</span> <span class="Constant">[]<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="ocamlLCIdentifier">x</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier">xs</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier">x</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier">discard_last_sep</span> <span class="ocamlLCIdentifier">xs<br/></li>
<li></span>&nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier">discard_last_sep</span> <span class="Statement">(</span><span class="PreProc">String</span>.<span class="ocamlLCIdentifier">split_on_char</span> <span class="Constant">'\000'</span> <span class="ocamlLCIdentifier"><a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a></span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li><a id="L433">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">concat_null_terminated</span></span> <span class="Statement">=</span> <span class="Statement">function<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">[]</span> <span class="Statement">-&gt;</span> <span class="Constant">&quot;&quot;<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="ocamlLCIdentifier">l</span> <span class="Statement">-&gt;</span> <span class="PreProc">String</span>.<span class="ocamlLCIdentifier">concat</span> <span class="Constant">&quot;\000&quot;</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">l</span> @ <span class="Statement">[</span><span class="Constant">&quot;&quot;</span><span class="Statement">])<br/></li>
<li></span><br/></li>
<li><a id="L437">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">chop_extensions</span></span> <span class="ocamlLCIdentifier"><a href="profile.mli.html#L23" title="ocaml/utils/profile.mli:23">file</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">dirname</span> <span class="Statement">=</span> <span class="PreProc">Filename</span>.<span class="ocamlLCIdentifier">dirname</span> <span class="ocamlLCIdentifier"><a href="profile.mli.html#L23" title="ocaml/utils/profile.mli:23">file</a></span> <span class="Statement">and</span> <span class="ocamlLCIdentifier">basename</span> <span class="Statement">=</span> <span class="PreProc">Filename</span>.<span class="ocamlLCIdentifier">basename</span> <span class="ocamlLCIdentifier"><a href="profile.mli.html#L23" title="ocaml/utils/profile.mli:23">file</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">try<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="strongly_connected_components.ml.html#L39" title="ocaml/utils/strongly_connected_components.ml:39">pos</a></span> <span class="Statement">=</span> <span class="PreProc">String</span>.<span class="ocamlLCIdentifier">index</span> <span class="ocamlLCIdentifier">basename</span> <span class="Constant">'.'</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">basename</span> <span class="Statement">=</span> <span class="PreProc">String</span>.<span class="ocamlLCIdentifier"><a href="targetint.mli.html#L50" title="ocaml/utils/targetint.mli:50">sub</a></span> <span class="ocamlLCIdentifier">basename</span> <span class="Constant">0</span> <span class="ocamlLCIdentifier"><a href="strongly_connected_components.ml.html#L39" title="ocaml/utils/strongly_connected_components.ml:39">pos</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="PreProc">Filename</span><span class="ocamlNone">.</span><span class="ocamlLCIdentifier">is_implicit</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier"><a href="profile.mli.html#L23" title="ocaml/utils/profile.mli:23">file</a></span><span class="ocamlNone"> </span><span class="Statement">&amp;&amp;</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">dirname</span><span class="ocamlNone"> </span><span class="Statement">=</span><span class="ocamlNone"> </span><span class="PreProc">Filename</span><span class="ocamlNone">.</span><span class="ocamlLCIdentifier">current_dir_name</span><span class="ocamlNone"> </span><span class="Statement">then<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">basename<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="PreProc">Filename</span>.<span class="ocamlLCIdentifier">concat</span> <span class="ocamlLCIdentifier">dirname</span> <span class="ocamlLCIdentifier">basename<br/></li>
<li></span>&nbsp; <span class="Statement">with</span> <span class="Constant">Not_found</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier"><a href="profile.mli.html#L23" title="ocaml/utils/profile.mli:23">file</a><br/></li>
<li></span><br/></li>
<li><a id="L448">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">search_substring</span></span> <span class="ocamlLCIdentifier">pat</span> <span class="ocamlLCIdentifier">str</span> <span class="ocamlLCIdentifier">start</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="Statement">rec</span> <span class="ocamlLCIdentifier">search</span> <span class="ocamlLCIdentifier">i</span> <span class="ocamlLCIdentifier">j</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">j</span><span class="ocamlNone"> </span><span class="Statement">&gt;=</span><span class="ocamlNone"> </span><span class="PreProc">String</span><span class="ocamlNone">.</span><span class="ocamlLCIdentifier"><a href="arg_helper.ml.html#L77" title="ocaml/utils/arg_helper.ml:77">length</a></span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">pat</span><span class="ocamlNone"> </span><span class="Statement">then</span> <span class="ocamlLCIdentifier">i<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">else</span> <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">i</span><span class="ocamlNone"> + </span><span class="ocamlLCIdentifier">j</span><span class="ocamlNone"> </span><span class="Statement">&gt;=</span><span class="ocamlNone"> </span><span class="PreProc">String</span><span class="ocamlNone">.</span><span class="ocamlLCIdentifier"><a href="arg_helper.ml.html#L77" title="ocaml/utils/arg_helper.ml:77">length</a></span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">str</span><span class="ocamlNone"> </span><span class="Statement">then</span> <span class="Statement">raise</span> <span class="Constant">Not_found<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">else</span> <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">str</span><span class="ocamlNone">.</span><span class="Statement">[</span><span class="ocamlLCIdentifier">i</span><span class="ocamlNone"> + </span><span class="ocamlLCIdentifier">j</span><span class="Statement">]</span><span class="ocamlNone"> </span><span class="Statement">=</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">pat</span><span class="ocamlNone">.</span><span class="Statement">[</span><span class="ocamlLCIdentifier">j</span><span class="Statement">]</span><span class="ocamlNone"> </span><span class="Statement">then</span> <span class="ocamlLCIdentifier">search</span> <span class="ocamlLCIdentifier">i</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">j</span>+<span class="Constant">1</span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">else</span> <span class="ocamlLCIdentifier">search</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">i</span>+<span class="Constant">1</span><span class="Statement">)</span> <span class="Constant">0<br/></li>
<li></span>&nbsp; <span class="Statement">in</span> <span class="ocamlLCIdentifier">search</span> <span class="ocamlLCIdentifier">start</span> <span class="Constant">0<br/></li>
<li></span><br/></li>
<li><a id="L456">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">replace_substring</span></span> <span class="Statement">~</span><span class="Identifier">before</span> <span class="Statement">~</span><span class="Identifier">after</span> <span class="ocamlLCIdentifier">str</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="Statement">rec</span> <span class="ocamlLCIdentifier">search</span> <span class="ocamlLCIdentifier"><a href="arg_helper.ml.html#L95" title="ocaml/utils/arg_helper.ml:95">acc</a></span> <span class="ocamlLCIdentifier">curr</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">match</span> <span class="ocamlLCIdentifier"><a href="#L448" title="ocaml/utils/misc.ml:448">search_substring</a></span> <span class="ocamlLCIdentifier">before</span> <span class="ocamlLCIdentifier">str</span> <span class="ocamlLCIdentifier">curr</span> <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="ocamlLCIdentifier">next</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="diffing_with_keys.mli.html#L49" title="ocaml/utils/diffing_with_keys.mli:49">prefix</a></span> <span class="Statement">=</span> <span class="PreProc">String</span>.<span class="ocamlLCIdentifier"><a href="targetint.mli.html#L50" title="ocaml/utils/targetint.mli:50">sub</a></span> <span class="ocamlLCIdentifier">str</span> <span class="ocamlLCIdentifier">curr</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">next</span> - <span class="ocamlLCIdentifier">curr</span><span class="Statement">)</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier">search</span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="diffing_with_keys.mli.html#L49" title="ocaml/utils/diffing_with_keys.mli:49">prefix</a></span> <span class="Statement">::</span> <span class="ocamlLCIdentifier"><a href="arg_helper.ml.html#L95" title="ocaml/utils/arg_helper.ml:95">acc</a></span><span class="Statement">)</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">next</span> + <span class="PreProc">String</span>.<span class="ocamlLCIdentifier"><a href="arg_helper.ml.html#L77" title="ocaml/utils/arg_helper.ml:77">length</a></span> <span class="ocamlLCIdentifier">before</span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Statement">exception</span> <span class="Constant">Not_found</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">suffix</span> <span class="Statement">=</span> <span class="PreProc">String</span>.<span class="ocamlLCIdentifier"><a href="targetint.mli.html#L50" title="ocaml/utils/targetint.mli:50">sub</a></span> <span class="ocamlLCIdentifier">str</span> <span class="ocamlLCIdentifier">curr</span> <span class="Statement">(</span><span class="PreProc">String</span>.<span class="ocamlLCIdentifier"><a href="arg_helper.ml.html#L77" title="ocaml/utils/arg_helper.ml:77">length</a></span> <span class="ocamlLCIdentifier">str</span> - <span class="ocamlLCIdentifier">curr</span><span class="Statement">)</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="PreProc">List</span>.<span class="ocamlLCIdentifier">rev</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">suffix</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier"><a href="arg_helper.ml.html#L95" title="ocaml/utils/arg_helper.ml:95">acc</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">in</span> <span class="PreProc">String</span>.<span class="ocamlLCIdentifier">concat</span> <span class="ocamlLCIdentifier">after</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">search</span> <span class="Constant">[]</span> <span class="Constant">0</span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li><a id="L467">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">rev_split_words</span></span> <span class="ocamlLCIdentifier"><a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="Statement">rec</span> <span class="ocamlLCIdentifier">split1</span> <span class="ocamlLCIdentifier"><a href="diffing.ml.html#L250" title="ocaml/utils/diffing.ml:250">res</a></span> <span class="ocamlLCIdentifier">i</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">i</span><span class="ocamlNone"> </span><span class="Statement">&gt;=</span><span class="ocamlNone"> </span><span class="PreProc">String</span><span class="ocamlNone">.</span><span class="ocamlLCIdentifier"><a href="arg_helper.ml.html#L77" title="ocaml/utils/arg_helper.ml:77">length</a></span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier"><a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a></span><span class="ocamlNone"> </span><span class="Statement">then</span> <span class="ocamlLCIdentifier"><a href="diffing.ml.html#L250" title="ocaml/utils/diffing.ml:250">res</a></span> <span class="Statement">else</span> <span class="Statement">begin<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">match</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a></span><span class="ocamlEnd">.</span><span class="Statement">[</span><span class="ocamlLCIdentifier">i</span><span class="Statement">]</span><span class="ocamlEnd"> </span><span class="Statement">with<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Constant">' '</span><span class="ocamlEnd"> </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Constant">'\<a href="lazy_backtrack.mli.html#L16" title="ocaml/utils/lazy_backtrack.mli:16">t</a>'</span><span class="ocamlEnd"> </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Constant">'\r'</span><span class="ocamlEnd"> </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Constant">'\n'</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">split1</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="diffing.ml.html#L250" title="ocaml/utils/diffing.ml:250">res</a></span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">i</span><span class="ocamlEnd">+</span><span class="Constant">1</span><span class="Statement">)<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Statement">_</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">split2</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="diffing.ml.html#L250" title="ocaml/utils/diffing.ml:250">res</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">i</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">i</span><span class="ocamlEnd">+</span><span class="Constant">1</span><span class="Statement">)<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="Statement">end<br/></li>
<li></span>&nbsp; <span class="Statement">and</span> <span class="ocamlLCIdentifier">split2</span> <span class="ocamlLCIdentifier"><a href="diffing.ml.html#L250" title="ocaml/utils/diffing.ml:250">res</a></span> <span class="ocamlLCIdentifier">i</span> <span class="ocamlLCIdentifier">j</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">j</span><span class="ocamlNone"> </span><span class="Statement">&gt;=</span><span class="ocamlNone"> </span><span class="PreProc">String</span><span class="ocamlNone">.</span><span class="ocamlLCIdentifier"><a href="arg_helper.ml.html#L77" title="ocaml/utils/arg_helper.ml:77">length</a></span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier"><a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a></span><span class="ocamlNone"> </span><span class="Statement">then</span> <span class="PreProc">String</span>.<span class="ocamlLCIdentifier"><a href="targetint.mli.html#L50" title="ocaml/utils/targetint.mli:50">sub</a></span> <span class="ocamlLCIdentifier"><a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a></span> <span class="ocamlLCIdentifier">i</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">j</span>-<span class="ocamlLCIdentifier">i</span><span class="Statement">)</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier"><a href="diffing.ml.html#L250" title="ocaml/utils/diffing.ml:250">res</a></span> <span class="Statement">else</span> <span class="Statement">begin<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">match</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a></span><span class="ocamlEnd">.</span><span class="Statement">[</span><span class="ocamlLCIdentifier">j</span><span class="Statement">]</span><span class="ocamlEnd"> </span><span class="Statement">with<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Constant">' '</span><span class="ocamlEnd"> </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Constant">'\<a href="lazy_backtrack.mli.html#L16" title="ocaml/utils/lazy_backtrack.mli:16">t</a>'</span><span class="ocamlEnd"> </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Constant">'\r'</span><span class="ocamlEnd"> </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Constant">'\n'</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">split1</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="PreProc">String</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier"><a href="targetint.mli.html#L50" title="ocaml/utils/targetint.mli:50">sub</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">i</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">j</span><span class="ocamlEnd">-</span><span class="ocamlLCIdentifier">i</span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="Statement">::</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="diffing.ml.html#L250" title="ocaml/utils/diffing.ml:250">res</a></span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">j</span><span class="ocamlEnd">+</span><span class="Constant">1</span><span class="Statement">)<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Statement">_</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">split2</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="diffing.ml.html#L250" title="ocaml/utils/diffing.ml:250">res</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">i</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">j</span><span class="ocamlEnd">+</span><span class="Constant">1</span><span class="Statement">)<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="Statement">end<br/></li>
<li></span>&nbsp; <span class="Statement">in</span> <span class="ocamlLCIdentifier">split1</span> <span class="Constant">[]</span> <span class="Constant">0<br/></li>
<li></span><br/></li>
<li><a id="L482">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">get_ref</span></span> <span class="ocamlLCIdentifier">r</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">v</span> <span class="Statement">=</span> <span class="Statement">!</span><span class="ocamlLCIdentifier">r</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier">r</span> <span class="Statement">:=</span> <span class="Constant">[]</span><span class="Statement">;</span> <span class="ocamlLCIdentifier">v<br/></li>
<li></span><br/></li>
<li><a id="L486">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">set_or_ignore</span></span> <span class="ocamlLCIdentifier">f</span> <span class="ocamlLCIdentifier">opt</span> <span class="ocamlLCIdentifier">x</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">match</span> <span class="ocamlLCIdentifier">f</span> <span class="ocamlLCIdentifier">x</span> <span class="Statement">with<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">None</span> <span class="Statement">-&gt;</span> <span class="Constant">()<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Some</span> <span class="ocamlLCIdentifier">y</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier">opt</span> <span class="Statement">:=</span> <span class="Constant">Some</span> <span class="ocamlLCIdentifier">y<br/></li>
<li></span><br/></li>
<li><a id="L491">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">fst3</span></span> <span class="Statement">(</span><span class="ocamlLCIdentifier">x</span>, <span class="Statement">_</span>, <span class="Statement">_)</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">x<br/></li>
<li><a id="L492">&#x200c;</a></span><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">snd3</span></span> <span class="Statement">(_</span>,<span class="ocamlLCIdentifier">x</span>,<span class="Statement">_)</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">x<br/></li>
<li><a id="L493">&#x200c;</a></span><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">thd3</span></span> <span class="Statement">(_</span>,<span class="Statement">_</span>,<span class="ocamlLCIdentifier">x</span><span class="Statement">)</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">x<br/></li>
<li></span><br/></li>
<li><a id="L495">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">fst4</span></span> <span class="Statement">(</span><span class="ocamlLCIdentifier">x</span>, <span class="Statement">_</span>, <span class="Statement">_</span>, <span class="Statement">_)</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">x<br/></li>
<li><a id="L496">&#x200c;</a></span><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">snd4</span></span> <span class="Statement">(_</span>,<span class="ocamlLCIdentifier">x</span>,<span class="Statement">_</span>, <span class="Statement">_)</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">x<br/></li>
<li><a id="L497">&#x200c;</a></span><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">thd4</span></span> <span class="Statement">(_</span>,<span class="Statement">_</span>,<span class="ocamlLCIdentifier">x</span>,<span class="Statement">_)</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">x<br/></li>
<li><a id="L498">&#x200c;</a></span><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">for4</span></span> <span class="Statement">(_</span>,<span class="Statement">_</span>,<span class="Statement">_</span>,<span class="ocamlLCIdentifier">x</span><span class="Statement">)</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">x<br/></li>
<li></span><br/></li>
<li><br/></li>
<li><span class="Statement">module</span><span class="PreProc"> LongString</span><span class="ocamlPreDef"> </span><span class="Statement">=</span> <span class="PreProc">struct<br/></li>
<li></span><span class="ocamlStruct">&nbsp; </span><span class="Statement">type</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="lazy_backtrack.mli.html#L16" title="ocaml/utils/lazy_backtrack.mli:16">t</a></span><span class="ocamlStruct"> </span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="profile.ml.html#L143" title="ocaml/utils/profile.ml:143">bytes</a></span><span class="ocamlStruct"> </span><span class="Type">array<br/></li>
<li></span><br/></li>
<li><span class="ocamlStruct">&nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="lazy_backtrack.mli.html#L21" title="ocaml/utils/lazy_backtrack.mli:21">create</a></span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">str_size</span><span class="ocamlStruct"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">tbl_size</span><span class="ocamlStruct"> </span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">str_size</span><span class="ocamlStruct"> / </span><span class="PreProc">Sys</span><span class="ocamlStruct">.</span><span class="ocamlLCIdentifier">max_string_length</span><span class="ocamlStruct"> + </span><span class="Constant">1</span><span class="ocamlStruct"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">tbl</span><span class="ocamlStruct"> </span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="PreProc">Array</span><span class="ocamlStruct">.</span><span class="ocamlLCIdentifier"><a href="profile.ml.html#L238" title="ocaml/utils/profile.ml:238">make</a></span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">tbl_size</span><span class="ocamlStruct"> </span><span class="PreProc">Bytes</span><span class="ocamlStruct">.</span><span class="ocamlLCIdentifier">empty</span><span class="ocamlStruct"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">for</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">i</span><span class="ocamlNone"> </span><span class="Statement">=</span><span class="ocamlNone"> </span><span class="Constant">0</span><span class="ocamlNone"> </span><span class="Statement">to</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">tbl_size</span><span class="ocamlStruct"> - </span><span class="Constant">2</span><span class="ocamlStruct"> </span><span class="Statement">do<br/></li>
<li></span><span class="ocamlDo">&nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier">tbl</span><span class="ocamlDo">.</span><span class="Statement">(</span><span class="ocamlLCIdentifier">i</span><span class="Statement">)</span><span class="ocamlDo"> </span><span class="Statement">&lt;-</span><span class="ocamlDo"> </span><span class="PreProc">Bytes</span><span class="ocamlDo">.</span><span class="ocamlLCIdentifier"><a href="lazy_backtrack.mli.html#L21" title="ocaml/utils/lazy_backtrack.mli:21">create</a></span><span class="ocamlDo"> </span><span class="PreProc">Sys</span><span class="ocamlDo">.</span><span class="ocamlLCIdentifier">max_string_length</span><span class="Statement">;<br/></li>
<li></span><span class="ocamlDo">&nbsp; &nbsp; </span><span class="Statement">done;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="ocamlLCIdentifier">tbl</span><span class="ocamlStruct">.</span><span class="Statement">(</span><span class="ocamlLCIdentifier">tbl_size</span><span class="ocamlStruct"> - </span><span class="Constant">1</span><span class="Statement">)</span><span class="ocamlStruct"> </span><span class="Statement">&lt;-</span><span class="ocamlStruct"> </span><span class="PreProc">Bytes</span><span class="ocamlStruct">.</span><span class="ocamlLCIdentifier"><a href="lazy_backtrack.mli.html#L21" title="ocaml/utils/lazy_backtrack.mli:21">create</a></span><span class="ocamlStruct"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">str_size</span><span class="ocamlStruct"> </span><span class="Statement">mod</span><span class="ocamlStruct"> </span><span class="PreProc">Sys</span><span class="ocamlStruct">.</span><span class="ocamlLCIdentifier">max_string_length</span><span class="Statement">);<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="ocamlLCIdentifier">tbl<br/></li>
<li></span><br/></li>
<li><span class="ocamlStruct">&nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="arg_helper.ml.html#L77" title="ocaml/utils/arg_helper.ml:77">length</a></span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">tbl</span><span class="ocamlStruct"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">tbl_size</span><span class="ocamlStruct"> </span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="PreProc">Array</span><span class="ocamlStruct">.</span><span class="ocamlLCIdentifier"><a href="arg_helper.ml.html#L77" title="ocaml/utils/arg_helper.ml:77">length</a></span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">tbl</span><span class="ocamlStruct"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="PreProc">Sys</span><span class="ocamlStruct">.</span><span class="ocamlLCIdentifier">max_string_length</span><span class="ocamlStruct"> </span><span class="Statement">*</span><span class="ocamlStruct"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">tbl_size</span><span class="ocamlStruct"> - </span><span class="Constant">1</span><span class="Statement">)</span><span class="ocamlStruct"> + </span><span class="PreProc">Bytes</span><span class="ocamlStruct">.</span><span class="ocamlLCIdentifier"><a href="arg_helper.ml.html#L77" title="ocaml/utils/arg_helper.ml:77">length</a></span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">tbl</span><span class="ocamlStruct">.</span><span class="Statement">(</span><span class="ocamlLCIdentifier">tbl_size</span><span class="ocamlStruct"> - </span><span class="Constant">1</span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li><span class="ocamlStruct">&nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="arg_helper.ml.html#L116" title="ocaml/utils/arg_helper.ml:116">get</a></span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">tbl</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">ind</span><span class="ocamlStruct"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="PreProc">Bytes</span><span class="ocamlStruct">.</span><span class="ocamlLCIdentifier"><a href="arg_helper.ml.html#L116" title="ocaml/utils/arg_helper.ml:116">get</a></span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">tbl</span><span class="ocamlStruct">.</span><span class="Statement">(</span><span class="ocamlLCIdentifier">ind</span><span class="ocamlStruct"> / </span><span class="PreProc">Sys</span><span class="ocamlStruct">.</span><span class="ocamlLCIdentifier">max_string_length</span><span class="Statement">)</span><span class="ocamlStruct"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">ind</span><span class="ocamlStruct"> </span><span class="Statement">mod</span><span class="ocamlStruct"> </span><span class="PreProc">Sys</span><span class="ocamlStruct">.</span><span class="ocamlLCIdentifier">max_string_length</span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li><span class="ocamlStruct">&nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">set</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">tbl</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">ind</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">c</span><span class="ocamlStruct"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="PreProc">Bytes</span><span class="ocamlStruct">.</span><span class="ocamlLCIdentifier">set</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">tbl</span><span class="ocamlStruct">.</span><span class="Statement">(</span><span class="ocamlLCIdentifier">ind</span><span class="ocamlStruct"> / </span><span class="PreProc">Sys</span><span class="ocamlStruct">.</span><span class="ocamlLCIdentifier">max_string_length</span><span class="Statement">)</span><span class="ocamlStruct"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">ind</span><span class="ocamlStruct"> </span><span class="Statement">mod</span><span class="ocamlStruct"> </span><span class="PreProc">Sys</span><span class="ocamlStruct">.</span><span class="ocamlLCIdentifier">max_string_length</span><span class="Statement">)<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier">c<br/></li>
<li></span><br/></li>
<li><span class="ocamlStruct">&nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">blit</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">src</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">srcoff</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">dst</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">dstoff</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="#L1117" title="ocaml/utils/misc.ml:1117">len</a></span><span class="ocamlStruct"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">for</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">i</span><span class="ocamlNone"> </span><span class="Statement">=</span><span class="ocamlNone"> </span><span class="Constant">0</span><span class="ocamlNone"> </span><span class="Statement">to</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="#L1117" title="ocaml/utils/misc.ml:1117">len</a></span><span class="ocamlStruct"> - </span><span class="Constant">1</span><span class="ocamlStruct"> </span><span class="Statement">do<br/></li>
<li></span><span class="ocamlDo">&nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier">set</span><span class="ocamlDo"> </span><span class="ocamlLCIdentifier">dst</span><span class="ocamlDo"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">dstoff</span><span class="ocamlDo"> + </span><span class="ocamlLCIdentifier">i</span><span class="Statement">)</span><span class="ocamlDo"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="arg_helper.ml.html#L116" title="ocaml/utils/arg_helper.ml:116">get</a></span><span class="ocamlDo"> </span><span class="ocamlLCIdentifier">src</span><span class="ocamlDo"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">srcoff</span><span class="ocamlDo"> + </span><span class="ocamlLCIdentifier">i</span><span class="Statement">))<br/></li>
<li></span><span class="ocamlDo">&nbsp; &nbsp; </span><span class="Statement">done<br/></li>
<li></span><br/></li>
<li><span class="ocamlStruct">&nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">blit_string</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">src</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">srcoff</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">dst</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">dstoff</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="#L1117" title="ocaml/utils/misc.ml:1117">len</a></span><span class="ocamlStruct"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">for</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">i</span><span class="ocamlNone"> </span><span class="Statement">=</span><span class="ocamlNone"> </span><span class="Constant">0</span><span class="ocamlNone"> </span><span class="Statement">to</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="#L1117" title="ocaml/utils/misc.ml:1117">len</a></span><span class="ocamlStruct"> - </span><span class="Constant">1</span><span class="ocamlStruct"> </span><span class="Statement">do<br/></li>
<li></span><span class="ocamlDo">&nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier">set</span><span class="ocamlDo"> </span><span class="ocamlLCIdentifier">dst</span><span class="ocamlDo"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">dstoff</span><span class="ocamlDo"> + </span><span class="ocamlLCIdentifier">i</span><span class="Statement">)</span><span class="ocamlDo"> </span><span class="Statement">(</span><span class="PreProc">String</span><span class="ocamlDo">.</span><span class="ocamlLCIdentifier"><a href="arg_helper.ml.html#L116" title="ocaml/utils/arg_helper.ml:116">get</a></span><span class="ocamlDo"> </span><span class="ocamlLCIdentifier">src</span><span class="ocamlDo"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">srcoff</span><span class="ocamlDo"> + </span><span class="ocamlLCIdentifier">i</span><span class="Statement">))<br/></li>
<li></span><span class="ocamlDo">&nbsp; &nbsp; </span><span class="Statement">done<br/></li>
<li></span><br/></li>
<li><span class="ocamlStruct">&nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="identifiable.ml.html#L23" title="ocaml/utils/identifiable.ml:23">output</a></span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">oc</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">tbl</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="strongly_connected_components.ml.html#L39" title="ocaml/utils/strongly_connected_components.ml:39">pos</a></span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="#L1117" title="ocaml/utils/misc.ml:1117">len</a></span><span class="ocamlStruct"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">for</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">i</span><span class="ocamlNone"> </span><span class="Statement">=</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier"><a href="strongly_connected_components.ml.html#L39" title="ocaml/utils/strongly_connected_components.ml:39">pos</a></span><span class="ocamlNone"> </span><span class="Statement">to</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="strongly_connected_components.ml.html#L39" title="ocaml/utils/strongly_connected_components.ml:39">pos</a></span><span class="ocamlStruct"> + </span><span class="ocamlLCIdentifier"><a href="#L1117" title="ocaml/utils/misc.ml:1117">len</a></span><span class="ocamlStruct"> - </span><span class="Constant">1</span><span class="ocamlStruct"> </span><span class="Statement">do<br/></li>
<li></span><span class="ocamlDo">&nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier">output_char</span><span class="ocamlDo"> </span><span class="ocamlLCIdentifier">oc</span><span class="ocamlDo"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="arg_helper.ml.html#L116" title="ocaml/utils/arg_helper.ml:116">get</a></span><span class="ocamlDo"> </span><span class="ocamlLCIdentifier">tbl</span><span class="ocamlDo"> </span><span class="ocamlLCIdentifier">i</span><span class="Statement">)<br/></li>
<li></span><span class="ocamlDo">&nbsp; &nbsp; </span><span class="Statement">done<br/></li>
<li></span><br/></li>
<li><span class="ocamlStruct">&nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">input_bytes_into</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">tbl</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">ic</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="#L1117" title="ocaml/utils/misc.ml:1117">len</a></span><span class="ocamlStruct"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">count</span><span class="ocamlStruct"> </span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">ref</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="#L1117" title="ocaml/utils/misc.ml:1117">len</a></span><span class="ocamlStruct"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="PreProc">Array</span><span class="ocamlStruct">.</span><span class="ocamlLCIdentifier">iter</span><span class="ocamlStruct"> </span><span class="Statement">(fun</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">str</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">chunk</span><span class="ocamlStruct"> </span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="PreProc">Int</span><span class="ocamlStruct">.</span><span class="ocamlLCIdentifier">min</span><span class="ocamlStruct"> </span><span class="Statement">!</span><span class="ocamlLCIdentifier">count</span><span class="ocamlStruct"> </span><span class="Statement">(</span><span class="PreProc">Bytes</span><span class="ocamlStruct">.</span><span class="ocamlLCIdentifier"><a href="arg_helper.ml.html#L77" title="ocaml/utils/arg_helper.ml:77">length</a></span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">str</span><span class="Statement">)</span><span class="ocamlStruct"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier">really_input</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">ic</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">str</span><span class="ocamlStruct"> </span><span class="Constant">0</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">chunk</span><span class="Statement">;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier">count</span><span class="ocamlStruct"> </span><span class="Statement">:=</span><span class="ocamlStruct"> </span><span class="Statement">!</span><span class="ocamlLCIdentifier">count</span><span class="ocamlStruct"> - </span><span class="ocamlLCIdentifier">chunk</span><span class="Statement">)</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">tbl<br/></li>
<li></span><br/></li>
<li><span class="ocamlStruct">&nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">input_bytes</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">ic</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="#L1117" title="ocaml/utils/misc.ml:1117">len</a></span><span class="ocamlStruct"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">tbl</span><span class="ocamlStruct"> </span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="lazy_backtrack.mli.html#L21" title="ocaml/utils/lazy_backtrack.mli:21">create</a></span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="#L1117" title="ocaml/utils/misc.ml:1117">len</a></span><span class="ocamlStruct"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="ocamlLCIdentifier">input_bytes_into</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">tbl</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">ic</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="#L1117" title="ocaml/utils/misc.ml:1117">len</a></span><span class="Statement">;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="ocamlLCIdentifier">tbl<br/></li>
<li></span><span class="PreProc">end<br/></li>
<li></span><br/></li>
<li><br/></li>
<li><a id="L553">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">edit_distance</span></span> <span class="ocamlLCIdentifier">a</span> <span class="ocamlLCIdentifier">b</span> <span class="ocamlLCIdentifier">cutoff</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">la</span>, <span class="ocamlLCIdentifier">lb</span> <span class="Statement">=</span> <span class="PreProc">String</span>.<span class="ocamlLCIdentifier"><a href="arg_helper.ml.html#L77" title="ocaml/utils/arg_helper.ml:77">length</a></span> <span class="ocamlLCIdentifier">a</span>, <span class="PreProc">String</span>.<span class="ocamlLCIdentifier"><a href="arg_helper.ml.html#L77" title="ocaml/utils/arg_helper.ml:77">length</a></span> <span class="ocamlLCIdentifier">b</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">cutoff</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="Comment">(* using <a href="targetint.mli.html#L92" title="ocaml/utils/targetint.mli:92">max_int</a> for cutoff would cause overflows in (i + cutoff + 1);<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp;&nbsp; we bring it back to the (max la lb) worstcase *)<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Int</span>.<span class="ocamlLCIdentifier">min</span> <span class="Statement">(</span><span class="PreProc">Int</span>.<span class="ocamlLCIdentifier">max</span> <span class="ocamlLCIdentifier">la</span> <span class="ocamlLCIdentifier">lb</span><span class="Statement">)</span> <span class="ocamlLCIdentifier">cutoff</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier"><a href="targetint.mli.html#L85" title="ocaml/utils/targetint.mli:85">abs</a></span><span class="ocamlNone"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">la</span><span class="ocamlNone"> - </span><span class="ocamlLCIdentifier">lb</span><span class="Statement">)</span><span class="ocamlNone"> </span><span class="Statement">&gt;</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">cutoff</span><span class="ocamlNone"> </span><span class="Statement">then</span> <span class="Constant">None<br/></li>
<li></span>&nbsp; <span class="Statement">else</span> <span class="Statement">begin<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="Comment">(* initialize with 'cutoff + 1' so that not-yet-written-to cases have<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp;&nbsp; the worst possible cost; this is useful when computing the cost of<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp;&nbsp; a case just at the boundary of the cutoff diagonal. *)<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">m</span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="PreProc">Array</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">make_matrix</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">la</span><span class="ocamlEnd"> + </span><span class="Constant">1</span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">lb</span><span class="ocamlEnd"> + </span><span class="Constant">1</span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">cutoff</span><span class="ocamlEnd"> + </span><span class="Constant">1</span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="ocamlLCIdentifier">m</span><span class="ocamlEnd">.</span><span class="Statement">(</span><span class="Constant">0</span><span class="Statement">)</span><span class="ocamlEnd">.</span><span class="Statement">(</span><span class="Constant">0</span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="Statement">&lt;-</span><span class="ocamlEnd"> </span><span class="Constant">0</span><span class="Statement">;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="Statement">for</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">i</span><span class="ocamlNone"> </span><span class="Statement">=</span><span class="ocamlNone"> </span><span class="Constant">1</span><span class="ocamlNone"> </span><span class="Statement">to</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">la</span><span class="ocamlEnd"> </span><span class="Statement">do<br/></li>
<li></span><span class="ocamlDo">&nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier">m</span><span class="ocamlDo">.</span><span class="Statement">(</span><span class="ocamlLCIdentifier">i</span><span class="Statement">)</span><span class="ocamlDo">.</span><span class="Statement">(</span><span class="Constant">0</span><span class="Statement">)</span><span class="ocamlDo"> </span><span class="Statement">&lt;-</span><span class="ocamlDo"> </span><span class="ocamlLCIdentifier">i</span><span class="Statement">;<br/></li>
<li></span><span class="ocamlDo">&nbsp; &nbsp; </span><span class="Statement">done;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="Statement">for</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">j</span><span class="ocamlNone"> </span><span class="Statement">=</span><span class="ocamlNone"> </span><span class="Constant">1</span><span class="ocamlNone"> </span><span class="Statement">to</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">lb</span><span class="ocamlEnd"> </span><span class="Statement">do<br/></li>
<li></span><span class="ocamlDo">&nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier">m</span><span class="ocamlDo">.</span><span class="Statement">(</span><span class="Constant">0</span><span class="Statement">)</span><span class="ocamlDo">.</span><span class="Statement">(</span><span class="ocamlLCIdentifier">j</span><span class="Statement">)</span><span class="ocamlDo"> </span><span class="Statement">&lt;-</span><span class="ocamlDo"> </span><span class="ocamlLCIdentifier">j</span><span class="Statement">;<br/></li>
<li></span><span class="ocamlDo">&nbsp; &nbsp; </span><span class="Statement">done;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="Statement">for</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">i</span><span class="ocamlNone"> </span><span class="Statement">=</span><span class="ocamlNone"> </span><span class="Constant">1</span><span class="ocamlNone"> </span><span class="Statement">to</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">la</span><span class="ocamlEnd"> </span><span class="Statement">do<br/></li>
<li></span><span class="ocamlDo">&nbsp; &nbsp; &nbsp; </span><span class="Statement">for</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">j</span><span class="ocamlNone"> </span><span class="Statement">=</span><span class="ocamlNone"> </span><span class="PreProc">Int</span><span class="ocamlNone">.</span><span class="ocamlLCIdentifier">max</span><span class="ocamlNone"> </span><span class="Constant">1</span><span class="ocamlNone"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">i</span><span class="ocamlNone"> - </span><span class="ocamlLCIdentifier">cutoff</span><span class="ocamlNone"> - </span><span class="Constant">1</span><span class="Statement">)</span><span class="ocamlNone"> </span><span class="Statement">to</span><span class="ocamlDo"> </span><span class="PreProc">Int</span><span class="ocamlDo">.</span><span class="ocamlLCIdentifier">min</span><span class="ocamlDo"> </span><span class="ocamlLCIdentifier">lb</span><span class="ocamlDo"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">i</span><span class="ocamlDo"> + </span><span class="ocamlLCIdentifier">cutoff</span><span class="ocamlDo"> + </span><span class="Constant">1</span><span class="Statement">)</span><span class="ocamlDo"> </span><span class="Statement">do<br/></li>
<li></span><span class="ocamlDo">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlDo"> </span><span class="ocamlLCIdentifier">cost</span><span class="ocamlDo"> </span><span class="Statement">=</span><span class="ocamlDo"> </span><span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">a</span><span class="ocamlNone">.</span><span class="Statement">[</span><span class="ocamlLCIdentifier">i</span><span class="ocamlNone">-</span><span class="Constant">1</span><span class="Statement">]</span><span class="ocamlNone"> </span><span class="Statement">=</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">b</span><span class="ocamlNone">.</span><span class="Statement">[</span><span class="ocamlLCIdentifier">j</span><span class="ocamlNone">-</span><span class="Constant">1</span><span class="Statement">]</span><span class="ocamlNone"> </span><span class="Statement">then</span><span class="ocamlDo"> </span><span class="Constant">0</span><span class="ocamlDo"> </span><span class="Statement">else</span><span class="ocamlDo"> </span><span class="Constant">1</span><span class="ocamlDo"> </span><span class="Statement">in<br/></li>
<li><a id="L575">&#x200c;</a></span><span class="ocamlDo">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlDo"> </span><span class="ocamlLCIdentifier"><span class="linkable">best</span></span><span class="ocamlDo"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlDo">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Comment">(* insert, delete or substitute *)<br/></li>
<li></span><span class="ocamlDo">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="PreProc">Int</span><span class="ocamlDo">.</span><span class="ocamlLCIdentifier">min</span><span class="ocamlDo"> </span><span class="Statement">(</span><span class="Constant">1</span><span class="ocamlDo"> + </span><span class="PreProc">Int</span><span class="ocamlDo">.</span><span class="ocamlLCIdentifier">min</span><span class="ocamlDo"> </span><span class="ocamlLCIdentifier">m</span><span class="ocamlDo">.</span><span class="Statement">(</span><span class="ocamlLCIdentifier">i</span><span class="ocamlDo">-</span><span class="Constant">1</span><span class="Statement">)</span><span class="ocamlDo">.</span><span class="Statement">(</span><span class="ocamlLCIdentifier">j</span><span class="Statement">)</span><span class="ocamlDo"> </span><span class="ocamlLCIdentifier">m</span><span class="ocamlDo">.</span><span class="Statement">(</span><span class="ocamlLCIdentifier">i</span><span class="Statement">)</span><span class="ocamlDo">.</span><span class="Statement">(</span><span class="ocamlLCIdentifier">j</span><span class="ocamlDo">-</span><span class="Constant">1</span><span class="Statement">))</span><span class="ocamlDo"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">m</span><span class="ocamlDo">.</span><span class="Statement">(</span><span class="ocamlLCIdentifier">i</span><span class="ocamlDo">-</span><span class="Constant">1</span><span class="Statement">)</span><span class="ocamlDo">.</span><span class="Statement">(</span><span class="ocamlLCIdentifier">j</span><span class="ocamlDo">-</span><span class="Constant">1</span><span class="Statement">)</span><span class="ocamlDo"> + </span><span class="ocamlLCIdentifier">cost</span><span class="Statement">)<br/></li>
<li></span><span class="ocamlDo">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">in<br/></li>
<li><a id="L579">&#x200c;</a></span><span class="ocamlDo">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlDo"> </span><span class="ocamlLCIdentifier"><span class="linkable">best</span></span><span class="ocamlDo"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlDo">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Comment">(* swap two adjacent letters; we use &quot;cost&quot; again in case of<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; a swap between two identical letters; this is slightly<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; redundant as this is a double-substitution case, but it<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; was done this way in most online implementations and<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; imitation has <a href="warnings.ml.html#L1077" title="ocaml/utils/warnings.ml:1077">its</a> virtues *)<br/></li>
<li></span><span class="ocamlDo">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">if</span><span class="ocamlNone"> </span><span class="Statement">not</span><span class="ocamlNone"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">i</span><span class="ocamlNone"> </span><span class="Statement">&gt;</span><span class="ocamlNone"> </span><span class="Constant">1</span><span class="ocamlNone"> </span><span class="Statement">&amp;&amp;</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">j</span><span class="ocamlNone"> </span><span class="Statement">&gt;</span><span class="ocamlNone"> </span><span class="Constant">1</span><span class="ocamlNone"> </span><span class="Statement">&amp;&amp;</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">a</span><span class="ocamlNone">.</span><span class="Statement">[</span><span class="ocamlLCIdentifier">i</span><span class="ocamlNone">-</span><span class="Constant">1</span><span class="Statement">]</span><span class="ocamlNone"> </span><span class="Statement">=</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">b</span><span class="ocamlNone">.</span><span class="Statement">[</span><span class="ocamlLCIdentifier">j</span><span class="ocamlNone">-</span><span class="Constant">2</span><span class="Statement">]</span><span class="ocamlNone"> </span><span class="Statement">&amp;&amp;</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">a</span><span class="ocamlNone">.</span><span class="Statement">[</span><span class="ocamlLCIdentifier">i</span><span class="ocamlNone">-</span><span class="Constant">2</span><span class="Statement">]</span><span class="ocamlNone"> </span><span class="Statement">=</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">b</span><span class="ocamlNone">.</span><span class="Statement">[</span><span class="ocamlLCIdentifier">j</span><span class="ocamlNone">-</span><span class="Constant">1</span><span class="Statement">])<br/></li>
<li></span><span class="ocamlNone">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">then</span><span class="ocamlDo"> </span><span class="ocamlLCIdentifier"><a href="#L575" title="ocaml/utils/misc.ml:575">best</a><br/></li>
<li></span><span class="ocamlDo">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">else</span><span class="ocamlDo"> </span><span class="PreProc">Int</span><span class="ocamlDo">.</span><span class="ocamlLCIdentifier">min</span><span class="ocamlDo"> </span><span class="ocamlLCIdentifier"><a href="#L575" title="ocaml/utils/misc.ml:575">best</a></span><span class="ocamlDo"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">m</span><span class="ocamlDo">.</span><span class="Statement">(</span><span class="ocamlLCIdentifier">i</span><span class="ocamlDo">-</span><span class="Constant">2</span><span class="Statement">)</span><span class="ocamlDo">.</span><span class="Statement">(</span><span class="ocamlLCIdentifier">j</span><span class="ocamlDo">-</span><span class="Constant">2</span><span class="Statement">)</span><span class="ocamlDo"> + </span><span class="ocamlLCIdentifier">cost</span><span class="Statement">)<br/></li>
<li></span><span class="ocamlDo">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlDo">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier">m</span><span class="ocamlDo">.</span><span class="Statement">(</span><span class="ocamlLCIdentifier">i</span><span class="Statement">)</span><span class="ocamlDo">.</span><span class="Statement">(</span><span class="ocamlLCIdentifier">j</span><span class="Statement">)</span><span class="ocamlDo"> </span><span class="Statement">&lt;-</span><span class="ocamlDo"> </span><span class="ocamlLCIdentifier"><a href="#L575" title="ocaml/utils/misc.ml:575">best</a><br/></li>
<li></span><span class="ocamlDo">&nbsp; &nbsp; &nbsp; </span><span class="Statement">done;<br/></li>
<li></span><span class="ocamlDo">&nbsp; &nbsp; </span><span class="Statement">done;<br/></li>
<li><a id="L592">&#x200c;</a></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><span class="linkable">result</span></span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">m</span><span class="ocamlEnd">.</span><span class="Statement">(</span><span class="ocamlLCIdentifier">la</span><span class="Statement">)</span><span class="ocamlEnd">.</span><span class="Statement">(</span><span class="ocamlLCIdentifier">lb</span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier"><a href="#L592" title="ocaml/utils/misc.ml:592">result</a></span><span class="ocamlNone"> </span><span class="Statement">&gt;</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">cutoff<br/></li>
<li></span><span class="ocamlNone">&nbsp; &nbsp; </span><span class="Statement">then</span><span class="ocamlEnd"> </span><span class="Constant">None<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="Statement">else</span><span class="ocamlEnd"> </span><span class="Constant">Some</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L592" title="ocaml/utils/misc.ml:592">result</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; </span><span class="Statement">end<br/></li>
<li></span><br/></li>
<li><a id="L598">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">spellcheck</span></span> <span class="ocamlLCIdentifier">env</span> <span class="ocamlLCIdentifier">name</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">cutoff</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">match</span> <span class="PreProc">String</span>.<span class="ocamlLCIdentifier"><a href="arg_helper.ml.html#L77" title="ocaml/utils/arg_helper.ml:77">length</a></span> <span class="ocamlLCIdentifier">name</span> <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">1</span> <span class="Statement">|</span> <span class="Constant">2</span> <span class="Statement">-&gt;</span> <span class="Constant">0<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">3</span> <span class="Statement">|</span> <span class="Constant">4</span> <span class="Statement">-&gt;</span> <span class="Constant">1<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">5</span> <span class="Statement">|</span> <span class="Constant">6</span> <span class="Statement">-&gt;</span> <span class="Constant">2<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Statement">_</span> <span class="Statement">-&gt;</span> <span class="Constant">3<br/></li>
<li></span>&nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="identifiable.ml.html#L90" title="ocaml/utils/identifiable.ml:90">compare</a></span> <span class="ocamlLCIdentifier"><a href="config.fixed.ml.html#L68" title="ocaml/utils/config.fixed.ml:68">target</a></span> <span class="ocamlLCIdentifier"><a href="arg_helper.ml.html#L95" title="ocaml/utils/arg_helper.ml:95">acc</a></span> <span class="ocamlLCIdentifier">head</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">match</span> <span class="ocamlLCIdentifier"><a href="#L553" title="ocaml/utils/misc.ml:553">edit_distance</a></span> <span class="ocamlLCIdentifier"><a href="config.fixed.ml.html#L68" title="ocaml/utils/config.fixed.ml:68">target</a></span> <span class="ocamlLCIdentifier">head</span> <span class="ocamlLCIdentifier">cutoff</span> <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">None</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier"><a href="arg_helper.ml.html#L95" title="ocaml/utils/arg_helper.ml:95">acc</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Some</span> <span class="ocamlLCIdentifier">dist</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">let</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">best_choice</span>, <span class="ocamlLCIdentifier">best_dist</span><span class="Statement">)</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="arg_helper.ml.html#L95" title="ocaml/utils/arg_helper.ml:95">acc</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">dist</span><span class="ocamlNone"> </span><span class="Statement">&lt;</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">best_dist</span><span class="ocamlNone"> </span><span class="Statement">then</span> <span class="Statement">([</span><span class="ocamlLCIdentifier">head</span><span class="Statement">]</span>, <span class="ocamlLCIdentifier">dist</span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">else</span> <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">dist</span><span class="ocamlNone"> </span><span class="Statement">=</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">best_dist</span><span class="ocamlNone"> </span><span class="Statement">then</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">head</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier">best_choice</span>, <span class="ocamlLCIdentifier">dist</span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">else</span> <span class="ocamlLCIdentifier"><a href="arg_helper.ml.html#L95" title="ocaml/utils/arg_helper.ml:95">acc</a><br/></li>
<li></span>&nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">env</span> <span class="Statement">=</span> <span class="PreProc">List</span>.<span class="ocamlLCIdentifier">sort_uniq</span> <span class="Statement">(fun</span> <span class="ocamlLCIdentifier">s1</span> <span class="ocamlLCIdentifier">s2</span> <span class="Statement">-&gt;</span> <span class="PreProc">String</span>.<span class="ocamlLCIdentifier"><a href="identifiable.ml.html#L90" title="ocaml/utils/identifiable.ml:90">compare</a></span> <span class="ocamlLCIdentifier">s2</span> <span class="ocamlLCIdentifier">s1</span><span class="Statement">)</span> <span class="ocamlLCIdentifier">env</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier">fst</span> <span class="Statement">(</span><span class="PreProc">List</span>.<span class="ocamlLCIdentifier">fold_left</span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="identifiable.ml.html#L90" title="ocaml/utils/identifiable.ml:90">compare</a></span> <span class="ocamlLCIdentifier">name</span><span class="Statement">)</span> <span class="Statement">(</span><span class="Constant">[]</span>, <span class="ocamlLCIdentifier"><a href="targetint.mli.html#L92" title="ocaml/utils/targetint.mli:92">max_int</a></span><span class="Statement">)</span> <span class="ocamlLCIdentifier">env</span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li><a id="L618">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">did_you_mean</span></span> <span class="ocamlLCIdentifier">ppf</span> <span class="ocamlLCIdentifier">get_choices</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Comment">(* flush now to <a href="arg_helper.ml.html#L116" title="ocaml/utils/arg_helper.ml:116">get</a> the <a href="binutils.mli.html#L16" title="ocaml/utils/binutils.mli:16">error</a> <a href="warnings.mli.html#L142" title="ocaml/utils/warnings.mli:142">report</a> early, in the (unheard of) case<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; where the search in the get_choices function would take a bit of<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; time; in the worst case, the user has seen the <a href="binutils.mli.html#L16" title="ocaml/utils/binutils.mli:16">error</a>, she can<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; interrupt the process before the spell-checking terminates. *)<br/></li>
<li></span>&nbsp; <span class="PreProc">Format</span>.<span class="ocamlLCIdentifier">fprintf</span> <span class="ocamlLCIdentifier">ppf</span> <span class="Constant">&quot;@?&quot;</span><span class="Statement">;<br/></li>
<li></span>&nbsp; <span class="Statement">match</span> <span class="ocamlLCIdentifier">get_choices</span> <span class="Constant">()</span> <span class="Statement">with<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">[]</span> <span class="Statement">-&gt;</span> <span class="Constant">()<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="ocamlLCIdentifier">choices</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp;&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="warnings.ml.html#L850" title="ocaml/utils/warnings.ml:850">rest</a></span>, <span class="ocamlLCIdentifier">last</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="#L91" title="ocaml/utils/misc.ml:91">split_last</a></span> <span class="ocamlLCIdentifier">choices</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp;&nbsp; <span class="PreProc">Format</span>.<span class="ocamlLCIdentifier">fprintf</span> <span class="ocamlLCIdentifier">ppf</span> <span class="Constant">&quot;@\n@{&lt;hint<a href="int_replace_polymorphic_compare.mli.html#L4" title="ocaml/utils/int_replace_polymorphic_compare.mli:4">&gt;</a>Hint@}: Did you mean %<a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a>%<a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a>%<a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a>?@?&quot;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">(</span><span class="PreProc">String</span>.<span class="ocamlLCIdentifier">concat</span> <span class="Constant">&quot;, &quot;</span> <span class="ocamlLCIdentifier"><a href="warnings.ml.html#L850" title="ocaml/utils/warnings.ml:850">rest</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">(if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier"><a href="warnings.ml.html#L850" title="ocaml/utils/warnings.ml:850">rest</a></span><span class="ocamlNone"> </span><span class="Statement">=</span><span class="ocamlNone"> </span><span class="Constant">[]</span><span class="ocamlNone"> </span><span class="Statement">then</span> <span class="Constant">&quot;&quot;</span> <span class="Statement">else</span> <span class="Constant">&quot; or &quot;</span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier">last<br/></li>
<li></span><br/></li>
<li><a id="L633">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">cut_at</span></span> <span class="ocamlLCIdentifier"><a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a></span> <span class="ocamlLCIdentifier">c</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="strongly_connected_components.ml.html#L39" title="ocaml/utils/strongly_connected_components.ml:39">pos</a></span> <span class="Statement">=</span> <span class="PreProc">String</span>.<span class="ocamlLCIdentifier">index</span> <span class="ocamlLCIdentifier"><a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a></span> <span class="ocamlLCIdentifier">c</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="PreProc">String</span>.<span class="ocamlLCIdentifier"><a href="targetint.mli.html#L50" title="ocaml/utils/targetint.mli:50">sub</a></span> <span class="ocamlLCIdentifier"><a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a></span> <span class="Constant">0</span> <span class="ocamlLCIdentifier"><a href="strongly_connected_components.ml.html#L39" title="ocaml/utils/strongly_connected_components.ml:39">pos</a></span>, <span class="PreProc">String</span>.<span class="ocamlLCIdentifier"><a href="targetint.mli.html#L50" title="ocaml/utils/targetint.mli:50">sub</a></span> <span class="ocamlLCIdentifier"><a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a></span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="strongly_connected_components.ml.html#L39" title="ocaml/utils/strongly_connected_components.ml:39">pos</a></span>+<span class="Constant">1</span><span class="Statement">)</span> <span class="Statement">(</span><span class="PreProc">String</span>.<span class="ocamlLCIdentifier"><a href="arg_helper.ml.html#L77" title="ocaml/utils/arg_helper.ml:77">length</a></span> <span class="ocamlLCIdentifier"><a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a></span> - <span class="ocamlLCIdentifier"><a href="strongly_connected_components.ml.html#L39" title="ocaml/utils/strongly_connected_components.ml:39">pos</a></span> - <span class="Constant">1</span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li><a id="L637">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">ordinal_suffix</span></span> <span class="ocamlLCIdentifier">n</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">teen</span> <span class="Statement">=</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">n</span> <span class="Statement">mod</span> <span class="Constant">100</span><span class="Statement">)</span>/<span class="Constant">10</span> <span class="Statement">=</span> <span class="Constant">1</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">match</span> <span class="ocamlLCIdentifier">n</span> <span class="Statement">mod</span> <span class="Constant">10</span> <span class="Statement">with<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">1</span> <span class="Statement">when</span> <span class="Statement">not</span> <span class="ocamlLCIdentifier">teen</span> <span class="Statement">-&gt;</span> <span class="Constant">&quot;st&quot;<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">2</span> <span class="Statement">when</span> <span class="Statement">not</span> <span class="ocamlLCIdentifier">teen</span> <span class="Statement">-&gt;</span> <span class="Constant">&quot;nd&quot;<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">3</span> <span class="Statement">when</span> <span class="Statement">not</span> <span class="ocamlLCIdentifier">teen</span> <span class="Statement">-&gt;</span> <span class="Constant">&quot;rd&quot;<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Statement">_</span> <span class="Statement">-&gt;</span> <span class="Constant">&quot;th&quot;<br/></li>
<li></span><br/></li>
<li><span class="Comment">(* Color handling *)<br/></li>
<li></span><span class="Statement">module</span><span class="PreProc"> Color</span><span class="ocamlPreDef"> </span><span class="Statement">=</span> <span class="PreProc">struct<br/></li>
<li></span><span class="ocamlStruct">&nbsp; </span><span class="Comment">(* use ANSI <a href="clflags.mli.html#L232" title="ocaml/utils/clflags.mli:232">color</a> codes, see https://en.wikipedia.org/wiki/ANSI_escape_code *)<br/></li>
<li></span><span class="ocamlStruct">&nbsp; </span><span class="Statement">type</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="clflags.mli.html#L232" title="ocaml/utils/clflags.mli:232">color</a></span><span class="ocamlStruct"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Black<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Red<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Green<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Yellow<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Blue<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Magenta<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Cyan<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">White<br/></li>
<li></span><br/></li>
<li><span class="ocamlStruct">&nbsp; </span><span class="Statement">type</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="diffing.ml.html#L38" title="ocaml/utils/diffing.ml:38">style</a></span><span class="ocamlStruct"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">FG</span><span class="ocamlStruct"> </span><span class="Statement">of</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="clflags.mli.html#L232" title="ocaml/utils/clflags.mli:232">color</a></span><span class="ocamlStruct"> </span><span class="Comment">(* foreground *)<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">BG</span><span class="ocamlStruct"> </span><span class="Statement">of</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="clflags.mli.html#L232" title="ocaml/utils/clflags.mli:232">color</a></span><span class="ocamlStruct"> </span><span class="Comment">(* background *)<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Bold<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Reset<br/></li>
<li></span><br/></li>
<li><span class="ocamlStruct">&nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">ansi_of_color</span><span class="ocamlStruct"> </span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="Statement">function<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Black</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="Constant">&quot;0&quot;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Red</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="Constant">&quot;1&quot;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Green</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="Constant">&quot;2&quot;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Yellow</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="Constant">&quot;3&quot;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Blue</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="Constant">&quot;4&quot;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Magenta</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="Constant">&quot;5&quot;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Cyan</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="Constant">&quot;6&quot;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">White</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="Constant">&quot;7&quot;<br/></li>
<li></span><br/></li>
<li><span class="ocamlStruct">&nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">code_of_style</span><span class="ocamlStruct"> </span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="Statement">function<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">FG</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">c</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="Constant">&quot;3&quot;</span><span class="ocamlStruct"> </span><span class="Statement">^</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">ansi_of_color</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">c<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">BG</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">c</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="Constant">&quot;4&quot;</span><span class="ocamlStruct"> </span><span class="Statement">^</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">ansi_of_color</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">c<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Bold</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="Constant">&quot;1&quot;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Reset</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="Constant">&quot;0&quot;<br/></li>
<li></span><br/></li>
<li><span class="ocamlStruct">&nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">ansi_of_style_l</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">l</span><span class="ocamlStruct"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a></span><span class="ocamlStruct"> </span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="Statement">match</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">l</span><span class="ocamlStruct"> </span><span class="Statement">with<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">[]</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">code_of_style</span><span class="ocamlStruct"> </span><span class="Constant">Reset<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Statement">[</span><span class="ocamlLCIdentifier"><a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a></span><span class="Statement">]</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">code_of_style</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a><br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Statement">_</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="PreProc">String</span><span class="ocamlStruct">.</span><span class="ocamlLCIdentifier">concat</span><span class="ocamlStruct"> </span><span class="Constant">&quot;;&quot;</span><span class="ocamlStruct"> </span><span class="Statement">(</span><span class="PreProc">List</span><span class="ocamlStruct">.</span><span class="ocamlLCIdentifier"><a href="identifiable.ml.html#L37" title="ocaml/utils/identifiable.ml:37">map</a></span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">code_of_style</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">l</span><span class="Statement">)<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Constant">&quot;\x1b[&quot;</span><span class="ocamlStruct"> </span><span class="Statement">^</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a></span><span class="ocamlStruct"> </span><span class="Statement">^</span><span class="ocamlStruct"> </span><span class="Constant">&quot;m&quot;<br/></li>
<li></span><br/></li>
<li><br/></li>
<li><span class="ocamlStruct">&nbsp; </span><span class="Statement">type</span><span class="ocamlStruct"> </span><span class="PreProc">Format</span><span class="ocamlStruct">.</span><span class="ocamlLCIdentifier">stag</span><span class="ocamlStruct"> +</span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="Constant">Style</span><span class="ocamlStruct"> </span><span class="Statement">of</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="diffing.ml.html#L38" title="ocaml/utils/diffing.ml:38">style</a></span><span class="ocamlStruct"> </span><span class="Type">list<br/></li>
<li></span><span class="ocamlStruct">&nbsp; </span><span class="Statement">type</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">styles</span><span class="ocamlStruct"> </span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="Statement">{<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="binutils.mli.html#L16" title="ocaml/utils/binutils.mli:16">error</a></span><span class="ocamlStruct">: </span><span class="ocamlLCIdentifier"><a href="diffing.ml.html#L38" title="ocaml/utils/diffing.ml:38">style</a></span><span class="ocamlStruct"> </span><span class="Type">list</span><span class="Statement">;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="ocamlLCIdentifier">warning</span><span class="ocamlStruct">: </span><span class="ocamlLCIdentifier"><a href="diffing.ml.html#L38" title="ocaml/utils/diffing.ml:38">style</a></span><span class="ocamlStruct"> </span><span class="Type">list</span><span class="Statement">;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="warnings.mli.html#L23" title="ocaml/utils/warnings.mli:23">loc</a></span><span class="ocamlStruct">: </span><span class="ocamlLCIdentifier"><a href="diffing.ml.html#L38" title="ocaml/utils/diffing.ml:38">style</a></span><span class="ocamlStruct"> </span><span class="Type">list</span><span class="Statement">;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="ocamlLCIdentifier">hint</span><span class="ocamlStruct">:</span><span class="ocamlLCIdentifier"><a href="diffing.ml.html#L38" title="ocaml/utils/diffing.ml:38">style</a></span><span class="ocamlStruct"> </span><span class="Type">list</span><span class="Statement">;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; </span><span class="Statement">}<br/></li>
<li></span><br/></li>
<li><span class="ocamlStruct">&nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">default_styles</span><span class="ocamlStruct"> </span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="Statement">{<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="ocamlLCIdentifier">warning</span><span class="ocamlStruct"> </span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="Statement">[</span><span class="Constant">Bold</span><span class="Statement">;</span><span class="ocamlStruct"> </span><span class="Constant">FG</span><span class="ocamlStruct"> </span><span class="Constant">Magenta</span><span class="Statement">];<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="binutils.mli.html#L16" title="ocaml/utils/binutils.mli:16">error</a></span><span class="ocamlStruct"> </span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="Statement">[</span><span class="Constant">Bold</span><span class="Statement">;</span><span class="ocamlStruct"> </span><span class="Constant">FG</span><span class="ocamlStruct"> </span><span class="Constant">Red</span><span class="Statement">];<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="warnings.mli.html#L23" title="ocaml/utils/warnings.mli:23">loc</a></span><span class="ocamlStruct"> </span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="Statement">[</span><span class="Constant">Bold</span><span class="Statement">];<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="ocamlLCIdentifier">hint</span><span class="ocamlStruct"> </span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="Statement">[</span><span class="Constant">Bold</span><span class="Statement">;</span><span class="ocamlStruct"> </span><span class="Constant">FG</span><span class="ocamlStruct"> </span><span class="Constant">Blue</span><span class="Statement">];<br/></li>
<li></span><span class="ocamlStruct">&nbsp; </span><span class="Statement">}<br/></li>
<li></span><br/></li>
<li><span class="ocamlStruct">&nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">cur_styles</span><span class="ocamlStruct"> </span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">ref</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">default_styles<br/></li>
<li></span><span class="ocamlStruct">&nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">get_styles</span><span class="ocamlStruct"> </span><span class="Constant">()</span><span class="ocamlStruct"> </span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="Statement">!</span><span class="ocamlLCIdentifier">cur_styles<br/></li>
<li></span><span class="ocamlStruct">&nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">set_styles</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a></span><span class="ocamlStruct"> </span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">cur_styles</span><span class="ocamlStruct"> </span><span class="Statement">:=</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a><br/></li>
<li></span><br/></li>
<li><span class="ocamlStruct">&nbsp; </span><span class="Comment">(* <a href="identifiable.ml.html#L37" title="ocaml/utils/identifiable.ml:37">map</a> a tag to a <a href="diffing.ml.html#L38" title="ocaml/utils/diffing.ml:38">style</a>, if the tag is known.<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; @raise Not_found otherwise *)<br/></li>
<li></span><span class="ocamlStruct">&nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">style_of_tag</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a></span><span class="ocamlStruct"> </span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="Statement">match</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a></span><span class="ocamlStruct"> </span><span class="Statement">with<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="PreProc">Format</span><span class="ocamlStruct">.</span><span class="Constant">String_tag</span><span class="ocamlStruct"> </span><span class="Constant">&quot;<a href="binutils.mli.html#L16" title="ocaml/utils/binutils.mli:16">error</a>&quot;</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="Statement">(!</span><span class="ocamlLCIdentifier">cur_styles</span><span class="Statement">)</span><span class="ocamlStruct">.</span><span class="ocamlLCIdentifier"><a href="binutils.mli.html#L16" title="ocaml/utils/binutils.mli:16">error</a><br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="PreProc">Format</span><span class="ocamlStruct">.</span><span class="Constant">String_tag</span><span class="ocamlStruct"> </span><span class="Constant">&quot;warning&quot;</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="Statement">(!</span><span class="ocamlLCIdentifier">cur_styles</span><span class="Statement">)</span><span class="ocamlStruct">.</span><span class="ocamlLCIdentifier">warning<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="PreProc">Format</span><span class="ocamlStruct">.</span><span class="Constant">String_tag</span><span class="ocamlStruct"> </span><span class="Constant">&quot;<a href="warnings.mli.html#L23" title="ocaml/utils/warnings.mli:23">loc</a>&quot;</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="Statement">(!</span><span class="ocamlLCIdentifier">cur_styles</span><span class="Statement">)</span><span class="ocamlStruct">.</span><span class="ocamlLCIdentifier"><a href="warnings.mli.html#L23" title="ocaml/utils/warnings.mli:23">loc</a><br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="PreProc">Format</span><span class="ocamlStruct">.</span><span class="Constant">String_tag</span><span class="ocamlStruct"> </span><span class="Constant">&quot;hint&quot;</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="Statement">(!</span><span class="ocamlLCIdentifier">cur_styles</span><span class="Statement">)</span><span class="ocamlStruct">.</span><span class="ocamlLCIdentifier">hint<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Style</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a></span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a><br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Statement">_</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="Statement">raise</span><span class="ocamlStruct"> </span><span class="Constant">Not_found<br/></li>
<li></span><br/></li>
<li><span class="ocamlStruct">&nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">color_enabled</span><span class="ocamlStruct"> </span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">ref</span><span class="ocamlStruct"> </span><span class="Constant">true<br/></li>
<li></span><br/></li>
<li><span class="ocamlStruct">&nbsp; </span><span class="Comment">(* either prints the tag of [<a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a>] or delegates to [or_else] *)<br/></li>
<li></span><span class="ocamlStruct">&nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">mark_open_tag</span><span class="ocamlStruct"> </span><span class="Statement">~</span><span class="Identifier">or_else</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a></span><span class="ocamlStruct"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">try<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="diffing.ml.html#L38" title="ocaml/utils/diffing.ml:38">style</a></span><span class="ocamlStruct"> </span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">style_of_tag</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a></span><span class="ocamlStruct"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; </span><span class="Statement">if</span><span class="ocamlNone"> </span><span class="Statement">!</span><span class="ocamlLCIdentifier">color_enabled</span><span class="ocamlNone"> </span><span class="Statement">then</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">ansi_of_style_l</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="diffing.ml.html#L38" title="ocaml/utils/diffing.ml:38">style</a></span><span class="ocamlStruct"> </span><span class="Statement">else</span><span class="ocamlStruct"> </span><span class="Constant">&quot;&quot;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">with</span><span class="ocamlStruct"> </span><span class="Constant">Not_found</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">or_else</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a><br/></li>
<li></span><br/></li>
<li><span class="ocamlStruct">&nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">mark_close_tag</span><span class="ocamlStruct"> </span><span class="Statement">~</span><span class="Identifier">or_else</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a></span><span class="ocamlStruct"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">try<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="Statement">_</span><span class="ocamlStruct"> </span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">style_of_tag</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a></span><span class="ocamlStruct"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; </span><span class="Statement">if</span><span class="ocamlNone"> </span><span class="Statement">!</span><span class="ocamlLCIdentifier">color_enabled</span><span class="ocamlNone"> </span><span class="Statement">then</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">ansi_of_style_l</span><span class="ocamlStruct"> </span><span class="Statement">[</span><span class="Constant">Reset</span><span class="Statement">]</span><span class="ocamlStruct"> </span><span class="Statement">else</span><span class="ocamlStruct"> </span><span class="Constant">&quot;&quot;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">with</span><span class="ocamlStruct"> </span><span class="Constant">Not_found</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">or_else</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a><br/></li>
<li></span><br/></li>
<li><span class="ocamlStruct">&nbsp; </span><span class="Comment">(* <a href="load_path.ml.html#L109" title="ocaml/utils/load_path.ml:109">add</a> <a href="clflags.mli.html#L232" title="ocaml/utils/clflags.mli:232">color</a> handling to formatter [ppf] *)<br/></li>
<li></span><span class="ocamlStruct">&nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">set_color_tag_handling</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">ppf</span><span class="ocamlStruct"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="Statement">open</span><span class="ocamlNone"> </span><span class="PreProc">Format</span><span class="ocamlStruct"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">functions</span><span class="ocamlStruct"> </span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">pp_get_formatter_stag_functions</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">ppf</span><span class="ocamlStruct"> </span><span class="Constant">()</span><span class="ocamlStruct"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">functions</span><span class="ocamlStruct">' </span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="Statement">{</span><span class="ocamlLCIdentifier">functions</span><span class="ocamlStruct"> </span><span class="Statement">with<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier">mark_open_stag</span><span class="Statement">=(</span><span class="ocamlLCIdentifier">mark_open_tag</span><span class="ocamlStruct"> </span><span class="Statement">~</span><span class="Identifier">or_else</span><span class="ocamlStruct">:</span><span class="ocamlLCIdentifier">functions</span><span class="ocamlStruct">.</span><span class="ocamlLCIdentifier">mark_open_stag</span><span class="Statement">);<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier">mark_close_stag</span><span class="Statement">=(</span><span class="ocamlLCIdentifier">mark_close_tag</span><span class="ocamlStruct"> </span><span class="Statement">~</span><span class="Identifier">or_else</span><span class="ocamlStruct">:</span><span class="ocamlLCIdentifier">functions</span><span class="ocamlStruct">.</span><span class="ocamlLCIdentifier">mark_close_stag</span><span class="Statement">);<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">}</span><span class="ocamlStruct"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="ocamlLCIdentifier">pp_set_mark_tags</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">ppf</span><span class="ocamlStruct"> </span><span class="Constant">true</span><span class="Statement">;</span><span class="ocamlStruct"> </span><span class="Comment">(* enable tags *)<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="ocamlLCIdentifier">pp_set_formatter_stag_functions</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">ppf</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">functions</span><span class="ocamlStruct">'</span><span class="Statement">;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Constant">()<br/></li>
<li></span><br/></li>
<li><span class="ocamlStruct">&nbsp; </span><span class="Statement">external</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">isatty</span><span class="ocamlStruct"> : </span><span class="ocamlLCIdentifier">out_channel</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="Type">bool</span><span class="ocamlStruct"> </span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="Constant">&quot;caml_sys_isatty&quot;<br/></li>
<li></span><br/></li>
<li><span class="ocamlStruct">&nbsp; </span><span class="Comment">(* reasonable heuristic on whether colors should be enabled *)<br/></li>
<li></span><span class="ocamlStruct">&nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">should_enable_color</span><span class="ocamlStruct"> </span><span class="Constant">()</span><span class="ocamlStruct"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">term</span><span class="ocamlStruct"> </span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="Statement">try</span><span class="ocamlStruct"> </span><span class="PreProc">Sys</span><span class="ocamlStruct">.</span><span class="ocamlLCIdentifier">getenv</span><span class="ocamlStruct"> </span><span class="Constant">&quot;TERM&quot;</span><span class="ocamlStruct"> </span><span class="Statement">with</span><span class="ocamlStruct"> </span><span class="Constant">Not_found</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="Constant">&quot;&quot;</span><span class="ocamlStruct"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="ocamlLCIdentifier">term</span><span class="ocamlStruct"> </span><span class="Statement">&lt;&gt;</span><span class="ocamlStruct"> </span><span class="Constant">&quot;dumb&quot;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">&amp;&amp;</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">term</span><span class="ocamlStruct"> </span><span class="Statement">&lt;&gt;</span><span class="ocamlStruct"> </span><span class="Constant">&quot;&quot;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">&amp;&amp;</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">isatty</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">stderr<br/></li>
<li></span><br/></li>
<li><span class="ocamlStruct">&nbsp; </span><span class="Statement">type</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">setting</span><span class="ocamlStruct"> </span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="Constant">Auto</span><span class="ocamlStruct"> </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Always</span><span class="ocamlStruct"> </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Never<br/></li>
<li></span><br/></li>
<li><span class="ocamlStruct">&nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">default_setting</span><span class="ocamlStruct"> </span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="Constant">Auto<br/></li>
<li></span><br/></li>
<li><span class="ocamlStruct">&nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="terminfo.mli.html#L28" title="ocaml/utils/terminfo.mli:28">setup</a></span><span class="ocamlStruct"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">first</span><span class="ocamlStruct"> </span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">ref</span><span class="ocamlStruct"> </span><span class="Constant">true</span><span class="ocamlStruct"> </span><span class="Statement">in</span><span class="ocamlStruct"> </span><span class="Comment">(* initialize only once *)<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">formatter_l</span><span class="ocamlStruct"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; </span><span class="Statement">[</span><span class="PreProc">Format</span><span class="ocamlStruct">.</span><span class="ocamlLCIdentifier">std_formatter</span><span class="Statement">;</span><span class="ocamlStruct"> </span><span class="PreProc">Format</span><span class="ocamlStruct">.</span><span class="ocamlLCIdentifier">err_formatter</span><span class="Statement">;</span><span class="ocamlStruct"> </span><span class="PreProc">Format</span><span class="ocamlStruct">.</span><span class="ocamlLCIdentifier">str_formatter</span><span class="Statement">]<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">enable_color</span><span class="ocamlStruct"> </span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="Statement">function<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Auto</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">should_enable_color</span><span class="ocamlStruct"> </span><span class="Constant">()<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Always</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="Constant">true<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Never</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="Constant">false<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">fun</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">o</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; </span><span class="Statement">if</span><span class="ocamlNone"> </span><span class="Statement">!</span><span class="ocamlLCIdentifier">first</span><span class="ocamlNone"> </span><span class="Statement">then</span><span class="ocamlStruct"> </span><span class="Statement">(<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier">first</span><span class="ocamlStruct"> </span><span class="Statement">:=</span><span class="ocamlStruct"> </span><span class="Constant">false</span><span class="Statement">;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="PreProc">Format</span><span class="ocamlStruct">.</span><span class="ocamlLCIdentifier">set_mark_tags</span><span class="ocamlStruct"> </span><span class="Constant">true</span><span class="Statement">;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="PreProc">List</span><span class="ocamlStruct">.</span><span class="ocamlLCIdentifier">iter</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">set_color_tag_handling</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">formatter_l</span><span class="Statement">;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier">color_enabled</span><span class="ocamlStruct"> </span><span class="Statement">:=</span><span class="ocamlStruct"> </span><span class="Statement">(match</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">o</span><span class="ocamlStruct"> </span><span class="Statement">with<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Some</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a></span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">enable_color</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a><br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">None</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">enable_color</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">default_setting</span><span class="Statement">)<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; </span><span class="Statement">);<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; </span><span class="Constant">()<br/></li>
<li></span><span class="PreProc">end<br/></li>
<li></span><br/></li>
<li><span class="Statement">module</span><span class="PreProc"> Error_style</span><span class="ocamlPreDef"> </span><span class="Statement">=</span> <span class="PreProc">struct<br/></li>
<li></span><span class="ocamlStruct">&nbsp; </span><span class="Statement">type</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">setting</span><span class="ocamlStruct"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Contextual<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Short<br/></li>
<li></span><br/></li>
<li><span class="ocamlStruct">&nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">default_setting</span><span class="ocamlStruct"> </span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="Constant">Contextual<br/></li>
<li></span><span class="PreProc">end<br/></li>
<li></span><br/></li>
<li><a id="L788">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">normalise_eol</span></span> <span class="ocamlLCIdentifier"><a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">b</span> <span class="Statement">=</span> <span class="PreProc">Buffer</span>.<span class="ocamlLCIdentifier"><a href="lazy_backtrack.mli.html#L21" title="ocaml/utils/lazy_backtrack.mli:21">create</a></span> <span class="Constant">80</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">for</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">i</span><span class="ocamlNone"> </span><span class="Statement">=</span><span class="ocamlNone"> </span><span class="Constant">0</span><span class="ocamlNone"> </span><span class="Statement">to</span> <span class="PreProc">String</span>.<span class="ocamlLCIdentifier"><a href="arg_helper.ml.html#L77" title="ocaml/utils/arg_helper.ml:77">length</a></span> <span class="ocamlLCIdentifier"><a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a></span> - <span class="Constant">1</span> <span class="Statement">do<br/></li>
<li></span><span class="ocamlDo">&nbsp; &nbsp; &nbsp; </span><span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier"><a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a></span><span class="ocamlNone">.</span><span class="Statement">[</span><span class="ocamlLCIdentifier">i</span><span class="Statement">]</span><span class="ocamlNone"> </span><span class="Statement">&lt;&gt;</span><span class="ocamlNone"> </span><span class="Constant">'\r'</span><span class="ocamlNone"> </span><span class="Statement">then</span><span class="ocamlDo"> </span><span class="PreProc">Buffer</span><span class="ocamlDo">.</span><span class="ocamlLCIdentifier">add_char</span><span class="ocamlDo"> </span><span class="ocamlLCIdentifier">b</span><span class="ocamlDo"> </span><span class="ocamlLCIdentifier"><a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a></span><span class="ocamlDo">.</span><span class="Statement">[</span><span class="ocamlLCIdentifier">i</span><span class="Statement">]<br/></li>
<li></span><span class="ocamlDo">&nbsp; &nbsp; </span><span class="Statement">done;<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Buffer</span>.<span class="ocamlLCIdentifier">contents</span> <span class="ocamlLCIdentifier">b<br/></li>
<li></span><br/></li>
<li><a id="L795">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">delete_eol_spaces</span></span> <span class="ocamlLCIdentifier">src</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">len_src</span> <span class="Statement">=</span> <span class="PreProc">String</span>.<span class="ocamlLCIdentifier"><a href="arg_helper.ml.html#L77" title="ocaml/utils/arg_helper.ml:77">length</a></span> <span class="ocamlLCIdentifier">src</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">dst</span> <span class="Statement">=</span> <span class="PreProc">Bytes</span>.<span class="ocamlLCIdentifier"><a href="lazy_backtrack.mli.html#L21" title="ocaml/utils/lazy_backtrack.mli:21">create</a></span> <span class="ocamlLCIdentifier">len_src</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="Statement">rec</span> <span class="ocamlLCIdentifier"><a href="profile.ml.html#L290" title="ocaml/utils/profile.ml:290">loop</a></span> <span class="ocamlLCIdentifier">i_src</span> <span class="ocamlLCIdentifier">i_dst</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">i_src</span><span class="ocamlNone"> </span><span class="Statement">=</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">len_src</span><span class="ocamlNone"> </span><span class="Statement">then<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">i_dst<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">match</span> <span class="ocamlLCIdentifier">src</span>.<span class="Statement">[</span><span class="ocamlLCIdentifier">i_src</span><span class="Statement">]</span> <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">' '</span> <span class="Statement">|</span> <span class="Constant">'\<a href="lazy_backtrack.mli.html#L16" title="ocaml/utils/lazy_backtrack.mli:16">t</a>'</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">loop_spaces</span> <span class="Constant">1</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">i_src</span> + <span class="Constant">1</span><span class="Statement">)</span> <span class="ocamlLCIdentifier">i_dst<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="ocamlLCIdentifier">c</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="PreProc">Bytes</span>.<span class="ocamlLCIdentifier">set</span> <span class="ocamlLCIdentifier">dst</span> <span class="ocamlLCIdentifier">i_dst</span> <span class="ocamlLCIdentifier">c</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="profile.ml.html#L290" title="ocaml/utils/profile.ml:290">loop</a></span> <span class="Statement">(</span><span class="ocamlLCIdentifier">i_src</span> + <span class="Constant">1</span><span class="Statement">)</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">i_dst</span> + <span class="Constant">1</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">and</span> <span class="ocamlLCIdentifier">loop_spaces</span> <span class="ocamlLCIdentifier">spaces</span> <span class="ocamlLCIdentifier">i_src</span> <span class="ocamlLCIdentifier">i_dst</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">i_src</span><span class="ocamlNone"> </span><span class="Statement">=</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">len_src</span><span class="ocamlNone"> </span><span class="Statement">then<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">i_dst<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">match</span> <span class="ocamlLCIdentifier">src</span>.<span class="Statement">[</span><span class="ocamlLCIdentifier">i_src</span><span class="Statement">]</span> <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">' '</span> <span class="Statement">|</span> <span class="Constant">'\<a href="lazy_backtrack.mli.html#L16" title="ocaml/utils/lazy_backtrack.mli:16">t</a>'</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">loop_spaces</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">spaces</span> + <span class="Constant">1</span><span class="Statement">)</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">i_src</span> + <span class="Constant">1</span><span class="Statement">)</span> <span class="ocamlLCIdentifier">i_dst<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">'\n'</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="PreProc">Bytes</span>.<span class="ocamlLCIdentifier">set</span> <span class="ocamlLCIdentifier">dst</span> <span class="ocamlLCIdentifier">i_dst</span> <span class="Constant">'\n'</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="profile.ml.html#L290" title="ocaml/utils/profile.ml:290">loop</a></span> <span class="Statement">(</span><span class="ocamlLCIdentifier">i_src</span> + <span class="Constant">1</span><span class="Statement">)</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">i_dst</span> + <span class="Constant">1</span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Statement">_</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">for</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">n</span><span class="ocamlNone"> </span><span class="Statement">=</span><span class="ocamlNone"> </span><span class="Constant">0</span><span class="ocamlNone"> </span><span class="Statement">to</span> <span class="ocamlLCIdentifier">spaces</span> <span class="Statement">do<br/></li>
<li></span><span class="ocamlDo">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="PreProc">Bytes</span><span class="ocamlDo">.</span><span class="ocamlLCIdentifier">set</span><span class="ocamlDo"> </span><span class="ocamlLCIdentifier">dst</span><span class="ocamlDo"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">i_dst</span><span class="ocamlDo"> + </span><span class="ocamlLCIdentifier">n</span><span class="Statement">)</span><span class="ocamlDo"> </span><span class="ocamlLCIdentifier">src</span><span class="ocamlDo">.</span><span class="Statement">[</span><span class="ocamlLCIdentifier">i_src</span><span class="ocamlDo"> - </span><span class="ocamlLCIdentifier">spaces</span><span class="ocamlDo"> + </span><span class="ocamlLCIdentifier">n</span><span class="Statement">]<br/></li>
<li></span><span class="ocamlDo">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">done;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="profile.ml.html#L290" title="ocaml/utils/profile.ml:290">loop</a></span> <span class="Statement">(</span><span class="ocamlLCIdentifier">i_src</span> + <span class="Constant">1</span><span class="Statement">)</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">i_dst</span> + <span class="ocamlLCIdentifier">spaces</span> + <span class="Constant">1</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">in<br/></li>
<li><a id="L824">&#x200c;</a></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">stop</span></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="profile.ml.html#L290" title="ocaml/utils/profile.ml:290">loop</a></span> <span class="Constant">0</span> <span class="Constant">0</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="PreProc">Bytes</span>.<span class="ocamlLCIdentifier">sub_string</span> <span class="ocamlLCIdentifier">dst</span> <span class="Constant">0</span> <span class="ocamlLCIdentifier"><a href="#L824" title="ocaml/utils/misc.ml:824">stop</a><br/></li>
<li></span><br/></li>
<li><a id="L827">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">pp_two_columns</span></span> <span class="Statement">?(</span><span class="Identifier">sep</span> <span class="Statement">=</span> <span class="Constant">&quot;|&quot;</span><span class="Statement">)</span> <span class="Statement">?</span><span class="Identifier">max_lines</span> <span class="ocamlLCIdentifier">ppf</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">lines</span>: <span class="Statement">(</span><span class="Type">string</span> <span class="Statement">*</span> <span class="Type">string</span><span class="Statement">)</span> <span class="Type">list</span><span class="Statement">)</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">left_column_size</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">List</span>.<span class="ocamlLCIdentifier">fold_left</span> <span class="Statement">(fun</span> <span class="ocamlLCIdentifier"><a href="arg_helper.ml.html#L95" title="ocaml/utils/arg_helper.ml:95">acc</a></span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a></span>, <span class="Statement">_)</span> <span class="Statement">-&gt;</span> <span class="PreProc">Int</span>.<span class="ocamlLCIdentifier">max</span> <span class="ocamlLCIdentifier"><a href="arg_helper.ml.html#L95" title="ocaml/utils/arg_helper.ml:95">acc</a></span> <span class="Statement">(</span><span class="PreProc">String</span>.<span class="ocamlLCIdentifier"><a href="arg_helper.ml.html#L77" title="ocaml/utils/arg_helper.ml:77">length</a></span> <span class="ocamlLCIdentifier"><a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a></span><span class="Statement">))</span> <span class="Constant">0</span> <span class="ocamlLCIdentifier">lines</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">lines_nb</span> <span class="Statement">=</span> <span class="PreProc">List</span>.<span class="ocamlLCIdentifier"><a href="arg_helper.ml.html#L77" title="ocaml/utils/arg_helper.ml:77">length</a></span> <span class="ocamlLCIdentifier">lines</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">ellipsed_first</span>, <span class="ocamlLCIdentifier">ellipsed_last</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">match</span> <span class="ocamlLCIdentifier">max_lines</span> <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Some</span> <span class="ocamlLCIdentifier">max_lines</span> <span class="Statement">when</span> <span class="ocamlLCIdentifier">lines_nb</span> <span class="Statement">&gt;</span> <span class="ocamlLCIdentifier">max_lines</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">printed_lines</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">max_lines</span> - <span class="Constant">1</span> <span class="Statement">in</span> <span class="Comment">(* the ellipsis uses <a href="targetint.mli.html#L38" title="ocaml/utils/targetint.mli:38">one</a> <a href="diffing.ml.html#L152" title="ocaml/utils/diffing.ml:152">line</a> *)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">lines_before</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">printed_lines</span> / <span class="Constant">2</span> + <span class="ocamlLCIdentifier">printed_lines</span> <span class="Statement">mod</span> <span class="Constant">2</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">lines_after</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">printed_lines</span> / <span class="Constant">2</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="ocamlLCIdentifier">lines_before</span>, <span class="ocamlLCIdentifier">lines_nb</span> - <span class="ocamlLCIdentifier">lines_after</span> - <span class="Constant">1</span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Statement">_</span> <span class="Statement">-&gt;</span> <span class="Statement">(</span>-<span class="Constant">1</span>, -<span class="Constant">1</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="PreProc">Format</span>.<span class="ocamlLCIdentifier">fprintf</span> <span class="ocamlLCIdentifier">ppf</span> <span class="Constant">&quot;@[&lt;v&gt;&quot;</span><span class="Statement">;<br/></li>
<li></span>&nbsp; <span class="PreProc">List</span>.<span class="ocamlLCIdentifier">iteri</span> <span class="Statement">(fun</span> <span class="ocamlLCIdentifier">k</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">line_l</span>, <span class="ocamlLCIdentifier">line_r</span><span class="Statement">)</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">k</span><span class="ocamlNone"> </span><span class="Statement">=</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">ellipsed_first</span><span class="ocamlNone"> </span><span class="Statement">then</span> <span class="PreProc">Format</span>.<span class="ocamlLCIdentifier">fprintf</span> <span class="ocamlLCIdentifier">ppf</span> <span class="Constant">&quot;...@,&quot;</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">ellipsed_first</span><span class="ocamlNone"> </span><span class="Statement">&lt;=</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">k</span><span class="ocamlNone"> </span><span class="Statement">&amp;&amp;</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">k</span><span class="ocamlNone"> </span><span class="Statement">&lt;=</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">ellipsed_last</span><span class="ocamlNone"> </span><span class="Statement">then</span> <span class="Constant">()<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">else</span> <span class="PreProc">Format</span>.<span class="ocamlLCIdentifier">fprintf</span> <span class="ocamlLCIdentifier">ppf</span> <span class="Constant">&quot;%*<a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a> %<a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a> %<a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a>@,&quot;</span> <span class="ocamlLCIdentifier">left_column_size</span> <span class="ocamlLCIdentifier">line_l</span> <span class="ocamlLCIdentifier">sep</span> <span class="ocamlLCIdentifier">line_r<br/></li>
<li></span>&nbsp; <span class="Statement">)</span> <span class="ocamlLCIdentifier">lines</span><span class="Statement">;<br/></li>
<li></span>&nbsp; <span class="PreProc">Format</span>.<span class="ocamlLCIdentifier">fprintf</span> <span class="ocamlLCIdentifier">ppf</span> <span class="Constant">&quot;@]&quot;<br/></li>
<li></span><br/></li>
<li><span class="Comment">(* showing configuration and configuration variables *)<br/></li>
<li><a id="L849">&#x200c;</a></span><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">show_config_and_exit</span></span> <span class="Constant">()</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="PreProc">Config</span>.<span class="ocamlLCIdentifier"><a href="config.common.ml.html#L148" title="ocaml/utils/config.common.ml:148">print_config</a></span> <span class="ocamlLCIdentifier">stdout</span><span class="Statement">;<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier"><a href="ccomp.ml.html#L96" title="ocaml/utils/ccomp.ml:96">exit</a></span> <span class="Constant">0<br/></li>
<li></span><br/></li>
<li><a id="L853">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">show_config_variable_and_exit</span></span> <span class="ocamlLCIdentifier">x</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">match</span> <span class="PreProc">Config</span>.<span class="ocamlLCIdentifier"><a href="config.common.ml.html#L154" title="ocaml/utils/config.common.ml:154">config_var</a></span> <span class="ocamlLCIdentifier">x</span> <span class="Statement">with<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Some</span> <span class="ocamlLCIdentifier">v</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Comment">(* we intentionally don'<a href="lazy_backtrack.mli.html#L16" title="ocaml/utils/lazy_backtrack.mli:16">t</a> <a href="identifiable.ml.html#L24" title="ocaml/utils/identifiable.ml:24">print</a> a newline to avoid Windows \r<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; issues: bash only strips the trailing \n when using a <a href="ccomp.mli.html#L23" title="ocaml/utils/ccomp.mli:23">command</a><br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; substitution $(ocamlc -config-var foo), so a trailing \r would<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; remain if printing a newline under Windows and scripts would<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; have to use $(ocamlc -config-var foo | tr -<a href="binutils.ml.html#L642" title="ocaml/utils/binutils.ml:642">d</a> '\r')<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; for portability. Ugh. *)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">print_string</span> <span class="ocamlLCIdentifier">v</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="ccomp.ml.html#L96" title="ocaml/utils/ccomp.ml:96">exit</a></span> <span class="Constant">0<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">None</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="ccomp.ml.html#L96" title="ocaml/utils/ccomp.ml:96">exit</a></span> <span class="Constant">2<br/></li>
<li></span><br/></li>
<li><a id="L867">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">get_build_path_prefix_map</span></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="load_path.mli.html#L62" title="ocaml/utils/load_path.mli:62">init</a></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">ref</span> <span class="Constant">false</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">map_cache</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">ref</span> <span class="Constant">None</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">fun</span> <span class="Constant">()</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="Statement">not</span><span class="ocamlNone"> </span><span class="Statement">!</span><span class="ocamlLCIdentifier"><a href="load_path.mli.html#L62" title="ocaml/utils/load_path.mli:62">init</a></span><span class="ocamlNone"> </span><span class="Statement">then</span> <span class="Statement">begin<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="load_path.mli.html#L62" title="ocaml/utils/load_path.mli:62">init</a></span><span class="ocamlEnd"> </span><span class="Statement">:=</span><span class="ocamlEnd"> </span><span class="Constant">true</span><span class="Statement">;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">match</span><span class="ocamlEnd"> </span><span class="PreProc">Sys</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">getenv</span><span class="ocamlEnd"> </span><span class="Constant">&quot;BUILD_PATH_PREFIX_MAP&quot;</span><span class="ocamlEnd"> </span><span class="Statement">with<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Statement">exception</span><span class="ocamlEnd"> </span><span class="Constant">Not_found</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;</span><span class="ocamlEnd"> </span><span class="Constant">()<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">encoded_map</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">match</span><span class="ocamlEnd"> </span><span class="PreProc">Build_path_prefix_map</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier"><a href="build_path_prefix_map.mli.html#L42" title="ocaml/utils/build_path_prefix_map.mli:42">decode_map</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">encoded_map</span><span class="ocamlEnd"> </span><span class="Statement">with<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Constant">Error</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">err</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="#L20" title="ocaml/utils/misc.ml:20">fatal_errorf</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Constant">&quot;Invalid value for the environment variable \<br/></li>
<li></span><span class="Constant">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; BUILD_PATH_PREFIX_MAP: %<a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a>&quot;</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">err<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Constant">Ok</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="identifiable.ml.html#L37" title="ocaml/utils/identifiable.ml:37">map</a></span><span class="ocamlEnd"> </span><span class="Statement">-&gt;</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">map_cache</span><span class="ocamlEnd"> </span><span class="Statement">:=</span><span class="ocamlEnd"> </span><span class="Constant">Some</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="identifiable.ml.html#L37" title="ocaml/utils/identifiable.ml:37">map</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="Statement">end;<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">!</span><span class="ocamlLCIdentifier">map_cache<br/></li>
<li></span><br/></li>
<li><a id="L885">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">debug_prefix_map_flags</span></span> <span class="Constant">()</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="Statement">not</span><span class="ocamlNone"> </span><span class="PreProc">Config</span><span class="ocamlNone">.</span><span class="ocamlLCIdentifier"><a href="config.fixed.ml.html#L29" title="ocaml/utils/config.fixed.ml:29">as_has_debug_prefix_map</a></span><span class="ocamlNone"> </span><span class="Statement">then<br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">[]<br/></li>
<li></span>&nbsp; <span class="Statement">else</span> <span class="Statement">begin<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="Statement">match</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L867" title="ocaml/utils/misc.ml:867">get_build_path_prefix_map</a></span><span class="ocamlEnd"> </span><span class="Constant">()</span><span class="ocamlEnd"> </span><span class="Statement">with<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Constant">None</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;</span><span class="ocamlEnd"> </span><span class="Constant">[]<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Constant">Some</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="identifiable.ml.html#L37" title="ocaml/utils/identifiable.ml:37">map</a></span><span class="ocamlEnd"> </span><span class="Statement">-&gt;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="PreProc">List</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">fold_right<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">(fun</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">map_elem</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="arg_helper.ml.html#L95" title="ocaml/utils/arg_helper.ml:95">acc</a></span><span class="ocamlEnd"> </span><span class="Statement">-&gt;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="Statement">match</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">map_elem</span><span class="ocamlEnd"> </span><span class="Statement">with<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Constant">None</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="arg_helper.ml.html#L95" title="ocaml/utils/arg_helper.ml:95">acc</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Constant">Some</span><span class="ocamlEnd"> </span><span class="Statement">{</span><span class="ocamlEnd"> </span><span class="PreProc">Build_path_prefix_map</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier"><a href="config.fixed.ml.html#L68" title="ocaml/utils/config.fixed.ml:68">target</a></span><span class="Statement">;</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="consistbl.mli.html#L50" title="ocaml/utils/consistbl.mli:50">source</a></span><span class="Statement">;</span><span class="ocamlEnd"> </span><span class="Statement">}</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="Statement">(</span><span class="PreProc">Printf</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">sprintf</span><span class="ocamlEnd"> </span><span class="Constant">&quot;--<a href="clflags.mli.html#L82" title="ocaml/utils/clflags.mli:82">debug</a>-<a href="diffing_with_keys.mli.html#L49" title="ocaml/utils/diffing_with_keys.mli:49">prefix</a>-<a href="identifiable.ml.html#L37" title="ocaml/utils/identifiable.ml:37">map</a> %<a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a>=%<a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a>&quot;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">(</span><span class="PreProc">Filename</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">quote</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="consistbl.mli.html#L50" title="ocaml/utils/consistbl.mli:50">source</a></span><span class="Statement">)<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">(</span><span class="PreProc">Filename</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">quote</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="config.fixed.ml.html#L68" title="ocaml/utils/config.fixed.ml:68">target</a></span><span class="Statement">))</span><span class="ocamlEnd"> </span><span class="Statement">::</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="arg_helper.ml.html#L95" title="ocaml/utils/arg_helper.ml:95">acc</a></span><span class="Statement">)<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="identifiable.ml.html#L37" title="ocaml/utils/identifiable.ml:37">map</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Constant">[]<br/></li>
<li></span><span class="ocamlEnd">&nbsp; </span><span class="Statement">end<br/></li>
<li></span><br/></li>
<li><span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="misc.mli.html#L520" title="ocaml/utils/misc.mli:520">print_if</a></span> <span class="ocamlLCIdentifier">ppf</span> <span class="ocamlLCIdentifier">flag</span> <span class="ocamlLCIdentifier">printer</span> <span class="ocamlLCIdentifier">arg</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="Statement">!</span><span class="ocamlLCIdentifier">flag</span><span class="ocamlNone"> </span><span class="Statement">then</span> <span class="PreProc">Format</span>.<span class="ocamlLCIdentifier">fprintf</span> <span class="ocamlLCIdentifier">ppf</span> <span class="Constant">&quot;%a@.&quot;</span> <span class="ocamlLCIdentifier">printer</span> <span class="ocamlLCIdentifier">arg</span><span class="Statement">;<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier">arg<br/></li>
<li></span><br/></li>
<li><span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="misc.mli.html#L550" title="ocaml/utils/misc.mli:550">print_see_manual</a></span> <span class="ocamlLCIdentifier">ppf</span> <span class="ocamlLCIdentifier">manual_section</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="Statement">open</span><span class="ocamlNone"> </span><span class="PreProc">Format</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier">fprintf</span> <span class="ocamlLCIdentifier">ppf</span> <span class="Constant">&quot;(see manual section %a)&quot;<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">(</span><span class="ocamlLCIdentifier">pp_print_list</span> <span class="Statement">~</span><span class="Identifier">pp_sep</span>:<span class="Statement">(fun</span> <span class="ocamlLCIdentifier">f</span> <span class="Constant">()</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier">pp_print_char</span> <span class="ocamlLCIdentifier">f</span> <span class="Constant">'.'</span><span class="Statement">)</span> <span class="ocamlLCIdentifier">pp_print_int</span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier">manual_section<br/></li>
<li></span><br/></li>
<li><br/></li>
<li><a id="L915">&#x200c;</a><span class="Statement">type</span> <span class="ocamlLCIdentifier"><span class="linkable">filepath</span></span> <span class="Statement">=</span> <span class="Type">string<br/></li>
<li><a id="L916">&#x200c;</a></span><span class="Statement">type</span> <span class="ocamlLCIdentifier"><span class="linkable">modname</span></span> <span class="Statement">=</span> <span class="Type">string<br/></li>
<li><a id="L917">&#x200c;</a></span><span class="Statement">type</span> <span class="ocamlLCIdentifier"><span class="linkable">crcs</span></span> <span class="Statement">=</span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L916" title="ocaml/utils/misc.ml:916">modname</a></span> <span class="Statement">*</span> <span class="PreProc">Digest</span>.<span class="ocamlLCIdentifier"><a href="lazy_backtrack.mli.html#L16" title="ocaml/utils/lazy_backtrack.mli:16">t</a></span> <span class="Type">option</span><span class="Statement">)</span> <span class="Type">list<br/></li>
<li></span><br/></li>
<li><a id="L919">&#x200c;</a><span class="Statement">type</span> <span class="ocamlLCIdentifier"><span class="linkable">alerts</span></span> <span class="Statement">=</span> <span class="Type">string</span> <span class="PreProc">Stdlib</span>.<span class="PreProc">String</span>.<span class="PreProc">Map</span>.<span class="ocamlLCIdentifier"><a href="lazy_backtrack.mli.html#L16" title="ocaml/utils/lazy_backtrack.mli:16">t</a><br/></li>
<li></span><br/></li>
<li><span class="Statement">module</span><span class="PreProc"> Magic_number</span><span class="ocamlPreDef"> </span><span class="Statement">=</span> <span class="PreProc">struct<br/></li>
<li></span><span class="ocamlStruct">&nbsp; </span><span class="Statement">type</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">native_obj_config</span><span class="ocamlStruct"> </span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="Statement">{<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="config.fixed.ml.html#L47" title="ocaml/utils/config.fixed.ml:47">flambda</a></span><span class="ocamlStruct"> : </span><span class="Type">bool</span><span class="Statement">;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; </span><span class="Statement">}<br/></li>
<li></span><span class="ocamlStruct">&nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">native_obj_config</span><span class="ocamlStruct"> </span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="Statement">{<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="config.fixed.ml.html#L47" title="ocaml/utils/config.fixed.ml:47">flambda</a></span><span class="ocamlStruct"> </span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="PreProc">Config</span><span class="ocamlStruct">.</span><span class="ocamlLCIdentifier"><a href="config.fixed.ml.html#L47" title="ocaml/utils/config.fixed.ml:47">flambda</a></span><span class="Statement">;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; </span><span class="Statement">}<br/></li>
<li></span><br/></li>
<li><span class="ocamlStruct">&nbsp; </span><span class="Statement">type</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="config.common.ml.html#L20" title="ocaml/utils/config.common.ml:20">version</a></span><span class="ocamlStruct"> </span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="Type">int<br/></li>
<li></span><br/></li>
<li><span class="ocamlStruct">&nbsp; </span><span class="Statement">type</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">kind</span><span class="ocamlStruct"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Exec<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Cmi</span><span class="ocamlStruct"> </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Cmo</span><span class="ocamlStruct"> </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Cma<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Cmx</span><span class="ocamlStruct"> </span><span class="Statement">of</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">native_obj_config</span><span class="ocamlStruct"> </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Cmxa</span><span class="ocamlStruct"> </span><span class="Statement">of</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">native_obj_config<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Cmxs<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Cmt<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Ast_impl</span><span class="ocamlStruct"> </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Ast_intf<br/></li>
<li></span><br/></li>
<li><span class="ocamlStruct">&nbsp; </span><span class="Comment">(* please keep up-to-date, this is used for sanity checking *)<br/></li>
<li></span><span class="ocamlStruct">&nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">all_native_obj_configs</span><span class="ocamlStruct"> </span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="Statement">[<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; </span><span class="Statement">{</span><span class="ocamlLCIdentifier"><a href="config.fixed.ml.html#L47" title="ocaml/utils/config.fixed.ml:47">flambda</a></span><span class="ocamlStruct"> </span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="Constant">true</span><span class="Statement">};<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; </span><span class="Statement">{</span><span class="ocamlLCIdentifier"><a href="config.fixed.ml.html#L47" title="ocaml/utils/config.fixed.ml:47">flambda</a></span><span class="ocamlStruct"> </span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="Constant">false</span><span class="Statement">};<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">]<br/></li>
<li></span><span class="ocamlStruct">&nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">all_kinds</span><span class="ocamlStruct"> </span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="Statement">[<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Constant">Exec</span><span class="Statement">;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Constant">Cmi</span><span class="Statement">;</span><span class="ocamlStruct"> </span><span class="Constant">Cmo</span><span class="Statement">;</span><span class="ocamlStruct"> </span><span class="Constant">Cma</span><span class="Statement">;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; </span><span class="Statement">]<br/></li>
<li></span><span class="ocamlStruct">&nbsp; @ </span><span class="PreProc">List</span><span class="ocamlStruct">.</span><span class="ocamlLCIdentifier"><a href="identifiable.ml.html#L37" title="ocaml/utils/identifiable.ml:37">map</a></span><span class="ocamlStruct"> </span><span class="Statement">(fun</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">conf</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="Constant">Cmx</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">conf</span><span class="Statement">)</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">all_native_obj_configs<br/></li>
<li></span><span class="ocamlStruct">&nbsp; @ </span><span class="PreProc">List</span><span class="ocamlStruct">.</span><span class="ocamlLCIdentifier"><a href="identifiable.ml.html#L37" title="ocaml/utils/identifiable.ml:37">map</a></span><span class="ocamlStruct"> </span><span class="Statement">(fun</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">conf</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="Constant">Cmxa</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">conf</span><span class="Statement">)</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">all_native_obj_configs<br/></li>
<li></span><span class="ocamlStruct">&nbsp; @ </span><span class="Statement">[<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Constant">Cmt</span><span class="Statement">;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Constant">Ast_impl</span><span class="Statement">;</span><span class="ocamlStruct"> </span><span class="Constant">Ast_intf</span><span class="Statement">;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; </span><span class="Statement">]<br/></li>
<li></span><br/></li>
<li><span class="ocamlStruct">&nbsp; </span><span class="Statement">type</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="diffing_with_keys.ml.html#L204" title="ocaml/utils/diffing_with_keys.ml:204">raw</a></span><span class="ocamlStruct"> </span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="Type">string<br/></li>
<li></span><span class="ocamlStruct">&nbsp; </span><span class="Statement">type</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">info</span><span class="ocamlStruct"> </span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="Statement">{<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="ocamlLCIdentifier">kind</span><span class="ocamlStruct">: </span><span class="ocamlLCIdentifier">kind</span><span class="Statement">;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="config.common.ml.html#L20" title="ocaml/utils/config.common.ml:20">version</a></span><span class="ocamlStruct">: </span><span class="ocamlLCIdentifier"><a href="config.common.ml.html#L20" title="ocaml/utils/config.common.ml:20">version</a></span><span class="Statement">;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; </span><span class="Statement">}<br/></li>
<li></span><br/></li>
<li><span class="ocamlStruct">&nbsp; </span><span class="Statement">type</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="#L1116" title="ocaml/utils/misc.ml:1116">raw_kind</a></span><span class="ocamlStruct"> </span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="Type">string<br/></li>
<li></span><br/></li>
<li><span class="ocamlStruct">&nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">parse_kind</span><span class="ocamlStruct"> : </span><span class="ocamlLCIdentifier"><a href="#L1116" title="ocaml/utils/misc.ml:1116">raw_kind</a></span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">kind</span><span class="ocamlStruct"> </span><span class="Type">option</span><span class="ocamlStruct"> </span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="Statement">function<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">&quot;Caml1999X&quot;</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="Constant">Some</span><span class="ocamlStruct"> </span><span class="Constant">Exec<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">&quot;Caml1999I&quot;</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="Constant">Some</span><span class="ocamlStruct"> </span><span class="Constant">Cmi<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">&quot;Caml1999O&quot;</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="Constant">Some</span><span class="ocamlStruct"> </span><span class="Constant">Cmo<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">&quot;Caml1999A&quot;</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="Constant">Some</span><span class="ocamlStruct"> </span><span class="Constant">Cma<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">&quot;Caml1999y&quot;</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="Constant">Some</span><span class="ocamlStruct"> </span><span class="Statement">(</span><span class="Constant">Cmx</span><span class="ocamlStruct"> </span><span class="Statement">{</span><span class="ocamlLCIdentifier"><a href="config.fixed.ml.html#L47" title="ocaml/utils/config.fixed.ml:47">flambda</a></span><span class="ocamlStruct"> </span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="Constant">true</span><span class="Statement">})<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">&quot;Caml1999Y&quot;</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="Constant">Some</span><span class="ocamlStruct"> </span><span class="Statement">(</span><span class="Constant">Cmx</span><span class="ocamlStruct"> </span><span class="Statement">{</span><span class="ocamlLCIdentifier"><a href="config.fixed.ml.html#L47" title="ocaml/utils/config.fixed.ml:47">flambda</a></span><span class="ocamlStruct"> </span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="Constant">false</span><span class="Statement">})<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">&quot;Caml1999z&quot;</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="Constant">Some</span><span class="ocamlStruct"> </span><span class="Statement">(</span><span class="Constant">Cmxa</span><span class="ocamlStruct"> </span><span class="Statement">{</span><span class="ocamlLCIdentifier"><a href="config.fixed.ml.html#L47" title="ocaml/utils/config.fixed.ml:47">flambda</a></span><span class="ocamlStruct"> </span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="Constant">true</span><span class="Statement">})<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">&quot;Caml1999Z&quot;</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="Constant">Some</span><span class="ocamlStruct"> </span><span class="Statement">(</span><span class="Constant">Cmxa</span><span class="ocamlStruct"> </span><span class="Statement">{</span><span class="ocamlLCIdentifier"><a href="config.fixed.ml.html#L47" title="ocaml/utils/config.fixed.ml:47">flambda</a></span><span class="ocamlStruct"> </span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="Constant">false</span><span class="Statement">})<br/></li>
<li></span><br/></li>
<li><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Comment">(* Caml2007D and Caml2012T were used instead of the common Caml1999 <a href="diffing_with_keys.mli.html#L49" title="ocaml/utils/diffing_with_keys.mli:49">prefix</a><br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp;&nbsp; between the introduction of those <a href="binutils.ml.html#L625" title="ocaml/utils/binutils.ml:625">magic</a> numbers and October 2017<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp;&nbsp; (8ba70ff194b66c0a50ffb97d41fe9c4bdf9362d6).<br/></li>
<li></span><br/></li>
<li><span class="Comment">&nbsp; &nbsp; &nbsp;&nbsp; We accept them here, but will always produce/show kind prefixes<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp;&nbsp; that follow the <a href="warnings.ml.html#L587" title="ocaml/utils/warnings.ml:587">current</a> convention, Caml1999{D,T}. *)<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">&quot;Caml2007D&quot;</span><span class="ocamlStruct"> </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">&quot;Caml1999D&quot;</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="Constant">Some</span><span class="ocamlStruct"> </span><span class="Constant">Cmxs<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">&quot;Caml2012T&quot;</span><span class="ocamlStruct"> </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">&quot;Caml1999T&quot;</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="Constant">Some</span><span class="ocamlStruct"> </span><span class="Constant">Cmt<br/></li>
<li></span><br/></li>
<li><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">&quot;Caml1999M&quot;</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="Constant">Some</span><span class="ocamlStruct"> </span><span class="Constant">Ast_impl<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">&quot;Caml1999N&quot;</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="Constant">Some</span><span class="ocamlStruct"> </span><span class="Constant">Ast_intf<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Statement">_</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="Constant">None<br/></li>
<li></span><br/></li>
<li><span class="ocamlStruct">&nbsp; </span><span class="Comment">(* note: over time the <a href="binutils.ml.html#L625" title="ocaml/utils/binutils.ml:625">magic</a> kind <a href="warnings.ml.html#L121" title="ocaml/utils/warnings.ml:121">number</a> has changed for certain kinds;<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; this function returns them as they are produced by the <a href="warnings.ml.html#L587" title="ocaml/utils/warnings.ml:587">current</a> compiler,<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; but [parse_kind] accepts older formats as well. *)<br/></li>
<li></span><span class="ocamlStruct">&nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="#L1116" title="ocaml/utils/misc.ml:1116">raw_kind</a></span><span class="ocamlStruct"> : </span><span class="ocamlLCIdentifier">kind</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="diffing_with_keys.ml.html#L204" title="ocaml/utils/diffing_with_keys.ml:204">raw</a></span><span class="ocamlStruct"> </span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="Statement">function<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Exec</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="Constant">&quot;Caml1999X&quot;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Cmi</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="Constant">&quot;Caml1999I&quot;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Cmo</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="Constant">&quot;Caml1999O&quot;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Cma</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="Constant">&quot;Caml1999A&quot;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Cmx</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">config</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">config</span><span class="ocamlNone">.</span><span class="ocamlLCIdentifier"><a href="config.fixed.ml.html#L47" title="ocaml/utils/config.fixed.ml:47">flambda</a><br/></li>
<li></span><span class="ocamlNone">&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="Statement">then</span><span class="ocamlStruct"> </span><span class="Constant">&quot;Caml1999y&quot;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="Statement">else</span><span class="ocamlStruct"> </span><span class="Constant">&quot;Caml1999Y&quot;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Cmxa</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">config</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">config</span><span class="ocamlNone">.</span><span class="ocamlLCIdentifier"><a href="config.fixed.ml.html#L47" title="ocaml/utils/config.fixed.ml:47">flambda</a><br/></li>
<li></span><span class="ocamlNone">&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="Statement">then</span><span class="ocamlStruct"> </span><span class="Constant">&quot;Caml1999z&quot;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="Statement">else</span><span class="ocamlStruct"> </span><span class="Constant">&quot;Caml1999Z&quot;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Cmxs</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="Constant">&quot;Caml1999D&quot;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Cmt</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="Constant">&quot;Caml1999T&quot;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Ast_impl</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="Constant">&quot;Caml1999M&quot;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Ast_intf</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="Constant">&quot;Caml1999N&quot;<br/></li>
<li></span><br/></li>
<li><span class="ocamlStruct">&nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">string_of_kind</span><span class="ocamlStruct"> : </span><span class="ocamlLCIdentifier">kind</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="Type">string</span><span class="ocamlStruct"> </span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="Statement">function<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Exec</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="Constant">&quot;exec&quot;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Cmi</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="Constant">&quot;cmi&quot;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Cmo</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="Constant">&quot;cmo&quot;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Cma</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="Constant">&quot;cma&quot;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Cmx</span><span class="ocamlStruct"> </span><span class="Statement">_</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="Constant">&quot;cmx&quot;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Cmxa</span><span class="ocamlStruct"> </span><span class="Statement">_</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="Constant">&quot;cmxa&quot;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Cmxs</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="Constant">&quot;cmxs&quot;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Cmt</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="Constant">&quot;cmt&quot;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Ast_impl</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="Constant">&quot;ast_impl&quot;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Ast_intf</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="Constant">&quot;ast_intf&quot;<br/></li>
<li></span><br/></li>
<li><span class="ocamlStruct">&nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">human_description_of_native_obj_config</span><span class="ocamlStruct"> : </span><span class="ocamlLCIdentifier">native_obj_config</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="Type">string</span><span class="ocamlStruct"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">fun[</span><span class="ocamlStruct">@</span><span class="ocamlLCIdentifier">warning</span><span class="ocamlStruct"> </span><span class="Constant">&quot;+9&quot;</span><span class="Statement">]</span><span class="ocamlStruct"> </span><span class="Statement">{</span><span class="ocamlLCIdentifier"><a href="config.fixed.ml.html#L47" title="ocaml/utils/config.fixed.ml:47">flambda</a></span><span class="Statement">}</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; </span><span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier"><a href="config.fixed.ml.html#L47" title="ocaml/utils/config.fixed.ml:47">flambda</a></span><span class="ocamlNone"> </span><span class="Statement">then</span><span class="ocamlStruct"> </span><span class="Constant">&quot;<a href="config.fixed.ml.html#L47" title="ocaml/utils/config.fixed.ml:47">flambda</a>&quot;</span><span class="ocamlStruct"> </span><span class="Statement">else</span><span class="ocamlStruct"> </span><span class="Constant">&quot;non <a href="config.fixed.ml.html#L47" title="ocaml/utils/config.fixed.ml:47">flambda</a>&quot;<br/></li>
<li></span><br/></li>
<li><span class="ocamlStruct">&nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">human_name_of_kind</span><span class="ocamlStruct"> : </span><span class="ocamlLCIdentifier">kind</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="Type">string</span><span class="ocamlStruct"> </span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="Statement">function<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Exec</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="Constant">&quot;executable&quot;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Cmi</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="Constant">&quot;compiled interface <a href="profile.mli.html#L23" title="ocaml/utils/profile.mli:23">file</a>&quot;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Cmo</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="Constant">&quot;bytecode object <a href="profile.mli.html#L23" title="ocaml/utils/profile.mli:23">file</a>&quot;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Cma</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="Constant">&quot;bytecode library&quot;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Cmx</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">config</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="PreProc">Printf</span><span class="ocamlStruct">.</span><span class="ocamlLCIdentifier">sprintf</span><span class="ocamlStruct"> </span><span class="Constant">&quot;native compilation unit <a href="warnings.mli.html#L160" title="ocaml/utils/warnings.mli:160">description</a> (%<a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a>)&quot;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="Statement">(</span><span class="ocamlLCIdentifier">human_description_of_native_obj_config</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">config</span><span class="Statement">)<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Cmxa</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">config</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="PreProc">Printf</span><span class="ocamlStruct">.</span><span class="ocamlLCIdentifier">sprintf</span><span class="ocamlStruct"> </span><span class="Constant">&quot;static native library (%<a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a>)&quot;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="Statement">(</span><span class="ocamlLCIdentifier">human_description_of_native_obj_config</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">config</span><span class="Statement">)<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Cmxs</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="Constant">&quot;dynamic native library&quot;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Cmt</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="Constant">&quot;compiled typedtree <a href="profile.mli.html#L23" title="ocaml/utils/profile.mli:23">file</a>&quot;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Ast_impl</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="Constant">&quot;serialized implementation AST&quot;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Ast_intf</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="Constant">&quot;serialized interface AST&quot;<br/></li>
<li></span><br/></li>
<li><span class="ocamlStruct">&nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">kind_length</span><span class="ocamlStruct"> </span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="Constant">9<br/></li>
<li></span><span class="ocamlStruct">&nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">version_length</span><span class="ocamlStruct"> </span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="Constant">3<br/></li>
<li></span><span class="ocamlStruct">&nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">magic_length</span><span class="ocamlStruct"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="ocamlLCIdentifier">kind_length</span><span class="ocamlStruct"> + </span><span class="ocamlLCIdentifier">version_length<br/></li>
<li></span><br/></li>
<li><span class="ocamlStruct">&nbsp; </span><span class="Statement">type</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">parse_error</span><span class="ocamlStruct"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Truncated</span><span class="ocamlStruct"> </span><span class="Statement">of</span><span class="ocamlStruct"> </span><span class="Type">string<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Not_a_magic_number</span><span class="ocamlStruct"> </span><span class="Statement">of</span><span class="ocamlStruct"> </span><span class="Type">string<br/></li>
<li></span><br/></li>
<li><span class="ocamlStruct">&nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">explain_parse_error</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">kind_opt</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="binutils.mli.html#L16" title="ocaml/utils/binutils.mli:16">error</a></span><span class="ocamlStruct"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="PreProc">Printf</span><span class="ocamlStruct">.</span><span class="ocamlLCIdentifier">sprintf<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="Constant">&quot;We expected a valid %<a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a>, but the <a href="profile.mli.html#L23" title="ocaml/utils/profile.mli:23">file</a> %<a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a>.&quot;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="Statement">(</span><span class="PreProc">Option</span><span class="ocamlStruct">.</span><span class="ocamlLCIdentifier">fold</span><span class="ocamlStruct"> </span><span class="Statement">~</span><span class="Identifier">none</span><span class="ocamlStruct">:</span><span class="Constant">&quot;object <a href="profile.mli.html#L23" title="ocaml/utils/profile.mli:23">file</a>&quot;</span><span class="ocamlStruct"> </span><span class="Statement">~</span><span class="Identifier">some</span><span class="ocamlStruct">:</span><span class="ocamlLCIdentifier">human_name_of_kind</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">kind_opt</span><span class="Statement">)<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="Statement">(match</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="binutils.mli.html#L16" title="ocaml/utils/binutils.mli:16">error</a></span><span class="ocamlStruct"> </span><span class="Statement">with<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Truncated</span><span class="ocamlStruct"> </span><span class="Constant">&quot;&quot;</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="Constant">&quot;is empty&quot;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Truncated</span><span class="ocamlStruct"> </span><span class="Statement">_</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="Constant">&quot;is truncated&quot;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Not_a_magic_number</span><span class="ocamlStruct"> </span><span class="Statement">_</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="Constant">&quot;has a different format&quot;</span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li><span class="ocamlStruct">&nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="arg_helper.ml.html#L101" title="ocaml/utils/arg_helper.ml:101">parse</a></span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a></span><span class="ocamlStruct"> : </span><span class="Statement">(</span><span class="ocamlLCIdentifier">info</span><span class="ocamlStruct">, </span><span class="ocamlLCIdentifier">parse_error</span><span class="Statement">)</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="#L592" title="ocaml/utils/misc.ml:592">result</a></span><span class="ocamlStruct"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">if</span><span class="ocamlNone"> </span><span class="PreProc">String</span><span class="ocamlNone">.</span><span class="ocamlLCIdentifier"><a href="arg_helper.ml.html#L77" title="ocaml/utils/arg_helper.ml:77">length</a></span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier"><a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a></span><span class="ocamlNone"> </span><span class="Statement">=</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">magic_length</span><span class="ocamlNone"> </span><span class="Statement">then</span><span class="ocamlStruct"> </span><span class="Statement">begin<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L1116" title="ocaml/utils/misc.ml:1116">raw_kind</a></span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="PreProc">String</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier"><a href="targetint.mli.html#L50" title="ocaml/utils/targetint.mli:50">sub</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a></span><span class="ocamlEnd"> </span><span class="Constant">0</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">kind_length</span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">raw_version</span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="PreProc">String</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier"><a href="targetint.mli.html#L50" title="ocaml/utils/targetint.mli:50">sub</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">kind_length</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">version_length</span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">match</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">parse_kind</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L1116" title="ocaml/utils/misc.ml:1116">raw_kind</a></span><span class="ocamlEnd"> </span><span class="Statement">with<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Constant">None</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;</span><span class="ocamlEnd"> </span><span class="Constant">Error</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="Constant">Not_a_magic_number</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a></span><span class="Statement">)<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Constant">Some</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">kind</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">begin</span><span class="ocamlEnd"> </span><span class="Statement">match</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">int_of_string</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">raw_version</span><span class="ocamlEnd"> </span><span class="Statement">with<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Statement">exception</span><span class="ocamlEnd"> </span><span class="Statement">_</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;</span><span class="ocamlEnd"> </span><span class="Constant">Error</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="Constant">Truncated</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a></span><span class="Statement">)<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="config.common.ml.html#L20" title="ocaml/utils/config.common.ml:20">version</a></span><span class="ocamlEnd"> </span><span class="Statement">-&gt;</span><span class="ocamlEnd"> </span><span class="Constant">Ok</span><span class="ocamlEnd"> </span><span class="Statement">{</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">kind</span><span class="Statement">;</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="config.common.ml.html#L20" title="ocaml/utils/config.common.ml:20">version</a></span><span class="ocamlEnd"> </span><span class="Statement">}<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">end<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="Statement">end<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">else</span><span class="ocamlStruct"> </span><span class="Statement">begin<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Comment">(* a header is &quot;truncated&quot; if it starts like a valid <a href="binutils.ml.html#L625" title="ocaml/utils/binutils.ml:625">magic</a> <a href="warnings.ml.html#L121" title="ocaml/utils/warnings.ml:121">number</a>,<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; that is if <a href="warnings.ml.html#L1077" title="ocaml/utils/warnings.ml:1077">its</a> longest segment of <a href="arg_helper.ml.html#L77" title="ocaml/utils/arg_helper.ml:77">length</a> at most [kind_length]<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; is a <a href="diffing_with_keys.mli.html#L49" title="ocaml/utils/diffing_with_keys.mli:49">prefix</a> of [<a href="#L1116" title="ocaml/utils/misc.ml:1116">raw_kind</a> kind] for some kind [kind] *)<br/></li>
<li><a id="L1073">&#x200c;</a></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><span class="linkable">sub_length</span></span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="PreProc">Int</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">min</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">kind_length</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="PreProc">String</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier"><a href="arg_helper.ml.html#L77" title="ocaml/utils/arg_helper.ml:77">length</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a></span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li><a id="L1074">&#x200c;</a></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><span class="linkable">starts_as</span></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">kind</span><span class="ocamlEnd"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="PreProc">String</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier"><a href="targetint.mli.html#L50" title="ocaml/utils/targetint.mli:50">sub</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a></span><span class="ocamlEnd"> </span><span class="Constant">0</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L1073" title="ocaml/utils/misc.ml:1073">sub_length</a></span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="PreProc">String</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier"><a href="targetint.mli.html#L50" title="ocaml/utils/targetint.mli:50">sub</a></span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L1116" title="ocaml/utils/misc.ml:1116">raw_kind</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">kind</span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="Constant">0</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L1073" title="ocaml/utils/misc.ml:1073">sub_length</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">if</span><span class="ocamlNone"> </span><span class="PreProc">List</span><span class="ocamlNone">.</span><span class="ocamlLCIdentifier">exists</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier"><a href="#L1074" title="ocaml/utils/misc.ml:1074">starts_as</a></span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">all_kinds</span><span class="ocamlNone"> </span><span class="Statement">then</span><span class="ocamlEnd"> </span><span class="Constant">Error</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="Constant">Truncated</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a></span><span class="Statement">)<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">else</span><span class="ocamlEnd"> </span><span class="Constant">Error</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="Constant">Not_a_magic_number</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a></span><span class="Statement">)<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="Statement">end<br/></li>
<li></span><br/></li>
<li><a id="L1081">&#x200c;</a><span class="ocamlStruct">&nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><span class="linkable">read_info</span></span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">ic</span><span class="ocamlStruct"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">header</span><span class="ocamlStruct"> </span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="PreProc">Buffer</span><span class="ocamlStruct">.</span><span class="ocamlLCIdentifier"><a href="lazy_backtrack.mli.html#L21" title="ocaml/utils/lazy_backtrack.mli:21">create</a></span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">magic_length</span><span class="ocamlStruct"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">begin<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">try</span><span class="ocamlEnd"> </span><span class="PreProc">Buffer</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">add_channel</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">header</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">ic</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">magic_length<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">with</span><span class="ocamlEnd"> </span><span class="Constant">End_of_file</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;</span><span class="ocamlEnd"> </span><span class="Constant">()<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="Statement">end;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="arg_helper.ml.html#L101" title="ocaml/utils/arg_helper.ml:101">parse</a></span><span class="ocamlStruct"> </span><span class="Statement">(</span><span class="PreProc">Buffer</span><span class="ocamlStruct">.</span><span class="ocamlLCIdentifier">contents</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">header</span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li><a id="L1089">&#x200c;</a><span class="ocamlStruct">&nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><span class="linkable">raw</span></span><span class="ocamlStruct"> </span><span class="Statement">{</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">kind</span><span class="Statement">;</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="config.common.ml.html#L20" title="ocaml/utils/config.common.ml:20">version</a></span><span class="Statement">;</span><span class="ocamlStruct"> </span><span class="Statement">}</span><span class="ocamlStruct"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="PreProc">Printf</span><span class="ocamlStruct">.</span><span class="ocamlLCIdentifier">sprintf</span><span class="ocamlStruct"> </span><span class="Constant">&quot;%<a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a>%03d&quot;</span><span class="ocamlStruct"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L1116" title="ocaml/utils/misc.ml:1116">raw_kind</a></span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">kind</span><span class="Statement">)</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="config.common.ml.html#L20" title="ocaml/utils/config.common.ml:20">version</a><br/></li>
<li></span><br/></li>
<li><a id="L1092">&#x200c;</a><span class="ocamlStruct">&nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><span class="linkable">current_raw</span></span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">kind</span><span class="ocamlStruct"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="Statement">open</span><span class="ocamlNone"> </span><span class="PreProc">Config</span><span class="ocamlStruct"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">match[</span><span class="ocamlStruct">@</span><span class="ocamlLCIdentifier">warning</span><span class="ocamlStruct"> </span><span class="Constant">&quot;+9&quot;</span><span class="Statement">]</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">kind</span><span class="ocamlStruct"> </span><span class="Statement">with<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Exec</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="config.common.ml.html#L31" title="ocaml/utils/config.common.ml:31">exec_magic_number</a><br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Cmi</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="config.mli.html#L102" title="ocaml/utils/config.mli:102">cmi_magic_number</a><br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Cmo</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="config.mli.html#L105" title="ocaml/utils/config.mli:105">cmo_magic_number</a><br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Cma</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="config.mli.html#L108" title="ocaml/utils/config.mli:108">cma_magic_number</a><br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Cmx</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">config</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="Comment">(* the 'if' guarantees that in the common case<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; we return the &quot;trusted&quot; value from Config. *)<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="#L1113" title="ocaml/utils/misc.ml:1113">reference</a></span><span class="ocamlStruct"> </span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="config.mli.html#L111" title="ocaml/utils/config.mli:111">cmx_magic_number</a></span><span class="ocamlStruct"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">config</span><span class="ocamlNone"> </span><span class="Statement">=</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">native_obj_config</span><span class="ocamlNone"> </span><span class="Statement">then</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="#L1113" title="ocaml/utils/misc.ml:1113">reference</a><br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="Statement">else<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="Comment">(* otherwise we stitch together the <a href="binutils.ml.html#L625" title="ocaml/utils/binutils.ml:625">magic</a> <a href="warnings.ml.html#L121" title="ocaml/utils/warnings.ml:121">number</a><br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; for a different configuration by concatenating<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; the right <a href="binutils.ml.html#L625" title="ocaml/utils/binutils.ml:625">magic</a> kind at this configuration<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; and the <a href="warnings.ml.html#L850" title="ocaml/utils/warnings.ml:850">rest</a> of the <a href="warnings.ml.html#L587" title="ocaml/utils/warnings.ml:587">current</a> <a href="diffing_with_keys.ml.html#L204" title="ocaml/utils/diffing_with_keys.ml:204">raw</a> <a href="warnings.ml.html#L121" title="ocaml/utils/warnings.ml:121">number</a> for our configuration. *)<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="#L1116" title="ocaml/utils/misc.ml:1116">raw_kind</a></span><span class="ocamlStruct"> </span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="#L1116" title="ocaml/utils/misc.ml:1116">raw_kind</a></span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">kind</span><span class="ocamlStruct"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="#L1117" title="ocaml/utils/misc.ml:1117">len</a></span><span class="ocamlStruct"> </span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="PreProc">String</span><span class="ocamlStruct">.</span><span class="ocamlLCIdentifier"><a href="arg_helper.ml.html#L77" title="ocaml/utils/arg_helper.ml:77">length</a></span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="#L1116" title="ocaml/utils/misc.ml:1116">raw_kind</a></span><span class="ocamlStruct"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="ocamlLCIdentifier"><a href="#L1116" title="ocaml/utils/misc.ml:1116">raw_kind</a></span><span class="ocamlStruct"> </span><span class="Statement">^</span><span class="ocamlStruct"> </span><span class="PreProc">String</span><span class="ocamlStruct">.</span><span class="ocamlLCIdentifier"><a href="targetint.mli.html#L50" title="ocaml/utils/targetint.mli:50">sub</a></span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="#L1113" title="ocaml/utils/misc.ml:1113">reference</a></span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="#L1117" title="ocaml/utils/misc.ml:1117">len</a></span><span class="ocamlStruct"> </span><span class="Statement">(</span><span class="PreProc">String</span><span class="ocamlStruct">.</span><span class="ocamlLCIdentifier"><a href="arg_helper.ml.html#L77" title="ocaml/utils/arg_helper.ml:77">length</a></span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="#L1113" title="ocaml/utils/misc.ml:1113">reference</a></span><span class="ocamlStruct"> - </span><span class="ocamlLCIdentifier"><a href="#L1117" title="ocaml/utils/misc.ml:1117">len</a></span><span class="Statement">)<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Cmxa</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">config</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;<br/></li>
<li><a id="L1113">&#x200c;</a></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><span class="linkable">reference</span></span><span class="ocamlStruct"> </span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="config.mli.html#L114" title="ocaml/utils/config.mli:114">cmxa_magic_number</a></span><span class="ocamlStruct"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">config</span><span class="ocamlNone"> </span><span class="Statement">=</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">native_obj_config</span><span class="ocamlNone"> </span><span class="Statement">then</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="#L1113" title="ocaml/utils/misc.ml:1113">reference</a><br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="Statement">else<br/></li>
<li><a id="L1116">&#x200c;</a></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><span class="linkable">raw_kind</span></span><span class="ocamlStruct"> </span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><span class="linkable">raw_kind</span></span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">kind</span><span class="ocamlStruct"> </span><span class="Statement">in<br/></li>
<li><a id="L1117">&#x200c;</a></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><span class="linkable">len</span></span><span class="ocamlStruct"> </span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="PreProc">String</span><span class="ocamlStruct">.</span><span class="ocamlLCIdentifier"><a href="arg_helper.ml.html#L77" title="ocaml/utils/arg_helper.ml:77">length</a></span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="#L1116" title="ocaml/utils/misc.ml:1116">raw_kind</a></span><span class="ocamlStruct"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="ocamlLCIdentifier"><a href="#L1116" title="ocaml/utils/misc.ml:1116">raw_kind</a></span><span class="ocamlStruct"> </span><span class="Statement">^</span><span class="ocamlStruct"> </span><span class="PreProc">String</span><span class="ocamlStruct">.</span><span class="ocamlLCIdentifier"><a href="targetint.mli.html#L50" title="ocaml/utils/targetint.mli:50">sub</a></span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="#L1113" title="ocaml/utils/misc.ml:1113">reference</a></span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="#L1117" title="ocaml/utils/misc.ml:1117">len</a></span><span class="ocamlStruct"> </span><span class="Statement">(</span><span class="PreProc">String</span><span class="ocamlStruct">.</span><span class="ocamlLCIdentifier"><a href="arg_helper.ml.html#L77" title="ocaml/utils/arg_helper.ml:77">length</a></span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="#L1113" title="ocaml/utils/misc.ml:1113">reference</a></span><span class="ocamlStruct"> - </span><span class="ocamlLCIdentifier"><a href="#L1117" title="ocaml/utils/misc.ml:1117">len</a></span><span class="Statement">)<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Cmxs</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="config.mli.html#L123" title="ocaml/utils/config.mli:123">cmxs_magic_number</a><br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Cmt</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="config.mli.html#L126" title="ocaml/utils/config.mli:126">cmt_magic_number</a><br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Ast_intf</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="config.mli.html#L117" title="ocaml/utils/config.mli:117">ast_intf_magic_number</a><br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Ast_impl</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="config.mli.html#L120" title="ocaml/utils/config.mli:120">ast_impl_magic_number</a><br/></li>
<li></span><br/></li>
<li><span class="ocamlStruct">&nbsp; </span><span class="Comment">(* it would seem more direct to define <a href="#L1128" title="ocaml/utils/misc.ml:1128">current_version</a> with the<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; correct numbers and <a href="#L1092" title="ocaml/utils/misc.ml:1092">current_raw</a> on top of it, but for now we<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; consider the Config.foo values to be ground truth, and don'<a href="lazy_backtrack.mli.html#L16" title="ocaml/utils/lazy_backtrack.mli:16">t</a> want<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; to trust the present module instead. *)<br/></li>
<li><a id="L1128">&#x200c;</a></span><span class="ocamlStruct">&nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><span class="linkable">current_version</span></span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">kind</span><span class="ocamlStruct"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="diffing_with_keys.ml.html#L204" title="ocaml/utils/diffing_with_keys.ml:204">raw</a></span><span class="ocamlStruct"> </span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="#L1092" title="ocaml/utils/misc.ml:1092">current_raw</a></span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">kind</span><span class="ocamlStruct"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">try</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">int_of_string</span><span class="ocamlStruct"> </span><span class="Statement">(</span><span class="PreProc">String</span><span class="ocamlStruct">.</span><span class="ocamlLCIdentifier"><a href="targetint.mli.html#L50" title="ocaml/utils/targetint.mli:50">sub</a></span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="diffing_with_keys.ml.html#L204" title="ocaml/utils/diffing_with_keys.ml:204">raw</a></span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">kind_length</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">version_length</span><span class="Statement">)<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">with</span><span class="ocamlStruct"> </span><span class="Statement">_</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="Statement">assert</span><span class="ocamlStruct"> </span><span class="Constant">false<br/></li>
<li></span><br/></li>
<li><a id="L1133">&#x200c;</a><span class="ocamlStruct">&nbsp; </span><span class="Statement">type</span><span class="ocamlStruct"> '</span><span class="ocamlLCIdentifier">a</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><span class="linkable">unexpected</span></span><span class="ocamlStruct"> </span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="Statement">{</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">expected</span><span class="ocamlStruct"> : '</span><span class="ocamlLCIdentifier">a</span><span class="Statement">;</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="#L1153" title="ocaml/utils/misc.ml:1153">actual</a></span><span class="ocamlStruct"> : '</span><span class="ocamlLCIdentifier">a</span><span class="ocamlStruct"> </span><span class="Statement">}<br/></li>
<li><a id="L1134">&#x200c;</a></span><span class="ocamlStruct">&nbsp; </span><span class="Statement">type</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><span class="linkable">unexpected_error</span></span><span class="ocamlStruct"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Kind</span><span class="ocamlStruct"> </span><span class="Statement">of</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">kind</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="#L1133" title="ocaml/utils/misc.ml:1133">unexpected</a><br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Version</span><span class="ocamlStruct"> </span><span class="Statement">of</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">kind</span><span class="ocamlStruct"> </span><span class="Statement">*</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="config.common.ml.html#L20" title="ocaml/utils/config.common.ml:20">version</a></span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="#L1133" title="ocaml/utils/misc.ml:1133">unexpected</a><br/></li>
<li></span><br/></li>
<li><a id="L1138">&#x200c;</a><span class="ocamlStruct">&nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><span class="linkable">explain_unexpected_error</span></span><span class="ocamlStruct"> </span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="Statement">function<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Kind</span><span class="ocamlStruct"> </span><span class="Statement">{</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="#L1153" title="ocaml/utils/misc.ml:1153">actual</a></span><span class="Statement">;</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">expected</span><span class="ocamlStruct"> </span><span class="Statement">}</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="PreProc">Printf</span><span class="ocamlStruct">.</span><span class="ocamlLCIdentifier">sprintf</span><span class="ocamlStruct"> </span><span class="Constant">&quot;We expected a %<a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a> (%<a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a>) but got a %<a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a> (%<a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a>) instead.&quot;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">(</span><span class="ocamlLCIdentifier">human_name_of_kind</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">expected</span><span class="Statement">)</span><span class="ocamlStruct"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">string_of_kind</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">expected</span><span class="Statement">)<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">(</span><span class="ocamlLCIdentifier">human_name_of_kind</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="#L1153" title="ocaml/utils/misc.ml:1153">actual</a></span><span class="Statement">)</span><span class="ocamlStruct"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">string_of_kind</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="#L1153" title="ocaml/utils/misc.ml:1153">actual</a></span><span class="Statement">)<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Version</span><span class="ocamlStruct"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">kind</span><span class="ocamlStruct">, </span><span class="Statement">{</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="#L1153" title="ocaml/utils/misc.ml:1153">actual</a></span><span class="Statement">;</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">expected</span><span class="ocamlStruct"> </span><span class="Statement">})</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="PreProc">Printf</span><span class="ocamlStruct">.</span><span class="ocamlLCIdentifier">sprintf</span><span class="ocamlStruct"> </span><span class="Constant">&quot;This seems to be a %<a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a> (%<a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a>) for %<a href="ccomp.ml.html#L51" title="ocaml/utils/ccomp.ml:51">s</a> <a href="config.common.ml.html#L20" title="ocaml/utils/config.common.ml:20">version</a> of OCaml.&quot;<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">(</span><span class="ocamlLCIdentifier">human_name_of_kind</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">kind</span><span class="Statement">)</span><span class="ocamlStruct"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">string_of_kind</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">kind</span><span class="Statement">)<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">(if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier"><a href="#L1153" title="ocaml/utils/misc.ml:1153">actual</a></span><span class="ocamlNone"> </span><span class="Statement">&lt;</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">expected</span><span class="ocamlNone"> </span><span class="Statement">then</span><span class="ocamlStruct"> </span><span class="Constant">&quot;an older&quot;</span><span class="ocamlStruct"> </span><span class="Statement">else</span><span class="ocamlStruct"> </span><span class="Constant">&quot;a newer&quot;</span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li><a id="L1148">&#x200c;</a><span class="ocamlStruct">&nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><span class="linkable">check_current</span></span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">expected_kind</span><span class="ocamlStruct"> </span><span class="Statement">{</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">kind</span><span class="Statement">;</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="config.common.ml.html#L20" title="ocaml/utils/config.common.ml:20">version</a></span><span class="ocamlStruct"> </span><span class="Statement">}</span><span class="ocamlStruct"> : </span><span class="Statement">_</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="#L592" title="ocaml/utils/misc.ml:592">result</a></span><span class="ocamlStruct"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">kind</span><span class="ocamlNone"> </span><span class="Statement">&lt;&gt;</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">expected_kind</span><span class="ocamlNone"> </span><span class="Statement">then</span><span class="ocamlStruct"> </span><span class="Statement">begin<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L1153" title="ocaml/utils/misc.ml:1153">actual</a></span><span class="ocamlEnd">, </span><span class="ocamlLCIdentifier">expected</span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">kind</span><span class="ocamlEnd">, </span><span class="ocamlLCIdentifier">expected_kind</span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Constant">Error</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="Constant">Kind</span><span class="ocamlEnd"> </span><span class="Statement">{</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L1153" title="ocaml/utils/misc.ml:1153">actual</a></span><span class="Statement">;</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">expected</span><span class="ocamlEnd"> </span><span class="Statement">})<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="Statement">end</span><span class="ocamlStruct"> </span><span class="Statement">else</span><span class="ocamlStruct"> </span><span class="Statement">begin<br/></li>
<li><a id="L1153">&#x200c;</a></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><span class="linkable">actual</span></span><span class="ocamlEnd">, </span><span class="ocamlLCIdentifier">expected</span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="config.common.ml.html#L20" title="ocaml/utils/config.common.ml:20">version</a></span><span class="ocamlEnd">, </span><span class="ocamlLCIdentifier"><a href="#L1128" title="ocaml/utils/misc.ml:1128">current_version</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">kind</span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier"><a href="#L1153" title="ocaml/utils/misc.ml:1153">actual</a></span><span class="ocamlNone"> </span><span class="Statement">&lt;&gt;</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">expected<br/></li>
<li></span><span class="ocamlNone">&nbsp; &nbsp; &nbsp; </span><span class="Statement">then</span><span class="ocamlEnd"> </span><span class="Constant">Error</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="Constant">Version</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">kind</span><span class="ocamlEnd">, </span><span class="Statement">{</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L1153" title="ocaml/utils/misc.ml:1153">actual</a></span><span class="Statement">;</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">expected</span><span class="ocamlEnd"> </span><span class="Statement">}))<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">else</span><span class="ocamlEnd"> </span><span class="Constant">Ok</span><span class="ocamlEnd"> </span><span class="Constant">()<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="Statement">end<br/></li>
<li></span><br/></li>
<li><a id="L1159">&#x200c;</a><span class="ocamlStruct">&nbsp; </span><span class="Statement">type</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><span class="linkable">error</span></span><span class="ocamlStruct"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Parse_error</span><span class="ocamlStruct"> </span><span class="Statement">of</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">parse_error<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Unexpected_error</span><span class="ocamlStruct"> </span><span class="Statement">of</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="#L1134" title="ocaml/utils/misc.ml:1134">unexpected_error</a><br/></li>
<li></span><br/></li>
<li><a id="L1163">&#x200c;</a><span class="ocamlStruct">&nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><span class="linkable">read_current_info</span></span><span class="ocamlStruct"> </span><span class="Statement">~</span><span class="Identifier">expected_kind</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">ic</span><span class="ocamlStruct"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; </span><span class="Statement">match</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="#L1081" title="ocaml/utils/misc.ml:1081">read_info</a></span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">ic</span><span class="ocamlStruct"> </span><span class="Statement">with<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Error</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">err</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="Constant">Error</span><span class="ocamlStruct"> </span><span class="Statement">(</span><span class="Constant">Parse_error</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">err</span><span class="Statement">)<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Ok</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">info</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;<br/></li>
<li><a id="L1167">&#x200c;</a></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="Statement">let</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">kind</span><span class="ocamlStruct"> </span><span class="Statement">=</span><span class="ocamlStruct"> </span><span class="PreProc">Option</span><span class="ocamlStruct">.</span><span class="ocamlLCIdentifier">value</span><span class="ocamlStruct"> </span><span class="Statement">~</span><span class="Identifier"><a href="arg_helper.ml.html#L40" title="ocaml/utils/arg_helper.ml:40">default</a></span><span class="ocamlStruct">:</span><span class="ocamlLCIdentifier">info</span><span class="ocamlStruct">.</span><span class="ocamlLCIdentifier">kind</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">expected_kind</span><span class="ocamlStruct"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="Statement">match</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier"><a href="#L1148" title="ocaml/utils/misc.ml:1148">check_current</a></span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">kind</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">info</span><span class="ocamlStruct"> </span><span class="Statement">with<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Error</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">err</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="Constant">Error</span><span class="ocamlStruct"> </span><span class="Statement">(</span><span class="Constant">Unexpected_error</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">err</span><span class="Statement">)<br/></li>
<li></span><span class="ocamlStruct">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="Statement">|</span><span class="ocamlStruct"> </span><span class="Constant">Ok</span><span class="ocamlStruct"> </span><span class="Constant">()</span><span class="ocamlStruct"> </span><span class="Statement">-&gt;</span><span class="ocamlStruct"> </span><span class="Constant">Ok</span><span class="ocamlStruct"> </span><span class="ocamlLCIdentifier">info<br/></li>
<li></span><span class="PreProc">end<br/></li>
</ol></span></code>
 <p class="nav-bar">
  <span class="nav-link"><a href="./index.html">One Level Up</a></span>
  <span class="nav-link"><a href="index.html">Top Level</a></span>
 </p>

 </body>
</html>
