<!-- generated by the vscode.pl tool from vscoded.-->

<html>
 <head>
  <title>ocaml/lambda/translmod.ml - ocaml</title>
  <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
  <style>
body {
    text-align: left;
    text-align-last: left;
}

.nav-bar {
    font-size: 120%;
    margin-top: 5px;
    margin-bottom: 5px;
}

.nav-link {
    padding-left: 5em;
    padding-right: 5em;
}

ul.toc {
    line-height: 200%;
    font-size: 150%;
}

code {
    font-family: consolas, monospace;
    line-height: 130%;
}

span.Constant {
    color: DarkGreen;
}

span.Special {
    color: #c06000;
}

span.Comment {
    color: DarkRed;
    font-style: italic;
}

span.Identifier {
    color: DarkCyan;
}

span.PreProc {
    color: DarkMagenta;
}

span.Statement, span.Type, span.Keyword, span.Repeat, span.Conditional,
    span.Operator, span.Exception
{
    color: DarkBlue;
}

span.Todo {
    color: DarkRed;
    background-color: Gold;
    font-style: italic;
}

span.Underlined {
    text-decoration: underline;
}

span.linkable {
    font-weight: bold;
}

code ol {
    counter-reset: item;
    list-style-type: none;
    margin-left: 0;
    padding-left: 0;
    list-style-position: inside;
}

code li {
    display: block;
}

code li:before {
    content: counter(item) "  ";
    counter-increment: item;
    color: #999;
    padding-right: 0.5em;
    padding-left: 0.4em;
    list-style-position: inside;
    text-align: right
}

  </style>
 </head>
 <body>
 <p class="nav-bar">
  <span class="nav-link"><a href="./index.html">One Level Up</a></span>
  <span class="nav-link"><a href="index.html">Top Level</a></span>
 </p>

  <h1>ocaml/lambda/translmod.ml - ocaml</h1>
 <h2>Global variables defined</h2>
 <ul class="toc">
<li><a href="#L1422">aliased_idents</a></li>
<li><a href="#L617">body</a></li>
<li><a href="#L628">body</a></li>
<li><a href="#L636">body</a></li>
<li><a href="#L660">body</a></li>
<li><a href="#L683">body</a></li>
<li><a href="#L699">body</a></li>
<li><a href="#L720">body</a></li>
<li><a href="#L749">body</a></li>
<li><a href="#L806">body</a></li>
<li><a href="#L1340">build_ident_map</a></li>
<li><a href="#L1462">close_toplevel_term</a></li>
<li><a href="#L405">compile_recmodule</a></li>
<li><a href="#L161">compose_coercions</a></li>
<li><a href="#L45">cons_opt</a></li>
<li><a href="#L829">defined_idents</a></li>
<li><a href="#L358">eval_rec_bindings</a></li>
<li><a href="#L1691">explanation_submsg</a></li>
<li><a href="#L614">ext_fields</a></li>
<li><a href="#L679">ext_fields</a></li>
<li><a href="#L300">extract_unsafe_cycle</a></li>
<li><a href="#L1385">f</a></li>
<li><a href="#L1095">field</a></li>
<li><a href="#L1179">field</a></li>
<li><a href="#L973">field_of_str</a></li>
<li><a href="#L58">field_path</a></li>
<li><a href="#L54">functor_path</a></li>
<li><a href="#L53">global_path</a></li>
<li><a href="#L634">id</a></li>
<li><a href="#L646">id</a></li>
<li><a href="#L1023">id</a></li>
<li><a href="#L627">ids</a></li>
<li><a href="#L698">ids</a></li>
<li><a href="#L705">ids</a></li>
<li><a href="#L735">ids</a></li>
<li><a href="#L998">ids</a></li>
<li><a href="#L1012">ids</a></li>
<li><a href="#L1133">ids</a></li>
<li><a href="#L1149">ids</a></li>
<li><a href="#L1205">ids</a></li>
<li><a href="#L1230">ids</a></li>
<li><a href="#L1253">ids</a></li>
<li><a href="#L1180">ids0</a></li>
<li><a href="#L1231">ids0</a></li>
<li><a href="#L231">init_shape</a></li>
<li><a href="#L686">lam</a></li>
<li><a href="#L999">lam</a></li>
<li><a href="#L1015">lam</a></li>
<li><a href="#L1026">lam</a></li>
<li><a href="#L1040">lam</a></li>
<li><a href="#L1056">lam</a></li>
<li><a href="#L1087">lam</a></li>
<li><a href="#L1108">lam</a></li>
<li><a href="#L1150">lam</a></li>
<li><a href="#L1171">lam</a></li>
<li><a href="#L1226">lam</a></li>
<li><a href="#L1025">loc</a></li>
<li><a href="#L1055">loc</a></li>
<li><a href="#L1086">loc</a></li>
<li><a href="#L1208">loc</a></li>
<li><a href="#L1229">loc</a></li>
<li><a href="#L1255">loc</a></li>
<li><a href="#L1181">loop</a></li>
<li><a href="#L1193">map</a></li>
<li><a href="#L1383">map</a></li>
<li><a href="#L707">mid</a></li>
<li><a href="#L736">mid</a></li>
<li><a href="#L1207">mid</a></li>
<li><a href="#L1254">mid</a></li>
<li><a href="#L612">mk_lam_let</a></li>
<li><a href="#L220">mod_prim</a></li>
<li><a href="#L706">modl</a></li>
<li><a href="#L1206">modl</a></li>
<li><a href="#L651">module_body</a></li>
<li><a href="#L655">module_body</a></li>
<li><a href="#L860">more_idents</a></li>
<li><a href="#L965">nat_toplevel_name</a></li>
<li><a href="#L635">path</a></li>
<li><a href="#L1024">path</a></li>
<li><a href="#L211">primitive_declarations</a></li>
<li><a href="#L1682">print_cycle</a></li>
<li><a href="#L726">pure</a></li>
<li><a href="#L1244">pure</a></li>
<li><a href="#L708">rebind_idents</a></li>
<li><a href="#L737">rebind_idents</a></li>
<li><a href="#L212">record_primitive</a></li>
<li><a href="#L315">reorder_rec_bindings</a></li>
<li><a href="#L1706">report_error</a></li>
<li><a href="#L777">required_globals</a></li>
<li><a href="#L1725">reset</a></li>
<li><a href="#L765">scan_used_globals</a></li>
<li><a href="#L805">scopes</a></li>
<li><a href="#L1424">set_toplevel_unique_name</a></li>
<li><a href="#L1277">store_ident</a></li>
<li><a href="#L1209">store_idents</a></li>
<li><a href="#L1233">store_idents</a></li>
<li><a href="#L1256">store_idents</a></li>
<li><a href="#L648">subscopes</a></li>
<li><a href="#L1063">subst</a></li>
<li><a href="#L1094">subst</a></li>
<li><a href="#L1178">subst</a></li>
<li><a href="#L1232">subst</a></li>
<li><a href="#L1428">toplevel_name</a></li>
<li><a href="#L1432">toploop_getvalue</a></li>
<li><a href="#L1419">toploop_getvalue_pos</a></li>
<li><a href="#L1418">toploop_ident</a></li>
<li><a href="#L1445">toploop_setvalue</a></li>
<li><a href="#L1460">toploop_setvalue_id</a></li>
<li><a href="#L1420">toploop_setvalue_pos</a></li>
<li><a href="#L816">transl_implementation</a></li>
<li><a href="#L508">transl_module</a></li>
<li><a href="#L1609">transl_package</a></li>
<li><a href="#L1594">transl_package_flambda</a></li>
<li><a href="#L1378">transl_store_gen</a></li>
<li><a href="#L1402">transl_store_implementation</a></li>
<li><a href="#L1632">transl_store_package</a></li>
<li><a href="#L1395">transl_store_phrases</a></li>
<li><a href="#L985">transl_store_structure</a></li>
<li><a href="#L961">transl_store_subst</a></li>
<li><a href="#L1577">transl_toplevel_item_and_close</a></li>
<li><a href="#L65">transl_type_extension</a></li>
<li><a href="#L222">undefined_location</a></li>
<li><a href="#L137">wrap_id_pos_list</a></li>
</ul>
 <h2>Data types defined</h2>
 <ul class="toc">
<li><a href="#L291">binding_status</a></li>
<li><a href="#L39">error</a></li>
<li><a href="#L296">id_or_ignore_loc</a></li>
<li><a href="#L30">unsafe_component</a></li>
<li><a href="#L36">unsafe_info</a></li>
</ul>
 <h2>Source code</h2>

  <code><ol><li><span class="Comment">(**************************************************************************)<br/></li>
<li></span><span class="Comment">(*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *)<br/></li>
<li></span><span class="Comment">(*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; OCaml&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *)<br/></li>
<li></span><span class="Comment">(*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *)<br/></li>
<li></span><span class="Comment">(*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; Xavier Leroy, projet Cristal, INRIA Rocquencourt&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; *)<br/></li>
<li></span><span class="Comment">(*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *)<br/></li>
<li></span><span class="Comment">(*&nbsp;&nbsp; Copyright 1996 Institut National de Recherche en Informatique et&nbsp; &nbsp;&nbsp; *)<br/></li>
<li></span><span class="Comment">(*&nbsp; &nbsp;&nbsp; en Automatique.&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *)<br/></li>
<li></span><span class="Comment">(*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *)<br/></li>
<li></span><span class="Comment">(*&nbsp;&nbsp; All rights reserved.&nbsp; This file is distributed under the terms of&nbsp; &nbsp; *)<br/></li>
<li></span><span class="Comment">(*&nbsp;&nbsp; the GNU Lesser General Public License version 2.1, with the&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *)<br/></li>
<li></span><span class="Comment">(*&nbsp;&nbsp; special exception on linking described in the file LICENSE.&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *)<br/></li>
<li></span><span class="Comment">(*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *)<br/></li>
<li></span><span class="Comment">(**************************************************************************)<br/></li>
<li></span><br/></li>
<li><span class="Comment">(* Translation from typed abstract syntax to <a href="printlambda.ml.html#L705" title="ocaml/lambda/printlambda.ml:705">lambda</a> terms,<br/></li>
<li></span><span class="Comment">&nbsp;&nbsp; for the module language *)<br/></li>
<li></span><br/></li>
<li><span class="Statement"><a href="matching.ml.html#L419" title="ocaml/lambda/matching.ml:419">open</a></span><span class="ocamlNone"> </span><span class="PreProc">Misc<br/></li>
<li></span><span class="Statement"><a href="matching.ml.html#L419" title="ocaml/lambda/matching.ml:419">open</a></span><span class="ocamlNone"> </span><span class="PreProc">Asttypes<br/></li>
<li></span><span class="Statement"><a href="matching.ml.html#L419" title="ocaml/lambda/matching.ml:419">open</a></span><span class="ocamlNone"> </span><span class="PreProc">Path<br/></li>
<li></span><span class="Statement"><a href="matching.ml.html#L419" title="ocaml/lambda/matching.ml:419">open</a></span><span class="ocamlNone"> </span><span class="PreProc">Types<br/></li>
<li></span><span class="Statement"><a href="matching.ml.html#L419" title="ocaml/lambda/matching.ml:419">open</a></span><span class="ocamlNone"> </span><span class="PreProc">Typedtree<br/></li>
<li></span><span class="Statement"><a href="matching.ml.html#L419" title="ocaml/lambda/matching.ml:419">open</a></span><span class="ocamlNone"> </span><span class="PreProc">Lambda<br/></li>
<li></span><span class="Statement"><a href="matching.ml.html#L419" title="ocaml/lambda/matching.ml:419">open</a></span><span class="ocamlNone"> </span><span class="PreProc">Translobj<br/></li>
<li></span><span class="Statement"><a href="matching.ml.html#L419" title="ocaml/lambda/matching.ml:419">open</a></span><span class="ocamlNone"> </span><span class="PreProc">Translcore<br/></li>
<li></span><span class="Statement"><a href="matching.ml.html#L419" title="ocaml/lambda/matching.ml:419">open</a></span><span class="ocamlNone"> </span><span class="PreProc">Translclass<br/></li>
<li></span><span class="Statement"><a href="matching.ml.html#L419" title="ocaml/lambda/matching.ml:419">open</a></span><span class="ocamlNone"> </span><span class="PreProc">Debuginfo.Scoped_location<br/></li>
<li></span><br/></li>
<li><a id="L30">&#x200c;</a><span class="Statement">type</span> <span class="ocamlLCIdentifier"><span class="linkable">unsafe_component</span></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Unsafe_module_binding<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Unsafe_functor<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Unsafe_non_function<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Unsafe_typext<br/></li>
<li></span><br/></li>
<li><a id="L36">&#x200c;</a><span class="Statement">type</span> <span class="ocamlLCIdentifier"><span class="linkable">unsafe_info</span></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Unsafe</span> <span class="Statement">of</span> <span class="Statement">{</span> <span class="ocamlLCIdentifier">reason</span>:<span class="ocamlLCIdentifier"><a href="translmod.mli.html#L45" title="ocaml/lambda/translmod.mli:45">unsafe_component</a></span><span class="Statement">;</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span>:<span class="PreProc">Location</span>.<span class="ocamlLCIdentifier"><a href="debuginfo.ml.html#L79" title="ocaml/lambda/debuginfo.ml:79">t</a></span><span class="Statement">;</span> <span class="ocamlLCIdentifier">subid</span>:<span class="PreProc">Ident</span>.<span class="ocamlLCIdentifier"><a href="debuginfo.ml.html#L79" title="ocaml/lambda/debuginfo.ml:79">t</a></span> <span class="Statement">}<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Unnamed<br/></li>
<li><a id="L39">&#x200c;</a></span><span class="Statement">type</span> <span class="ocamlLCIdentifier"><span class="linkable">error</span></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Constant">Circular_dependency</span> <span class="Statement">of</span> <span class="Statement">(</span><span class="PreProc">Ident</span>.<span class="ocamlLCIdentifier"><a href="debuginfo.ml.html#L79" title="ocaml/lambda/debuginfo.ml:79">t</a></span> <span class="Statement">*</span> <span class="ocamlLCIdentifier"><a href="translmod.mli.html#L51" title="ocaml/lambda/translmod.mli:51">unsafe_info</a></span><span class="Statement">)</span> <span class="Type"><a href="tmc.ml.html#L478" title="ocaml/lambda/tmc.ml:478">list</a><br/></li>
<li></span><span class="Statement">|</span> <span class="Constant">Conflicting_inline_attributes<br/></li>
<li></span><br/></li>
<li><span class="Statement">exception</span> <span class="Constant">Error</span> <span class="Statement">of</span> <span class="PreProc">Location</span>.<span class="ocamlLCIdentifier"><a href="debuginfo.ml.html#L79" title="ocaml/lambda/debuginfo.ml:79">t</a></span> <span class="Statement">*</span> <span class="ocamlLCIdentifier"><a href="translprim.mli.html#L46" title="ocaml/lambda/translprim.mli:46">error</a><br/></li>
<li></span><br/></li>
<li><a id="L45">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">cons_opt</span></span> <span class="ocamlLCIdentifier">x_opt</span> <span class="ocamlLCIdentifier">xs</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">match</span> <span class="ocamlLCIdentifier">x_opt</span> <span class="Statement">with<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">None</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier">xs<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Some</span> <span class="ocamlLCIdentifier">x</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier">x</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier">xs<br/></li>
<li></span><br/></li>
<li><span class="Comment">(* Keep track of the root <a href="translclass.ml.html#L444" title="ocaml/lambda/translclass.ml:444">path</a> (from the root of the namespace to the<br/></li>
<li></span><span class="Comment">&nbsp;&nbsp; currently compiled module expression).&nbsp; Useful for naming extensions. *)<br/></li>
<li></span><br/></li>
<li><a id="L53">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">global_path</span></span> <span class="ocamlLCIdentifier">glob</span> <span class="Statement">=</span> <span class="Constant">Some</span><span class="Statement">(</span><span class="Constant">Pident</span> <span class="ocamlLCIdentifier">glob</span><span class="Statement">)<br/></li>
<li><a id="L54">&#x200c;</a></span><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">functor_path</span></span> <span class="ocamlLCIdentifier"><a href="translclass.ml.html#L444" title="ocaml/lambda/translclass.ml:444">path</a></span> <span class="ocamlLCIdentifier">param</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">match</span> <span class="ocamlLCIdentifier"><a href="translclass.ml.html#L444" title="ocaml/lambda/translclass.ml:444">path</a></span> <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">None</span> <span class="Statement">-&gt;</span> <span class="Constant">None<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Some</span> <span class="ocamlLCIdentifier">p</span> <span class="Statement">-&gt;</span> <span class="Constant">Some</span><span class="Statement">(</span><span class="Constant">Papply</span><span class="Statement">(</span><span class="ocamlLCIdentifier">p</span>, <span class="Constant">Pident</span> <span class="ocamlLCIdentifier">param</span><span class="Statement">))<br/></li>
<li><a id="L58">&#x200c;</a></span><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">field_path</span></span> <span class="ocamlLCIdentifier"><a href="translclass.ml.html#L444" title="ocaml/lambda/translclass.ml:444">path</a></span> <span class="ocamlLCIdentifier"><a href="#L1095" title="ocaml/lambda/translmod.ml:1095">field</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">match</span> <span class="ocamlLCIdentifier"><a href="translclass.ml.html#L444" title="ocaml/lambda/translclass.ml:444">path</a></span> <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">None</span> <span class="Statement">-&gt;</span> <span class="Constant">None<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Some</span> <span class="ocamlLCIdentifier">p</span> <span class="Statement">-&gt;</span> <span class="Constant">Some</span><span class="Statement">(</span><span class="Constant">Pdot</span><span class="Statement">(</span><span class="ocamlLCIdentifier">p</span>, <span class="PreProc">Ident</span>.<span class="ocamlLCIdentifier"><a href="translcore.ml.html#L56" title="ocaml/lambda/translcore.ml:56">name</a></span> <span class="ocamlLCIdentifier"><a href="#L1095" title="ocaml/lambda/translmod.ml:1095">field</a></span><span class="Statement">))<br/></li>
<li></span><br/></li>
<li><span class="Comment">(* Compile type extensions *)<br/></li>
<li></span><br/></li>
<li><a id="L65">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">transl_type_extension</span></span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier">env</span> <span class="ocamlLCIdentifier">rootpath</span> <span class="ocamlLCIdentifier">tyext</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L601" title="ocaml/lambda/translcore.ml:601">body</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="PreProc">List</span>.<span class="ocamlLCIdentifier">fold_right<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">(fun</span> <span class="ocamlLCIdentifier">ext</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L601" title="ocaml/lambda/translcore.ml:601">body</a></span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="translobj.ml.html#L145" title="ocaml/lambda/translobj.ml:145">lam</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="translcore.mli.html#L36" title="ocaml/lambda/translcore.mli:36">transl_extension_constructor</a></span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier">env<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L58" title="ocaml/lambda/translmod.ml:58">field_path</a></span> <span class="ocamlLCIdentifier">rootpath</span> <span class="ocamlLCIdentifier">ext</span>.<span class="ocamlLCIdentifier">ext_id</span><span class="Statement">)</span> <span class="ocamlLCIdentifier">ext<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Constant">Llet</span><span class="Statement">(</span><span class="Constant">Strict</span>, <span class="Constant">Pgenval</span>, <span class="ocamlLCIdentifier">ext</span>.<span class="ocamlLCIdentifier">ext_id</span>, <span class="ocamlLCIdentifier"><a href="translobj.ml.html#L145" title="ocaml/lambda/translobj.ml:145">lam</a></span>, <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L601" title="ocaml/lambda/translcore.ml:601">body</a></span><span class="Statement">))<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier">tyext</span>.<span class="ocamlLCIdentifier">tyext_constructors<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L601" title="ocaml/lambda/translcore.ml:601">body</a><br/></li>
<li></span><br/></li>
<li><span class="Comment">(* Compile a coercion *)<br/></li>
<li></span><br/></li>
<li><span class="Statement">let</span> <span class="Statement">rec</span> <span class="ocamlLCIdentifier">apply_coercion</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span> <span class="ocamlLCIdentifier">strict</span> <span class="ocamlLCIdentifier">restr</span> <span class="ocamlLCIdentifier"><a href="matching.ml.html#L2339" title="ocaml/lambda/matching.ml:2339">arg</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">match</span> <span class="ocamlLCIdentifier">restr</span> <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">Tcoerce_none</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="matching.ml.html#L2339" title="ocaml/lambda/matching.ml:2339">arg</a><br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Tcoerce_structure</span><span class="Statement">(</span><span class="ocamlLCIdentifier">pos_cc_list</span>, <span class="ocamlLCIdentifier">id_pos_list</span><span class="Statement">)</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="lambda.mli.html#L367" title="ocaml/lambda/lambda.mli:367">name_lambda</a></span> <span class="ocamlLCIdentifier">strict</span> <span class="ocamlLCIdentifier"><a href="matching.ml.html#L2339" title="ocaml/lambda/matching.ml:2339">arg</a></span> <span class="Statement">(fun</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">get_field</span> <span class="ocamlLCIdentifier">pos</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">pos</span><span class="ocamlNone"> </span><span class="Statement">&lt;</span><span class="ocamlNone"> </span><span class="Constant">0</span><span class="ocamlNone"> </span><span class="Statement">then</span> <span class="ocamlLCIdentifier"><a href="lambda.mli.html#L366" title="ocaml/lambda/lambda.mli:366">lambda_unit</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">else</span> <span class="Constant">Lprim</span><span class="Statement">(</span><span class="Constant">Pfield</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">pos</span>, <span class="Constant">Pointer</span>, <span class="Constant">Mutable</span><span class="Statement">)</span>, <span class="Statement">[</span><span class="Constant">Lvar</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span><span class="Statement">]</span>, <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="translobj.ml.html#L145" title="ocaml/lambda/translobj.ml:145">lam</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">Lprim</span><span class="Statement">(</span><span class="Constant">Pmakeblock</span><span class="Statement">(</span><span class="Constant">0</span>, <span class="Constant">Immutable</span>, <span class="Constant">None</span><span class="Statement">)</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="PreProc">List</span>.<span class="ocamlLCIdentifier"><a href="matching.ml.html#L922" title="ocaml/lambda/matching.ml:922">map</a></span> <span class="Statement">(</span><span class="ocamlLCIdentifier">apply_coercion_field</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span> <span class="ocamlLCIdentifier">get_field</span><span class="Statement">)</span> <span class="ocamlLCIdentifier">pos_cc_list</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L137" title="ocaml/lambda/translmod.ml:137">wrap_id_pos_list</a></span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span> <span class="ocamlLCIdentifier">id_pos_list</span> <span class="ocamlLCIdentifier">get_field</span> <span class="ocamlLCIdentifier"><a href="translobj.ml.html#L145" title="ocaml/lambda/translobj.ml:145">lam</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Tcoerce_functor</span><span class="Statement">(</span><span class="ocamlLCIdentifier">cc_arg</span>, <span class="ocamlLCIdentifier">cc_res</span><span class="Statement">)</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">param</span> <span class="Statement">=</span> <span class="PreProc">Ident</span>.<span class="ocamlLCIdentifier">create_local</span> <span class="Constant">&quot;funarg&quot;</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">carg</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">apply_coercion</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span> <span class="Constant">Alias</span> <span class="ocamlLCIdentifier">cc_arg</span> <span class="Statement">(</span><span class="Constant">Lvar</span> <span class="ocamlLCIdentifier">param</span><span class="Statement">)</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">apply_coercion_result</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span> <span class="ocamlLCIdentifier">strict</span> <span class="ocamlLCIdentifier"><a href="matching.ml.html#L2339" title="ocaml/lambda/matching.ml:2339">arg</a></span> <span class="Statement">[</span><span class="ocamlLCIdentifier">param</span>, <span class="Constant">Pgenval</span><span class="Statement">]</span> <span class="Statement">[</span><span class="ocamlLCIdentifier">carg</span><span class="Statement">]</span> <span class="ocamlLCIdentifier">cc_res<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Tcoerce_primitive</span> <span class="Statement">{</span> <span class="ocamlLCIdentifier">pc_loc</span> <span class="Statement">=</span> <span class="Statement">_;</span> <span class="ocamlLCIdentifier">pc_desc</span><span class="Statement">;</span> <span class="ocamlLCIdentifier">pc_env</span><span class="Statement">;</span> <span class="ocamlLCIdentifier">pc_type</span><span class="Statement">;</span> <span class="Statement">}</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="PreProc">Translprim</span>.<span class="ocamlLCIdentifier"><a href="translprim.mli.html#L35" title="ocaml/lambda/translprim.mli:35">transl_primitive</a></span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span> <span class="ocamlLCIdentifier">pc_desc</span> <span class="ocamlLCIdentifier">pc_env</span> <span class="ocamlLCIdentifier">pc_type</span> <span class="Constant">None<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Tcoerce_alias</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">env</span>, <span class="ocamlLCIdentifier"><a href="translclass.ml.html#L444" title="ocaml/lambda/translclass.ml:444">path</a></span>, <span class="ocamlLCIdentifier">cc</span><span class="Statement">)</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="translobj.ml.html#L145" title="ocaml/lambda/translobj.ml:145">lam</a></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="lambda.mli.html#L403" title="ocaml/lambda/lambda.mli:403">transl_module_path</a></span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span> <span class="ocamlLCIdentifier">env</span> <span class="ocamlLCIdentifier"><a href="translclass.ml.html#L444" title="ocaml/lambda/translclass.ml:444">path</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="lambda.mli.html#L367" title="ocaml/lambda/lambda.mli:367">name_lambda</a></span> <span class="ocamlLCIdentifier">strict</span> <span class="ocamlLCIdentifier"><a href="matching.ml.html#L2339" title="ocaml/lambda/matching.ml:2339">arg</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">(fun</span> <span class="Statement">_</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier">apply_coercion</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span> <span class="Constant">Alias</span> <span class="ocamlLCIdentifier">cc</span> <span class="ocamlLCIdentifier"><a href="translobj.ml.html#L145" title="ocaml/lambda/translobj.ml:145">lam</a></span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li><span class="Statement">and</span> <span class="ocamlLCIdentifier">apply_coercion_field</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span> <span class="ocamlLCIdentifier">get_field</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">pos</span>, <span class="ocamlLCIdentifier">cc</span><span class="Statement">)</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier">apply_coercion</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span> <span class="Constant">Alias</span> <span class="ocamlLCIdentifier">cc</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">get_field</span> <span class="ocamlLCIdentifier">pos</span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li><span class="Statement">and</span> <span class="ocamlLCIdentifier">apply_coercion_result</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span> <span class="ocamlLCIdentifier">strict</span> <span class="ocamlLCIdentifier">funct</span> <span class="ocamlLCIdentifier"><a href="translprim.ml.html#L784" title="ocaml/lambda/translprim.ml:784">params</a></span> <span class="ocamlLCIdentifier"><a href="simplif.ml.html#L732" title="ocaml/lambda/simplif.ml:732">args</a></span> <span class="ocamlLCIdentifier">cc_res</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">match</span> <span class="ocamlLCIdentifier">cc_res</span> <span class="Statement">with<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Tcoerce_functor</span><span class="Statement">(</span><span class="ocamlLCIdentifier">cc_arg</span>, <span class="ocamlLCIdentifier">cc_res</span><span class="Statement">)</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">param</span> <span class="Statement">=</span> <span class="PreProc">Ident</span>.<span class="ocamlLCIdentifier">create_local</span> <span class="Constant">&quot;funarg&quot;</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="matching.ml.html#L2339" title="ocaml/lambda/matching.ml:2339">arg</a></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">apply_coercion</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span> <span class="Constant">Alias</span> <span class="ocamlLCIdentifier">cc_arg</span> <span class="Statement">(</span><span class="Constant">Lvar</span> <span class="ocamlLCIdentifier">param</span><span class="Statement">)</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier">apply_coercion_result</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span> <span class="ocamlLCIdentifier">strict</span> <span class="ocamlLCIdentifier">funct<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">((</span><span class="ocamlLCIdentifier">param</span>, <span class="Constant">Pgenval</span><span class="Statement">)</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier"><a href="translprim.ml.html#L784" title="ocaml/lambda/translprim.ml:784">params</a></span><span class="Statement">)</span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="matching.ml.html#L2339" title="ocaml/lambda/matching.ml:2339">arg</a></span> <span class="Statement">::</span> <span class="ocamlLCIdentifier"><a href="simplif.ml.html#L732" title="ocaml/lambda/simplif.ml:732">args</a></span><span class="Statement">)</span> <span class="ocamlLCIdentifier">cc_res<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Statement">_</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="lambda.mli.html#L367" title="ocaml/lambda/lambda.mli:367">name_lambda</a></span> <span class="ocamlLCIdentifier">strict</span> <span class="ocamlLCIdentifier">funct<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">(fun</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier"><a href="translclass.ml.html#L30" title="ocaml/lambda/translclass.ml:30">lfunction</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">~</span><span class="Identifier"><a href="translcore.ml.html#L383" title="ocaml/lambda/translcore.ml:383">kind</a></span>:<span class="Constant">Curried<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">~</span><span class="Identifier"><a href="translprim.ml.html#L784" title="ocaml/lambda/translprim.ml:784">params</a></span>:<span class="Statement">(</span><span class="PreProc">List</span>.<span class="ocamlLCIdentifier">rev</span> <span class="ocamlLCIdentifier"><a href="translprim.ml.html#L784" title="ocaml/lambda/translprim.ml:784">params</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">~</span><span class="Identifier">return</span>:<span class="Constant">Pgenval<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">~</span><span class="Identifier"><a href="simplif.ml.html#L760" title="ocaml/lambda/simplif.ml:760">attr</a></span>:<span class="Statement">{</span> <span class="ocamlLCIdentifier"><a href="lambda.mli.html#L451" title="ocaml/lambda/lambda.mli:451">default_function_attribute</a></span> <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">is_a_functor</span> <span class="Statement">=</span> <span class="Constant">true</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">stub</span> <span class="Statement">=</span> <span class="Constant">true</span><span class="Statement">;</span> <span class="Statement">}<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">~</span><span class="Identifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">~</span><span class="Identifier"><a href="translcore.ml.html#L601" title="ocaml/lambda/translcore.ml:601">body</a></span>:<span class="Statement">(</span><span class="ocamlLCIdentifier">apply_coercion<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span> <span class="Constant">Strict</span> <span class="ocamlLCIdentifier">cc_res<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">(</span><span class="Constant">Lapply</span><span class="Statement">{<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">ap_loc</span><span class="Statement">=</span><span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">ap_func</span><span class="Statement">=</span><span class="Constant">Lvar</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">ap_args</span><span class="Statement">=</span><span class="PreProc">List</span>.<span class="ocamlLCIdentifier">rev</span> <span class="ocamlLCIdentifier"><a href="simplif.ml.html#L732" title="ocaml/lambda/simplif.ml:732">args</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">ap_tailcall</span><span class="Statement">=</span><span class="Constant">Default_tailcall</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">ap_inlined</span><span class="Statement">=</span><span class="Constant">Default_inline</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">ap_specialised</span><span class="Statement">=</span><span class="Constant">Default_specialise</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">})))<br/></li>
<li></span><br/></li>
<li><a id="L137">&#x200c;</a><span class="Statement">and</span> <span class="ocamlLCIdentifier"><span class="linkable">wrap_id_pos_list</span></span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span> <span class="ocamlLCIdentifier">id_pos_list</span> <span class="ocamlLCIdentifier">get_field</span> <span class="ocamlLCIdentifier"><a href="translobj.ml.html#L145" title="ocaml/lambda/translobj.ml:145">lam</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="translclass.ml.html#L710" title="ocaml/lambda/translclass.ml:710">fv</a></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="lambda.mli.html#L401" title="ocaml/lambda/lambda.mli:401">free_variables</a></span> <span class="ocamlLCIdentifier"><a href="translobj.ml.html#L145" title="ocaml/lambda/translobj.ml:145">lam</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Comment">(*Format.<a href="matching.ml.html#L498" title="ocaml/lambda/matching.ml:498">eprintf</a> &quot;%a@.&quot; Printlambda.<a href="printlambda.ml.html#L705" title="ocaml/lambda/printlambda.ml:705">lambda</a> <a href="translobj.ml.html#L145" title="ocaml/lambda/translobj.ml:145">lam</a>;<br/></li>
<li></span><span class="Comment">&nbsp; Ident.Set.iter (fun <a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a> -&gt; Format.<a href="matching.ml.html#L498" title="ocaml/lambda/matching.ml:498">eprintf</a> &quot;%a &quot; Ident.print <a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a>) <a href="translclass.ml.html#L710" title="ocaml/lambda/translclass.ml:710">fv</a>;<br/></li>
<li></span><span class="Comment">&nbsp; Format.<a href="matching.ml.html#L498" title="ocaml/lambda/matching.ml:498">eprintf</a> &quot;@.&quot;;*)<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="translobj.ml.html#L145" title="ocaml/lambda/translobj.ml:145">lam</a></span>, <span class="ocamlLCIdentifier">_fv</span>, <span class="ocamlLCIdentifier"><a href="translclass.ml.html#L563" title="ocaml/lambda/translclass.ml:563">s</a></span><span class="Statement">)</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">List</span>.<span class="ocamlLCIdentifier">fold_left</span> <span class="Statement">(fun</span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="translobj.ml.html#L145" title="ocaml/lambda/translobj.ml:145">lam</a></span>, <span class="ocamlLCIdentifier"><a href="translclass.ml.html#L710" title="ocaml/lambda/translclass.ml:710">fv</a></span>, <span class="ocamlLCIdentifier"><a href="translclass.ml.html#L563" title="ocaml/lambda/translclass.ml:563">s</a></span><span class="Statement">)</span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span>',<span class="ocamlLCIdentifier">pos</span>,<span class="ocamlLCIdentifier">c</span><span class="Statement">)</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="PreProc">Ident</span><span class="ocamlNone">.</span><span class="PreProc">Set</span><span class="ocamlNone">.</span><span class="ocamlLCIdentifier">mem</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span><span class="ocamlNone">' </span><span class="ocamlLCIdentifier"><a href="translclass.ml.html#L710" title="ocaml/lambda/translclass.ml:710">fv</a></span><span class="ocamlNone"> </span><span class="Statement">then<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span>'' <span class="Statement">=</span> <span class="PreProc">Ident</span>.<span class="ocamlLCIdentifier">create_local</span> <span class="Statement">(</span><span class="PreProc">Ident</span>.<span class="ocamlLCIdentifier"><a href="translcore.ml.html#L56" title="ocaml/lambda/translcore.ml:56">name</a></span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span>'<span class="Statement">)</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L1059" title="ocaml/lambda/translcore.ml:1059">rhs</a></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">apply_coercion</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span> <span class="Constant">Alias</span> <span class="ocamlLCIdentifier">c</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">get_field</span> <span class="ocamlLCIdentifier">pos</span><span class="Statement">)</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">fv_rhs</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="lambda.mli.html#L401" title="ocaml/lambda/lambda.mli:401">free_variables</a></span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L1059" title="ocaml/lambda/translcore.ml:1059">rhs</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="Constant">Llet</span><span class="Statement">(</span><span class="Constant">Alias</span>, <span class="Constant">Pgenval</span>, <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span>'', <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L1059" title="ocaml/lambda/translcore.ml:1059">rhs</a></span>, <span class="ocamlLCIdentifier"><a href="translobj.ml.html#L145" title="ocaml/lambda/translobj.ml:145">lam</a></span><span class="Statement">)</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="PreProc">Ident</span>.<span class="PreProc">Set</span>.<span class="ocamlLCIdentifier"><a href="matching.ml.html#L900" title="ocaml/lambda/matching.ml:900">union</a></span> <span class="ocamlLCIdentifier"><a href="translclass.ml.html#L710" title="ocaml/lambda/translclass.ml:710">fv</a></span> <span class="ocamlLCIdentifier">fv_rhs</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="PreProc">Ident</span>.<span class="PreProc">Map</span>.<span class="ocamlLCIdentifier"><a href="matching.ml.html#L884" title="ocaml/lambda/matching.ml:884">add</a></span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span>' <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span>'' <span class="ocamlLCIdentifier"><a href="translclass.ml.html#L563" title="ocaml/lambda/translclass.ml:563">s</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">else</span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="translobj.ml.html#L145" title="ocaml/lambda/translobj.ml:145">lam</a></span>, <span class="ocamlLCIdentifier"><a href="translclass.ml.html#L710" title="ocaml/lambda/translclass.ml:710">fv</a></span>, <span class="ocamlLCIdentifier"><a href="translclass.ml.html#L563" title="ocaml/lambda/translclass.ml:563">s</a></span><span class="Statement">))<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="translobj.ml.html#L145" title="ocaml/lambda/translobj.ml:145">lam</a></span>, <span class="ocamlLCIdentifier"><a href="translclass.ml.html#L710" title="ocaml/lambda/translclass.ml:710">fv</a></span>, <span class="PreProc">Ident</span>.<span class="PreProc">Map</span>.<span class="ocamlLCIdentifier"><a href="matching.ml.html#L533" title="ocaml/lambda/matching.ml:533">empty</a></span><span class="Statement">)</span> <span class="ocamlLCIdentifier">id_pos_list<br/></li>
<li></span>&nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier"><a href="translclass.ml.html#L563" title="ocaml/lambda/translclass.ml:563">s</a></span><span class="ocamlNone"> </span><span class="Statement">==</span><span class="ocamlNone"> </span><span class="PreProc">Ident</span><span class="ocamlNone">.</span><span class="PreProc">Map</span><span class="ocamlNone">.</span><span class="ocamlLCIdentifier"><a href="matching.ml.html#L533" title="ocaml/lambda/matching.ml:533">empty</a></span><span class="ocamlNone"> </span><span class="Statement">then</span> <span class="ocamlLCIdentifier"><a href="translobj.ml.html#L145" title="ocaml/lambda/translobj.ml:145">lam</a></span> <span class="Statement">else</span> <span class="PreProc">Lambda</span>.<span class="ocamlLCIdentifier"><a href="lambda.mli.html#L427" title="ocaml/lambda/lambda.mli:427">rename</a></span> <span class="ocamlLCIdentifier"><a href="translclass.ml.html#L563" title="ocaml/lambda/translclass.ml:563">s</a></span> <span class="ocamlLCIdentifier"><a href="translobj.ml.html#L145" title="ocaml/lambda/translobj.ml:145">lam</a><br/></li>
<li></span><br/></li>
<li><br/></li>
<li><span class="Comment">(* Compose two coercions<br/></li>
<li></span><span class="Comment">&nbsp;&nbsp; apply_coercion c1 (apply_coercion c2 e) behaves like<br/></li>
<li></span><span class="Comment">&nbsp;&nbsp; apply_coercion (<a href="#L161" title="ocaml/lambda/translmod.ml:161">compose_coercions</a> c1 c2) e. *)<br/></li>
<li></span><br/></li>
<li><a id="L161">&#x200c;</a><span class="Statement">let</span> <span class="Statement">rec</span> <span class="ocamlLCIdentifier"><span class="linkable">compose_coercions</span></span> <span class="ocamlLCIdentifier">c1</span> <span class="ocamlLCIdentifier">c2</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">match</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">c1</span>, <span class="ocamlLCIdentifier">c2</span><span class="Statement">)</span> <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">(</span><span class="Constant">Tcoerce_none</span>, <span class="ocamlLCIdentifier">c2</span><span class="Statement">)</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier">c2<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">c1</span>, <span class="Constant">Tcoerce_none</span><span class="Statement">)</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier">c1<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Statement">(</span><span class="Constant">Tcoerce_structure</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">pc1</span>, <span class="ocamlLCIdentifier">ids1</span><span class="Statement">)</span>, <span class="Constant">Tcoerce_structure</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">pc2</span>, <span class="ocamlLCIdentifier">ids2</span><span class="Statement">))</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">v2</span> <span class="Statement">=</span> <span class="PreProc">Array</span>.<span class="ocamlLCIdentifier">of_list</span> <span class="ocamlLCIdentifier">pc2</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">ids1</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="PreProc">List</span>.<span class="ocamlLCIdentifier"><a href="matching.ml.html#L922" title="ocaml/lambda/matching.ml:922">map</a></span> <span class="Statement">(fun</span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span>,<span class="ocamlLCIdentifier">pos1</span>,<span class="ocamlLCIdentifier">c1</span><span class="Statement">)</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">pos1</span><span class="ocamlNone"> </span><span class="Statement">&lt;</span><span class="ocamlNone"> </span><span class="Constant">0</span><span class="ocamlNone"> </span><span class="Statement">then</span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span>, <span class="ocamlLCIdentifier">pos1</span>, <span class="ocamlLCIdentifier">c1</span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">pos2</span>,<span class="ocamlLCIdentifier">c2</span><span class="Statement">)</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">v2</span>.<span class="Statement">(</span><span class="ocamlLCIdentifier">pos1</span><span class="Statement">)</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span>, <span class="ocamlLCIdentifier">pos2</span>, <span class="ocamlLCIdentifier"><a href="#L161" title="ocaml/lambda/translmod.ml:161">compose_coercions</a></span> <span class="ocamlLCIdentifier">c1</span> <span class="ocamlLCIdentifier">c2</span><span class="Statement">))<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">ids1<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Constant">Tcoerce_structure<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="PreProc">List</span>.<span class="ocamlLCIdentifier"><a href="matching.ml.html#L922" title="ocaml/lambda/matching.ml:922">map</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">(fun</span> <span class="ocamlLCIdentifier">pc</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">match</span> <span class="ocamlLCIdentifier">pc</span> <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Statement">_</span>, <span class="Statement">(</span><span class="Constant">Tcoerce_primitive</span> <span class="Statement">_</span> <span class="Statement">|</span> <span class="Constant">Tcoerce_alias</span> <span class="Statement">_)</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">(* These cases do not take an argument (the position is -1),<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; so they do not need adjusting. *)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">pc<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">p1</span>, <span class="ocamlLCIdentifier">c1</span><span class="Statement">)</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">p2</span>, <span class="ocamlLCIdentifier">c2</span><span class="Statement">)</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">v2</span>.<span class="Statement">(</span><span class="ocamlLCIdentifier">p1</span><span class="Statement">)</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="ocamlLCIdentifier">p2</span>, <span class="ocamlLCIdentifier"><a href="#L161" title="ocaml/lambda/translmod.ml:161">compose_coercions</a></span> <span class="ocamlLCIdentifier">c1</span> <span class="ocamlLCIdentifier">c2</span><span class="Statement">))<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">pc1</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier">ids1</span> @ <span class="ocamlLCIdentifier">ids2</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Statement">(</span><span class="Constant">Tcoerce_functor</span><span class="Statement">(</span><span class="ocamlLCIdentifier">arg1</span>, <span class="ocamlLCIdentifier">res1</span><span class="Statement">)</span>, <span class="Constant">Tcoerce_functor</span><span class="Statement">(</span><span class="ocamlLCIdentifier">arg2</span>, <span class="ocamlLCIdentifier">res2</span><span class="Statement">))</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Constant">Tcoerce_functor</span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L161" title="ocaml/lambda/translmod.ml:161">compose_coercions</a></span> <span class="ocamlLCIdentifier">arg2</span> <span class="ocamlLCIdentifier">arg1</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L161" title="ocaml/lambda/translmod.ml:161">compose_coercions</a></span> <span class="ocamlLCIdentifier">res1</span> <span class="ocamlLCIdentifier">res2</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">c1</span>, <span class="Constant">Tcoerce_alias</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">env</span>, <span class="ocamlLCIdentifier"><a href="translclass.ml.html#L444" title="ocaml/lambda/translclass.ml:444">path</a></span>, <span class="ocamlLCIdentifier">c2</span><span class="Statement">))</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Constant">Tcoerce_alias</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">env</span>, <span class="ocamlLCIdentifier"><a href="translclass.ml.html#L444" title="ocaml/lambda/translclass.ml:444">path</a></span>, <span class="ocamlLCIdentifier"><a href="#L161" title="ocaml/lambda/translmod.ml:161">compose_coercions</a></span> <span class="ocamlLCIdentifier">c1</span> <span class="ocamlLCIdentifier">c2</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Statement">(_</span>, <span class="Statement">_)</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">fatal_error</span> <span class="Constant">&quot;Translmod.<a href="#L161" title="ocaml/lambda/translmod.ml:161">compose_coercions</a>&quot;<br/></li>
<li></span><br/></li>
<li><span class="Comment">(*<br/></li>
<li></span><span class="Comment">let apply_coercion a b c =<br/></li>
<li></span><span class="Comment">&nbsp; Format.<a href="matching.ml.html#L498" title="ocaml/lambda/matching.ml:498">eprintf</a> &quot;@[&lt;2&gt;apply_coercion@ %a@]@.&quot; Includemod.print_coercion b;<br/></li>
<li></span><span class="Comment">&nbsp; apply_coercion a b c<br/></li>
<li></span><br/></li>
<li><span class="Comment">let <a href="#L161" title="ocaml/lambda/translmod.ml:161">compose_coercions</a> c1 c2 =<br/></li>
<li></span><span class="Comment">&nbsp; let c3 = <a href="#L161" title="ocaml/lambda/translmod.ml:161">compose_coercions</a> c1 c2 in<br/></li>
<li></span><span class="Comment">&nbsp; let <a href="matching.ml.html#L419" title="ocaml/lambda/matching.ml:419">open</a> Includemod in<br/></li>
<li></span><span class="Comment">&nbsp; Format.<a href="matching.ml.html#L498" title="ocaml/lambda/matching.ml:498">eprintf</a> &quot;@[&lt;2&gt;<a href="#L161" title="ocaml/lambda/translmod.ml:161">compose_coercions</a>@ (%a)@ (%a) =@ %a@]@.&quot;<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; print_coercion c1 print_coercion c2 print_coercion c3;<br/></li>
<li></span><span class="Comment">&nbsp; c3<br/></li>
<li></span><span class="Comment">*)<br/></li>
<li></span><br/></li>
<li><span class="Comment">(* Record the <a href="matching.ml.html#L2324" title="ocaml/lambda/matching.ml:2324">primitive</a> declarations occurring in the module compiled *)<br/></li>
<li></span><br/></li>
<li><a id="L211">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">primitive_declarations</span></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">ref</span> <span class="Statement">(</span><span class="Constant">[]</span> : <span class="PreProc">Primitive</span>.<span class="ocamlLCIdentifier">description</span> <span class="Type"><a href="tmc.ml.html#L478" title="ocaml/lambda/tmc.ml:478">list</a></span><span class="Statement">)<br/></li>
<li><a id="L212">&#x200c;</a></span><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">record_primitive</span></span> <span class="Statement">=</span> <span class="Statement">function<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Statement">{</span><span class="ocamlLCIdentifier">val_kind</span><span class="Statement">=</span><span class="Constant">Val_prim</span> <span class="ocamlLCIdentifier">p</span><span class="Statement">;</span><span class="ocamlLCIdentifier">val_loc</span><span class="Statement">}</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="PreProc">Translprim</span>.<span class="ocamlLCIdentifier"><a href="translprim.mli.html#L32" title="ocaml/lambda/translprim.mli:32">check_primitive_arity</a></span> <span class="ocamlLCIdentifier">val_loc</span> <span class="ocamlLCIdentifier">p</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="translmod.mli.html#L43" title="ocaml/lambda/translmod.mli:43">primitive_declarations</a></span> <span class="Statement">:=</span> <span class="ocamlLCIdentifier">p</span> <span class="Statement">::</span> <span class="Statement">!</span><span class="ocamlLCIdentifier"><a href="translmod.mli.html#L43" title="ocaml/lambda/translmod.mli:43">primitive_declarations</a><br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Statement">_</span> <span class="Statement">-&gt;</span> <span class="Constant">()<br/></li>
<li></span><br/></li>
<li><span class="Comment">(* Utilities for compiling &quot;module rec&quot; definitions *)<br/></li>
<li></span><br/></li>
<li><a id="L220">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">mod_prim</span></span> <span class="Statement">=</span> <span class="PreProc">Lambda</span>.<span class="ocamlLCIdentifier"><a href="lambda.mli.html#L393" title="ocaml/lambda/lambda.mli:393">transl_prim</a></span> <span class="Constant">&quot;CamlinternalMod&quot;<br/></li>
<li></span><br/></li>
<li><a id="L222">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">undefined_location</span></span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">fname</span>, <span class="ocamlLCIdentifier">line</span>, <span class="Type">char</span><span class="Statement">)</span> <span class="Statement">=</span> <span class="PreProc">Location</span>.<span class="ocamlLCIdentifier">get_pos_info</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span>.<span class="PreProc">Location</span>.<span class="ocamlLCIdentifier">loc_start</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Constant">Lconst</span><span class="Statement">(</span><span class="Constant">Const_block</span><span class="Statement">(</span><span class="Constant">0</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">[</span><span class="Constant">Const_base</span><span class="Statement">(</span><span class="Constant">Const_string</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">fname</span>, <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span>, <span class="Constant">None</span><span class="Statement">));<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="lambda.mli.html#L365" title="ocaml/lambda/lambda.mli:365">const_int</a></span> <span class="ocamlLCIdentifier">line</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="lambda.mli.html#L365" title="ocaml/lambda/lambda.mli:365">const_int</a></span> <span class="Type">char</span><span class="Statement">]))<br/></li>
<li></span><br/></li>
<li><span class="Statement">exception</span> <span class="Constant">Initialization_failure</span> <span class="Statement">of</span> <span class="ocamlLCIdentifier"><a href="translmod.mli.html#L51" title="ocaml/lambda/translmod.mli:51">unsafe_info</a><br/></li>
<li></span><br/></li>
<li><a id="L231">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">init_shape</span></span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span> <span class="ocamlLCIdentifier"><a href="#L706" title="ocaml/lambda/translmod.ml:706">modl</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="Statement">rec</span> <span class="ocamlLCIdentifier">init_shape_mod</span> <span class="ocamlLCIdentifier">subid</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span> <span class="ocamlLCIdentifier">env</span> <span class="ocamlLCIdentifier">mty</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">match</span> <span class="PreProc">Mtype</span>.<span class="ocamlLCIdentifier">scrape</span> <span class="ocamlLCIdentifier">env</span> <span class="ocamlLCIdentifier">mty</span> <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Constant">Mty_ident</span> <span class="Statement">_<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Mty_alias</span> <span class="Statement">_</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">raise</span> <span class="Statement">(</span><span class="Constant">Initialization_failure<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="Constant">Unsafe</span> <span class="Statement">{</span><span class="ocamlLCIdentifier">reason</span><span class="Statement">=</span><span class="Constant">Unsafe_module_binding</span><span class="Statement">;</span><span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span><span class="Statement">;</span><span class="ocamlLCIdentifier">subid</span><span class="Statement">}))<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Mty_signature</span> <span class="ocamlLCIdentifier">sg</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">Const_block</span><span class="Statement">(</span><span class="Constant">0</span>, <span class="Statement">[</span><span class="Constant">Const_block</span><span class="Statement">(</span><span class="Constant">0</span>, <span class="ocamlLCIdentifier">init_shape_struct</span> <span class="ocamlLCIdentifier">env</span> <span class="ocamlLCIdentifier">sg</span><span class="Statement">)])<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Mty_functor</span> <span class="Statement">_</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">(* can we do better? *)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">raise</span> <span class="Statement">(</span><span class="Constant">Initialization_failure<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="Constant">Unsafe</span> <span class="Statement">{</span><span class="ocamlLCIdentifier">reason</span><span class="Statement">=</span><span class="Constant">Unsafe_functor</span><span class="Statement">;</span><span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span><span class="Statement">;</span><span class="ocamlLCIdentifier">subid</span><span class="Statement">}))<br/></li>
<li></span>&nbsp; <span class="Statement">and</span> <span class="ocamlLCIdentifier">init_shape_struct</span> <span class="ocamlLCIdentifier">env</span> <span class="ocamlLCIdentifier">sg</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">match</span> <span class="ocamlLCIdentifier">sg</span> <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Constant">[]</span> <span class="Statement">-&gt;</span> <span class="Constant">[]<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Sig_value</span><span class="Statement">(</span><span class="ocamlLCIdentifier">subid</span>, <span class="Statement">{</span><span class="ocamlLCIdentifier">val_kind</span><span class="Statement">=</span><span class="Constant">Val_reg</span><span class="Statement">;</span> <span class="ocamlLCIdentifier">val_type</span><span class="Statement">=</span><span class="ocamlLCIdentifier">ty</span><span class="Statement">;</span> <span class="ocamlLCIdentifier">val_loc</span><span class="Statement">=</span><span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span><span class="Statement">}</span>,<span class="Statement">_)</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier">rem</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">init_v</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">match</span> <span class="ocamlLCIdentifier">get_desc</span> <span class="Statement">(</span><span class="PreProc">Ctype</span>.<span class="ocamlLCIdentifier">expand_head</span> <span class="ocamlLCIdentifier">env</span> <span class="ocamlLCIdentifier">ty</span><span class="Statement">)</span> <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">Tarrow</span><span class="Statement">(_</span>,<span class="Statement">_</span>,<span class="Statement">_</span>,<span class="Statement">_)</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="lambda.mli.html#L365" title="ocaml/lambda/lambda.mli:365">const_int</a></span> <span class="Constant">0</span> <span class="Comment">(* camlinternalMod.Function *)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tconstr</span><span class="Statement">(</span><span class="ocamlLCIdentifier">p</span>, <span class="Statement">_</span>, <span class="Statement">_)</span> <span class="Statement">when</span> <span class="PreProc">Path</span>.<span class="ocamlLCIdentifier">same</span> <span class="ocamlLCIdentifier">p</span> <span class="PreProc">Predef</span>.<span class="ocamlLCIdentifier">path_lazy_t</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="lambda.mli.html#L365" title="ocaml/lambda/lambda.mli:365">const_int</a></span> <span class="Constant">1</span> <span class="Comment">(* camlinternalMod.Lazy *)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Statement">_</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">not_a_function</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">Unsafe</span> <span class="Statement">{</span><span class="ocamlLCIdentifier">reason</span><span class="Statement">=</span><span class="Constant">Unsafe_non_function</span><span class="Statement">;</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span><span class="Statement">;</span> <span class="ocamlLCIdentifier">subid</span> <span class="Statement">}<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">raise</span> <span class="Statement">(</span><span class="Constant">Initialization_failure</span> <span class="ocamlLCIdentifier">not_a_function</span><span class="Statement">)</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">init_v</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier">init_shape_struct</span> <span class="ocamlLCIdentifier">env</span> <span class="ocamlLCIdentifier">rem<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Sig_value</span><span class="Statement">(_</span>, <span class="Statement">{</span><span class="ocamlLCIdentifier">val_kind</span><span class="Statement">=</span><span class="Constant">Val_prim</span> <span class="Statement">_}</span>, <span class="Statement">_)</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier">rem</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">init_shape_struct</span> <span class="ocamlLCIdentifier">env</span> <span class="ocamlLCIdentifier">rem<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Sig_value</span> <span class="Statement">_</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier">_rem</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">assert</span> <span class="Constant">false<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Sig_type</span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span>, <span class="ocamlLCIdentifier">tdecl</span>, <span class="Statement">_</span>, <span class="Statement">_)</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier">rem</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">init_shape_struct</span> <span class="Statement">(</span><span class="PreProc">Env</span>.<span class="ocamlLCIdentifier">add_type</span> <span class="Statement">~</span><span class="Identifier">check</span>:<span class="Constant">false</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span> <span class="ocamlLCIdentifier">tdecl</span> <span class="ocamlLCIdentifier">env</span><span class="Statement">)</span> <span class="ocamlLCIdentifier">rem<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Sig_typext</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">subid</span>, <span class="Statement">{</span><span class="ocamlLCIdentifier">ext_loc</span><span class="Statement">=</span><span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span><span class="Statement">}</span>,<span class="Statement">_</span>,<span class="Statement">_)</span> <span class="Statement">::</span> <span class="Statement">_</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">raise</span> <span class="Statement">(</span><span class="Constant">Initialization_failure</span> <span class="Statement">(</span><span class="Constant">Unsafe</span> <span class="Statement">{</span><span class="ocamlLCIdentifier">reason</span><span class="Statement">=</span><span class="Constant">Unsafe_typext</span><span class="Statement">;</span><span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span><span class="Statement">;</span><span class="ocamlLCIdentifier">subid</span><span class="Statement">}))<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Sig_module</span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span>, <span class="Constant">Mp_present</span>, <span class="ocamlLCIdentifier">md</span>, <span class="Statement">_</span>, <span class="Statement">_)</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier">rem</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">init_shape_mod</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span> <span class="ocamlLCIdentifier">md</span>.<span class="ocamlLCIdentifier">md_loc</span> <span class="ocamlLCIdentifier">env</span> <span class="ocamlLCIdentifier">md</span>.<span class="ocamlLCIdentifier">md_type</span> <span class="Statement">::<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">init_shape_struct</span> <span class="Statement">(</span><span class="PreProc">Env</span>.<span class="ocamlLCIdentifier">add_module_declaration</span> <span class="Statement">~</span><span class="Identifier">check</span>:<span class="Constant">false<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span> <span class="Constant">Mp_present</span> <span class="ocamlLCIdentifier">md</span> <span class="ocamlLCIdentifier">env</span><span class="Statement">)</span> <span class="ocamlLCIdentifier">rem<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Sig_module</span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span>, <span class="Constant">Mp_absent</span>, <span class="ocamlLCIdentifier">md</span>, <span class="Statement">_</span>, <span class="Statement">_)</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier">rem</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">init_shape_struct<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="PreProc">Env</span>.<span class="ocamlLCIdentifier">add_module_declaration</span> <span class="Statement">~</span><span class="Identifier">check</span>:<span class="Constant">false<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span> <span class="Constant">Mp_absent</span> <span class="ocamlLCIdentifier">md</span> <span class="ocamlLCIdentifier">env</span><span class="Statement">)</span> <span class="ocamlLCIdentifier">rem<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Sig_modtype</span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span>, <span class="ocamlLCIdentifier">minfo</span>, <span class="Statement">_)</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier">rem</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">init_shape_struct</span> <span class="Statement">(</span><span class="PreProc">Env</span>.<span class="ocamlLCIdentifier">add_modtype</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span> <span class="ocamlLCIdentifier">minfo</span> <span class="ocamlLCIdentifier">env</span><span class="Statement">)</span> <span class="ocamlLCIdentifier">rem<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Sig_class</span> <span class="Statement">_</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier">rem</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="lambda.mli.html#L365" title="ocaml/lambda/lambda.mli:365">const_int</a></span> <span class="Constant">2</span> <span class="Comment">(* camlinternalMod.Class *)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">::</span> <span class="ocamlLCIdentifier">init_shape_struct</span> <span class="ocamlLCIdentifier">env</span> <span class="ocamlLCIdentifier">rem<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Sig_class_type</span> <span class="Statement">_</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier">rem</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">init_shape_struct</span> <span class="ocamlLCIdentifier">env</span> <span class="ocamlLCIdentifier">rem<br/></li>
<li></span>&nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">try<br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">Ok</span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L222" title="ocaml/lambda/translmod.ml:222">undefined_location</a></span> <span class="ocamlLCIdentifier"><a href="#L706" title="ocaml/lambda/translmod.ml:706">modl</a></span>.<span class="ocamlLCIdentifier">mod_loc</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">Lconst</span><span class="Statement">(</span><span class="ocamlLCIdentifier">init_shape_mod</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span> <span class="ocamlLCIdentifier"><a href="#L706" title="ocaml/lambda/translmod.ml:706">modl</a></span>.<span class="ocamlLCIdentifier">mod_loc</span> <span class="ocamlLCIdentifier"><a href="#L706" title="ocaml/lambda/translmod.ml:706">modl</a></span>.<span class="ocamlLCIdentifier">mod_env</span> <span class="ocamlLCIdentifier"><a href="#L706" title="ocaml/lambda/translmod.ml:706">modl</a></span>.<span class="ocamlLCIdentifier">mod_type</span><span class="Statement">))<br/></li>
<li></span>&nbsp; <span class="Statement">with</span> <span class="Constant">Initialization_failure</span> <span class="ocamlLCIdentifier">reason</span> <span class="Statement">-&gt;</span> <span class="PreProc">Result</span>.<span class="Constant">Error</span><span class="Statement">(</span><span class="ocamlLCIdentifier">reason</span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li><span class="Comment">(* Reorder bindings to honor dependencies.&nbsp; *)<br/></li>
<li></span><br/></li>
<li><a id="L291">&#x200c;</a><span class="Statement">type</span> <span class="ocamlLCIdentifier"><span class="linkable">binding_status</span></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Undefined<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Inprogress</span> <span class="Statement">of</span> <span class="Type"><a href="translobj.ml.html#L84" title="ocaml/lambda/translobj.ml:84">int</a></span> <span class="Type"><a href="tmc.ml.html#L473" title="ocaml/lambda/tmc.ml:473">option</a></span> <span class="Comment">(** parent node *)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Defined<br/></li>
<li></span><br/></li>
<li><a id="L296">&#x200c;</a><span class="Statement">type</span> <span class="ocamlLCIdentifier"><span class="linkable">id_or_ignore_loc</span></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Id</span> <span class="Statement">of</span> <span class="PreProc">Ident</span>.<span class="ocamlLCIdentifier"><a href="debuginfo.ml.html#L79" title="ocaml/lambda/debuginfo.ml:79">t</a><br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Ignore_loc</span> <span class="Statement">of</span> <span class="PreProc">Lambda</span>.<span class="ocamlLCIdentifier"><a href="lambda.mli.html#L277" title="ocaml/lambda/lambda.mli:277">scoped_location</a><br/></li>
<li></span><br/></li>
<li><a id="L300">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">extract_unsafe_cycle</span></span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span> <span class="ocamlLCIdentifier">status</span> <span class="ocamlLCIdentifier">init</span> <span class="ocamlLCIdentifier">cycle_start</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">info</span> <span class="ocamlLCIdentifier"><a href="translclass.ml.html#L713" title="ocaml/lambda/translclass.ml:713">i</a></span> <span class="Statement">=</span> <span class="Statement">match</span> <span class="ocamlLCIdentifier">init</span>.<span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="translclass.ml.html#L713" title="ocaml/lambda/translclass.ml:713">i</a></span><span class="Statement">)</span> <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="PreProc">Result</span>.<span class="Constant">Error</span> <span class="ocamlLCIdentifier"><a href="matching.ml.html#L2555" title="ocaml/lambda/matching.ml:2555">r</a></span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">begin</span><span class="ocamlEnd"> </span><span class="Statement">match</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span><span class="ocamlEnd">.</span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="translclass.ml.html#L713" title="ocaml/lambda/translclass.ml:713">i</a></span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="Statement">with<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Constant">Id</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span><span class="ocamlEnd"> </span><span class="Statement">-&gt;</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span><span class="ocamlEnd">, </span><span class="ocamlLCIdentifier"><a href="matching.ml.html#L2555" title="ocaml/lambda/matching.ml:2555">r</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Constant">Ignore_loc</span><span class="ocamlEnd"> </span><span class="Statement">_</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">assert</span><span class="ocamlEnd"> </span><span class="Constant">false</span><span class="ocamlEnd"> </span><span class="Comment">(* Can'<a href="debuginfo.ml.html#L79" title="ocaml/lambda/debuginfo.ml:79">t</a> refer to something without a <a href="translcore.ml.html#L56" title="ocaml/lambda/translcore.ml:56">name</a>. *)<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">end<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Ok</span> <span class="Statement">_</span> <span class="Statement">-&gt;</span> <span class="Statement">assert</span> <span class="Constant">false</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="Statement">rec</span> <span class="ocamlLCIdentifier">collect</span> <span class="ocamlLCIdentifier">stop</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L708" title="ocaml/lambda/translcore.ml:708">l</a></span> <span class="ocamlLCIdentifier"><a href="translclass.ml.html#L713" title="ocaml/lambda/translclass.ml:713">i</a></span> <span class="Statement">=</span> <span class="Statement">match</span> <span class="ocamlLCIdentifier">status</span>.<span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="translclass.ml.html#L713" title="ocaml/lambda/translclass.ml:713">i</a></span><span class="Statement">)</span> <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Inprogress</span> <span class="Constant">None</span> <span class="Statement">|</span> <span class="Constant">Undefined</span> <span class="Statement">|</span> <span class="Constant">Defined</span> <span class="Statement">-&gt;</span> <span class="Statement">assert</span> <span class="Constant">false<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Inprogress</span> <span class="Constant">Some</span> <span class="ocamlLCIdentifier"><a href="translclass.ml.html#L713" title="ocaml/lambda/translclass.ml:713">i</a></span> <span class="Statement">when</span> <span class="ocamlLCIdentifier"><a href="translclass.ml.html#L713" title="ocaml/lambda/translclass.ml:713">i</a></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">stop</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier">info</span> <span class="ocamlLCIdentifier"><a href="translclass.ml.html#L713" title="ocaml/lambda/translclass.ml:713">i</a></span> <span class="Statement">::</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L708" title="ocaml/lambda/translcore.ml:708">l</a><br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Inprogress</span> <span class="Constant">Some</span> <span class="ocamlLCIdentifier"><a href="translclass.ml.html#L713" title="ocaml/lambda/translclass.ml:713">i</a></span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier">collect</span> <span class="ocamlLCIdentifier">stop</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">info</span> <span class="ocamlLCIdentifier"><a href="translclass.ml.html#L713" title="ocaml/lambda/translclass.ml:713">i</a></span><span class="Statement">::</span><span class="ocamlLCIdentifier"><a href="translcore.ml.html#L708" title="ocaml/lambda/translcore.ml:708">l</a></span><span class="Statement">)</span> <span class="ocamlLCIdentifier"><a href="translclass.ml.html#L713" title="ocaml/lambda/translclass.ml:713">i</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier">collect</span> <span class="ocamlLCIdentifier">cycle_start</span> <span class="Constant">[]</span> <span class="ocamlLCIdentifier">cycle_start<br/></li>
<li></span><br/></li>
<li><a id="L315">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">reorder_rec_bindings</span></span> <span class="ocamlLCIdentifier">bindings</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span> <span class="Statement">=</span> <span class="PreProc">Array</span>.<span class="ocamlLCIdentifier">of_list</span> <span class="Statement">(</span><span class="PreProc">List</span>.<span class="ocamlLCIdentifier"><a href="matching.ml.html#L922" title="ocaml/lambda/matching.ml:922">map</a></span> <span class="Statement">(fun</span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span>,<span class="Statement">_</span>,<span class="Statement">_</span>,<span class="Statement">_)</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span><span class="Statement">)</span> <span class="ocamlLCIdentifier">bindings</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">and</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span> <span class="Statement">=</span> <span class="PreProc">Array</span>.<span class="ocamlLCIdentifier">of_list</span> <span class="Statement">(</span><span class="PreProc">List</span>.<span class="ocamlLCIdentifier"><a href="matching.ml.html#L922" title="ocaml/lambda/matching.ml:922">map</a></span> <span class="Statement">(fun</span> <span class="Statement">(_</span>,<span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span>,<span class="Statement">_</span>,<span class="Statement">_)</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span><span class="Statement">)</span> <span class="ocamlLCIdentifier">bindings</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">and</span> <span class="ocamlLCIdentifier">init</span> <span class="Statement">=</span> <span class="PreProc">Array</span>.<span class="ocamlLCIdentifier">of_list</span> <span class="Statement">(</span><span class="PreProc">List</span>.<span class="ocamlLCIdentifier"><a href="matching.ml.html#L922" title="ocaml/lambda/matching.ml:922">map</a></span> <span class="Statement">(fun</span> <span class="Statement">(_</span>,<span class="Statement">_</span>,<span class="ocamlLCIdentifier">init</span>,<span class="Statement">_)</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier">init</span><span class="Statement">)</span> <span class="ocamlLCIdentifier">bindings</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">and</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L1059" title="ocaml/lambda/translcore.ml:1059">rhs</a></span> <span class="Statement">=</span> <span class="PreProc">Array</span>.<span class="ocamlLCIdentifier">of_list</span> <span class="Statement">(</span><span class="PreProc">List</span>.<span class="ocamlLCIdentifier"><a href="matching.ml.html#L922" title="ocaml/lambda/matching.ml:922">map</a></span> <span class="Statement">(fun</span> <span class="Statement">(_</span>,<span class="Statement">_</span>,<span class="Statement">_</span>,<span class="ocamlLCIdentifier"><a href="translcore.ml.html#L1059" title="ocaml/lambda/translcore.ml:1059">rhs</a></span><span class="Statement">)</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L1059" title="ocaml/lambda/translcore.ml:1059">rhs</a></span><span class="Statement">)</span> <span class="ocamlLCIdentifier">bindings</span><span class="Statement">)</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="translclass.ml.html#L710" title="ocaml/lambda/translclass.ml:710">fv</a></span> <span class="Statement">=</span> <span class="PreProc">Array</span>.<span class="ocamlLCIdentifier"><a href="matching.ml.html#L922" title="ocaml/lambda/matching.ml:922">map</a></span> <span class="PreProc">Lambda</span>.<span class="ocamlLCIdentifier"><a href="lambda.mli.html#L401" title="ocaml/lambda/lambda.mli:401">free_variables</a></span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L1059" title="ocaml/lambda/translcore.ml:1059">rhs</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">num_bindings</span> <span class="Statement">=</span> <span class="PreProc">Array</span>.<span class="ocamlLCIdentifier">length</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">status</span> <span class="Statement">=</span> <span class="PreProc">Array</span>.<span class="ocamlLCIdentifier"><a href="tmc.ml.html#L190" title="ocaml/lambda/tmc.ml:190">make</a></span> <span class="ocamlLCIdentifier">num_bindings</span> <span class="Constant">Undefined</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">res</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">ref</span> <span class="Constant">[]</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">is_unsafe</span> <span class="ocamlLCIdentifier"><a href="translclass.ml.html#L713" title="ocaml/lambda/translclass.ml:713">i</a></span> <span class="Statement">=</span> <span class="Statement">match</span> <span class="ocamlLCIdentifier">init</span>.<span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="translclass.ml.html#L713" title="ocaml/lambda/translclass.ml:713">i</a></span><span class="Statement">)</span> <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Ok</span> <span class="Statement">_</span> <span class="Statement">-&gt;</span> <span class="Constant">false<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="PreProc">Result</span>.<span class="Constant">Error</span> <span class="Statement">_</span> <span class="Statement">-&gt;</span> <span class="Constant">true</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">init_res</span> <span class="ocamlLCIdentifier"><a href="translclass.ml.html#L713" title="ocaml/lambda/translclass.ml:713">i</a></span> <span class="Statement">=</span> <span class="Statement">match</span> <span class="ocamlLCIdentifier">init</span>.<span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="translclass.ml.html#L713" title="ocaml/lambda/translclass.ml:713">i</a></span><span class="Statement">)</span> <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="PreProc">Result</span>.<span class="Constant">Error</span> <span class="Statement">_</span> <span class="Statement">-&gt;</span> <span class="Constant">None<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Ok</span><span class="Statement">(</span><span class="ocamlLCIdentifier">a</span>,<span class="ocamlLCIdentifier">b</span><span class="Statement">)</span> <span class="Statement">-&gt;</span> <span class="Constant">Some</span><span class="Statement">(</span><span class="ocamlLCIdentifier">a</span>,<span class="ocamlLCIdentifier">b</span><span class="Statement">)</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="Statement">rec</span> <span class="ocamlLCIdentifier">emit_binding</span> <span class="ocamlLCIdentifier">parent</span> <span class="ocamlLCIdentifier"><a href="translclass.ml.html#L713" title="ocaml/lambda/translclass.ml:713">i</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">match</span> <span class="ocamlLCIdentifier">status</span>.<span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="translclass.ml.html#L713" title="ocaml/lambda/translclass.ml:713">i</a></span><span class="Statement">)</span> <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Constant">Defined</span> <span class="Statement">-&gt;</span> <span class="Constant">()<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Inprogress</span> <span class="Statement">_</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">status</span>.<span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="translclass.ml.html#L713" title="ocaml/lambda/translclass.ml:713">i</a></span><span class="Statement">)</span> <span class="Statement">&lt;-</span> <span class="Constant">Inprogress</span> <span class="ocamlLCIdentifier">parent</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">cycle</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="#L300" title="ocaml/lambda/translmod.ml:300">extract_unsafe_cycle</a></span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span> <span class="ocamlLCIdentifier">status</span> <span class="ocamlLCIdentifier">init</span> <span class="ocamlLCIdentifier"><a href="translclass.ml.html#L713" title="ocaml/lambda/translclass.ml:713">i</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">raise(</span><span class="Constant">Error</span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span>.<span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="translclass.ml.html#L713" title="ocaml/lambda/translclass.ml:713">i</a></span><span class="Statement">)</span>, <span class="Constant">Circular_dependency</span> <span class="ocamlLCIdentifier">cycle</span><span class="Statement">))<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Undefined</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">is_unsafe</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier"><a href="translclass.ml.html#L713" title="ocaml/lambda/translclass.ml:713">i</a></span><span class="ocamlNone"> </span><span class="Statement">then</span> <span class="Statement">begin<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier">status</span><span class="ocamlEnd">.</span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="translclass.ml.html#L713" title="ocaml/lambda/translclass.ml:713">i</a></span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="Statement">&lt;-</span><span class="ocamlEnd"> </span><span class="Constant">Inprogress</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">parent</span><span class="Statement">;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">for</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">j</span><span class="ocamlNone"> </span><span class="Statement">=</span><span class="ocamlNone"> </span><span class="Constant">0</span><span class="ocamlNone"> </span><span class="Statement">to</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">num_bindings</span><span class="ocamlEnd"> - </span><span class="Constant">1</span><span class="ocamlEnd"> </span><span class="Statement">do<br/></li>
<li></span><span class="ocamlDo">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">match</span><span class="ocamlDo"> </span><span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span><span class="ocamlDo">.</span><span class="Statement">(</span><span class="ocamlLCIdentifier">j</span><span class="Statement">)</span><span class="ocamlDo"> </span><span class="Statement">with<br/></li>
<li></span><span class="ocamlDo">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlDo"> </span><span class="Constant">Id</span><span class="ocamlDo"> </span><span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span><span class="ocamlDo"> </span><span class="Statement">when</span><span class="ocamlDo"> </span><span class="PreProc">Ident</span><span class="ocamlDo">.</span><span class="PreProc">Set</span><span class="ocamlDo">.</span><span class="ocamlLCIdentifier">mem</span><span class="ocamlDo"> </span><span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span><span class="ocamlDo"> </span><span class="ocamlLCIdentifier"><a href="translclass.ml.html#L710" title="ocaml/lambda/translclass.ml:710">fv</a></span><span class="ocamlDo">.</span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="translclass.ml.html#L713" title="ocaml/lambda/translclass.ml:713">i</a></span><span class="Statement">)</span><span class="ocamlDo"> </span><span class="Statement">-&gt;</span><span class="ocamlDo"> </span><span class="ocamlLCIdentifier">emit_binding</span><span class="ocamlDo"> </span><span class="Statement">(</span><span class="Constant">Some</span><span class="ocamlDo"> </span><span class="ocamlLCIdentifier"><a href="translclass.ml.html#L713" title="ocaml/lambda/translclass.ml:713">i</a></span><span class="Statement">)</span><span class="ocamlDo"> </span><span class="ocamlLCIdentifier">j<br/></li>
<li></span><span class="ocamlDo">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlDo"> </span><span class="Statement">_</span><span class="ocamlDo"> </span><span class="Statement">-&gt;</span><span class="ocamlDo"> </span><span class="Constant">()<br/></li>
<li></span><span class="ocamlDo">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">done<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">end;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">res</span> <span class="Statement">:=</span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span>.<span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="translclass.ml.html#L713" title="ocaml/lambda/translclass.ml:713">i</a></span><span class="Statement">)</span>, <span class="ocamlLCIdentifier">init_res</span> <span class="ocamlLCIdentifier"><a href="translclass.ml.html#L713" title="ocaml/lambda/translclass.ml:713">i</a></span>, <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L1059" title="ocaml/lambda/translcore.ml:1059">rhs</a></span>.<span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="translclass.ml.html#L713" title="ocaml/lambda/translclass.ml:713">i</a></span><span class="Statement">))</span> <span class="Statement">::</span> <span class="Statement">!</span><span class="ocamlLCIdentifier">res</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">status</span>.<span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="translclass.ml.html#L713" title="ocaml/lambda/translclass.ml:713">i</a></span><span class="Statement">)</span> <span class="Statement">&lt;-</span> <span class="Constant">Defined</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">for</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier"><a href="translclass.ml.html#L713" title="ocaml/lambda/translclass.ml:713">i</a></span><span class="ocamlNone"> </span><span class="Statement">=</span><span class="ocamlNone"> </span><span class="Constant">0</span><span class="ocamlNone"> </span><span class="Statement">to</span> <span class="ocamlLCIdentifier">num_bindings</span> - <span class="Constant">1</span> <span class="Statement">do<br/></li>
<li></span><span class="ocamlDo">&nbsp; &nbsp; </span><span class="Statement">match</span><span class="ocamlDo"> </span><span class="ocamlLCIdentifier">status</span><span class="ocamlDo">.</span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="translclass.ml.html#L713" title="ocaml/lambda/translclass.ml:713">i</a></span><span class="Statement">)</span><span class="ocamlDo"> </span><span class="Statement">with<br/></li>
<li></span><span class="ocamlDo">&nbsp; &nbsp; &nbsp; </span><span class="Constant">Undefined</span><span class="ocamlDo"> </span><span class="Statement">-&gt;</span><span class="ocamlDo"> </span><span class="ocamlLCIdentifier">emit_binding</span><span class="ocamlDo"> </span><span class="Constant">None</span><span class="ocamlDo"> </span><span class="ocamlLCIdentifier"><a href="translclass.ml.html#L713" title="ocaml/lambda/translclass.ml:713">i</a><br/></li>
<li></span><span class="ocamlDo">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlDo"> </span><span class="Constant">Inprogress</span><span class="ocamlDo"> </span><span class="Statement">_</span><span class="ocamlDo"> </span><span class="Statement">-&gt;</span><span class="ocamlDo"> </span><span class="Statement">assert</span><span class="ocamlDo"> </span><span class="Constant">false<br/></li>
<li></span><span class="ocamlDo">&nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlDo"> </span><span class="Constant">Defined</span><span class="ocamlDo"> </span><span class="Statement">-&gt;</span><span class="ocamlDo"> </span><span class="Constant">()<br/></li>
<li></span><span class="ocamlDo">&nbsp; </span><span class="Statement">done;<br/></li>
<li></span>&nbsp; <span class="PreProc">List</span>.<span class="ocamlLCIdentifier">rev</span> <span class="Statement">!</span><span class="ocamlLCIdentifier">res<br/></li>
<li></span><br/></li>
<li><span class="Comment">(* Generate <a href="printlambda.ml.html#L705" title="ocaml/lambda/printlambda.ml:705">lambda</a>-code for a reordered <a href="tmc.ml.html#L478" title="ocaml/lambda/tmc.ml:478">list</a> of bindings *)<br/></li>
<li></span><br/></li>
<li><a id="L358">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">eval_rec_bindings</span></span> <span class="ocamlLCIdentifier">bindings</span> <span class="ocamlLCIdentifier">cont</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="Statement">rec</span> <span class="ocamlLCIdentifier">bind_inits</span> <span class="Statement">=</span> <span class="Statement">function<br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">[]</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">bind_strict</span> <span class="ocamlLCIdentifier">bindings<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Statement">(</span><span class="Constant">Ignore_loc</span> <span class="Statement">_</span>, <span class="Statement">_</span>, <span class="Statement">_)</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier">rem<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Statement">(_</span>, <span class="Constant">None</span>, <span class="Statement">_)</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier">rem</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">bind_inits</span> <span class="ocamlLCIdentifier">rem<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Statement">(</span><span class="Constant">Id</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span>, <span class="Constant">Some</span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span>, <span class="ocamlLCIdentifier"><a href="translprim.ml.html#L486" title="ocaml/lambda/translprim.ml:486">shape</a></span><span class="Statement">)</span>, <span class="ocamlLCIdentifier">_rhs</span><span class="Statement">)</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier">rem</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Constant">Llet</span><span class="Statement">(</span><span class="Constant">Strict</span>, <span class="Constant">Pgenval</span>, <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">Lapply</span><span class="Statement">{<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier">ap_loc</span><span class="Statement">=</span><span class="Constant">Loc_unknown</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier">ap_func</span><span class="Statement">=</span><span class="ocamlLCIdentifier"><a href="#L220" title="ocaml/lambda/translmod.ml:220">mod_prim</a></span> <span class="Constant">&quot;init_mod&quot;</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier">ap_args</span><span class="Statement">=[</span><span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span><span class="Statement">;</span> <span class="ocamlLCIdentifier"><a href="translprim.ml.html#L486" title="ocaml/lambda/translprim.ml:486">shape</a></span><span class="Statement">];<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier">ap_tailcall</span><span class="Statement">=</span><span class="Constant">Default_tailcall</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier">ap_inlined</span><span class="Statement">=</span><span class="Constant">Default_inline</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier">ap_specialised</span><span class="Statement">=</span><span class="Constant">Default_specialise</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">}</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier">bind_inits</span> <span class="ocamlLCIdentifier">rem</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">and</span> <span class="ocamlLCIdentifier">bind_strict</span> <span class="Statement">=</span> <span class="Statement">function<br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">[]</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">patch_forwards</span> <span class="ocamlLCIdentifier">bindings<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Statement">(</span><span class="Constant">Ignore_loc</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span>, <span class="Constant">None</span>, <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L1059" title="ocaml/lambda/translcore.ml:1059">rhs</a></span><span class="Statement">)</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier">rem</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Constant">Lsequence</span><span class="Statement">(</span><span class="Constant">Lprim</span><span class="Statement">(</span><span class="Constant">Pignore</span>, <span class="Statement">[</span><span class="ocamlLCIdentifier"><a href="translcore.ml.html#L1059" title="ocaml/lambda/translcore.ml:1059">rhs</a></span><span class="Statement">]</span>, <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span><span class="Statement">)</span>, <span class="ocamlLCIdentifier">bind_strict</span> <span class="ocamlLCIdentifier">rem</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Statement">(</span><span class="Constant">Id</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span>, <span class="Constant">None</span>, <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L1059" title="ocaml/lambda/translcore.ml:1059">rhs</a></span><span class="Statement">)</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier">rem</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Constant">Llet</span><span class="Statement">(</span><span class="Constant">Strict</span>, <span class="Constant">Pgenval</span>, <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span>, <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L1059" title="ocaml/lambda/translcore.ml:1059">rhs</a></span>, <span class="ocamlLCIdentifier">bind_strict</span> <span class="ocamlLCIdentifier">rem</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">_id</span>, <span class="Constant">Some</span> <span class="Statement">_</span>, <span class="ocamlLCIdentifier">_rhs</span><span class="Statement">)</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier">rem</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">bind_strict</span> <span class="ocamlLCIdentifier">rem<br/></li>
<li></span>&nbsp; <span class="Statement">and</span> <span class="ocamlLCIdentifier">patch_forwards</span> <span class="Statement">=</span> <span class="Statement">function<br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">[]</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">cont<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Statement">(</span><span class="Constant">Ignore_loc</span> <span class="Statement">_</span>, <span class="Statement">_</span>, <span class="ocamlLCIdentifier">_rhs</span><span class="Statement">)</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier">rem<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Statement">(_</span>, <span class="Constant">None</span>, <span class="ocamlLCIdentifier">_rhs</span><span class="Statement">)</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier">rem</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">patch_forwards</span> <span class="ocamlLCIdentifier">rem<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Statement">(</span><span class="Constant">Id</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span>, <span class="Constant">Some</span><span class="Statement">(</span><span class="ocamlLCIdentifier">_loc</span>, <span class="ocamlLCIdentifier"><a href="translprim.ml.html#L486" title="ocaml/lambda/translprim.ml:486">shape</a></span><span class="Statement">)</span>, <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L1059" title="ocaml/lambda/translcore.ml:1059">rhs</a></span><span class="Statement">)</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier">rem</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Constant">Lsequence</span><span class="Statement">(<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">Lapply</span> <span class="Statement">{<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">ap_loc</span><span class="Statement">=</span><span class="Constant">Loc_unknown</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">ap_func</span><span class="Statement">=</span><span class="ocamlLCIdentifier"><a href="#L220" title="ocaml/lambda/translmod.ml:220">mod_prim</a></span> <span class="Constant">&quot;update_mod&quot;</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">ap_args</span><span class="Statement">=[</span><span class="ocamlLCIdentifier"><a href="translprim.ml.html#L486" title="ocaml/lambda/translprim.ml:486">shape</a></span><span class="Statement">;</span> <span class="Constant">Lvar</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span><span class="Statement">;</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L1059" title="ocaml/lambda/translcore.ml:1059">rhs</a></span><span class="Statement">];<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">ap_tailcall</span><span class="Statement">=</span><span class="Constant">Default_tailcall</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">ap_inlined</span><span class="Statement">=</span><span class="Constant">Default_inline</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">ap_specialised</span><span class="Statement">=</span><span class="Constant">Default_specialise</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">}</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">patch_forwards</span> <span class="ocamlLCIdentifier">rem</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier">bind_inits</span> <span class="ocamlLCIdentifier">bindings<br/></li>
<li></span><br/></li>
<li><a id="L405">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">compile_recmodule</span></span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier">compile_rhs</span> <span class="ocamlLCIdentifier">bindings</span> <span class="ocamlLCIdentifier">cont</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier"><a href="#L358" title="ocaml/lambda/translmod.ml:358">eval_rec_bindings</a><br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L315" title="ocaml/lambda/translmod.ml:315">reorder_rec_bindings</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">(</span><span class="PreProc">List</span>.<span class="ocamlLCIdentifier"><a href="matching.ml.html#L922" title="ocaml/lambda/matching.ml:922">map</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">(fun</span> <span class="Statement">{</span><span class="ocamlLCIdentifier">mb_id</span><span class="Statement">=</span><span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span><span class="Statement">;</span> <span class="ocamlLCIdentifier">mb_name</span><span class="Statement">;</span> <span class="ocamlLCIdentifier">mb_expr</span><span class="Statement">=</span><span class="ocamlLCIdentifier"><a href="#L706" title="ocaml/lambda/translmod.ml:706">modl</a></span><span class="Statement">;</span> <span class="Statement">_}</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="#L296" title="ocaml/lambda/translmod.ml:296">id_or_ignore_loc</a></span>, <span class="ocamlLCIdentifier"><a href="translprim.ml.html#L486" title="ocaml/lambda/translprim.ml:486">shape</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">match</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span> <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">|</span> <span class="Constant">None</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="debuginfo.ml.html#L85" title="ocaml/lambda/debuginfo.ml:85">of_location</a></span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier">mb_name</span>.<span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">Ignore_loc</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span>, <span class="PreProc">Result</span>.<span class="Constant">Error</span> <span class="Constant">Unnamed<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">|</span> <span class="Constant">Some</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span> <span class="Statement">-&gt;</span> <span class="Constant">Id</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span>, <span class="ocamlLCIdentifier"><a href="#L231" title="ocaml/lambda/translmod.ml:231">init_shape</a></span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span> <span class="ocamlLCIdentifier"><a href="#L706" title="ocaml/lambda/translmod.ml:706">modl</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L296" title="ocaml/lambda/translmod.ml:296">id_or_ignore_loc</a></span>, <span class="ocamlLCIdentifier"><a href="#L706" title="ocaml/lambda/translmod.ml:706">modl</a></span>.<span class="ocamlLCIdentifier">mod_loc</span>, <span class="ocamlLCIdentifier"><a href="translprim.ml.html#L486" title="ocaml/lambda/translprim.ml:486">shape</a></span>, <span class="ocamlLCIdentifier">compile_rhs</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span> <span class="ocamlLCIdentifier"><a href="#L706" title="ocaml/lambda/translmod.ml:706">modl</a></span><span class="Statement">))<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">bindings</span><span class="Statement">))<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier">cont<br/></li>
<li></span><br/></li>
<li><span class="Comment">(* Code to translate class entries in a structure *)<br/></li>
<li></span><br/></li>
<li><span class="Statement">let</span> <span class="ocamlLCIdentifier">transl_class_bindings</span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier">cl_list</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L1050" title="ocaml/lambda/translcore.ml:1050">ids</a></span> <span class="Statement">=</span> <span class="PreProc">List</span>.<span class="ocamlLCIdentifier"><a href="matching.ml.html#L922" title="ocaml/lambda/matching.ml:922">map</a></span> <span class="Statement">(fun</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">ci</span>, <span class="Statement">_)</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier">ci</span>.<span class="ocamlLCIdentifier">ci_id_class</span><span class="Statement">)</span> <span class="ocamlLCIdentifier">cl_list</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="translcore.ml.html#L1050" title="ocaml/lambda/translcore.ml:1050">ids</a></span>,<br/></li>
<li>&nbsp;&nbsp; <span class="PreProc">List</span>.<span class="ocamlLCIdentifier"><a href="matching.ml.html#L922" title="ocaml/lambda/matching.ml:922">map</a><br/></li>
<li></span>&nbsp; &nbsp;&nbsp; <span class="Statement">(fun</span> <span class="Statement">({</span><span class="ocamlLCIdentifier">ci_id_class</span><span class="Statement">=</span><span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span><span class="Statement">;</span> <span class="ocamlLCIdentifier">ci_expr</span><span class="Statement">=</span><span class="ocamlLCIdentifier"><a href="translclass.ml.html#L366" title="ocaml/lambda/translclass.ml:366">cl</a></span><span class="Statement">;</span> <span class="ocamlLCIdentifier">ci_virt</span><span class="Statement">=</span><span class="ocamlLCIdentifier">vf</span><span class="Statement">}</span>, <span class="ocamlLCIdentifier">meths</span><span class="Statement">)</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span>, <span class="ocamlLCIdentifier"><a href="translclass.ml.html#L683" title="ocaml/lambda/translclass.ml:683">transl_class</a></span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L1050" title="ocaml/lambda/translcore.ml:1050">ids</a></span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span> <span class="ocamlLCIdentifier">meths</span> <span class="ocamlLCIdentifier"><a href="translclass.ml.html#L366" title="ocaml/lambda/translclass.ml:366">cl</a></span> <span class="ocamlLCIdentifier">vf</span><span class="Statement">))<br/></li>
<li></span>&nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier">cl_list</span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li><span class="Comment">(* Compile one or more functors, merging curried functors to produce<br/></li>
<li></span><span class="Comment">&nbsp;&nbsp; multi-argument functors.&nbsp; Any [@<a href="debuginfo.ml.html#L180" title="ocaml/lambda/debuginfo.ml:180">inline</a>] attribute on a functor that is<br/></li>
<li></span><span class="Comment">&nbsp;&nbsp; merged must be consistent with any other [@<a href="debuginfo.ml.html#L180" title="ocaml/lambda/debuginfo.ml:180">inline</a>] attribute(<a href="translclass.ml.html#L563" title="ocaml/lambda/translclass.ml:563">s</a>) on the<br/></li>
<li></span><span class="Comment">&nbsp;&nbsp; functor(<a href="translclass.ml.html#L563" title="ocaml/lambda/translclass.ml:563">s</a>) being merged with.&nbsp; Such an attribute will be placed on the<br/></li>
<li></span><span class="Comment">&nbsp;&nbsp; resulting merged functor. *)<br/></li>
<li></span><br/></li>
<li><span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="lambda.mli.html#L479" title="ocaml/lambda/lambda.mli:479">merge_inline_attributes</a></span> <span class="ocamlLCIdentifier">attr1</span> <span class="ocamlLCIdentifier">attr2</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">match</span> <span class="PreProc">Lambda</span>.<span class="ocamlLCIdentifier"><a href="lambda.mli.html#L479" title="ocaml/lambda/lambda.mli:479">merge_inline_attributes</a></span> <span class="ocamlLCIdentifier">attr1</span> <span class="ocamlLCIdentifier">attr2</span> <span class="Statement">with<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Some</span> <span class="ocamlLCIdentifier"><a href="simplif.ml.html#L760" title="ocaml/lambda/simplif.ml:760">attr</a></span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier"><a href="simplif.ml.html#L760" title="ocaml/lambda/simplif.ml:760">attr</a><br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">None</span> <span class="Statement">-&gt;</span> <span class="Statement">raise</span> <span class="Statement">(</span><span class="Constant">Error</span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="debuginfo.mli.html#L34" title="ocaml/lambda/debuginfo.mli:34">to_location</a></span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span>, <span class="Constant">Conflicting_inline_attributes</span><span class="Statement">))<br/></li>
<li></span><br/></li>
<li><span class="Statement">let</span> <span class="ocamlLCIdentifier">merge_functors</span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier">mexp</span> <span class="ocamlLCIdentifier">coercion</span> <span class="ocamlLCIdentifier">root_path</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="Statement">rec</span> <span class="ocamlLCIdentifier"><a href="matching.ml.html#L912" title="ocaml/lambda/matching.ml:912">merge</a></span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier">mexp</span> <span class="ocamlLCIdentifier">coercion</span> <span class="ocamlLCIdentifier"><a href="translclass.ml.html#L444" title="ocaml/lambda/translclass.ml:444">path</a></span> <span class="ocamlLCIdentifier">acc</span> <span class="ocamlLCIdentifier"><a href="lambda.mli.html#L220" title="ocaml/lambda/lambda.mli:220">inline_attribute</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">finished</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">acc</span>, <span class="ocamlLCIdentifier">mexp</span>, <span class="ocamlLCIdentifier"><a href="translclass.ml.html#L444" title="ocaml/lambda/translclass.ml:444">path</a></span>, <span class="ocamlLCIdentifier">coercion</span>, <span class="ocamlLCIdentifier"><a href="lambda.mli.html#L220" title="ocaml/lambda/lambda.mli:220">inline_attribute</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">match</span> <span class="ocamlLCIdentifier">mexp</span>.<span class="ocamlLCIdentifier">mod_desc</span> <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tmod_functor</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">param</span>, <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L601" title="ocaml/lambda/translcore.ml:601">body</a></span><span class="Statement">)</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="lambda.mli.html#L220" title="ocaml/lambda/lambda.mli:220">inline_attribute</a></span>' <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="PreProc">Translattribute</span>.<span class="ocamlLCIdentifier"><a href="translattribute.mli.html#L32" title="ocaml/lambda/translattribute.mli:32">get_inline_attribute</a></span> <span class="ocamlLCIdentifier">mexp</span>.<span class="ocamlLCIdentifier">mod_attributes<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">arg_coercion</span>, <span class="ocamlLCIdentifier">res_coercion</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">match</span> <span class="ocamlLCIdentifier">coercion</span> <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tcoerce_none</span> <span class="Statement">-&gt;</span> <span class="Constant">Tcoerce_none</span>, <span class="Constant">Tcoerce_none<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tcoerce_functor</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">arg_coercion</span>, <span class="ocamlLCIdentifier">res_coercion</span><span class="Statement">)</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">arg_coercion</span>, <span class="ocamlLCIdentifier">res_coercion<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Statement">_</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier">fatal_error</span> <span class="Constant">&quot;Translmod.merge_functors: bad coercion&quot;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="debuginfo.ml.html#L85" title="ocaml/lambda/debuginfo.ml:85">of_location</a></span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier">mexp</span>.<span class="ocamlLCIdentifier">mod_loc</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="translclass.ml.html#L444" title="ocaml/lambda/translclass.ml:444">path</a></span>, <span class="ocamlLCIdentifier">param</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">match</span> <span class="ocamlLCIdentifier">param</span> <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Unit</span> <span class="Statement">-&gt;</span> <span class="Constant">None</span>, <span class="PreProc">Ident</span>.<span class="ocamlLCIdentifier">create_local</span> <span class="Constant">&quot;*&quot;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Named</span> <span class="Statement">(</span><span class="Constant">None</span>, <span class="Statement">_</span>, <span class="Statement">_)</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span> <span class="Statement">=</span> <span class="PreProc">Ident</span>.<span class="ocamlLCIdentifier">create_local</span> <span class="Constant">&quot;_&quot;</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L54" title="ocaml/lambda/translmod.ml:54">functor_path</a></span> <span class="ocamlLCIdentifier"><a href="translclass.ml.html#L444" title="ocaml/lambda/translclass.ml:444">path</a></span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span>, <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Named</span> <span class="Statement">(</span><span class="Constant">Some</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span>, <span class="Statement">_</span>, <span class="Statement">_)</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier"><a href="#L54" title="ocaml/lambda/translmod.ml:54">functor_path</a></span> <span class="ocamlLCIdentifier"><a href="translclass.ml.html#L444" title="ocaml/lambda/translclass.ml:444">path</a></span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span>, <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="lambda.mli.html#L220" title="ocaml/lambda/lambda.mli:220">inline_attribute</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="lambda.mli.html#L479" title="ocaml/lambda/lambda.mli:479">merge_inline_attributes</a></span> <span class="ocamlLCIdentifier"><a href="lambda.mli.html#L220" title="ocaml/lambda/lambda.mli:220">inline_attribute</a></span> <span class="ocamlLCIdentifier"><a href="lambda.mli.html#L220" title="ocaml/lambda/lambda.mli:220">inline_attribute</a></span>' <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="matching.ml.html#L912" title="ocaml/lambda/matching.ml:912">merge</a></span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L601" title="ocaml/lambda/translcore.ml:601">body</a></span> <span class="ocamlLCIdentifier">res_coercion</span> <span class="ocamlLCIdentifier"><a href="translclass.ml.html#L444" title="ocaml/lambda/translclass.ml:444">path</a></span> <span class="Statement">((</span><span class="ocamlLCIdentifier">param</span>, <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span>, <span class="ocamlLCIdentifier">arg_coercion</span><span class="Statement">)</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier">acc</span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="lambda.mli.html#L220" title="ocaml/lambda/lambda.mli:220">inline_attribute</a><br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Statement">_</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier">finished<br/></li>
<li></span>&nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier"><a href="matching.ml.html#L912" title="ocaml/lambda/matching.ml:912">merge</a></span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier">mexp</span> <span class="ocamlLCIdentifier">coercion</span> <span class="ocamlLCIdentifier">root_path</span> <span class="Constant">[]</span> <span class="Constant">Default_inline<br/></li>
<li></span><br/></li>
<li><span class="Statement">let</span> <span class="Statement">rec</span> <span class="ocamlLCIdentifier">compile_functor</span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier">mexp</span> <span class="ocamlLCIdentifier">coercion</span> <span class="ocamlLCIdentifier">root_path</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">functor_params_rev</span>, <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L601" title="ocaml/lambda/translcore.ml:601">body</a></span>, <span class="ocamlLCIdentifier">body_path</span>, <span class="ocamlLCIdentifier">res_coercion</span>, <span class="ocamlLCIdentifier"><a href="lambda.mli.html#L220" title="ocaml/lambda/lambda.mli:220">inline_attribute</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier">merge_functors</span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier">mexp</span> <span class="ocamlLCIdentifier">coercion</span> <span class="ocamlLCIdentifier">root_path<br/></li>
<li></span>&nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">assert</span> <span class="Statement">(</span><span class="PreProc">List</span>.<span class="ocamlLCIdentifier">length</span> <span class="ocamlLCIdentifier">functor_params_rev</span> <span class="Statement">&gt;=</span> <span class="Constant">1</span><span class="Statement">);</span>&nbsp; <span class="Comment">(* cf. [<a href="translcore.ml.html#L37" title="ocaml/lambda/translcore.ml:37">transl_module</a>] *)<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="translprim.ml.html#L784" title="ocaml/lambda/translprim.ml:784">params</a></span>, <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L601" title="ocaml/lambda/translcore.ml:601">body</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">List</span>.<span class="ocamlLCIdentifier">fold_left</span> <span class="Statement">(fun</span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="translprim.ml.html#L784" title="ocaml/lambda/translprim.ml:784">params</a></span>, <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L601" title="ocaml/lambda/translcore.ml:601">body</a></span><span class="Statement">)</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">param</span>, <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span>, <span class="ocamlLCIdentifier">arg_coercion</span><span class="Statement">)</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">param</span>' <span class="Statement">=</span> <span class="PreProc">Ident</span>.<span class="ocamlLCIdentifier"><a href="lambda.mli.html#L427" title="ocaml/lambda/lambda.mli:427">rename</a></span> <span class="ocamlLCIdentifier">param</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="matching.ml.html#L2339" title="ocaml/lambda/matching.ml:2339">arg</a></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">apply_coercion</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span> <span class="Constant">Alias</span> <span class="ocamlLCIdentifier">arg_coercion</span> <span class="Statement">(</span><span class="Constant">Lvar</span> <span class="ocamlLCIdentifier">param</span>'<span class="Statement">)</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="translprim.ml.html#L784" title="ocaml/lambda/translprim.ml:784">params</a></span> <span class="Statement">=</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">param</span>', <span class="Constant">Pgenval</span><span class="Statement">)</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier"><a href="translprim.ml.html#L784" title="ocaml/lambda/translprim.ml:784">params</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L601" title="ocaml/lambda/translcore.ml:601">body</a></span> <span class="Statement">=</span> <span class="Constant">Llet</span> <span class="Statement">(</span><span class="Constant">Alias</span>, <span class="Constant">Pgenval</span>, <span class="ocamlLCIdentifier">param</span>, <span class="ocamlLCIdentifier"><a href="matching.ml.html#L2339" title="ocaml/lambda/matching.ml:2339">arg</a></span>, <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L601" title="ocaml/lambda/translcore.ml:601">body</a></span><span class="Statement">)</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="translprim.ml.html#L784" title="ocaml/lambda/translprim.ml:784">params</a></span>, <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L601" title="ocaml/lambda/translcore.ml:601">body</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="Constant">[]</span>, <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L37" title="ocaml/lambda/translcore.ml:37">transl_module</a></span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier">res_coercion</span> <span class="ocamlLCIdentifier">body_path</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L601" title="ocaml/lambda/translcore.ml:601">body</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">functor_params_rev<br/></li>
<li></span>&nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier"><a href="translclass.ml.html#L30" title="ocaml/lambda/translclass.ml:30">lfunction</a><br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier"><a href="translcore.ml.html#L383" title="ocaml/lambda/translcore.ml:383">kind</a></span>:<span class="Constant">Curried<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier"><a href="translprim.ml.html#L784" title="ocaml/lambda/translprim.ml:784">params</a><br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier">return</span>:<span class="Constant">Pgenval<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier"><a href="simplif.ml.html#L760" title="ocaml/lambda/simplif.ml:760">attr</a></span>:<span class="Statement">{<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="debuginfo.ml.html#L180" title="ocaml/lambda/debuginfo.ml:180">inline</a></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="lambda.mli.html#L220" title="ocaml/lambda/lambda.mli:220">inline_attribute</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">specialise</span> <span class="Statement">=</span> <span class="Constant">Default_specialise</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">local</span> <span class="Statement">=</span> <span class="Constant">Default_local</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">poll</span> <span class="Statement">=</span> <span class="Constant">Default_poll</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">is_a_functor</span> <span class="Statement">=</span> <span class="Constant">true</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">stub</span> <span class="Statement">=</span> <span class="Constant">false</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">tmc_candidate</span> <span class="Statement">=</span> <span class="Constant">false</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">}<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a><br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier"><a href="translcore.ml.html#L601" title="ocaml/lambda/translcore.ml:601">body</a><br/></li>
<li></span><br/></li>
<li><span class="Comment">(* Compile a module expression *)<br/></li>
<li></span><br/></li>
<li><a id="L508">&#x200c;</a><span class="Statement">and</span> <span class="ocamlLCIdentifier"><span class="linkable">transl_module</span></span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier">cc</span> <span class="ocamlLCIdentifier">rootpath</span> <span class="ocamlLCIdentifier">mexp</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="PreProc">List</span>.<span class="ocamlLCIdentifier">iter</span> <span class="Statement">(</span><span class="PreProc">Translattribute</span>.<span class="ocamlLCIdentifier"><a href="translattribute.mli.html#L21" title="ocaml/lambda/translattribute.mli:21">check_attribute_on_module</a></span> <span class="ocamlLCIdentifier">mexp</span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier">mexp</span>.<span class="ocamlLCIdentifier">mod_attributes</span><span class="Statement">;<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="debuginfo.ml.html#L85" title="ocaml/lambda/debuginfo.ml:85">of_location</a></span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier">mexp</span>.<span class="ocamlLCIdentifier">mod_loc</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">match</span> <span class="ocamlLCIdentifier">mexp</span>.<span class="ocamlLCIdentifier">mod_desc</span> <span class="Statement">with<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Tmod_ident</span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="translclass.ml.html#L444" title="ocaml/lambda/translclass.ml:444">path</a></span>,<span class="Statement">_)</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">apply_coercion</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span> <span class="Constant">Strict</span> <span class="ocamlLCIdentifier">cc<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="lambda.mli.html#L403" title="ocaml/lambda/lambda.mli:403">transl_module_path</a></span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span> <span class="ocamlLCIdentifier">mexp</span>.<span class="ocamlLCIdentifier">mod_env</span> <span class="ocamlLCIdentifier"><a href="translclass.ml.html#L444" title="ocaml/lambda/translclass.ml:444">path</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Tmod_structure</span> <span class="ocamlLCIdentifier">str</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">fst</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">transl_struct</span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span> <span class="Constant">[]</span> <span class="ocamlLCIdentifier">cc</span> <span class="ocamlLCIdentifier">rootpath</span> <span class="ocamlLCIdentifier">str</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Tmod_functor</span> <span class="Statement">_</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="translobj.ml.html#L165" title="ocaml/lambda/translobj.ml:165">oo_wrap</a></span> <span class="ocamlLCIdentifier">mexp</span>.<span class="ocamlLCIdentifier">mod_env</span> <span class="Constant">true</span> <span class="Statement">(fun</span> <span class="Constant">()</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">compile_functor</span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier">mexp</span> <span class="ocamlLCIdentifier">cc</span> <span class="ocamlLCIdentifier">rootpath</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span><span class="Statement">)</span> <span class="Constant">()<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Tmod_apply</span><span class="Statement">(</span><span class="ocamlLCIdentifier">funct</span>, <span class="ocamlLCIdentifier"><a href="matching.ml.html#L2339" title="ocaml/lambda/matching.ml:2339">arg</a></span>, <span class="ocamlLCIdentifier">ccarg</span><span class="Statement">)</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">translated_arg</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L37" title="ocaml/lambda/translcore.ml:37">transl_module</a></span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier">ccarg</span> <span class="Constant">None</span> <span class="ocamlLCIdentifier"><a href="matching.ml.html#L2339" title="ocaml/lambda/matching.ml:2339">arg</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="translcore.mli.html#L27" title="ocaml/lambda/translcore.mli:27">transl_apply</a></span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="Statement">~</span><span class="Identifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span> <span class="Statement">~</span><span class="Identifier">cc</span> <span class="ocamlLCIdentifier">mexp</span>.<span class="ocamlLCIdentifier">mod_env</span> <span class="ocamlLCIdentifier">funct</span> <span class="ocamlLCIdentifier">translated_arg<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Tmod_apply_unit</span> <span class="ocamlLCIdentifier">funct</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="translcore.mli.html#L27" title="ocaml/lambda/translcore.mli:27">transl_apply</a></span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="Statement">~</span><span class="Identifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span> <span class="Statement">~</span><span class="Identifier">cc</span> <span class="ocamlLCIdentifier">mexp</span>.<span class="ocamlLCIdentifier">mod_env</span> <span class="ocamlLCIdentifier">funct</span> <span class="ocamlLCIdentifier"><a href="lambda.mli.html#L366" title="ocaml/lambda/lambda.mli:366">lambda_unit</a><br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Tmod_constraint</span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="matching.ml.html#L2339" title="ocaml/lambda/matching.ml:2339">arg</a></span>, <span class="Statement">_</span>, <span class="Statement">_</span>, <span class="ocamlLCIdentifier">ccarg</span><span class="Statement">)</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L37" title="ocaml/lambda/translcore.ml:37">transl_module</a></span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L161" title="ocaml/lambda/translmod.ml:161">compose_coercions</a></span> <span class="ocamlLCIdentifier">cc</span> <span class="ocamlLCIdentifier">ccarg</span><span class="Statement">)</span> <span class="ocamlLCIdentifier">rootpath</span> <span class="ocamlLCIdentifier"><a href="matching.ml.html#L2339" title="ocaml/lambda/matching.ml:2339">arg</a><br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Tmod_unpack</span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="matching.ml.html#L2339" title="ocaml/lambda/matching.ml:2339">arg</a></span>, <span class="Statement">_)</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">apply_coercion</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span> <span class="Constant">Strict</span> <span class="ocamlLCIdentifier">cc</span> <span class="Statement">(</span><span class="PreProc">Translcore</span>.<span class="ocamlLCIdentifier"><a href="translcore.ml.html#L216" title="ocaml/lambda/translcore.ml:216">transl_exp</a></span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier"><a href="matching.ml.html#L2339" title="ocaml/lambda/matching.ml:2339">arg</a></span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li><span class="Statement">and</span> <span class="ocamlLCIdentifier"><a href="translcore.mli.html#L27" title="ocaml/lambda/translcore.mli:27">transl_apply</a></span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="Statement">~</span><span class="Identifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span> <span class="Statement">~</span><span class="Identifier">cc</span> <span class="ocamlLCIdentifier">mod_env</span> <span class="ocamlLCIdentifier">funct</span> <span class="ocamlLCIdentifier">translated_arg</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">inlined_attribute</span>, <span class="ocamlLCIdentifier">funct</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Translattribute</span>.<span class="ocamlLCIdentifier"><a href="translattribute.mli.html#L60" title="ocaml/lambda/translattribute.mli:60">get_and_remove_inlined_attribute_on_module</a></span> <span class="ocamlLCIdentifier">funct<br/></li>
<li></span>&nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier"><a href="translobj.ml.html#L165" title="ocaml/lambda/translobj.ml:165">oo_wrap</a></span> <span class="ocamlLCIdentifier">mod_env</span> <span class="Constant">true<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">(</span><span class="ocamlLCIdentifier">apply_coercion</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span> <span class="Constant">Strict</span> <span class="ocamlLCIdentifier">cc</span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">(</span><span class="Constant">Lapply</span><span class="Statement">{<br/></li>
<li></span>&nbsp; &nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier">ap_loc</span><span class="Statement">=</span><span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier">ap_func</span><span class="Statement">=</span><span class="ocamlLCIdentifier"><a href="translcore.ml.html#L37" title="ocaml/lambda/translcore.ml:37">transl_module</a></span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="Constant">Tcoerce_none</span> <span class="Constant">None</span> <span class="ocamlLCIdentifier">funct</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier">ap_args</span><span class="Statement">=[</span><span class="ocamlLCIdentifier">translated_arg</span><span class="Statement">];<br/></li>
<li></span>&nbsp; &nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier">ap_tailcall</span><span class="Statement">=</span><span class="Constant">Default_tailcall</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier">ap_inlined</span><span class="Statement">=</span><span class="ocamlLCIdentifier">inlined_attribute</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier">ap_specialised</span><span class="Statement">=</span><span class="Constant">Default_specialise</span><span class="Statement">})<br/></li>
<li></span><br/></li>
<li><span class="Statement">and</span> <span class="ocamlLCIdentifier">transl_struct</span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span> <span class="ocamlLCIdentifier">fields</span> <span class="ocamlLCIdentifier">cc</span> <span class="ocamlLCIdentifier">rootpath</span> <span class="Statement">{</span><span class="ocamlLCIdentifier">str_final_env</span><span class="Statement">;</span> <span class="ocamlLCIdentifier">str_items</span><span class="Statement">;</span> <span class="Statement">_}</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier">transl_structure</span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span> <span class="ocamlLCIdentifier">fields</span> <span class="ocamlLCIdentifier">cc</span> <span class="ocamlLCIdentifier">rootpath</span> <span class="ocamlLCIdentifier">str_final_env</span> <span class="ocamlLCIdentifier">str_items<br/></li>
<li></span><br/></li>
<li><span class="Comment">(* The function&nbsp; transl_structure is called by&nbsp; the bytecode compiler.<br/></li>
<li></span><span class="Comment">&nbsp;&nbsp; Some effort is made to compile in top to bottom order, in order to display<br/></li>
<li></span><span class="Comment">&nbsp;&nbsp; warning by increasing locations. *)<br/></li>
<li></span><span class="Statement">and</span> <span class="ocamlLCIdentifier">transl_structure</span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span> <span class="ocamlLCIdentifier">fields</span> <span class="ocamlLCIdentifier">cc</span> <span class="ocamlLCIdentifier">rootpath</span> <span class="ocamlLCIdentifier">final_env</span> <span class="Statement">=</span> <span class="Statement">function<br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">[]</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L601" title="ocaml/lambda/translcore.ml:601">body</a></span>, <span class="ocamlLCIdentifier"><a href="matching.ml.html#L3846" title="ocaml/lambda/matching.ml:3846">size</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">match</span> <span class="ocamlLCIdentifier">cc</span> <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">Tcoerce_none</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">Lprim</span><span class="Statement">(</span><span class="Constant">Pmakeblock</span><span class="Statement">(</span><span class="Constant">0</span>, <span class="Constant">Immutable</span>, <span class="Constant">None</span><span class="Statement">)</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="PreProc">List</span>.<span class="ocamlLCIdentifier"><a href="matching.ml.html#L922" title="ocaml/lambda/matching.ml:922">map</a></span> <span class="Statement">(fun</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span> <span class="Statement">-&gt;</span> <span class="Constant">Lvar</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span><span class="Statement">)</span> <span class="Statement">(</span><span class="PreProc">List</span>.<span class="ocamlLCIdentifier">rev</span> <span class="ocamlLCIdentifier">fields</span><span class="Statement">)</span>, <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span><span class="Statement">)</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="PreProc">List</span>.<span class="ocamlLCIdentifier">length</span> <span class="ocamlLCIdentifier">fields<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tcoerce_structure</span><span class="Statement">(</span><span class="ocamlLCIdentifier">pos_cc_list</span>, <span class="ocamlLCIdentifier">id_pos_list</span><span class="Statement">)</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">(* Do not ignore id_pos_list ! *)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">(*Format.<a href="matching.ml.html#L498" title="ocaml/lambda/matching.ml:498">eprintf</a> &quot;%a@.@[&quot; Includemod.print_coercion cc;<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; List.iter (fun <a href="translcore.ml.html#L708" title="ocaml/lambda/translcore.ml:708">l</a> -&gt; Format.<a href="matching.ml.html#L498" title="ocaml/lambda/matching.ml:498">eprintf</a> &quot;%a@ &quot; Ident.print <a href="translcore.ml.html#L708" title="ocaml/lambda/translcore.ml:708">l</a>)<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; fields;<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Format.<a href="matching.ml.html#L498" title="ocaml/lambda/matching.ml:498">eprintf</a> &quot;@]@.&quot;;*)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">v</span> <span class="Statement">=</span> <span class="PreProc">Array</span>.<span class="ocamlLCIdentifier">of_list</span> <span class="Statement">(</span><span class="PreProc">List</span>.<span class="ocamlLCIdentifier">rev</span> <span class="ocamlLCIdentifier">fields</span><span class="Statement">)</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">get_field</span> <span class="ocamlLCIdentifier">pos</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">pos</span><span class="ocamlNone"> </span><span class="Statement">&lt;</span><span class="ocamlNone"> </span><span class="Constant">0</span><span class="ocamlNone"> </span><span class="Statement">then</span> <span class="ocamlLCIdentifier"><a href="lambda.mli.html#L366" title="ocaml/lambda/lambda.mli:366">lambda_unit</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">else</span> <span class="Constant">Lvar</span> <span class="ocamlLCIdentifier">v</span>.<span class="Statement">(</span><span class="ocamlLCIdentifier">pos</span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L1050" title="ocaml/lambda/translcore.ml:1050">ids</a></span> <span class="Statement">=</span> <span class="PreProc">List</span>.<span class="ocamlLCIdentifier">fold_right</span> <span class="PreProc">Ident</span>.<span class="PreProc">Set</span>.<span class="ocamlLCIdentifier"><a href="matching.ml.html#L884" title="ocaml/lambda/matching.ml:884">add</a></span> <span class="ocamlLCIdentifier">fields</span> <span class="PreProc">Ident</span>.<span class="PreProc">Set</span>.<span class="ocamlLCIdentifier"><a href="matching.ml.html#L533" title="ocaml/lambda/matching.ml:533">empty</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="translobj.ml.html#L145" title="ocaml/lambda/translobj.ml:145">lam</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">Lprim</span><span class="Statement">(</span><span class="Constant">Pmakeblock</span><span class="Statement">(</span><span class="Constant">0</span>, <span class="Constant">Immutable</span>, <span class="Constant">None</span><span class="Statement">)</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="PreProc">List</span>.<span class="ocamlLCIdentifier"><a href="matching.ml.html#L922" title="ocaml/lambda/matching.ml:922">map</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">(fun</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">pos</span>, <span class="ocamlLCIdentifier">cc</span><span class="Statement">)</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">match</span> <span class="ocamlLCIdentifier">cc</span> <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">Tcoerce_primitive</span> <span class="ocamlLCIdentifier">p</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="PreProc">Translprim</span>.<span class="ocamlLCIdentifier"><a href="translprim.mli.html#L35" title="ocaml/lambda/translprim.mli:35">transl_primitive</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="debuginfo.ml.html#L85" title="ocaml/lambda/debuginfo.ml:85">of_location</a></span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier">p</span>.<span class="ocamlLCIdentifier">pc_loc</span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">p</span>.<span class="ocamlLCIdentifier">pc_desc</span> <span class="ocamlLCIdentifier">p</span>.<span class="ocamlLCIdentifier">pc_env</span> <span class="ocamlLCIdentifier">p</span>.<span class="ocamlLCIdentifier">pc_type</span> <span class="Constant">None<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Statement">_</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier">apply_coercion</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span> <span class="Constant">Strict</span> <span class="ocamlLCIdentifier">cc</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">get_field</span> <span class="ocamlLCIdentifier">pos</span><span class="Statement">))<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">pos_cc_list</span>, <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">and</span> <span class="ocamlLCIdentifier">id_pos_list</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="PreProc">List</span>.<span class="ocamlLCIdentifier">filter</span> <span class="Statement">(fun</span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span>,<span class="Statement">_</span>,<span class="Statement">_)</span> <span class="Statement">-&gt;</span> <span class="Statement">not</span> <span class="Statement">(</span><span class="PreProc">Ident</span>.<span class="PreProc">Set</span>.<span class="ocamlLCIdentifier">mem</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L1050" title="ocaml/lambda/translcore.ml:1050">ids</a></span><span class="Statement">))<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">id_pos_list<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L137" title="ocaml/lambda/translmod.ml:137">wrap_id_pos_list</a></span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span> <span class="ocamlLCIdentifier">id_pos_list</span> <span class="ocamlLCIdentifier">get_field</span> <span class="ocamlLCIdentifier"><a href="translobj.ml.html#L145" title="ocaml/lambda/translobj.ml:145">lam</a></span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="PreProc">List</span>.<span class="ocamlLCIdentifier">length</span> <span class="ocamlLCIdentifier">pos_cc_list<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Statement">_</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">fatal_error</span> <span class="Constant">&quot;Translmod.transl_structure&quot;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Comment">(* This debugging event provides information regarding the structure<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; items. It is ignored by the OCaml debugger but is used by<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; Js_of_ocaml to preserve variable names. *)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">(if</span><span class="ocamlNone"> </span><span class="Statement">!</span><span class="PreProc">Clflags</span><span class="ocamlNone">.</span><span class="ocamlLCIdentifier">debug</span><span class="ocamlNone"> </span><span class="Statement">&amp;&amp;</span><span class="ocamlNone"> </span><span class="Statement">not</span><span class="ocamlNone"> </span><span class="Statement">!</span><span class="PreProc">Clflags</span><span class="ocamlNone">.</span><span class="ocamlLCIdentifier">native_code</span><span class="ocamlNone"> </span><span class="Statement">then<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">Levent</span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="translcore.ml.html#L601" title="ocaml/lambda/translcore.ml:601">body</a></span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">{</span><span class="ocamlLCIdentifier">lev_loc</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier">lev_kind</span> <span class="Statement">=</span> <span class="Constant">Lev_pseudo</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier">lev_repr</span> <span class="Statement">=</span> <span class="Constant">None</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier">lev_env</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">final_env</span><span class="Statement">})<br/></li>
<li></span>&nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L601" title="ocaml/lambda/translcore.ml:601">body</a></span><span class="Statement">)</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="matching.ml.html#L3846" title="ocaml/lambda/matching.ml:3846">size</a><br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="ocamlLCIdentifier"><a href="debuginfo.mli.html#L38" title="ocaml/lambda/debuginfo.mli:38">item</a></span> <span class="Statement">::</span> <span class="ocamlLCIdentifier">rem</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">match</span> <span class="ocamlLCIdentifier"><a href="debuginfo.mli.html#L38" title="ocaml/lambda/debuginfo.mli:38">item</a></span>.<span class="ocamlLCIdentifier">str_desc</span> <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_eval</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">expr</span>, <span class="Statement">_)</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L601" title="ocaml/lambda/translcore.ml:601">body</a></span>, <span class="ocamlLCIdentifier"><a href="matching.ml.html#L3846" title="ocaml/lambda/matching.ml:3846">size</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">transl_structure</span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span> <span class="ocamlLCIdentifier">fields</span> <span class="ocamlLCIdentifier">cc</span> <span class="ocamlLCIdentifier">rootpath</span> <span class="ocamlLCIdentifier">final_env</span> <span class="ocamlLCIdentifier">rem<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">Lsequence</span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="translcore.ml.html#L216" title="ocaml/lambda/translcore.ml:216">transl_exp</a></span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier">expr</span>, <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L601" title="ocaml/lambda/translcore.ml:601">body</a></span><span class="Statement">)</span>, <span class="ocamlLCIdentifier"><a href="matching.ml.html#L3846" title="ocaml/lambda/matching.ml:3846">size</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_value</span><span class="Statement">(</span><span class="ocamlLCIdentifier">rec_flag</span>, <span class="ocamlLCIdentifier">pat_expr_list</span><span class="Statement">)</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">(* Translate bindings first *)<br/></li>
<li><a id="L612">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">mk_lam_let</span></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="translcore.mli.html#L33" title="ocaml/lambda/translcore.mli:33">transl_let</a></span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="Statement">~</span><span class="Identifier">in_structure</span>:<span class="Constant">true</span> <span class="ocamlLCIdentifier">rec_flag</span> <span class="ocamlLCIdentifier">pat_expr_list</span> <span class="Statement">in<br/></li>
<li><a id="L614">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">ext_fields</span></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="PreProc">List</span>.<span class="ocamlLCIdentifier">rev_append</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">let_bound_idents</span> <span class="ocamlLCIdentifier">pat_expr_list</span><span class="Statement">)</span> <span class="ocamlLCIdentifier">fields</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">(* Then, translate remainder of struct *)<br/></li>
<li><a id="L617">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">body</span></span>, <span class="ocamlLCIdentifier"><a href="matching.ml.html#L3846" title="ocaml/lambda/matching.ml:3846">size</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">transl_structure</span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span> <span class="ocamlLCIdentifier"><a href="#L614" title="ocaml/lambda/translmod.ml:614">ext_fields</a></span> <span class="ocamlLCIdentifier">cc</span> <span class="ocamlLCIdentifier">rootpath</span> <span class="ocamlLCIdentifier">final_env</span> <span class="ocamlLCIdentifier">rem<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L612" title="ocaml/lambda/translmod.ml:612">mk_lam_let</a></span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L601" title="ocaml/lambda/translcore.ml:601">body</a></span>, <span class="ocamlLCIdentifier"><a href="matching.ml.html#L3846" title="ocaml/lambda/matching.ml:3846">size</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_primitive</span> <span class="ocamlLCIdentifier">descr</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L212" title="ocaml/lambda/translmod.ml:212">record_primitive</a></span> <span class="ocamlLCIdentifier">descr</span>.<span class="ocamlLCIdentifier">val_val</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">transl_structure</span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span> <span class="ocamlLCIdentifier">fields</span> <span class="ocamlLCIdentifier">cc</span> <span class="ocamlLCIdentifier">rootpath</span> <span class="ocamlLCIdentifier">final_env</span> <span class="ocamlLCIdentifier">rem<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_type</span> <span class="Statement">_</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">transl_structure</span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span> <span class="ocamlLCIdentifier">fields</span> <span class="ocamlLCIdentifier">cc</span> <span class="ocamlLCIdentifier">rootpath</span> <span class="ocamlLCIdentifier">final_env</span> <span class="ocamlLCIdentifier">rem<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_typext</span><span class="Statement">(</span><span class="ocamlLCIdentifier">tyext</span><span class="Statement">)</span> <span class="Statement">-&gt;<br/></li>
<li><a id="L627">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">ids</span></span> <span class="Statement">=</span> <span class="PreProc">List</span>.<span class="ocamlLCIdentifier"><a href="matching.ml.html#L922" title="ocaml/lambda/matching.ml:922">map</a></span> <span class="Statement">(fun</span> <span class="ocamlLCIdentifier">ext</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier">ext</span>.<span class="ocamlLCIdentifier">ext_id</span><span class="Statement">)</span> <span class="ocamlLCIdentifier">tyext</span>.<span class="ocamlLCIdentifier">tyext_constructors</span> <span class="Statement">in<br/></li>
<li><a id="L628">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">body</span></span>, <span class="ocamlLCIdentifier"><a href="matching.ml.html#L3846" title="ocaml/lambda/matching.ml:3846">size</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">transl_structure</span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span> <span class="Statement">(</span><span class="PreProc">List</span>.<span class="ocamlLCIdentifier">rev_append</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L1050" title="ocaml/lambda/translcore.ml:1050">ids</a></span> <span class="ocamlLCIdentifier">fields</span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">cc</span> <span class="ocamlLCIdentifier">rootpath</span> <span class="ocamlLCIdentifier">final_env</span> <span class="ocamlLCIdentifier">rem<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L65" title="ocaml/lambda/translmod.ml:65">transl_type_extension</a></span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier"><a href="debuginfo.mli.html#L38" title="ocaml/lambda/debuginfo.mli:38">item</a></span>.<span class="ocamlLCIdentifier">str_env</span> <span class="ocamlLCIdentifier">rootpath</span> <span class="ocamlLCIdentifier">tyext</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L601" title="ocaml/lambda/translcore.ml:601">body</a></span>, <span class="ocamlLCIdentifier"><a href="matching.ml.html#L3846" title="ocaml/lambda/matching.ml:3846">size</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_exception</span> <span class="ocamlLCIdentifier">ext</span> <span class="Statement">-&gt;<br/></li>
<li><a id="L634">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">id</span></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">ext</span>.<span class="ocamlLCIdentifier">tyexn_constructor</span>.<span class="ocamlLCIdentifier">ext_id</span> <span class="Statement">in<br/></li>
<li><a id="L635">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">path</span></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="#L58" title="ocaml/lambda/translmod.ml:58">field_path</a></span> <span class="ocamlLCIdentifier">rootpath</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span> <span class="Statement">in<br/></li>
<li><a id="L636">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">body</span></span>, <span class="ocamlLCIdentifier"><a href="matching.ml.html#L3846" title="ocaml/lambda/matching.ml:3846">size</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">transl_structure</span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span><span class="Statement">::</span><span class="ocamlLCIdentifier">fields</span><span class="Statement">)</span> <span class="ocamlLCIdentifier">cc</span> <span class="ocamlLCIdentifier">rootpath</span> <span class="ocamlLCIdentifier">final_env</span> <span class="ocamlLCIdentifier">rem<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">Llet</span><span class="Statement">(</span><span class="Constant">Strict</span>, <span class="Constant">Pgenval</span>, <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier"><a href="translcore.mli.html#L36" title="ocaml/lambda/translcore.mli:36">transl_extension_constructor</a></span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="debuginfo.mli.html#L38" title="ocaml/lambda/debuginfo.mli:38">item</a></span>.<span class="ocamlLCIdentifier">str_env<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="translclass.ml.html#L444" title="ocaml/lambda/translclass.ml:444">path</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">ext</span>.<span class="ocamlLCIdentifier">tyexn_constructor</span>, <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L601" title="ocaml/lambda/translcore.ml:601">body</a></span><span class="Statement">)</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="matching.ml.html#L3846" title="ocaml/lambda/matching.ml:3846">size</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_module</span> <span class="Statement">({</span><span class="ocamlLCIdentifier">mb_presence</span><span class="Statement">=</span><span class="Constant">Mp_present</span><span class="Statement">}</span> <span class="Statement">as</span> <span class="ocamlLCIdentifier">mb</span><span class="Statement">)</span> <span class="Statement">-&gt;<br/></li>
<li><a id="L646">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">id</span></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">mb</span>.<span class="ocamlLCIdentifier">mb_id</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">(* Translate module first *)<br/></li>
<li><a id="L648">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">subscopes</span></span> <span class="Statement">=</span> <span class="Statement">match</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span> <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">None</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Some</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier">enter_module_definition</span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span> <span class="Statement">in<br/></li>
<li><a id="L651">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">module_body</span></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L37" title="ocaml/lambda/translcore.ml:37">transl_module</a></span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span>:<span class="ocamlLCIdentifier"><a href="#L648" title="ocaml/lambda/translmod.ml:648">subscopes</a></span> <span class="Constant">Tcoerce_none<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="PreProc">Option</span>.<span class="ocamlLCIdentifier"><a href="matching.ml.html#L2350" title="ocaml/lambda/matching.ml:2350">bind</a></span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L58" title="ocaml/lambda/translmod.ml:58">field_path</a></span> <span class="ocamlLCIdentifier">rootpath</span><span class="Statement">))</span> <span class="ocamlLCIdentifier">mb</span>.<span class="ocamlLCIdentifier">mb_expr<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">in<br/></li>
<li><a id="L655">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">module_body</span></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="PreProc">Translattribute</span>.<span class="ocamlLCIdentifier"><a href="translattribute.mli.html#L26" title="ocaml/lambda/translattribute.mli:26">add_inline_attribute</a></span> <span class="ocamlLCIdentifier"><a href="#L651" title="ocaml/lambda/translmod.ml:651">module_body</a></span> <span class="ocamlLCIdentifier">mb</span>.<span class="ocamlLCIdentifier">mb_loc<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier">mb</span>.<span class="ocamlLCIdentifier">mb_attributes<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">(* Translate remainder second *)<br/></li>
<li><a id="L660">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">body</span></span>, <span class="ocamlLCIdentifier"><a href="matching.ml.html#L3846" title="ocaml/lambda/matching.ml:3846">size</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">transl_structure</span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L45" title="ocaml/lambda/translmod.ml:45">cons_opt</a></span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span> <span class="ocamlLCIdentifier">fields</span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">cc</span> <span class="ocamlLCIdentifier">rootpath</span> <span class="ocamlLCIdentifier">final_env</span> <span class="ocamlLCIdentifier">rem<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">begin</span><span class="ocamlEnd"> </span><span class="Statement">match</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span><span class="ocamlEnd"> </span><span class="Statement">with<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Constant">None</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Constant">Lsequence</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="Constant">Lprim</span><span class="Statement">(</span><span class="Constant">Pignore</span><span class="ocamlEnd">, </span><span class="Statement">[</span><span class="ocamlLCIdentifier"><a href="#L651" title="ocaml/lambda/translmod.ml:651">module_body</a></span><span class="Statement">]</span><span class="ocamlEnd">,<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="ocamlLCIdentifier"><a href="debuginfo.ml.html#L85" title="ocaml/lambda/debuginfo.ml:85">of_location</a></span><span class="ocamlEnd"> </span><span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">mb</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">mb_name</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span><span class="Statement">)</span><span class="ocamlEnd">, </span><span class="ocamlLCIdentifier"><a href="translcore.ml.html#L601" title="ocaml/lambda/translcore.ml:601">body</a></span><span class="Statement">)</span><span class="ocamlEnd">,<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="matching.ml.html#L3846" title="ocaml/lambda/matching.ml:3846">size</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Constant">Some</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span><span class="ocamlEnd"> </span><span class="Statement">-&gt;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Constant">Llet</span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="translcore.ml.html#L614" title="ocaml/lambda/translcore.ml:614">pure_module</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">mb</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">mb_expr</span><span class="ocamlEnd">, </span><span class="Constant">Pgenval</span><span class="ocamlEnd">, </span><span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span><span class="ocamlEnd">, </span><span class="ocamlLCIdentifier"><a href="#L651" title="ocaml/lambda/translmod.ml:651">module_body</a></span><span class="ocamlEnd">, </span><span class="ocamlLCIdentifier"><a href="translcore.ml.html#L601" title="ocaml/lambda/translcore.ml:601">body</a></span><span class="Statement">)</span><span class="ocamlEnd">, </span><span class="ocamlLCIdentifier"><a href="matching.ml.html#L3846" title="ocaml/lambda/matching.ml:3846">size</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">end<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_module</span> <span class="Statement">({</span><span class="ocamlLCIdentifier">mb_presence</span><span class="Statement">=</span><span class="Constant">Mp_absent</span><span class="Statement">}</span> <span class="Statement">as</span> <span class="ocamlLCIdentifier">mb</span><span class="Statement">)</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="PreProc">List</span>.<span class="ocamlLCIdentifier">iter</span> <span class="Statement">(</span><span class="PreProc">Translattribute</span>.<span class="ocamlLCIdentifier"><a href="translattribute.mli.html#L21" title="ocaml/lambda/translattribute.mli:21">check_attribute_on_module</a></span> <span class="ocamlLCIdentifier">mb</span>.<span class="ocamlLCIdentifier">mb_expr</span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">mb</span>.<span class="ocamlLCIdentifier">mb_attributes</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="PreProc">List</span>.<span class="ocamlLCIdentifier">iter</span> <span class="Statement">(</span><span class="PreProc">Translattribute</span>.<span class="ocamlLCIdentifier"><a href="translattribute.mli.html#L21" title="ocaml/lambda/translattribute.mli:21">check_attribute_on_module</a></span> <span class="ocamlLCIdentifier">mb</span>.<span class="ocamlLCIdentifier">mb_expr</span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">mb</span>.<span class="ocamlLCIdentifier">mb_expr</span>.<span class="ocamlLCIdentifier">mod_attributes</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">transl_structure</span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span> <span class="ocamlLCIdentifier">fields</span> <span class="ocamlLCIdentifier">cc</span> <span class="ocamlLCIdentifier">rootpath</span> <span class="ocamlLCIdentifier">final_env</span> <span class="ocamlLCIdentifier">rem<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_recmodule</span> <span class="ocamlLCIdentifier">bindings</span> <span class="Statement">-&gt;<br/></li>
<li><a id="L679">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">ext_fields</span></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="PreProc">List</span>.<span class="ocamlLCIdentifier">rev_append</span> <span class="Statement">(</span><span class="PreProc">List</span>.<span class="ocamlLCIdentifier">filter_map</span> <span class="Statement">(fun</span> <span class="ocamlLCIdentifier">mb</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier">mb</span>.<span class="ocamlLCIdentifier">mb_id</span><span class="Statement">)</span> <span class="ocamlLCIdentifier">bindings</span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">fields<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">in<br/></li>
<li><a id="L683">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">body</span></span>, <span class="ocamlLCIdentifier"><a href="matching.ml.html#L3846" title="ocaml/lambda/matching.ml:3846">size</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">transl_structure</span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span> <span class="ocamlLCIdentifier"><a href="#L614" title="ocaml/lambda/translmod.ml:614">ext_fields</a></span> <span class="ocamlLCIdentifier">cc</span> <span class="ocamlLCIdentifier">rootpath</span> <span class="ocamlLCIdentifier">final_env</span> <span class="ocamlLCIdentifier">rem<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">in<br/></li>
<li><a id="L686">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">lam</span></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L405" title="ocaml/lambda/translmod.ml:405">compile_recmodule</a></span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="Statement">(fun</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span> <span class="ocamlLCIdentifier"><a href="#L706" title="ocaml/lambda/translmod.ml:706">modl</a></span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">match</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span> <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">None</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L37" title="ocaml/lambda/translcore.ml:37">transl_module</a></span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="Constant">Tcoerce_none</span> <span class="Constant">None</span> <span class="ocamlLCIdentifier"><a href="#L706" title="ocaml/lambda/translmod.ml:706">modl</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Some</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L37" title="ocaml/lambda/translcore.ml:37">transl_module</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span>:<span class="Statement">(</span><span class="ocamlLCIdentifier">enter_module_definition</span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">Tcoerce_none</span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L58" title="ocaml/lambda/translmod.ml:58">field_path</a></span> <span class="ocamlLCIdentifier">rootpath</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span><span class="Statement">)</span> <span class="ocamlLCIdentifier"><a href="#L706" title="ocaml/lambda/translmod.ml:706">modl</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">)</span> <span class="ocamlLCIdentifier">bindings</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L601" title="ocaml/lambda/translcore.ml:601">body</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="translobj.ml.html#L145" title="ocaml/lambda/translobj.ml:145">lam</a></span>, <span class="ocamlLCIdentifier"><a href="matching.ml.html#L3846" title="ocaml/lambda/matching.ml:3846">size</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_class</span> <span class="ocamlLCIdentifier">cl_list</span> <span class="Statement">-&gt;<br/></li>
<li><a id="L698">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><span class="linkable">ids</span></span>, <span class="ocamlLCIdentifier">class_bindings</span><span class="Statement">)</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">transl_class_bindings</span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier">cl_list</span> <span class="Statement">in<br/></li>
<li><a id="L699">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">body</span></span>, <span class="ocamlLCIdentifier"><a href="matching.ml.html#L3846" title="ocaml/lambda/matching.ml:3846">size</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">transl_structure</span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span> <span class="Statement">(</span><span class="PreProc">List</span>.<span class="ocamlLCIdentifier">rev_append</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L1050" title="ocaml/lambda/translcore.ml:1050">ids</a></span> <span class="ocamlLCIdentifier">fields</span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">cc</span> <span class="ocamlLCIdentifier">rootpath</span> <span class="ocamlLCIdentifier">final_env</span> <span class="ocamlLCIdentifier">rem<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">Lletrec</span><span class="Statement">(</span><span class="ocamlLCIdentifier">class_bindings</span>, <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L601" title="ocaml/lambda/translcore.ml:601">body</a></span><span class="Statement">)</span>, <span class="ocamlLCIdentifier"><a href="matching.ml.html#L3846" title="ocaml/lambda/matching.ml:3846">size</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_include</span> <span class="ocamlLCIdentifier">incl</span> <span class="Statement">-&gt;<br/></li>
<li><a id="L705">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">ids</span></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">bound_value_identifiers</span> <span class="ocamlLCIdentifier">incl</span>.<span class="ocamlLCIdentifier">incl_type</span> <span class="Statement">in<br/></li>
<li><a id="L706">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">modl</span></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">incl</span>.<span class="ocamlLCIdentifier">incl_mod</span> <span class="Statement">in<br/></li>
<li><a id="L707">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">mid</span></span> <span class="Statement">=</span> <span class="PreProc">Ident</span>.<span class="ocamlLCIdentifier">create_local</span> <span class="Constant">&quot;include&quot;</span> <span class="Statement">in<br/></li>
<li><a id="L708">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="Statement">rec</span> <span class="ocamlLCIdentifier"><span class="linkable">rebind_idents</span></span> <span class="ocamlLCIdentifier">pos</span> <span class="ocamlLCIdentifier">newfields</span> <span class="Statement">=</span> <span class="Statement">function<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">[]</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">transl_structure</span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span> <span class="ocamlLCIdentifier">newfields</span> <span class="ocamlLCIdentifier">cc</span> <span class="ocamlLCIdentifier">rootpath</span> <span class="ocamlLCIdentifier">final_env</span> <span class="ocamlLCIdentifier">rem<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span> <span class="Statement">::</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L1050" title="ocaml/lambda/translcore.ml:1050">ids</a></span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L601" title="ocaml/lambda/translcore.ml:601">body</a></span>, <span class="ocamlLCIdentifier"><a href="matching.ml.html#L3846" title="ocaml/lambda/matching.ml:3846">size</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L708" title="ocaml/lambda/translmod.ml:708">rebind_idents</a></span> <span class="Statement">(</span><span class="ocamlLCIdentifier">pos</span> + <span class="Constant">1</span><span class="Statement">)</span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span> <span class="Statement">::</span> <span class="ocamlLCIdentifier">newfields</span><span class="Statement">)</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L1050" title="ocaml/lambda/translcore.ml:1050">ids</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">Llet</span><span class="Statement">(</span><span class="Constant">Alias</span>, <span class="Constant">Pgenval</span>, <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">Lprim</span><span class="Statement">(</span><span class="Constant">Pfield</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">pos</span>, <span class="Constant">Pointer</span>, <span class="Constant">Mutable</span><span class="Statement">)</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">[</span><span class="Constant">Lvar</span> <span class="ocamlLCIdentifier"><a href="#L707" title="ocaml/lambda/translmod.ml:707">mid</a></span><span class="Statement">]</span>, <span class="ocamlLCIdentifier"><a href="debuginfo.ml.html#L85" title="ocaml/lambda/debuginfo.ml:85">of_location</a></span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier">incl</span>.<span class="ocamlLCIdentifier">incl_loc</span><span class="Statement">)</span>, <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L601" title="ocaml/lambda/translcore.ml:601">body</a></span><span class="Statement">)</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="matching.ml.html#L3846" title="ocaml/lambda/matching.ml:3846">size</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">in<br/></li>
<li><a id="L720">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">body</span></span>, <span class="ocamlLCIdentifier"><a href="matching.ml.html#L3846" title="ocaml/lambda/matching.ml:3846">size</a></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="#L708" title="ocaml/lambda/translmod.ml:708">rebind_idents</a></span> <span class="Constant">0</span> <span class="ocamlLCIdentifier">fields</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L1050" title="ocaml/lambda/translcore.ml:1050">ids</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">Llet</span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="translcore.ml.html#L614" title="ocaml/lambda/translcore.ml:614">pure_module</a></span> <span class="ocamlLCIdentifier"><a href="#L706" title="ocaml/lambda/translmod.ml:706">modl</a></span>, <span class="Constant">Pgenval</span>, <span class="ocamlLCIdentifier"><a href="#L707" title="ocaml/lambda/translmod.ml:707">mid</a></span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L37" title="ocaml/lambda/translcore.ml:37">transl_module</a></span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="Constant">Tcoerce_none</span> <span class="Constant">None</span> <span class="ocamlLCIdentifier"><a href="#L706" title="ocaml/lambda/translmod.ml:706">modl</a></span>, <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L601" title="ocaml/lambda/translcore.ml:601">body</a></span><span class="Statement">)</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="matching.ml.html#L3846" title="ocaml/lambda/matching.ml:3846">size</a><br/></li>
<li></span><br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_open</span> <span class="ocamlLCIdentifier">od</span> <span class="Statement">-&gt;<br/></li>
<li><a id="L726">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">pure</span></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L614" title="ocaml/lambda/translcore.ml:614">pure_module</a></span> <span class="ocamlLCIdentifier">od</span>.<span class="ocamlLCIdentifier">open_expr</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">(* this optimization shouldn'<a href="debuginfo.ml.html#L79" title="ocaml/lambda/debuginfo.ml:79">t</a> be needed because Simplif would<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; actually <a href="matching.ml.html#L867" title="ocaml/lambda/matching.ml:867">remove</a> the [Llet] when it'<a href="translclass.ml.html#L563" title="ocaml/lambda/translclass.ml:563">s</a> not used.<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; But since [<a href="#L765" title="ocaml/lambda/translmod.ml:765">scan_used_globals</a>] runs before Simplif, we need to do<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; it. *)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">begin</span><span class="ocamlEnd"> </span><span class="Statement">match</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">od</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">open_bound_items</span><span class="ocamlEnd"> </span><span class="Statement">with<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Constant">[]</span><span class="ocamlEnd"> </span><span class="Statement">when</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="translcore.ml.html#L592" title="ocaml/lambda/translcore.ml:592">pure</a></span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="Constant">Alias</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier">transl_structure</span><span class="ocamlEnd"> </span><span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">fields</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">cc</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">rootpath</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">final_env</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">rem<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Statement">_</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;<br/></li>
<li><a id="L735">&#x200c;</a></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><span class="linkable">ids</span></span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">bound_value_identifiers</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">od</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">open_bound_items</span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li><a id="L736">&#x200c;</a></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><span class="linkable">mid</span></span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="PreProc">Ident</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">create_local</span><span class="ocamlEnd"> </span><span class="Constant">&quot;<a href="matching.ml.html#L419" title="ocaml/lambda/matching.ml:419">open</a>&quot;</span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li><a id="L737">&#x200c;</a></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="Statement">rec</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><span class="linkable">rebind_idents</span></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">pos</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">newfields</span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="Statement">function<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Constant">[]</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">transl_structure<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">newfields</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">cc</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">rootpath</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">final_env</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">rem<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span><span class="ocamlEnd"> </span><span class="Statement">::</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="translcore.ml.html#L1050" title="ocaml/lambda/translcore.ml:1050">ids</a></span><span class="ocamlEnd"> </span><span class="Statement">-&gt;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="translcore.ml.html#L601" title="ocaml/lambda/translcore.ml:601">body</a></span><span class="ocamlEnd">, </span><span class="ocamlLCIdentifier"><a href="matching.ml.html#L3846" title="ocaml/lambda/matching.ml:3846">size</a></span><span class="ocamlEnd"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="#L708" title="ocaml/lambda/translmod.ml:708">rebind_idents</a></span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">pos</span><span class="ocamlEnd"> + </span><span class="Constant">1</span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span><span class="ocamlEnd"> </span><span class="Statement">::</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">newfields</span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="translcore.ml.html#L1050" title="ocaml/lambda/translcore.ml:1050">ids</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Constant">Llet</span><span class="Statement">(</span><span class="Constant">Alias</span><span class="ocamlEnd">, </span><span class="Constant">Pgenval</span><span class="ocamlEnd">, </span><span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span><span class="ocamlEnd">,<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Constant">Lprim</span><span class="Statement">(</span><span class="Constant">Pfield</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">pos</span><span class="ocamlEnd">, </span><span class="Constant">Pointer</span><span class="ocamlEnd">, </span><span class="Constant">Mutable</span><span class="Statement">)</span><span class="ocamlEnd">, </span><span class="Statement">[</span><span class="Constant">Lvar</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L707" title="ocaml/lambda/translmod.ml:707">mid</a></span><span class="Statement">]</span><span class="ocamlEnd">,<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="debuginfo.ml.html#L85" title="ocaml/lambda/debuginfo.ml:85">of_location</a></span><span class="ocamlEnd"> </span><span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">od</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">open_loc</span><span class="Statement">)</span><span class="ocamlEnd">, </span><span class="ocamlLCIdentifier"><a href="translcore.ml.html#L601" title="ocaml/lambda/translcore.ml:601">body</a></span><span class="Statement">)</span><span class="ocamlEnd">,<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="matching.ml.html#L3846" title="ocaml/lambda/matching.ml:3846">size</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">in<br/></li>
<li><a id="L749">&#x200c;</a></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><span class="linkable">body</span></span><span class="ocamlEnd">, </span><span class="ocamlLCIdentifier"><a href="matching.ml.html#L3846" title="ocaml/lambda/matching.ml:3846">size</a></span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L708" title="ocaml/lambda/translmod.ml:708">rebind_idents</a></span><span class="ocamlEnd"> </span><span class="Constant">0</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">fields</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="translcore.ml.html#L1050" title="ocaml/lambda/translcore.ml:1050">ids</a></span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Constant">Llet</span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="translcore.ml.html#L592" title="ocaml/lambda/translcore.ml:592">pure</a></span><span class="ocamlEnd">, </span><span class="Constant">Pgenval</span><span class="ocamlEnd">, </span><span class="ocamlLCIdentifier"><a href="#L707" title="ocaml/lambda/translmod.ml:707">mid</a></span><span class="ocamlEnd">,<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="ocamlLCIdentifier"><a href="translcore.ml.html#L37" title="ocaml/lambda/translcore.ml:37">transl_module</a></span><span class="ocamlEnd"> </span><span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span><span class="ocamlEnd"> </span><span class="Constant">Tcoerce_none</span><span class="ocamlEnd"> </span><span class="Constant">None</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">od</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">open_expr</span><span class="ocamlEnd">, </span><span class="ocamlLCIdentifier"><a href="translcore.ml.html#L601" title="ocaml/lambda/translcore.ml:601">body</a></span><span class="Statement">)</span><span class="ocamlEnd">,<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="matching.ml.html#L3846" title="ocaml/lambda/matching.ml:3846">size</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">end<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_modtype</span> <span class="Statement">_<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_class_type</span> <span class="Statement">_<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_attribute</span> <span class="Statement">_</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">transl_structure</span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span> <span class="ocamlLCIdentifier">fields</span> <span class="ocamlLCIdentifier">cc</span> <span class="ocamlLCIdentifier">rootpath</span> <span class="ocamlLCIdentifier">final_env</span> <span class="ocamlLCIdentifier">rem<br/></li>
<li></span><br/></li>
<li><span class="Comment">(* Update forward declaration in Translcore *)<br/></li>
<li></span><span class="Statement">let</span> <span class="Statement">_</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="PreProc">Translcore</span>.<span class="ocamlLCIdentifier"><a href="translcore.ml.html#L37" title="ocaml/lambda/translcore.ml:37">transl_module</a></span> <span class="Statement">:=</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L37" title="ocaml/lambda/translcore.ml:37">transl_module</a><br/></li>
<li></span><br/></li>
<li><span class="Comment">(* Introduce dependencies on modules referenced only by &quot;external&quot;. *)<br/></li>
<li></span><br/></li>
<li><a id="L765">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">scan_used_globals</span></span> <span class="ocamlLCIdentifier"><a href="translobj.ml.html#L145" title="ocaml/lambda/translobj.ml:145">lam</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">is_compunit</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span> <span class="Statement">=</span> <span class="Statement">not</span> <span class="Statement">(</span><span class="PreProc">Ident</span>.<span class="ocamlLCIdentifier">is_predef</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span><span class="Statement">)</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">globals</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">ref</span> <span class="PreProc">Ident</span>.<span class="PreProc">Set</span>.<span class="ocamlLCIdentifier"><a href="matching.ml.html#L533" title="ocaml/lambda/matching.ml:533">empty</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="Statement">rec</span> <span class="ocamlLCIdentifier">scan</span> <span class="ocamlLCIdentifier"><a href="translobj.ml.html#L145" title="ocaml/lambda/translobj.ml:145">lam</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Lambda</span>.<span class="ocamlLCIdentifier"><a href="lambda.mli.html#L380" title="ocaml/lambda/lambda.mli:380">iter_head_constructor</a></span> <span class="ocamlLCIdentifier">scan</span> <span class="ocamlLCIdentifier"><a href="translobj.ml.html#L145" title="ocaml/lambda/translobj.ml:145">lam</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">match</span> <span class="ocamlLCIdentifier"><a href="translobj.ml.html#L145" title="ocaml/lambda/translobj.ml:145">lam</a></span> <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Constant">Lprim</span> <span class="Statement">((</span><span class="Constant">Pgetglobal</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span> <span class="Statement">|</span> <span class="Constant">Psetglobal</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span><span class="Statement">)</span>, <span class="Statement">_</span>, <span class="Statement">_)</span> <span class="Statement">when</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">is_compunit</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span><span class="Statement">)</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">globals</span> <span class="Statement">:=</span> <span class="PreProc">Ident</span>.<span class="PreProc">Set</span>.<span class="ocamlLCIdentifier"><a href="matching.ml.html#L884" title="ocaml/lambda/matching.ml:884">add</a></span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span> <span class="Statement">!</span><span class="ocamlLCIdentifier">globals<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Statement">_</span> <span class="Statement">-&gt;</span> <span class="Constant">()<br/></li>
<li></span>&nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier">scan</span> <span class="ocamlLCIdentifier"><a href="translobj.ml.html#L145" title="ocaml/lambda/translobj.ml:145">lam</a></span><span class="Statement">;</span> <span class="Statement">!</span><span class="ocamlLCIdentifier">globals<br/></li>
<li></span><br/></li>
<li><a id="L777">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">required_globals</span></span> <span class="Statement">~</span><span class="Identifier">flambda</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L601" title="ocaml/lambda/translcore.ml:601">body</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">globals</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="#L765" title="ocaml/lambda/translmod.ml:765">scan_used_globals</a></span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L601" title="ocaml/lambda/translcore.ml:601">body</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">add_global</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span> <span class="ocamlLCIdentifier">req</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="Statement">not</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">flambda</span><span class="ocamlNone"> </span><span class="Statement">&amp;&amp;</span><span class="ocamlNone"> </span><span class="PreProc">Ident</span><span class="ocamlNone">.</span><span class="PreProc">Set</span><span class="ocamlNone">.</span><span class="ocamlLCIdentifier">mem</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">globals</span><span class="ocamlNone"> </span><span class="Statement">then<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">req<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="PreProc">Ident</span>.<span class="PreProc">Set</span>.<span class="ocamlLCIdentifier"><a href="matching.ml.html#L884" title="ocaml/lambda/matching.ml:884">add</a></span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span> <span class="ocamlLCIdentifier">req<br/></li>
<li></span>&nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">required</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">List</span>.<span class="ocamlLCIdentifier">fold_left<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">(fun</span> <span class="ocamlLCIdentifier">acc</span> <span class="ocamlLCIdentifier"><a href="translclass.ml.html#L444" title="ocaml/lambda/translclass.ml:444">path</a></span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier">add_global</span> <span class="Statement">(</span><span class="PreProc">Path</span>.<span class="ocamlLCIdentifier"><a href="matching.ml.html#L263" title="ocaml/lambda/matching.ml:263">head</a></span> <span class="ocamlLCIdentifier"><a href="translclass.ml.html#L444" title="ocaml/lambda/translclass.ml:444">path</a></span><span class="Statement">)</span> <span class="ocamlLCIdentifier">acc</span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">(if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">flambda</span><span class="ocamlNone"> </span><span class="Statement">then</span> <span class="ocamlLCIdentifier">globals</span> <span class="Statement">else</span> <span class="PreProc">Ident</span>.<span class="PreProc">Set</span>.<span class="ocamlLCIdentifier"><a href="matching.ml.html#L533" title="ocaml/lambda/matching.ml:533">empty</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="PreProc">Translprim</span>.<span class="ocamlLCIdentifier"><a href="translprim.mli.html#L30" title="ocaml/lambda/translprim.mli:30">get_used_primitives</a></span> <span class="Constant">()</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">required</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">List</span>.<span class="ocamlLCIdentifier">fold_right</span> <span class="ocamlLCIdentifier">add_global</span> <span class="Statement">(</span><span class="PreProc">Env</span>.<span class="ocamlLCIdentifier">get_required_globals</span> <span class="Constant">()</span><span class="Statement">)</span> <span class="ocamlLCIdentifier">required<br/></li>
<li></span>&nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="PreProc">Env</span>.<span class="ocamlLCIdentifier">reset_required_globals</span> <span class="Constant">()</span><span class="Statement">;<br/></li>
<li></span>&nbsp; <span class="PreProc">Translprim</span>.<span class="ocamlLCIdentifier"><a href="translprim.mli.html#L29" title="ocaml/lambda/translprim.mli:29">clear_used_primitives</a></span> <span class="Constant">()</span><span class="Statement">;<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier">required<br/></li>
<li></span><br/></li>
<li><span class="Comment">(* Compile an implementation *)<br/></li>
<li></span><br/></li>
<li><span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="translmod.mli.html#L28" title="ocaml/lambda/translmod.mli:28">transl_implementation_flambda</a></span> <span class="ocamlLCIdentifier"><a href="translprim.ml.html#L648" title="ocaml/lambda/translprim.ml:648">module_name</a></span> <span class="Statement">(</span><span class="ocamlLCIdentifier">str</span>, <span class="ocamlLCIdentifier">cc</span><span class="Statement">)</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier"><a href="translobj.ml.html#L77" title="ocaml/lambda/translobj.ml:77">reset_labels</a></span> <span class="Constant">()</span><span class="Statement">;<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier"><a href="translmod.mli.html#L43" title="ocaml/lambda/translmod.mli:43">primitive_declarations</a></span> <span class="Statement">:=</span> <span class="Constant">[]</span><span class="Statement">;<br/></li>
<li></span>&nbsp; <span class="PreProc">Translprim</span>.<span class="ocamlLCIdentifier"><a href="translprim.mli.html#L29" title="ocaml/lambda/translprim.mli:29">clear_used_primitives</a></span> <span class="Constant">()</span><span class="Statement">;<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">module_id</span> <span class="Statement">=</span> <span class="PreProc">Ident</span>.<span class="ocamlLCIdentifier">create_persistent</span> <span class="ocamlLCIdentifier"><a href="translprim.ml.html#L648" title="ocaml/lambda/translprim.ml:648">module_name</a></span> <span class="Statement">in<br/></li>
<li><a id="L805">&#x200c;</a></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">scopes</span></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">enter_module_definition</span> <span class="Statement">~</span><span class="Identifier"><span class="linkable">scopes</span></span>:<span class="ocamlLCIdentifier"><a href="debuginfo.ml.html#L39" title="ocaml/lambda/debuginfo.ml:39">empty_scopes</a></span> <span class="ocamlLCIdentifier">module_id</span> <span class="Statement">in<br/></li>
<li><a id="L806">&#x200c;</a></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">body</span></span>, <span class="ocamlLCIdentifier"><a href="matching.ml.html#L3846" title="ocaml/lambda/matching.ml:3846">size</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Translobj</span>.<span class="ocamlLCIdentifier"><a href="translobj.ml.html#L148" title="ocaml/lambda/translobj.ml:148">transl_label_init</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">(fun</span> <span class="Constant">()</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier">transl_struct</span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="Constant">Loc_unknown</span> <span class="Constant">[]</span> <span class="ocamlLCIdentifier">cc<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L53" title="ocaml/lambda/translmod.ml:53">global_path</a></span> <span class="ocamlLCIdentifier">module_id</span><span class="Statement">)</span> <span class="ocamlLCIdentifier">str</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">{</span> <span class="ocamlLCIdentifier">module_ident</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">module_id</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier">main_module_block_size</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="matching.ml.html#L3846" title="ocaml/lambda/matching.ml:3846">size</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L777" title="ocaml/lambda/translmod.ml:777">required_globals</a></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="#L777" title="ocaml/lambda/translmod.ml:777">required_globals</a></span> <span class="Statement">~</span><span class="Identifier">flambda</span>:<span class="Constant">true</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L601" title="ocaml/lambda/translcore.ml:601">body</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier">code</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L601" title="ocaml/lambda/translcore.ml:601">body</a></span> <span class="Statement">}<br/></li>
<li></span><br/></li>
<li><a id="L816">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">transl_implementation</span></span> <span class="ocamlLCIdentifier"><a href="translprim.ml.html#L648" title="ocaml/lambda/translprim.ml:648">module_name</a></span> <span class="Statement">(</span><span class="ocamlLCIdentifier">str</span>, <span class="ocamlLCIdentifier">cc</span><span class="Statement">)</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">implementation</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="translmod.mli.html#L28" title="ocaml/lambda/translmod.mli:28">transl_implementation_flambda</a></span> <span class="ocamlLCIdentifier"><a href="translprim.ml.html#L648" title="ocaml/lambda/translprim.ml:648">module_name</a></span> <span class="Statement">(</span><span class="ocamlLCIdentifier">str</span>, <span class="ocamlLCIdentifier">cc</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">code</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">Lprim</span> <span class="Statement">(</span><span class="Constant">Psetglobal</span> <span class="ocamlLCIdentifier">implementation</span>.<span class="ocamlLCIdentifier">module_ident</span>, <span class="Statement">[</span><span class="ocamlLCIdentifier">implementation</span>.<span class="ocamlLCIdentifier">code</span><span class="Statement">]</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">Loc_unknown</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">{</span> <span class="ocamlLCIdentifier">implementation</span> <span class="Statement">with</span> <span class="ocamlLCIdentifier">code</span> <span class="Statement">}<br/></li>
<li></span><br/></li>
<li><span class="Comment">(* Build the <a href="tmc.ml.html#L478" title="ocaml/lambda/tmc.ml:478">list</a> of value identifiers defined by a toplevel structure<br/></li>
<li></span><span class="Comment">&nbsp;&nbsp; (excluding <a href="matching.ml.html#L2324" title="ocaml/lambda/matching.ml:2324">primitive</a> declarations). *)<br/></li>
<li></span><br/></li>
<li><a id="L829">&#x200c;</a><span class="Statement">let</span> <span class="Statement">rec</span> <span class="ocamlLCIdentifier"><span class="linkable">defined_idents</span></span> <span class="Statement">=</span> <span class="Statement">function<br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">[]</span> <span class="Statement">-&gt;</span> <span class="Constant">[]<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="ocamlLCIdentifier"><a href="debuginfo.mli.html#L38" title="ocaml/lambda/debuginfo.mli:38">item</a></span> <span class="Statement">::</span> <span class="ocamlLCIdentifier">rem</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">match</span> <span class="ocamlLCIdentifier"><a href="debuginfo.mli.html#L38" title="ocaml/lambda/debuginfo.mli:38">item</a></span>.<span class="ocamlLCIdentifier">str_desc</span> <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_eval</span> <span class="Statement">_</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier"><a href="#L829" title="ocaml/lambda/translmod.ml:829">defined_idents</a></span> <span class="ocamlLCIdentifier">rem<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_value</span><span class="Statement">(</span><span class="ocamlLCIdentifier">_rec_flag</span>, <span class="ocamlLCIdentifier">pat_expr_list</span><span class="Statement">)</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">let_bound_idents</span> <span class="ocamlLCIdentifier">pat_expr_list</span> @ <span class="ocamlLCIdentifier"><a href="#L829" title="ocaml/lambda/translmod.ml:829">defined_idents</a></span> <span class="ocamlLCIdentifier">rem<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_primitive</span> <span class="Statement">_</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier"><a href="#L829" title="ocaml/lambda/translmod.ml:829">defined_idents</a></span> <span class="ocamlLCIdentifier">rem<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_type</span> <span class="Statement">_</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier"><a href="#L829" title="ocaml/lambda/translmod.ml:829">defined_idents</a></span> <span class="ocamlLCIdentifier">rem<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_typext</span> <span class="ocamlLCIdentifier">tyext</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="PreProc">List</span>.<span class="ocamlLCIdentifier"><a href="matching.ml.html#L922" title="ocaml/lambda/matching.ml:922">map</a></span> <span class="Statement">(fun</span> <span class="ocamlLCIdentifier">ext</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier">ext</span>.<span class="ocamlLCIdentifier">ext_id</span><span class="Statement">)</span> <span class="ocamlLCIdentifier">tyext</span>.<span class="ocamlLCIdentifier">tyext_constructors<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; @ <span class="ocamlLCIdentifier"><a href="#L829" title="ocaml/lambda/translmod.ml:829">defined_idents</a></span> <span class="ocamlLCIdentifier">rem<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_exception</span> <span class="ocamlLCIdentifier">ext</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier">ext</span>.<span class="ocamlLCIdentifier">tyexn_constructor</span>.<span class="ocamlLCIdentifier">ext_id</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier"><a href="#L829" title="ocaml/lambda/translmod.ml:829">defined_idents</a></span> <span class="ocamlLCIdentifier">rem<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_module</span> <span class="Statement">{</span><span class="ocamlLCIdentifier">mb_id</span> <span class="Statement">=</span> <span class="Constant">Some</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span><span class="Statement">;</span> <span class="ocamlLCIdentifier">mb_presence</span><span class="Statement">=</span><span class="Constant">Mp_present</span><span class="Statement">}</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span> <span class="Statement">::</span> <span class="ocamlLCIdentifier"><a href="#L829" title="ocaml/lambda/translmod.ml:829">defined_idents</a></span> <span class="ocamlLCIdentifier">rem<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_module</span> <span class="Statement">({</span><span class="ocamlLCIdentifier">mb_id</span> <span class="Statement">=</span> <span class="Constant">None</span><span class="Statement">}<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">|{</span><span class="ocamlLCIdentifier">mb_presence</span><span class="Statement">=</span><span class="Constant">Mp_absent</span><span class="Statement">})</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier"><a href="#L829" title="ocaml/lambda/translmod.ml:829">defined_idents</a></span> <span class="ocamlLCIdentifier">rem<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_recmodule</span> <span class="ocamlLCIdentifier">decls</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="PreProc">List</span>.<span class="ocamlLCIdentifier">filter_map</span> <span class="Statement">(fun</span> <span class="ocamlLCIdentifier">mb</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier">mb</span>.<span class="ocamlLCIdentifier">mb_id</span><span class="Statement">)</span> <span class="ocamlLCIdentifier">decls</span> @ <span class="ocamlLCIdentifier"><a href="#L829" title="ocaml/lambda/translmod.ml:829">defined_idents</a></span> <span class="ocamlLCIdentifier">rem<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_modtype</span> <span class="Statement">_</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier"><a href="#L829" title="ocaml/lambda/translmod.ml:829">defined_idents</a></span> <span class="ocamlLCIdentifier">rem<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_open</span> <span class="ocamlLCIdentifier">od</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">bound_value_identifiers</span> <span class="ocamlLCIdentifier">od</span>.<span class="ocamlLCIdentifier">open_bound_items</span> @ <span class="ocamlLCIdentifier"><a href="#L829" title="ocaml/lambda/translmod.ml:829">defined_idents</a></span> <span class="ocamlLCIdentifier">rem<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_class</span> <span class="ocamlLCIdentifier">cl_list</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="PreProc">List</span>.<span class="ocamlLCIdentifier"><a href="matching.ml.html#L922" title="ocaml/lambda/matching.ml:922">map</a></span> <span class="Statement">(fun</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">ci</span>, <span class="Statement">_)</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier">ci</span>.<span class="ocamlLCIdentifier">ci_id_class</span><span class="Statement">)</span> <span class="ocamlLCIdentifier">cl_list</span> @ <span class="ocamlLCIdentifier"><a href="#L829" title="ocaml/lambda/translmod.ml:829">defined_idents</a></span> <span class="ocamlLCIdentifier">rem<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_class_type</span> <span class="Statement">_</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier"><a href="#L829" title="ocaml/lambda/translmod.ml:829">defined_idents</a></span> <span class="ocamlLCIdentifier">rem<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_include</span> <span class="ocamlLCIdentifier">incl</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">bound_value_identifiers</span> <span class="ocamlLCIdentifier">incl</span>.<span class="ocamlLCIdentifier">incl_type</span> @ <span class="ocamlLCIdentifier"><a href="#L829" title="ocaml/lambda/translmod.ml:829">defined_idents</a></span> <span class="ocamlLCIdentifier">rem<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_attribute</span> <span class="Statement">_</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier"><a href="#L829" title="ocaml/lambda/translmod.ml:829">defined_idents</a></span> <span class="ocamlLCIdentifier">rem<br/></li>
<li></span><br/></li>
<li><span class="Comment">(* second level idents (module M = struct ... let <a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a> = ... end),<br/></li>
<li></span><span class="Comment">&nbsp;&nbsp; and all sub-levels idents *)<br/></li>
<li><a id="L860">&#x200c;</a></span><span class="Statement">let</span> <span class="Statement">rec</span> <span class="ocamlLCIdentifier"><span class="linkable">more_idents</span></span> <span class="Statement">=</span> <span class="Statement">function<br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">[]</span> <span class="Statement">-&gt;</span> <span class="Constant">[]<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="ocamlLCIdentifier"><a href="debuginfo.mli.html#L38" title="ocaml/lambda/debuginfo.mli:38">item</a></span> <span class="Statement">::</span> <span class="ocamlLCIdentifier">rem</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">match</span> <span class="ocamlLCIdentifier"><a href="debuginfo.mli.html#L38" title="ocaml/lambda/debuginfo.mli:38">item</a></span>.<span class="ocamlLCIdentifier">str_desc</span> <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_eval</span> <span class="Statement">_</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier"><a href="#L860" title="ocaml/lambda/translmod.ml:860">more_idents</a></span> <span class="ocamlLCIdentifier">rem<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_value</span> <span class="Statement">_</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier"><a href="#L860" title="ocaml/lambda/translmod.ml:860">more_idents</a></span> <span class="ocamlLCIdentifier">rem<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_primitive</span> <span class="Statement">_</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier"><a href="#L860" title="ocaml/lambda/translmod.ml:860">more_idents</a></span> <span class="ocamlLCIdentifier">rem<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_type</span> <span class="Statement">_</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier"><a href="#L860" title="ocaml/lambda/translmod.ml:860">more_idents</a></span> <span class="ocamlLCIdentifier">rem<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_typext</span> <span class="Statement">_</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier"><a href="#L860" title="ocaml/lambda/translmod.ml:860">more_idents</a></span> <span class="ocamlLCIdentifier">rem<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_exception</span> <span class="Statement">_</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier"><a href="#L860" title="ocaml/lambda/translmod.ml:860">more_idents</a></span> <span class="ocamlLCIdentifier">rem<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_recmodule</span> <span class="Statement">_</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier"><a href="#L860" title="ocaml/lambda/translmod.ml:860">more_idents</a></span> <span class="ocamlLCIdentifier">rem<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_modtype</span> <span class="Statement">_</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier"><a href="#L860" title="ocaml/lambda/translmod.ml:860">more_idents</a></span> <span class="ocamlLCIdentifier">rem<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_open</span> <span class="ocamlLCIdentifier">od</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">rest</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="#L860" title="ocaml/lambda/translmod.ml:860">more_idents</a></span> <span class="ocamlLCIdentifier">rem</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">begin</span><span class="ocamlEnd"> </span><span class="Statement">match</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">od</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">open_expr</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">mod_desc</span><span class="ocamlEnd"> </span><span class="Statement">with<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Constant">Tmod_structure</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">str</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">all_idents</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">str</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">str_items</span><span class="ocamlEnd"> @ </span><span class="ocamlLCIdentifier">rest<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Statement">_</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">rest<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">end<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_class</span> <span class="Statement">_</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier"><a href="#L860" title="ocaml/lambda/translmod.ml:860">more_idents</a></span> <span class="ocamlLCIdentifier">rem<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_class_type</span> <span class="Statement">_</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier"><a href="#L860" title="ocaml/lambda/translmod.ml:860">more_idents</a></span> <span class="ocamlLCIdentifier">rem<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_include</span><span class="Statement">{</span><span class="ocamlLCIdentifier">incl_mod</span><span class="Statement">={</span><span class="ocamlLCIdentifier">mod_desc</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">Tmod_constraint</span> <span class="Statement">({</span><span class="ocamlLCIdentifier">mod_desc</span> <span class="Statement">=</span> <span class="Constant">Tmod_structure</span> <span class="ocamlLCIdentifier">str</span><span class="Statement">}</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">_</span>, <span class="Statement">_</span>, <span class="Statement">_)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tmod_structure</span> <span class="ocamlLCIdentifier">str</span> <span class="Statement">}}</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">all_idents</span> <span class="ocamlLCIdentifier">str</span>.<span class="ocamlLCIdentifier">str_items</span> @ <span class="ocamlLCIdentifier"><a href="#L860" title="ocaml/lambda/translmod.ml:860">more_idents</a></span> <span class="ocamlLCIdentifier">rem<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_include</span> <span class="Statement">_</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier"><a href="#L860" title="ocaml/lambda/translmod.ml:860">more_idents</a></span> <span class="ocamlLCIdentifier">rem<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_module<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">{</span><span class="ocamlLCIdentifier">mb_presence</span><span class="Statement">=</span><span class="Constant">Mp_present</span><span class="Statement">;</span> <span class="ocamlLCIdentifier">mb_expr</span><span class="Statement">={</span><span class="ocamlLCIdentifier">mod_desc</span> <span class="Statement">=</span> <span class="Constant">Tmod_structure</span> <span class="ocamlLCIdentifier">str</span><span class="Statement">}}<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_module<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">{</span><span class="ocamlLCIdentifier">mb_presence</span><span class="Statement">=</span><span class="Constant">Mp_present</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier">mb_expr</span><span class="Statement">={</span><span class="ocamlLCIdentifier">mod_desc</span><span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">Tmod_constraint</span> <span class="Statement">({</span><span class="ocamlLCIdentifier">mod_desc</span> <span class="Statement">=</span> <span class="Constant">Tmod_structure</span> <span class="ocamlLCIdentifier">str</span><span class="Statement">}</span>, <span class="Statement">_</span>, <span class="Statement">_</span>, <span class="Statement">_)}}</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">all_idents</span> <span class="ocamlLCIdentifier">str</span>.<span class="ocamlLCIdentifier">str_items</span> @ <span class="ocamlLCIdentifier"><a href="#L860" title="ocaml/lambda/translmod.ml:860">more_idents</a></span> <span class="ocamlLCIdentifier">rem<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_module</span> <span class="Statement">_</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier"><a href="#L860" title="ocaml/lambda/translmod.ml:860">more_idents</a></span> <span class="ocamlLCIdentifier">rem<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_attribute</span> <span class="Statement">_</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier"><a href="#L860" title="ocaml/lambda/translmod.ml:860">more_idents</a></span> <span class="ocamlLCIdentifier">rem<br/></li>
<li></span><br/></li>
<li><span class="Statement">and</span> <span class="ocamlLCIdentifier">all_idents</span> <span class="Statement">=</span> <span class="Statement">function<br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">[]</span> <span class="Statement">-&gt;</span> <span class="Constant">[]<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="ocamlLCIdentifier"><a href="debuginfo.mli.html#L38" title="ocaml/lambda/debuginfo.mli:38">item</a></span> <span class="Statement">::</span> <span class="ocamlLCIdentifier">rem</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">match</span> <span class="ocamlLCIdentifier"><a href="debuginfo.mli.html#L38" title="ocaml/lambda/debuginfo.mli:38">item</a></span>.<span class="ocamlLCIdentifier">str_desc</span> <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_eval</span> <span class="Statement">_</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier">all_idents</span> <span class="ocamlLCIdentifier">rem<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_value</span><span class="Statement">(</span><span class="ocamlLCIdentifier">_rec_flag</span>, <span class="ocamlLCIdentifier">pat_expr_list</span><span class="Statement">)</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">let_bound_idents</span> <span class="ocamlLCIdentifier">pat_expr_list</span> @ <span class="ocamlLCIdentifier">all_idents</span> <span class="ocamlLCIdentifier">rem<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_primitive</span> <span class="Statement">_</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier">all_idents</span> <span class="ocamlLCIdentifier">rem<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_type</span> <span class="Statement">_</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier">all_idents</span> <span class="ocamlLCIdentifier">rem<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_typext</span> <span class="ocamlLCIdentifier">tyext</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="PreProc">List</span>.<span class="ocamlLCIdentifier"><a href="matching.ml.html#L922" title="ocaml/lambda/matching.ml:922">map</a></span> <span class="Statement">(fun</span> <span class="ocamlLCIdentifier">ext</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier">ext</span>.<span class="ocamlLCIdentifier">ext_id</span><span class="Statement">)</span> <span class="ocamlLCIdentifier">tyext</span>.<span class="ocamlLCIdentifier">tyext_constructors<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; @ <span class="ocamlLCIdentifier">all_idents</span> <span class="ocamlLCIdentifier">rem<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_exception</span> <span class="ocamlLCIdentifier">ext</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier">ext</span>.<span class="ocamlLCIdentifier">tyexn_constructor</span>.<span class="ocamlLCIdentifier">ext_id</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier">all_idents</span> <span class="ocamlLCIdentifier">rem<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_recmodule</span> <span class="ocamlLCIdentifier">decls</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="PreProc">List</span>.<span class="ocamlLCIdentifier">filter_map</span> <span class="Statement">(fun</span> <span class="ocamlLCIdentifier">mb</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier">mb</span>.<span class="ocamlLCIdentifier">mb_id</span><span class="Statement">)</span> <span class="ocamlLCIdentifier">decls</span> @ <span class="ocamlLCIdentifier">all_idents</span> <span class="ocamlLCIdentifier">rem<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_modtype</span> <span class="Statement">_</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier">all_idents</span> <span class="ocamlLCIdentifier">rem<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_open</span> <span class="ocamlLCIdentifier">od</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">rest</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">all_idents</span> <span class="ocamlLCIdentifier">rem</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">begin</span><span class="ocamlEnd"> </span><span class="Statement">match</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">od</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">open_expr</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">mod_desc</span><span class="ocamlEnd"> </span><span class="Statement">with<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Constant">Tmod_structure</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">str</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier">bound_value_identifiers</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">od</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">open_bound_items<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; @ </span><span class="ocamlLCIdentifier">all_idents</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">str</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">str_items<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; @ </span><span class="ocamlLCIdentifier">rest<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Statement">_</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">bound_value_identifiers</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">od</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">open_bound_items</span><span class="ocamlEnd"> @ </span><span class="ocamlLCIdentifier">rest<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">end<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_class</span> <span class="ocamlLCIdentifier">cl_list</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="PreProc">List</span>.<span class="ocamlLCIdentifier"><a href="matching.ml.html#L922" title="ocaml/lambda/matching.ml:922">map</a></span> <span class="Statement">(fun</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">ci</span>, <span class="Statement">_)</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier">ci</span>.<span class="ocamlLCIdentifier">ci_id_class</span><span class="Statement">)</span> <span class="ocamlLCIdentifier">cl_list</span> @ <span class="ocamlLCIdentifier">all_idents</span> <span class="ocamlLCIdentifier">rem<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_class_type</span> <span class="Statement">_</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier">all_idents</span> <span class="ocamlLCIdentifier">rem<br/></li>
<li></span><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_include</span><span class="Statement">{</span><span class="ocamlLCIdentifier">incl_type</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier">incl_mod</span><span class="Statement">={</span><span class="ocamlLCIdentifier">mod_desc</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">(</span> <span class="Constant">Tmod_constraint</span><span class="Statement">({</span><span class="ocamlLCIdentifier">mod_desc</span><span class="Statement">=</span><span class="Constant">Tmod_structure</span> <span class="ocamlLCIdentifier">str</span><span class="Statement">}</span>, <span class="Statement">_</span>, <span class="Statement">_</span>, <span class="Statement">_)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">|</span> <span class="Constant">Tmod_structure</span> <span class="ocamlLCIdentifier">str</span> <span class="Statement">)}}</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">bound_value_identifiers</span> <span class="ocamlLCIdentifier">incl_type<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; @ <span class="ocamlLCIdentifier">all_idents</span> <span class="ocamlLCIdentifier">str</span>.<span class="ocamlLCIdentifier">str_items<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; @ <span class="ocamlLCIdentifier">all_idents</span> <span class="ocamlLCIdentifier">rem<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_include</span> <span class="ocamlLCIdentifier">incl</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">bound_value_identifiers</span> <span class="ocamlLCIdentifier">incl</span>.<span class="ocamlLCIdentifier">incl_type</span> @ <span class="ocamlLCIdentifier">all_idents</span> <span class="ocamlLCIdentifier">rem<br/></li>
<li></span><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_module<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">{</span> <span class="ocamlLCIdentifier">mb_id</span> <span class="Statement">=</span> <span class="Constant">Some</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">mb_presence</span><span class="Statement">=</span><span class="Constant">Mp_present</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">mb_expr</span><span class="Statement">={</span><span class="ocamlLCIdentifier">mod_desc</span> <span class="Statement">=</span> <span class="Constant">Tmod_structure</span> <span class="ocamlLCIdentifier">str</span><span class="Statement">}</span> <span class="Statement">}<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_module<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">{</span> <span class="ocamlLCIdentifier">mb_id</span> <span class="Statement">=</span> <span class="Constant">Some</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">mb_presence</span> <span class="Statement">=</span> <span class="Constant">Mp_present</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">mb_expr</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">{</span><span class="ocamlLCIdentifier">mod_desc</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">Tmod_constraint</span> <span class="Statement">({</span><span class="ocamlLCIdentifier">mod_desc</span> <span class="Statement">=</span> <span class="Constant">Tmod_structure</span> <span class="ocamlLCIdentifier">str</span><span class="Statement">}</span>, <span class="Statement">_</span>, <span class="Statement">_</span>, <span class="Statement">_)}}</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span> <span class="Statement">::</span> <span class="ocamlLCIdentifier">all_idents</span> <span class="ocamlLCIdentifier">str</span>.<span class="ocamlLCIdentifier">str_items</span> @ <span class="ocamlLCIdentifier">all_idents</span> <span class="ocamlLCIdentifier">rem<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_module</span> <span class="Statement">{</span><span class="ocamlLCIdentifier">mb_id</span> <span class="Statement">=</span> <span class="Constant">Some</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span><span class="Statement">;</span><span class="ocamlLCIdentifier">mb_presence</span><span class="Statement">=</span><span class="Constant">Mp_present</span><span class="Statement">}</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span> <span class="Statement">::</span> <span class="ocamlLCIdentifier">all_idents</span> <span class="ocamlLCIdentifier">rem<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_module</span> <span class="Statement">({</span><span class="ocamlLCIdentifier">mb_id</span> <span class="Statement">=</span> <span class="Constant">None</span><span class="Statement">}</span> <span class="Statement">|</span> <span class="Statement">{</span><span class="ocamlLCIdentifier">mb_presence</span><span class="Statement">=</span><span class="Constant">Mp_absent</span><span class="Statement">})</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier">all_idents</span> <span class="ocamlLCIdentifier">rem<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_attribute</span> <span class="Statement">_</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier">all_idents</span> <span class="ocamlLCIdentifier">rem<br/></li>
<li></span><br/></li>
<li><br/></li>
<li><span class="Comment">(* A variant of transl_structure used to compile toplevel structure definitions<br/></li>
<li></span><span class="Comment">&nbsp;&nbsp; for the native-code compiler. Store the defined values in the fields<br/></li>
<li></span><span class="Comment">&nbsp;&nbsp; of the global as soon as they are defined, in order to reduce register<br/></li>
<li></span><span class="Comment">&nbsp;&nbsp; pressure.&nbsp; Also rewrites the defining expressions so that they<br/></li>
<li></span><span class="Comment">&nbsp;&nbsp; refer to earlier fields of the structure through the fields of<br/></li>
<li></span><span class="Comment">&nbsp;&nbsp; the global, not by their names.<br/></li>
<li></span><span class="Comment">&nbsp;&nbsp; &quot;<a href="matching.ml.html#L922" title="ocaml/lambda/matching.ml:922">map</a>&quot; is a <a href="translclass.ml.html#L769" title="ocaml/lambda/translclass.ml:769">table</a> from defined idents to (pos in global block, coercion).<br/></li>
<li></span><span class="Comment">&nbsp;&nbsp; &quot;<a href="translprim.ml.html#L80" title="ocaml/lambda/translprim.ml:80">prim</a>&quot; is a <a href="tmc.ml.html#L478" title="ocaml/lambda/tmc.ml:478">list</a> of (pos in global block, <a href="matching.ml.html#L2324" title="ocaml/lambda/matching.ml:2324">primitive</a> declaration). *)<br/></li>
<li></span><br/></li>
<li><a id="L961">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">transl_store_subst</span></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">ref</span> <span class="PreProc">Ident</span>.<span class="PreProc">Map</span>.<span class="ocamlLCIdentifier"><a href="matching.ml.html#L533" title="ocaml/lambda/matching.ml:533">empty</a><br/></li>
<li></span>&nbsp; <span class="Comment">(** In the native toplevel, this reference is threaded through successive<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; calls of <a href="#L985" title="ocaml/lambda/translmod.ml:985">transl_store_structure</a> *)<br/></li>
<li></span><br/></li>
<li><a id="L965">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">nat_toplevel_name</span></span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">try</span> <span class="Statement">match</span> <span class="PreProc">Ident</span>.<span class="PreProc">Map</span>.<span class="ocamlLCIdentifier">find</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span> <span class="Statement">!</span><span class="ocamlLCIdentifier"><a href="#L961" title="ocaml/lambda/translmod.ml:961">transl_store_subst</a></span> <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Lprim</span><span class="Statement">(</span><span class="Constant">Pfield</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">pos</span>, <span class="Statement">_</span>, <span class="Statement">_)</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">[</span><span class="Constant">Lprim</span><span class="Statement">(</span><span class="Constant">Pgetglobal</span> <span class="ocamlLCIdentifier">glob</span>, <span class="Constant">[]</span>, <span class="Statement">_)]</span>, <span class="Statement">_)</span> <span class="Statement">-&gt;</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">glob</span>,<span class="ocamlLCIdentifier">pos</span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Statement">_</span> <span class="Statement">-&gt;</span> <span class="Statement">raise</span> <span class="Constant">Not_found<br/></li>
<li></span>&nbsp; <span class="Statement">with</span> <span class="Constant">Not_found</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier">fatal_error</span><span class="Statement">(</span><span class="Constant">&quot;Translmod.<a href="translmod.mli.html#L41" title="ocaml/lambda/translmod.mli:41">nat_toplevel_name</a>: &quot;</span> <span class="Statement">^</span> <span class="PreProc">Ident</span>.<span class="ocamlLCIdentifier">unique_name</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li><a id="L973">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">field_of_str</span></span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span> <span class="ocamlLCIdentifier">str</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L1050" title="ocaml/lambda/translcore.ml:1050">ids</a></span> <span class="Statement">=</span> <span class="PreProc">Array</span>.<span class="ocamlLCIdentifier">of_list</span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L829" title="ocaml/lambda/translmod.ml:829">defined_idents</a></span> <span class="ocamlLCIdentifier">str</span>.<span class="ocamlLCIdentifier">str_items</span><span class="Statement">)</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">fun</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">pos</span>, <span class="ocamlLCIdentifier">cc</span><span class="Statement">)</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">match</span> <span class="ocamlLCIdentifier">cc</span> <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tcoerce_primitive</span> <span class="Statement">{</span> <span class="ocamlLCIdentifier">pc_loc</span> <span class="Statement">=</span> <span class="Statement">_;</span> <span class="ocamlLCIdentifier">pc_desc</span><span class="Statement">;</span> <span class="ocamlLCIdentifier">pc_env</span><span class="Statement">;</span> <span class="ocamlLCIdentifier">pc_type</span><span class="Statement">;</span> <span class="Statement">}</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="PreProc">Translprim</span>.<span class="ocamlLCIdentifier"><a href="translprim.mli.html#L35" title="ocaml/lambda/translprim.mli:35">transl_primitive</a></span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span> <span class="ocamlLCIdentifier">pc_desc</span> <span class="ocamlLCIdentifier">pc_env</span> <span class="ocamlLCIdentifier">pc_type</span> <span class="Constant">None<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tcoerce_alias</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">env</span>, <span class="ocamlLCIdentifier"><a href="translclass.ml.html#L444" title="ocaml/lambda/translclass.ml:444">path</a></span>, <span class="ocamlLCIdentifier">cc</span><span class="Statement">)</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="translobj.ml.html#L145" title="ocaml/lambda/translobj.ml:145">lam</a></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="lambda.mli.html#L403" title="ocaml/lambda/lambda.mli:403">transl_module_path</a></span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span> <span class="ocamlLCIdentifier">env</span> <span class="ocamlLCIdentifier"><a href="translclass.ml.html#L444" title="ocaml/lambda/translclass.ml:444">path</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">apply_coercion</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span> <span class="Constant">Alias</span> <span class="ocamlLCIdentifier">cc</span> <span class="ocamlLCIdentifier"><a href="translobj.ml.html#L145" title="ocaml/lambda/translobj.ml:145">lam</a><br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Statement">_</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier">apply_coercion</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span> <span class="Constant">Strict</span> <span class="ocamlLCIdentifier">cc</span> <span class="Statement">(</span><span class="Constant">Lvar</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L1050" title="ocaml/lambda/translcore.ml:1050">ids</a></span>.<span class="Statement">(</span><span class="ocamlLCIdentifier">pos</span><span class="Statement">))<br/></li>
<li></span><br/></li>
<li><br/></li>
<li><a id="L985">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">transl_store_structure</span></span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier">glob</span> <span class="ocamlLCIdentifier"><a href="matching.ml.html#L922" title="ocaml/lambda/matching.ml:922">map</a></span> <span class="ocamlLCIdentifier">prims</span> <span class="ocamlLCIdentifier">aliases</span> <span class="ocamlLCIdentifier">str</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="translclass.ml.html#L720" title="ocaml/lambda/translclass.ml:720">no_env_update</a></span> <span class="Statement">_</span> <span class="Statement">_</span> <span class="ocamlLCIdentifier">env</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">env</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="Statement">rec</span> <span class="ocamlLCIdentifier">transl_store</span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier">rootpath</span> <span class="ocamlLCIdentifier"><a href="simplif.ml.html#L475" title="ocaml/lambda/simplif.ml:475">subst</a></span> <span class="ocamlLCIdentifier">cont</span> <span class="Statement">=</span> <span class="Statement">function<br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">[]</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L961" title="ocaml/lambda/translmod.ml:961">transl_store_subst</a></span> <span class="Statement">:=</span> <span class="ocamlLCIdentifier"><a href="simplif.ml.html#L475" title="ocaml/lambda/simplif.ml:475">subst</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="PreProc">Lambda</span>.<span class="ocamlLCIdentifier"><a href="simplif.ml.html#L475" title="ocaml/lambda/simplif.ml:475">subst</a></span> <span class="ocamlLCIdentifier"><a href="translclass.ml.html#L720" title="ocaml/lambda/translclass.ml:720">no_env_update</a></span> <span class="ocamlLCIdentifier"><a href="simplif.ml.html#L475" title="ocaml/lambda/simplif.ml:475">subst</a></span> <span class="ocamlLCIdentifier">cont<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="ocamlLCIdentifier"><a href="debuginfo.mli.html#L38" title="ocaml/lambda/debuginfo.mli:38">item</a></span> <span class="Statement">::</span> <span class="ocamlLCIdentifier">rem</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">match</span> <span class="ocamlLCIdentifier"><a href="debuginfo.mli.html#L38" title="ocaml/lambda/debuginfo.mli:38">item</a></span>.<span class="ocamlLCIdentifier">str_desc</span> <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_eval</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">expr</span>, <span class="ocamlLCIdentifier">_attrs</span><span class="Statement">)</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">Lsequence</span><span class="Statement">(</span><span class="PreProc">Lambda</span>.<span class="ocamlLCIdentifier"><a href="simplif.ml.html#L475" title="ocaml/lambda/simplif.ml:475">subst</a></span> <span class="ocamlLCIdentifier"><a href="translclass.ml.html#L720" title="ocaml/lambda/translclass.ml:720">no_env_update</a></span> <span class="ocamlLCIdentifier"><a href="simplif.ml.html#L475" title="ocaml/lambda/simplif.ml:475">subst</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="translcore.ml.html#L216" title="ocaml/lambda/translcore.ml:216">transl_exp</a></span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier">expr</span><span class="Statement">)</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">transl_store</span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier">rootpath</span> <span class="ocamlLCIdentifier"><a href="simplif.ml.html#L475" title="ocaml/lambda/simplif.ml:475">subst</a></span> <span class="ocamlLCIdentifier">cont</span> <span class="ocamlLCIdentifier">rem</span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_value</span><span class="Statement">(</span><span class="ocamlLCIdentifier">rec_flag</span>, <span class="ocamlLCIdentifier">pat_expr_list</span><span class="Statement">)</span> <span class="Statement">-&gt;<br/></li>
<li><a id="L998">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">ids</span></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">let_bound_idents</span> <span class="ocamlLCIdentifier">pat_expr_list</span> <span class="Statement">in<br/></li>
<li><a id="L999">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">lam</span></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="translcore.mli.html#L33" title="ocaml/lambda/translcore.mli:33">transl_let</a></span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="Statement">~</span><span class="Identifier">in_structure</span>:<span class="Constant">true</span> <span class="ocamlLCIdentifier">rec_flag</span> <span class="ocamlLCIdentifier">pat_expr_list<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L1209" title="ocaml/lambda/translmod.ml:1209">store_idents</a></span> <span class="Constant">Loc_unknown</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L1050" title="ocaml/lambda/translcore.ml:1050">ids</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">Lsequence</span><span class="Statement">(</span><span class="PreProc">Lambda</span>.<span class="ocamlLCIdentifier"><a href="simplif.ml.html#L475" title="ocaml/lambda/simplif.ml:475">subst</a></span> <span class="ocamlLCIdentifier"><a href="translclass.ml.html#L720" title="ocaml/lambda/translclass.ml:720">no_env_update</a></span> <span class="ocamlLCIdentifier"><a href="simplif.ml.html#L475" title="ocaml/lambda/simplif.ml:475">subst</a></span> <span class="ocamlLCIdentifier"><a href="translobj.ml.html#L145" title="ocaml/lambda/translobj.ml:145">lam</a></span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">transl_store</span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier">rootpath<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="ocamlLCIdentifier">add_idents</span> <span class="Constant">false</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L1050" title="ocaml/lambda/translcore.ml:1050">ids</a></span> <span class="ocamlLCIdentifier"><a href="simplif.ml.html#L475" title="ocaml/lambda/simplif.ml:475">subst</a></span><span class="Statement">)</span> <span class="ocamlLCIdentifier">cont</span> <span class="ocamlLCIdentifier">rem</span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_primitive</span> <span class="ocamlLCIdentifier">descr</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L212" title="ocaml/lambda/translmod.ml:212">record_primitive</a></span> <span class="ocamlLCIdentifier">descr</span>.<span class="ocamlLCIdentifier">val_val</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">transl_store</span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier">rootpath</span> <span class="ocamlLCIdentifier"><a href="simplif.ml.html#L475" title="ocaml/lambda/simplif.ml:475">subst</a></span> <span class="ocamlLCIdentifier">cont</span> <span class="ocamlLCIdentifier">rem<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_type</span> <span class="Statement">_</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">transl_store</span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier">rootpath</span> <span class="ocamlLCIdentifier"><a href="simplif.ml.html#L475" title="ocaml/lambda/simplif.ml:475">subst</a></span> <span class="ocamlLCIdentifier">cont</span> <span class="ocamlLCIdentifier">rem<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_typext</span><span class="Statement">(</span><span class="ocamlLCIdentifier">tyext</span><span class="Statement">)</span> <span class="Statement">-&gt;<br/></li>
<li><a id="L1012">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">ids</span></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="PreProc">List</span>.<span class="ocamlLCIdentifier"><a href="matching.ml.html#L922" title="ocaml/lambda/matching.ml:922">map</a></span> <span class="Statement">(fun</span> <span class="ocamlLCIdentifier">ext</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier">ext</span>.<span class="ocamlLCIdentifier">ext_id</span><span class="Statement">)</span> <span class="ocamlLCIdentifier">tyext</span>.<span class="ocamlLCIdentifier">tyext_constructors<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">in<br/></li>
<li><a id="L1015">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">lam</span></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L65" title="ocaml/lambda/translmod.ml:65">transl_type_extension</a></span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier"><a href="debuginfo.mli.html#L38" title="ocaml/lambda/debuginfo.mli:38">item</a></span>.<span class="ocamlLCIdentifier">str_env</span> <span class="ocamlLCIdentifier">rootpath</span> <span class="ocamlLCIdentifier">tyext<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L1209" title="ocaml/lambda/translmod.ml:1209">store_idents</a></span> <span class="Constant">Loc_unknown</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L1050" title="ocaml/lambda/translcore.ml:1050">ids</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">Lsequence</span><span class="Statement">(</span><span class="PreProc">Lambda</span>.<span class="ocamlLCIdentifier"><a href="simplif.ml.html#L475" title="ocaml/lambda/simplif.ml:475">subst</a></span> <span class="ocamlLCIdentifier"><a href="translclass.ml.html#L720" title="ocaml/lambda/translclass.ml:720">no_env_update</a></span> <span class="ocamlLCIdentifier"><a href="simplif.ml.html#L475" title="ocaml/lambda/simplif.ml:475">subst</a></span> <span class="ocamlLCIdentifier"><a href="translobj.ml.html#L145" title="ocaml/lambda/translobj.ml:145">lam</a></span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">transl_store</span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier">rootpath<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="ocamlLCIdentifier">add_idents</span> <span class="Constant">false</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L1050" title="ocaml/lambda/translcore.ml:1050">ids</a></span> <span class="ocamlLCIdentifier"><a href="simplif.ml.html#L475" title="ocaml/lambda/simplif.ml:475">subst</a></span><span class="Statement">)</span> <span class="ocamlLCIdentifier">cont</span> <span class="ocamlLCIdentifier">rem</span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_exception</span> <span class="ocamlLCIdentifier">ext</span> <span class="Statement">-&gt;<br/></li>
<li><a id="L1023">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">id</span></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">ext</span>.<span class="ocamlLCIdentifier">tyexn_constructor</span>.<span class="ocamlLCIdentifier">ext_id</span> <span class="Statement">in<br/></li>
<li><a id="L1024">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">path</span></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="#L58" title="ocaml/lambda/translmod.ml:58">field_path</a></span> <span class="ocamlLCIdentifier">rootpath</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span> <span class="Statement">in<br/></li>
<li><a id="L1025">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">loc</span></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="debuginfo.ml.html#L85" title="ocaml/lambda/debuginfo.ml:85">of_location</a></span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier">ext</span>.<span class="ocamlLCIdentifier">tyexn_constructor</span>.<span class="ocamlLCIdentifier">ext_loc</span> <span class="Statement">in<br/></li>
<li><a id="L1026">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">lam</span></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="translcore.mli.html#L36" title="ocaml/lambda/translcore.mli:36">transl_extension_constructor</a></span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier"><a href="debuginfo.mli.html#L38" title="ocaml/lambda/debuginfo.mli:38">item</a></span>.<span class="ocamlLCIdentifier">str_env<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier"><a href="translclass.ml.html#L444" title="ocaml/lambda/translclass.ml:444">path</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier">ext</span>.<span class="ocamlLCIdentifier">tyexn_constructor<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">Lsequence</span><span class="Statement">(</span><span class="Constant">Llet</span><span class="Statement">(</span><span class="Constant">Strict</span>, <span class="Constant">Pgenval</span>, <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="PreProc">Lambda</span>.<span class="ocamlLCIdentifier"><a href="simplif.ml.html#L475" title="ocaml/lambda/simplif.ml:475">subst</a></span> <span class="ocamlLCIdentifier"><a href="translclass.ml.html#L720" title="ocaml/lambda/translclass.ml:720">no_env_update</a></span> <span class="ocamlLCIdentifier"><a href="simplif.ml.html#L475" title="ocaml/lambda/simplif.ml:475">subst</a></span> <span class="ocamlLCIdentifier"><a href="translobj.ml.html#L145" title="ocaml/lambda/translobj.ml:145">lam</a></span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier"><a href="#L1277" title="ocaml/lambda/translmod.ml:1277">store_ident</a></span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span><span class="Statement">)</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">transl_store</span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier">rootpath<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="ocamlLCIdentifier">add_ident</span> <span class="Constant">false</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span> <span class="ocamlLCIdentifier"><a href="simplif.ml.html#L475" title="ocaml/lambda/simplif.ml:475">subst</a></span><span class="Statement">)</span> <span class="ocamlLCIdentifier">cont</span> <span class="ocamlLCIdentifier">rem</span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_module<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">{</span><span class="ocamlLCIdentifier">mb_id</span><span class="Statement">=</span><span class="Constant">None</span><span class="Statement">;</span> <span class="ocamlLCIdentifier">mb_name</span><span class="Statement">;</span> <span class="ocamlLCIdentifier">mb_presence</span><span class="Statement">=</span><span class="Constant">Mp_present</span><span class="Statement">;</span> <span class="ocamlLCIdentifier">mb_expr</span><span class="Statement">=</span><span class="ocamlLCIdentifier"><a href="#L706" title="ocaml/lambda/translmod.ml:706">modl</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier">mb_loc</span><span class="Statement">=</span><span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span><span class="Statement">;</span> <span class="ocamlLCIdentifier">mb_attributes</span><span class="Statement">}</span> <span class="Statement">-&gt;<br/></li>
<li><a id="L1040">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">lam</span></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="PreProc">Translattribute</span>.<span class="ocamlLCIdentifier"><a href="translattribute.mli.html#L26" title="ocaml/lambda/translattribute.mli:26">add_inline_attribute</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="translcore.ml.html#L37" title="ocaml/lambda/translcore.ml:37">transl_module</a></span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="Constant">Tcoerce_none</span> <span class="Constant">None</span> <span class="ocamlLCIdentifier"><a href="#L706" title="ocaml/lambda/translmod.ml:706">modl</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span> <span class="ocamlLCIdentifier">mb_attributes<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">Lsequence</span><span class="Statement">(<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">Lprim</span><span class="Statement">(</span><span class="Constant">Pignore</span>,<span class="Statement">[</span><span class="PreProc">Lambda</span>.<span class="ocamlLCIdentifier"><a href="simplif.ml.html#L475" title="ocaml/lambda/simplif.ml:475">subst</a></span> <span class="ocamlLCIdentifier"><a href="translclass.ml.html#L720" title="ocaml/lambda/translclass.ml:720">no_env_update</a></span> <span class="ocamlLCIdentifier"><a href="simplif.ml.html#L475" title="ocaml/lambda/simplif.ml:475">subst</a></span> <span class="ocamlLCIdentifier"><a href="translobj.ml.html#L145" title="ocaml/lambda/translobj.ml:145">lam</a></span><span class="Statement">]</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="debuginfo.ml.html#L85" title="ocaml/lambda/debuginfo.ml:85">of_location</a></span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier">mb_name</span>.<span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span><span class="Statement">)</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">transl_store</span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier">rootpath</span> <span class="ocamlLCIdentifier"><a href="simplif.ml.html#L475" title="ocaml/lambda/simplif.ml:475">subst</a></span> <span class="ocamlLCIdentifier">cont</span> <span class="ocamlLCIdentifier">rem<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_module</span><span class="Statement">{</span><span class="ocamlLCIdentifier">mb_id</span><span class="Statement">=</span><span class="Constant">Some</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span><span class="Statement">;</span><span class="ocamlLCIdentifier">mb_loc</span><span class="Statement">=</span><span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span><span class="Statement">;</span><span class="ocamlLCIdentifier">mb_presence</span><span class="Statement">=</span><span class="Constant">Mp_present</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">mb_expr</span><span class="Statement">={</span><span class="ocamlLCIdentifier">mod_desc</span> <span class="Statement">=</span> <span class="Constant">Tmod_structure</span> <span class="ocamlLCIdentifier">str</span><span class="Statement">}</span> <span class="Statement">as</span> <span class="ocamlLCIdentifier">mexp</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">mb_attributes</span><span class="Statement">}</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="PreProc">List</span>.<span class="ocamlLCIdentifier">iter</span> <span class="Statement">(</span><span class="PreProc">Translattribute</span>.<span class="ocamlLCIdentifier"><a href="translattribute.mli.html#L21" title="ocaml/lambda/translattribute.mli:21">check_attribute_on_module</a></span> <span class="ocamlLCIdentifier">mexp</span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">mb_attributes</span><span class="Statement">;<br/></li>
<li><a id="L1055">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">loc</span></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="debuginfo.ml.html#L85" title="ocaml/lambda/debuginfo.ml:85">of_location</a></span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier"><span class="linkable">loc</span></span> <span class="Statement">in<br/></li>
<li><a id="L1056">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">lam</span></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">transl_store<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span>:<span class="Statement">(</span><span class="ocamlLCIdentifier">enter_module_definition</span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L58" title="ocaml/lambda/translmod.ml:58">field_path</a></span> <span class="ocamlLCIdentifier">rootpath</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span><span class="Statement">)</span> <span class="ocamlLCIdentifier"><a href="simplif.ml.html#L475" title="ocaml/lambda/simplif.ml:475">subst</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="lambda.mli.html#L366" title="ocaml/lambda/lambda.mli:366">lambda_unit</a></span> <span class="ocamlLCIdentifier">str</span>.<span class="ocamlLCIdentifier">str_items<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">(* Careful: see <a href="matching.ml.html#L3845" title="ocaml/lambda/matching.ml:3845">next</a> case *)<br/></li>
<li><a id="L1063">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">subst</span></span> <span class="Statement">=</span> <span class="Statement">!</span><span class="ocamlLCIdentifier"><a href="#L961" title="ocaml/lambda/translmod.ml:961">transl_store_subst</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">Lsequence</span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="translobj.ml.html#L145" title="ocaml/lambda/translobj.ml:145">lam</a></span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">Llet</span><span class="Statement">(</span><span class="Constant">Strict</span>, <span class="Constant">Pgenval</span>, <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="PreProc">Lambda</span>.<span class="ocamlLCIdentifier"><a href="simplif.ml.html#L475" title="ocaml/lambda/simplif.ml:475">subst</a></span> <span class="ocamlLCIdentifier"><a href="translclass.ml.html#L720" title="ocaml/lambda/translclass.ml:720">no_env_update</a></span> <span class="ocamlLCIdentifier"><a href="simplif.ml.html#L475" title="ocaml/lambda/simplif.ml:475">subst</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">(</span><span class="Constant">Lprim</span><span class="Statement">(</span><span class="Constant">Pmakeblock</span><span class="Statement">(</span><span class="Constant">0</span>, <span class="Constant">Immutable</span>, <span class="Constant">None</span><span class="Statement">)</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="PreProc">List</span>.<span class="ocamlLCIdentifier"><a href="matching.ml.html#L922" title="ocaml/lambda/matching.ml:922">map</a></span> <span class="Statement">(fun</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span> <span class="Statement">-&gt;</span> <span class="Constant">Lvar</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L829" title="ocaml/lambda/translmod.ml:829">defined_idents</a></span> <span class="ocamlLCIdentifier">str</span>.<span class="ocamlLCIdentifier">str_items</span><span class="Statement">)</span>, <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span><span class="Statement">))</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">Lsequence</span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L1277" title="ocaml/lambda/translmod.ml:1277">store_ident</a></span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier">transl_store</span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier">rootpath<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="ocamlLCIdentifier">add_ident</span> <span class="Constant">true</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span> <span class="ocamlLCIdentifier"><a href="simplif.ml.html#L475" title="ocaml/lambda/simplif.ml:475">subst</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">cont</span> <span class="ocamlLCIdentifier">rem</span><span class="Statement">)))<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_module</span><span class="Statement">{<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">mb_id</span><span class="Statement">=</span><span class="Constant">Some</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span><span class="Statement">;</span><span class="ocamlLCIdentifier">mb_loc</span><span class="Statement">=</span><span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span><span class="Statement">;</span><span class="ocamlLCIdentifier">mb_presence</span><span class="Statement">=</span><span class="Constant">Mp_present</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">mb_expr</span><span class="Statement">=</span> <span class="Statement">{<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">mod_desc</span> <span class="Statement">=</span> <span class="Constant">Tmod_constraint</span> <span class="Statement">(<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">{</span><span class="ocamlLCIdentifier">mod_desc</span> <span class="Statement">=</span> <span class="Constant">Tmod_structure</span> <span class="ocamlLCIdentifier">str</span><span class="Statement">}</span> <span class="Statement">as</span> <span class="ocamlLCIdentifier">mexp</span>, <span class="Statement">_</span>, <span class="Statement">_</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="Constant">Tcoerce_structure</span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="matching.ml.html#L922" title="ocaml/lambda/matching.ml:922">map</a></span>, <span class="Statement">_)</span> <span class="Statement">as</span> <span class="ocamlLCIdentifier">_cc</span><span class="Statement">))};<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">mb_attributes<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">}</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">(*&nbsp; &nbsp; Format.printf &quot;coerc <a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a> %<a href="translclass.ml.html#L563" title="ocaml/lambda/translclass.ml:563">s</a>: %a@.&quot; (Ident.unique_name <a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a>)<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Includemod.print_coercion cc; *)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="PreProc">List</span>.<span class="ocamlLCIdentifier">iter</span> <span class="Statement">(</span><span class="PreProc">Translattribute</span>.<span class="ocamlLCIdentifier"><a href="translattribute.mli.html#L21" title="ocaml/lambda/translattribute.mli:21">check_attribute_on_module</a></span> <span class="ocamlLCIdentifier">mexp</span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">mb_attributes</span><span class="Statement">;<br/></li>
<li><a id="L1086">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">loc</span></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="debuginfo.ml.html#L85" title="ocaml/lambda/debuginfo.ml:85">of_location</a></span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier"><span class="linkable">loc</span></span> <span class="Statement">in<br/></li>
<li><a id="L1087">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">lam</span></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">transl_store<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span>:<span class="Statement">(</span><span class="ocamlLCIdentifier">enter_module_definition</span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L58" title="ocaml/lambda/translmod.ml:58">field_path</a></span> <span class="ocamlLCIdentifier">rootpath</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span><span class="Statement">)</span> <span class="ocamlLCIdentifier"><a href="simplif.ml.html#L475" title="ocaml/lambda/simplif.ml:475">subst</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="lambda.mli.html#L366" title="ocaml/lambda/lambda.mli:366">lambda_unit</a></span> <span class="ocamlLCIdentifier">str</span>.<span class="ocamlLCIdentifier">str_items<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">(* Careful: see <a href="matching.ml.html#L3845" title="ocaml/lambda/matching.ml:3845">next</a> case *)<br/></li>
<li><a id="L1094">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">subst</span></span> <span class="Statement">=</span> <span class="Statement">!</span><span class="ocamlLCIdentifier"><a href="#L961" title="ocaml/lambda/translmod.ml:961">transl_store_subst</a></span> <span class="Statement">in<br/></li>
<li><a id="L1095">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">field</span></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="#L973" title="ocaml/lambda/translmod.ml:973">field_of_str</a></span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span> <span class="ocamlLCIdentifier">str</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">Lsequence</span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="translobj.ml.html#L145" title="ocaml/lambda/translobj.ml:145">lam</a></span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">Llet</span><span class="Statement">(</span><span class="Constant">Strict</span>, <span class="Constant">Pgenval</span>, <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="PreProc">Lambda</span>.<span class="ocamlLCIdentifier"><a href="simplif.ml.html#L475" title="ocaml/lambda/simplif.ml:475">subst</a></span> <span class="ocamlLCIdentifier"><a href="translclass.ml.html#L720" title="ocaml/lambda/translclass.ml:720">no_env_update</a></span> <span class="ocamlLCIdentifier"><a href="simplif.ml.html#L475" title="ocaml/lambda/simplif.ml:475">subst</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">(</span><span class="Constant">Lprim</span><span class="Statement">(</span><span class="Constant">Pmakeblock</span><span class="Statement">(</span><span class="Constant">0</span>, <span class="Constant">Immutable</span>, <span class="Constant">None</span><span class="Statement">)</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="PreProc">List</span>.<span class="ocamlLCIdentifier"><a href="matching.ml.html#L922" title="ocaml/lambda/matching.ml:922">map</a></span> <span class="ocamlLCIdentifier"><a href="#L1095" title="ocaml/lambda/translmod.ml:1095">field</a></span> <span class="ocamlLCIdentifier"><a href="matching.ml.html#L922" title="ocaml/lambda/matching.ml:922">map</a></span>, <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span><span class="Statement">))</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">Lsequence</span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L1277" title="ocaml/lambda/translmod.ml:1277">store_ident</a></span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier">transl_store</span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier">rootpath<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="ocamlLCIdentifier">add_ident</span> <span class="Constant">true</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span> <span class="ocamlLCIdentifier"><a href="simplif.ml.html#L475" title="ocaml/lambda/simplif.ml:475">subst</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">cont</span> <span class="ocamlLCIdentifier">rem</span><span class="Statement">)))<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_module<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">{</span><span class="ocamlLCIdentifier">mb_id</span><span class="Statement">=</span><span class="Constant">Some</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span><span class="Statement">;</span> <span class="ocamlLCIdentifier">mb_presence</span><span class="Statement">=</span><span class="Constant">Mp_present</span><span class="Statement">;</span> <span class="ocamlLCIdentifier">mb_expr</span><span class="Statement">=</span><span class="ocamlLCIdentifier"><a href="#L706" title="ocaml/lambda/translmod.ml:706">modl</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier">mb_loc</span><span class="Statement">=</span><span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span><span class="Statement">;</span> <span class="ocamlLCIdentifier">mb_attributes</span><span class="Statement">}</span> <span class="Statement">-&gt;<br/></li>
<li><a id="L1108">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">lam</span></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="PreProc">Translattribute</span>.<span class="ocamlLCIdentifier"><a href="translattribute.mli.html#L26" title="ocaml/lambda/translattribute.mli:26">add_inline_attribute</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="translcore.ml.html#L37" title="ocaml/lambda/translcore.ml:37">transl_module</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span>:<span class="Statement">(</span><span class="ocamlLCIdentifier">enter_module_definition</span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">Tcoerce_none</span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L58" title="ocaml/lambda/translmod.ml:58">field_path</a></span> <span class="ocamlLCIdentifier">rootpath</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span><span class="Statement">)</span> <span class="ocamlLCIdentifier"><a href="#L706" title="ocaml/lambda/translmod.ml:706">modl</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span> <span class="ocamlLCIdentifier">mb_attributes<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">(* Careful: the module value stored in the global may be different<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; from the local module value, in case a coercion is applied.<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; If so, keep using the local module value (<a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a>) in the remainder of<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; the compilation <a href="tmc.ml.html#L197" title="ocaml/lambda/tmc.ml:197">unit</a> (add_ident true returns <a href="simplif.ml.html#L475" title="ocaml/lambda/simplif.ml:475">subst</a> unchanged).<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; If not, we can use the value from the global<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (add_ident true adds <a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a> -&gt; Pgetglobal... to <a href="simplif.ml.html#L475" title="ocaml/lambda/simplif.ml:475">subst</a>). *)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">Llet</span><span class="Statement">(</span><span class="Constant">Strict</span>, <span class="Constant">Pgenval</span>, <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span>, <span class="PreProc">Lambda</span>.<span class="ocamlLCIdentifier"><a href="simplif.ml.html#L475" title="ocaml/lambda/simplif.ml:475">subst</a></span> <span class="ocamlLCIdentifier"><a href="translclass.ml.html#L720" title="ocaml/lambda/translclass.ml:720">no_env_update</a></span> <span class="ocamlLCIdentifier"><a href="simplif.ml.html#L475" title="ocaml/lambda/simplif.ml:475">subst</a></span> <span class="ocamlLCIdentifier"><a href="translobj.ml.html#L145" title="ocaml/lambda/translobj.ml:145">lam</a></span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">Lsequence</span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L1277" title="ocaml/lambda/translmod.ml:1277">store_ident</a></span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="debuginfo.ml.html#L85" title="ocaml/lambda/debuginfo.ml:85">of_location</a></span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span><span class="Statement">)</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier">transl_store</span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier">rootpath<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">(</span><span class="ocamlLCIdentifier">add_ident</span> <span class="Constant">true</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span> <span class="ocamlLCIdentifier"><a href="simplif.ml.html#L475" title="ocaml/lambda/simplif.ml:475">subst</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier">cont</span> <span class="ocamlLCIdentifier">rem</span><span class="Statement">))<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_module</span> <span class="Statement">({</span><span class="ocamlLCIdentifier">mb_presence</span><span class="Statement">=</span><span class="Constant">Mp_absent</span><span class="Statement">}</span> <span class="Statement">as</span> <span class="ocamlLCIdentifier">mb</span><span class="Statement">)</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="PreProc">List</span>.<span class="ocamlLCIdentifier">iter</span> <span class="Statement">(</span><span class="PreProc">Translattribute</span>.<span class="ocamlLCIdentifier"><a href="translattribute.mli.html#L21" title="ocaml/lambda/translattribute.mli:21">check_attribute_on_module</a></span> <span class="ocamlLCIdentifier">mb</span>.<span class="ocamlLCIdentifier">mb_expr</span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">mb</span>.<span class="ocamlLCIdentifier">mb_attributes</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="PreProc">List</span>.<span class="ocamlLCIdentifier">iter</span> <span class="Statement">(</span><span class="PreProc">Translattribute</span>.<span class="ocamlLCIdentifier"><a href="translattribute.mli.html#L21" title="ocaml/lambda/translattribute.mli:21">check_attribute_on_module</a></span> <span class="ocamlLCIdentifier">mb</span>.<span class="ocamlLCIdentifier">mb_expr</span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">mb</span>.<span class="ocamlLCIdentifier">mb_expr</span>.<span class="ocamlLCIdentifier">mod_attributes</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">transl_store</span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier">rootpath</span> <span class="ocamlLCIdentifier"><a href="simplif.ml.html#L475" title="ocaml/lambda/simplif.ml:475">subst</a></span> <span class="ocamlLCIdentifier">cont</span> <span class="ocamlLCIdentifier">rem<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_recmodule</span> <span class="ocamlLCIdentifier">bindings</span> <span class="Statement">-&gt;<br/></li>
<li><a id="L1133">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">ids</span></span> <span class="Statement">=</span> <span class="PreProc">List</span>.<span class="ocamlLCIdentifier">filter_map</span> <span class="Statement">(fun</span> <span class="ocamlLCIdentifier">mb</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier">mb</span>.<span class="ocamlLCIdentifier">mb_id</span><span class="Statement">)</span> <span class="ocamlLCIdentifier">bindings</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L405" title="ocaml/lambda/translmod.ml:405">compile_recmodule</a></span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">(fun</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span> <span class="ocamlLCIdentifier"><a href="#L706" title="ocaml/lambda/translmod.ml:706">modl</a></span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="PreProc">Lambda</span>.<span class="ocamlLCIdentifier"><a href="simplif.ml.html#L475" title="ocaml/lambda/simplif.ml:475">subst</a></span> <span class="ocamlLCIdentifier"><a href="translclass.ml.html#L720" title="ocaml/lambda/translclass.ml:720">no_env_update</a></span> <span class="ocamlLCIdentifier"><a href="simplif.ml.html#L475" title="ocaml/lambda/simplif.ml:475">subst</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">(match</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span> <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">None</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L37" title="ocaml/lambda/translcore.ml:37">transl_module</a></span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="Constant">Tcoerce_none</span> <span class="Constant">None</span> <span class="ocamlLCIdentifier"><a href="#L706" title="ocaml/lambda/translmod.ml:706">modl</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Some</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L37" title="ocaml/lambda/translcore.ml:37">transl_module</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span>:<span class="Statement">(</span><span class="ocamlLCIdentifier">enter_module_definition</span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">Tcoerce_none</span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L58" title="ocaml/lambda/translmod.ml:58">field_path</a></span> <span class="ocamlLCIdentifier">rootpath</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span><span class="Statement">)</span> <span class="ocamlLCIdentifier"><a href="#L706" title="ocaml/lambda/translmod.ml:706">modl</a></span><span class="Statement">))<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">bindings<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="Constant">Lsequence</span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L1209" title="ocaml/lambda/translmod.ml:1209">store_idents</a></span> <span class="Constant">Loc_unknown</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L1050" title="ocaml/lambda/translcore.ml:1050">ids</a></span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier">transl_store</span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier">rootpath<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">(</span><span class="ocamlLCIdentifier">add_idents</span> <span class="Constant">true</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L1050" title="ocaml/lambda/translcore.ml:1050">ids</a></span> <span class="ocamlLCIdentifier"><a href="simplif.ml.html#L475" title="ocaml/lambda/simplif.ml:475">subst</a></span><span class="Statement">)</span> <span class="ocamlLCIdentifier">cont</span> <span class="ocamlLCIdentifier">rem</span><span class="Statement">))<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_class</span> <span class="ocamlLCIdentifier">cl_list</span> <span class="Statement">-&gt;<br/></li>
<li><a id="L1149">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><span class="linkable">ids</span></span>, <span class="ocamlLCIdentifier">class_bindings</span><span class="Statement">)</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">transl_class_bindings</span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier">cl_list</span> <span class="Statement">in<br/></li>
<li><a id="L1150">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">lam</span></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">Lletrec</span><span class="Statement">(</span><span class="ocamlLCIdentifier">class_bindings</span>, <span class="ocamlLCIdentifier"><a href="#L1209" title="ocaml/lambda/translmod.ml:1209">store_idents</a></span> <span class="Constant">Loc_unknown</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L1050" title="ocaml/lambda/translcore.ml:1050">ids</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">Lsequence</span><span class="Statement">(</span><span class="PreProc">Lambda</span>.<span class="ocamlLCIdentifier"><a href="simplif.ml.html#L475" title="ocaml/lambda/simplif.ml:475">subst</a></span> <span class="ocamlLCIdentifier"><a href="translclass.ml.html#L720" title="ocaml/lambda/translclass.ml:720">no_env_update</a></span> <span class="ocamlLCIdentifier"><a href="simplif.ml.html#L475" title="ocaml/lambda/simplif.ml:475">subst</a></span> <span class="ocamlLCIdentifier"><a href="translobj.ml.html#L145" title="ocaml/lambda/translobj.ml:145">lam</a></span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">transl_store</span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier">rootpath</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">add_idents</span> <span class="Constant">false</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L1050" title="ocaml/lambda/translcore.ml:1050">ids</a></span> <span class="ocamlLCIdentifier"><a href="simplif.ml.html#L475" title="ocaml/lambda/simplif.ml:475">subst</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">cont</span> <span class="ocamlLCIdentifier">rem</span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_include</span><span class="Statement">({<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">incl_loc</span><span class="Statement">=</span><span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">incl_mod</span><span class="Statement">=</span> <span class="Statement">{<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">mod_desc</span> <span class="Statement">=</span> <span class="Constant">Tmod_constraint</span> <span class="Statement">(<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">({</span><span class="ocamlLCIdentifier">mod_desc</span> <span class="Statement">=</span> <span class="Constant">Tmod_structure</span> <span class="ocamlLCIdentifier">str</span><span class="Statement">}</span> <span class="Statement">as</span> <span class="ocamlLCIdentifier">mexp</span><span class="Statement">)</span>, <span class="Statement">_</span>, <span class="Statement">_</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="Constant">Tcoerce_structure</span> <span class="Statement">_</span> <span class="Statement">|</span> <span class="Constant">Tcoerce_none</span><span class="Statement">))}<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Statement">({</span> <span class="ocamlLCIdentifier">mod_desc</span> <span class="Statement">=</span> <span class="Constant">Tmod_structure</span> <span class="ocamlLCIdentifier">str</span><span class="Statement">}</span> <span class="Statement">as</span> <span class="ocamlLCIdentifier">mexp</span><span class="Statement">);<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">incl_attributes</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">incl_type</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">}</span> <span class="Statement">as</span> <span class="ocamlLCIdentifier">incl</span><span class="Statement">)</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="PreProc">List</span>.<span class="ocamlLCIdentifier">iter</span> <span class="Statement">(</span><span class="PreProc">Translattribute</span>.<span class="ocamlLCIdentifier"><a href="translattribute.mli.html#L21" title="ocaml/lambda/translattribute.mli:21">check_attribute_on_module</a></span> <span class="ocamlLCIdentifier">mexp</span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">incl_attributes</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">(* Shouldn'<a href="debuginfo.ml.html#L79" title="ocaml/lambda/debuginfo.ml:79">t</a> we use mod_attributes instead of incl_attributes?<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; Same question for the Tstr_module cases above, btw. *)<br/></li>
<li><a id="L1171">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">lam</span></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">transl_store</span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="Constant">None</span> <span class="ocamlLCIdentifier"><a href="simplif.ml.html#L475" title="ocaml/lambda/simplif.ml:475">subst</a></span> <span class="ocamlLCIdentifier"><a href="lambda.mli.html#L366" title="ocaml/lambda/lambda.mli:366">lambda_unit</a></span> <span class="ocamlLCIdentifier">str</span>.<span class="ocamlLCIdentifier">str_items<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">(* It is tempting to pass rootpath instead of None<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; in order to give a more precise <a href="translcore.ml.html#L56" title="ocaml/lambda/translcore.ml:56">name</a> to exceptions<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; in the included structured, but this would introduce<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; a difference of behavior compared to bytecode. *)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">in<br/></li>
<li><a id="L1178">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">subst</span></span> <span class="Statement">=</span> <span class="Statement">!</span><span class="ocamlLCIdentifier"><a href="#L961" title="ocaml/lambda/translmod.ml:961">transl_store_subst</a></span> <span class="Statement">in<br/></li>
<li><a id="L1179">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">field</span></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="#L973" title="ocaml/lambda/translmod.ml:973">field_of_str</a></span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="debuginfo.ml.html#L85" title="ocaml/lambda/debuginfo.ml:85">of_location</a></span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span><span class="Statement">)</span> <span class="ocamlLCIdentifier">str</span> <span class="Statement">in<br/></li>
<li><a id="L1180">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">ids0</span></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">bound_value_identifiers</span> <span class="ocamlLCIdentifier">incl_type</span> <span class="Statement">in<br/></li>
<li><a id="L1181">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="Statement">rec</span> <span class="ocamlLCIdentifier"><span class="linkable">loop</span></span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L1050" title="ocaml/lambda/translcore.ml:1050">ids</a></span> <span class="ocamlLCIdentifier"><a href="simplif.ml.html#L732" title="ocaml/lambda/simplif.ml:732">args</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">match</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L1050" title="ocaml/lambda/translcore.ml:1050">ids</a></span>, <span class="ocamlLCIdentifier"><a href="simplif.ml.html#L732" title="ocaml/lambda/simplif.ml:732">args</a></span> <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">[]</span>, <span class="Constant">[]</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">transl_store</span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier">rootpath</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">add_idents</span> <span class="Constant">true</span> <span class="ocamlLCIdentifier"><a href="#L1180" title="ocaml/lambda/translmod.ml:1180">ids0</a></span> <span class="ocamlLCIdentifier"><a href="simplif.ml.html#L475" title="ocaml/lambda/simplif.ml:475">subst</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">cont</span> <span class="ocamlLCIdentifier">rem<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span> <span class="Statement">::</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L1050" title="ocaml/lambda/translcore.ml:1050">ids</a></span>, <span class="ocamlLCIdentifier"><a href="matching.ml.html#L2339" title="ocaml/lambda/matching.ml:2339">arg</a></span> <span class="Statement">::</span> <span class="ocamlLCIdentifier"><a href="simplif.ml.html#L732" title="ocaml/lambda/simplif.ml:732">args</a></span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">Llet</span><span class="Statement">(</span><span class="Constant">Alias</span>, <span class="Constant">Pgenval</span>, <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="PreProc">Lambda</span>.<span class="ocamlLCIdentifier"><a href="simplif.ml.html#L475" title="ocaml/lambda/simplif.ml:475">subst</a></span> <span class="ocamlLCIdentifier"><a href="translclass.ml.html#L720" title="ocaml/lambda/translclass.ml:720">no_env_update</a></span> <span class="ocamlLCIdentifier"><a href="simplif.ml.html#L475" title="ocaml/lambda/simplif.ml:475">subst</a></span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L1095" title="ocaml/lambda/translmod.ml:1095">field</a></span> <span class="ocamlLCIdentifier"><a href="matching.ml.html#L2339" title="ocaml/lambda/matching.ml:2339">arg</a></span><span class="Statement">)</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">Lsequence</span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L1277" title="ocaml/lambda/translmod.ml:1277">store_ident</a></span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="debuginfo.ml.html#L85" title="ocaml/lambda/debuginfo.ml:85">of_location</a></span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span><span class="Statement">)</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier"><a href="#L1181" title="ocaml/lambda/translmod.ml:1181">loop</a></span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L1050" title="ocaml/lambda/translcore.ml:1050">ids</a></span> <span class="ocamlLCIdentifier"><a href="simplif.ml.html#L732" title="ocaml/lambda/simplif.ml:732">args</a></span><span class="Statement">))<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Statement">_</span> <span class="Statement">-&gt;</span> <span class="Statement">assert</span> <span class="Constant">false<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">in<br/></li>
<li><a id="L1193">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">map</span></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">match</span> <span class="ocamlLCIdentifier">incl</span>.<span class="ocamlLCIdentifier">incl_mod</span>.<span class="ocamlLCIdentifier">mod_desc</span> <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tmod_constraint</span> <span class="Statement">(_</span>, <span class="Statement">_</span>, <span class="Statement">_</span>, <span class="Constant">Tcoerce_structure</span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="matching.ml.html#L922" title="ocaml/lambda/matching.ml:922">map</a></span>, <span class="Statement">_))</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier"><a href="matching.ml.html#L922" title="ocaml/lambda/matching.ml:922">map</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tmod_structure</span> <span class="Statement">_<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tmod_constraint</span> <span class="Statement">(_</span>, <span class="Statement">_</span>, <span class="Statement">_</span>, <span class="Constant">Tcoerce_none</span><span class="Statement">)</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="PreProc">List</span>.<span class="ocamlLCIdentifier">init</span> <span class="Statement">(</span><span class="PreProc">List</span>.<span class="ocamlLCIdentifier">length</span> <span class="ocamlLCIdentifier"><a href="#L1180" title="ocaml/lambda/translmod.ml:1180">ids0</a></span><span class="Statement">)</span> <span class="Statement">(fun</span> <span class="ocamlLCIdentifier"><a href="translclass.ml.html#L713" title="ocaml/lambda/translclass.ml:713">i</a></span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier"><a href="translclass.ml.html#L713" title="ocaml/lambda/translclass.ml:713">i</a></span>, <span class="Constant">Tcoerce_none</span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Statement">_</span> <span class="Statement">-&gt;</span> <span class="Statement">assert</span> <span class="Constant">false<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">Lsequence</span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="translobj.ml.html#L145" title="ocaml/lambda/translobj.ml:145">lam</a></span>, <span class="ocamlLCIdentifier"><a href="#L1181" title="ocaml/lambda/translmod.ml:1181">loop</a></span> <span class="ocamlLCIdentifier"><a href="#L1180" title="ocaml/lambda/translmod.ml:1180">ids0</a></span> <span class="ocamlLCIdentifier"><a href="matching.ml.html#L922" title="ocaml/lambda/matching.ml:922">map</a></span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_include</span> <span class="ocamlLCIdentifier">incl</span> <span class="Statement">-&gt;<br/></li>
<li><a id="L1205">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">ids</span></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">bound_value_identifiers</span> <span class="ocamlLCIdentifier">incl</span>.<span class="ocamlLCIdentifier">incl_type</span> <span class="Statement">in<br/></li>
<li><a id="L1206">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">modl</span></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">incl</span>.<span class="ocamlLCIdentifier">incl_mod</span> <span class="Statement">in<br/></li>
<li><a id="L1207">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">mid</span></span> <span class="Statement">=</span> <span class="PreProc">Ident</span>.<span class="ocamlLCIdentifier">create_local</span> <span class="Constant">&quot;include&quot;</span> <span class="Statement">in<br/></li>
<li><a id="L1208">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">loc</span></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">incl</span>.<span class="ocamlLCIdentifier">incl_loc</span> <span class="Statement">in<br/></li>
<li><a id="L1209">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="Statement">rec</span> <span class="ocamlLCIdentifier"><span class="linkable">store_idents</span></span> <span class="ocamlLCIdentifier">pos</span> <span class="Statement">=</span> <span class="Statement">function<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">[]</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier">transl_store<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier">rootpath</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">add_idents</span> <span class="Constant">true</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L1050" title="ocaml/lambda/translcore.ml:1050">ids</a></span> <span class="ocamlLCIdentifier"><a href="simplif.ml.html#L475" title="ocaml/lambda/simplif.ml:475">subst</a></span><span class="Statement">)</span> <span class="ocamlLCIdentifier">cont</span> <span class="ocamlLCIdentifier">rem<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span> <span class="Statement">::</span> <span class="ocamlLCIdentifier">idl</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">Llet</span><span class="Statement">(</span><span class="Constant">Alias</span>, <span class="Constant">Pgenval</span>, <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">Lprim</span><span class="Statement">(</span><span class="Constant">Pfield</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">pos</span>, <span class="Constant">Pointer</span>, <span class="Constant">Mutable</span><span class="Statement">)</span>, <span class="Statement">[</span><span class="Constant">Lvar</span> <span class="ocamlLCIdentifier"><a href="#L707" title="ocaml/lambda/translmod.ml:707">mid</a></span><span class="Statement">]</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier"><a href="debuginfo.ml.html#L85" title="ocaml/lambda/debuginfo.ml:85">of_location</a></span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span><span class="Statement">)</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">Lsequence</span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L1277" title="ocaml/lambda/translmod.ml:1277">store_ident</a></span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="debuginfo.ml.html#L85" title="ocaml/lambda/debuginfo.ml:85">of_location</a></span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span><span class="Statement">)</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier"><a href="#L1209" title="ocaml/lambda/translmod.ml:1209">store_idents</a></span> <span class="Statement">(</span><span class="ocamlLCIdentifier">pos</span> + <span class="Constant">1</span><span class="Statement">)</span> <span class="ocamlLCIdentifier">idl</span><span class="Statement">))<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">Llet</span><span class="Statement">(</span><span class="Constant">Strict</span>, <span class="Constant">Pgenval</span>, <span class="ocamlLCIdentifier"><a href="#L707" title="ocaml/lambda/translmod.ml:707">mid</a></span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="PreProc">Lambda</span>.<span class="ocamlLCIdentifier"><a href="simplif.ml.html#L475" title="ocaml/lambda/simplif.ml:475">subst</a></span> <span class="ocamlLCIdentifier"><a href="translclass.ml.html#L720" title="ocaml/lambda/translclass.ml:720">no_env_update</a></span> <span class="ocamlLCIdentifier"><a href="simplif.ml.html#L475" title="ocaml/lambda/simplif.ml:475">subst</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="translcore.ml.html#L37" title="ocaml/lambda/translcore.ml:37">transl_module</a></span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="Constant">Tcoerce_none</span> <span class="Constant">None</span> <span class="ocamlLCIdentifier"><a href="#L706" title="ocaml/lambda/translmod.ml:706">modl</a></span><span class="Statement">)</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier"><a href="#L1209" title="ocaml/lambda/translmod.ml:1209">store_idents</a></span> <span class="Constant">0</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L1050" title="ocaml/lambda/translcore.ml:1050">ids</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_open</span> <span class="ocamlLCIdentifier">od</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">begin</span><span class="ocamlEnd"> </span><span class="Statement">match</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">od</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">open_expr</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">mod_desc</span><span class="ocamlEnd"> </span><span class="Statement">with<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Constant">Tmod_structure</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">str</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;<br/></li>
<li><a id="L1226">&#x200c;</a></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><span class="linkable">lam</span></span><span class="ocamlEnd"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier">transl_store</span><span class="ocamlEnd"> </span><span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">rootpath</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="simplif.ml.html#L475" title="ocaml/lambda/simplif.ml:475">subst</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="lambda.mli.html#L366" title="ocaml/lambda/lambda.mli:366">lambda_unit</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">str</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">str_items<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">in<br/></li>
<li><a id="L1229">&#x200c;</a></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><span class="linkable">loc</span></span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="debuginfo.ml.html#L85" title="ocaml/lambda/debuginfo.ml:85">of_location</a></span><span class="ocamlEnd"> </span><span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">od</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">open_loc</span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li><a id="L1230">&#x200c;</a></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><span class="linkable">ids</span></span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="PreProc">Array</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">of_list</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L829" title="ocaml/lambda/translmod.ml:829">defined_idents</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">str</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">str_items</span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li><a id="L1231">&#x200c;</a></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><span class="linkable">ids0</span></span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">bound_value_identifiers</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">od</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">open_bound_items</span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li><a id="L1232">&#x200c;</a></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><span class="linkable">subst</span></span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="Statement">!</span><span class="ocamlLCIdentifier"><a href="#L961" title="ocaml/lambda/translmod.ml:961">transl_store_subst</a></span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li><a id="L1233">&#x200c;</a></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="Statement">rec</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><span class="linkable">store_idents</span></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">pos</span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="Statement">function<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Constant">[]</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">transl_store</span><span class="ocamlEnd"> </span><span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">rootpath<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">(</span><span class="ocamlLCIdentifier">add_idents</span><span class="ocamlEnd"> </span><span class="Constant">true</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L1180" title="ocaml/lambda/translmod.ml:1180">ids0</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="simplif.ml.html#L475" title="ocaml/lambda/simplif.ml:475">subst</a></span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">cont</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">rem<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span><span class="ocamlEnd"> </span><span class="Statement">::</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">idl</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Constant">Llet</span><span class="Statement">(</span><span class="Constant">Alias</span><span class="ocamlEnd">, </span><span class="Constant">Pgenval</span><span class="ocamlEnd">, </span><span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span><span class="ocamlEnd">, </span><span class="Constant">Lvar</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="translcore.ml.html#L1050" title="ocaml/lambda/translcore.ml:1050">ids</a></span><span class="ocamlEnd">.</span><span class="Statement">(</span><span class="ocamlLCIdentifier">pos</span><span class="Statement">)</span><span class="ocamlEnd">,<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="Constant">Lsequence</span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L1277" title="ocaml/lambda/translmod.ml:1277">store_ident</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span><span class="ocamlEnd">,<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="ocamlLCIdentifier"><a href="#L1209" title="ocaml/lambda/translmod.ml:1209">store_idents</a></span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">pos</span><span class="ocamlEnd"> + </span><span class="Constant">1</span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">idl</span><span class="Statement">))<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Constant">Lsequence</span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="translobj.ml.html#L145" title="ocaml/lambda/translobj.ml:145">lam</a></span><span class="ocamlEnd">, </span><span class="PreProc">Lambda</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier"><a href="simplif.ml.html#L475" title="ocaml/lambda/simplif.ml:475">subst</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="translclass.ml.html#L720" title="ocaml/lambda/translclass.ml:720">no_env_update</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="simplif.ml.html#L475" title="ocaml/lambda/simplif.ml:475">subst</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L1209" title="ocaml/lambda/translmod.ml:1209">store_idents</a></span><span class="ocamlEnd"> </span><span class="Constant">0</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L1180" title="ocaml/lambda/translmod.ml:1180">ids0</a></span><span class="Statement">))<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Statement">_</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;<br/></li>
<li><a id="L1244">&#x200c;</a></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><span class="linkable">pure</span></span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="translcore.ml.html#L614" title="ocaml/lambda/translcore.ml:614">pure_module</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">od</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">open_expr</span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Comment">(* this optimization shouldn'<a href="debuginfo.ml.html#L79" title="ocaml/lambda/debuginfo.ml:79">t</a> be needed because Simplif would<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; actually <a href="matching.ml.html#L867" title="ocaml/lambda/matching.ml:867">remove</a> the [Llet] when it'<a href="translclass.ml.html#L563" title="ocaml/lambda/translclass.ml:563">s</a> not used.<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; But since [<a href="#L765" title="ocaml/lambda/translmod.ml:765">scan_used_globals</a>] runs before Simplif, we need to<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; do it. *)<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">match</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">od</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">open_bound_items</span><span class="ocamlEnd"> </span><span class="Statement">with<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Constant">[]</span><span class="ocamlEnd"> </span><span class="Statement">when</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="translcore.ml.html#L592" title="ocaml/lambda/translcore.ml:592">pure</a></span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="Constant">Alias</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier">transl_store</span><span class="ocamlEnd"> </span><span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">rootpath</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="simplif.ml.html#L475" title="ocaml/lambda/simplif.ml:475">subst</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">cont</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">rem<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Statement">_</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;<br/></li>
<li><a id="L1253">&#x200c;</a></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><span class="linkable">ids</span></span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">bound_value_identifiers</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">od</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">open_bound_items</span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li><a id="L1254">&#x200c;</a></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><span class="linkable">mid</span></span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="PreProc">Ident</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">create_local</span><span class="ocamlEnd"> </span><span class="Constant">&quot;<a href="matching.ml.html#L419" title="ocaml/lambda/matching.ml:419">open</a>&quot;</span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li><a id="L1255">&#x200c;</a></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><span class="linkable">loc</span></span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="debuginfo.ml.html#L85" title="ocaml/lambda/debuginfo.ml:85">of_location</a></span><span class="ocamlEnd"> </span><span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">od</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">open_loc</span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li><a id="L1256">&#x200c;</a></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="Statement">rec</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><span class="linkable">store_idents</span></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">pos</span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="Statement">function<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Constant">[]</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">transl_store</span><span class="ocamlEnd"> </span><span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">rootpath<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">(</span><span class="ocamlLCIdentifier">add_idents</span><span class="ocamlEnd"> </span><span class="Constant">true</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="translcore.ml.html#L1050" title="ocaml/lambda/translcore.ml:1050">ids</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="simplif.ml.html#L475" title="ocaml/lambda/simplif.ml:475">subst</a></span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">cont</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">rem<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span><span class="ocamlEnd"> </span><span class="Statement">::</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">idl</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Constant">Llet</span><span class="Statement">(</span><span class="Constant">Alias</span><span class="ocamlEnd">, </span><span class="Constant">Pgenval</span><span class="ocamlEnd">, </span><span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span><span class="ocamlEnd">,<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="Constant">Lprim</span><span class="Statement">(</span><span class="Constant">Pfield</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">pos</span><span class="ocamlEnd">, </span><span class="Constant">Pointer</span><span class="ocamlEnd">, </span><span class="Constant">Mutable</span><span class="Statement">)</span><span class="ocamlEnd">,<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="Statement">[</span><span class="Constant">Lvar</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L707" title="ocaml/lambda/translmod.ml:707">mid</a></span><span class="Statement">]</span><span class="ocamlEnd">, </span><span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span><span class="Statement">)</span><span class="ocamlEnd">,<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="Constant">Lsequence</span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L1277" title="ocaml/lambda/translmod.ml:1277">store_ident</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span><span class="ocamlEnd">,<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="ocamlLCIdentifier"><a href="#L1209" title="ocaml/lambda/translmod.ml:1209">store_idents</a></span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">pos</span><span class="ocamlEnd"> + </span><span class="Constant">1</span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">idl</span><span class="Statement">))<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Constant">Llet</span><span class="Statement">(<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="translcore.ml.html#L592" title="ocaml/lambda/translcore.ml:592">pure</a></span><span class="ocamlEnd">, </span><span class="Constant">Pgenval</span><span class="ocamlEnd">, </span><span class="ocamlLCIdentifier"><a href="#L707" title="ocaml/lambda/translmod.ml:707">mid</a></span><span class="ocamlEnd">,<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="PreProc">Lambda</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier"><a href="simplif.ml.html#L475" title="ocaml/lambda/simplif.ml:475">subst</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="translclass.ml.html#L720" title="ocaml/lambda/translclass.ml:720">no_env_update</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="simplif.ml.html#L475" title="ocaml/lambda/simplif.ml:475">subst</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="translcore.ml.html#L37" title="ocaml/lambda/translcore.ml:37">transl_module</a></span><span class="ocamlEnd"> </span><span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span><span class="ocamlEnd"> </span><span class="Constant">Tcoerce_none</span><span class="ocamlEnd"> </span><span class="Constant">None</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">od</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">open_expr</span><span class="Statement">)</span><span class="ocamlEnd">,<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="#L1209" title="ocaml/lambda/translmod.ml:1209">store_idents</a></span><span class="ocamlEnd"> </span><span class="Constant">0</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="translcore.ml.html#L1050" title="ocaml/lambda/translcore.ml:1050">ids</a></span><span class="Statement">)<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">end<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_modtype</span> <span class="Statement">_<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_class_type</span> <span class="Statement">_<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_attribute</span> <span class="Statement">_</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">transl_store</span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier">rootpath</span> <span class="ocamlLCIdentifier"><a href="simplif.ml.html#L475" title="ocaml/lambda/simplif.ml:475">subst</a></span> <span class="ocamlLCIdentifier">cont</span> <span class="ocamlLCIdentifier">rem<br/></li>
<li></span><br/></li>
<li><a id="L1277">&#x200c;</a>&nbsp; <span class="Statement">and</span> <span class="ocamlLCIdentifier"><span class="linkable">store_ident</span></span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">try<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">pos</span>, <span class="ocamlLCIdentifier">cc</span><span class="Statement">)</span> <span class="Statement">=</span> <span class="PreProc">Ident</span>.<span class="ocamlLCIdentifier">find_same</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span> <span class="ocamlLCIdentifier"><a href="matching.ml.html#L922" title="ocaml/lambda/matching.ml:922">map</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">init_val</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">apply_coercion</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span> <span class="Constant">Alias</span> <span class="ocamlLCIdentifier">cc</span> <span class="Statement">(</span><span class="Constant">Lvar</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span><span class="Statement">)</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Constant">Lprim</span><span class="Statement">(</span><span class="Constant">Psetfield</span><span class="Statement">(</span><span class="ocamlLCIdentifier">pos</span>, <span class="Constant">Pointer</span>, <span class="Constant">Root_initialization</span><span class="Statement">)</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">[</span><span class="Constant">Lprim</span><span class="Statement">(</span><span class="Constant">Pgetglobal</span> <span class="ocamlLCIdentifier">glob</span>, <span class="Constant">[]</span>, <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span><span class="Statement">);</span> <span class="ocamlLCIdentifier">init_val</span><span class="Statement">]</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">with</span> <span class="Constant">Not_found</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">fatal_error</span><span class="Statement">(</span><span class="Constant">&quot;Translmod.<a href="#L1277" title="ocaml/lambda/translmod.ml:1277">store_ident</a>: &quot;</span> <span class="Statement">^</span> <span class="PreProc">Ident</span>.<span class="ocamlLCIdentifier">unique_name</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li>&nbsp; <span class="Statement">and</span> <span class="ocamlLCIdentifier"><a href="#L1209" title="ocaml/lambda/translmod.ml:1209">store_idents</a></span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L906" title="ocaml/lambda/translcore.ml:906">idlist</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="lambda.mli.html#L408" title="ocaml/lambda/lambda.mli:408">make_sequence</a></span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L1277" title="ocaml/lambda/translmod.ml:1277">store_ident</a></span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span><span class="Statement">)</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L906" title="ocaml/lambda/translcore.ml:906">idlist</a><br/></li>
<li></span><br/></li>
<li>&nbsp; <span class="Statement">and</span> <span class="ocamlLCIdentifier">add_ident</span> <span class="ocamlLCIdentifier">may_coerce</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span> <span class="ocamlLCIdentifier"><a href="simplif.ml.html#L475" title="ocaml/lambda/simplif.ml:475">subst</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">try<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">pos</span>, <span class="ocamlLCIdentifier">cc</span><span class="Statement">)</span> <span class="Statement">=</span> <span class="PreProc">Ident</span>.<span class="ocamlLCIdentifier">find_same</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span> <span class="ocamlLCIdentifier"><a href="matching.ml.html#L922" title="ocaml/lambda/matching.ml:922">map</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">match</span> <span class="ocamlLCIdentifier">cc</span> <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">Tcoerce_none</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="PreProc">Ident</span>.<span class="PreProc">Map</span>.<span class="ocamlLCIdentifier"><a href="matching.ml.html#L884" title="ocaml/lambda/matching.ml:884">add</a></span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="Constant">Lprim</span><span class="Statement">(</span><span class="Constant">Pfield</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">pos</span>, <span class="Constant">Pointer</span>, <span class="Constant">Immutable</span><span class="Statement">)</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">[</span><span class="Constant">Lprim</span><span class="Statement">(</span><span class="Constant">Pgetglobal</span> <span class="ocamlLCIdentifier">glob</span>, <span class="Constant">[]</span>, <span class="Constant">Loc_unknown</span><span class="Statement">)]</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">Loc_unknown</span><span class="Statement">))<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="simplif.ml.html#L475" title="ocaml/lambda/simplif.ml:475">subst</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Statement">_</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">may_coerce</span><span class="ocamlNone"> </span><span class="Statement">then</span> <span class="ocamlLCIdentifier"><a href="simplif.ml.html#L475" title="ocaml/lambda/simplif.ml:475">subst</a></span> <span class="Statement">else</span> <span class="Statement">assert</span> <span class="Constant">false<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">with</span> <span class="Constant">Not_found</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">assert</span> <span class="Constant">false<br/></li>
<li></span><br/></li>
<li>&nbsp; <span class="Statement">and</span> <span class="ocamlLCIdentifier">add_idents</span> <span class="ocamlLCIdentifier">may_coerce</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L906" title="ocaml/lambda/translcore.ml:906">idlist</a></span> <span class="ocamlLCIdentifier"><a href="simplif.ml.html#L475" title="ocaml/lambda/simplif.ml:475">subst</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">List</span>.<span class="ocamlLCIdentifier">fold_right</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">add_ident</span> <span class="ocamlLCIdentifier">may_coerce</span><span class="Statement">)</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L906" title="ocaml/lambda/translcore.ml:906">idlist</a></span> <span class="ocamlLCIdentifier"><a href="simplif.ml.html#L475" title="ocaml/lambda/simplif.ml:475">subst</a><br/></li>
<li></span><br/></li>
<li>&nbsp; <span class="Statement">and</span> <span class="ocamlLCIdentifier">store_primitive</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">pos</span>, <span class="ocamlLCIdentifier"><a href="translprim.ml.html#L80" title="ocaml/lambda/translprim.ml:80">prim</a></span><span class="Statement">)</span> <span class="ocamlLCIdentifier">cont</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">Lsequence</span><span class="Statement">(</span><span class="Constant">Lprim</span><span class="Statement">(</span><span class="Constant">Psetfield</span><span class="Statement">(</span><span class="ocamlLCIdentifier">pos</span>, <span class="Constant">Pointer</span>, <span class="Constant">Root_initialization</span><span class="Statement">)</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">[</span><span class="Constant">Lprim</span><span class="Statement">(</span><span class="Constant">Pgetglobal</span> <span class="ocamlLCIdentifier">glob</span>, <span class="Constant">[]</span>, <span class="Constant">Loc_unknown</span><span class="Statement">);<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="PreProc">Translprim</span>.<span class="ocamlLCIdentifier"><a href="translprim.mli.html#L35" title="ocaml/lambda/translprim.mli:35">transl_primitive</a></span> <span class="Constant">Loc_unknown<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier"><a href="translprim.ml.html#L80" title="ocaml/lambda/translprim.ml:80">prim</a></span>.<span class="ocamlLCIdentifier">pc_desc</span> <span class="ocamlLCIdentifier"><a href="translprim.ml.html#L80" title="ocaml/lambda/translprim.ml:80">prim</a></span>.<span class="ocamlLCIdentifier">pc_env</span> <span class="ocamlLCIdentifier"><a href="translprim.ml.html#L80" title="ocaml/lambda/translprim.ml:80">prim</a></span>.<span class="ocamlLCIdentifier">pc_type</span> <span class="Constant">None</span><span class="Statement">]</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">Loc_unknown</span><span class="Statement">)</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">cont</span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li>&nbsp; <span class="Statement">and</span> <span class="ocamlLCIdentifier">store_alias</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">pos</span>, <span class="ocamlLCIdentifier">env</span>, <span class="ocamlLCIdentifier"><a href="translclass.ml.html#L444" title="ocaml/lambda/translclass.ml:444">path</a></span>, <span class="ocamlLCIdentifier">cc</span><span class="Statement">)</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">path_lam</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="lambda.mli.html#L403" title="ocaml/lambda/lambda.mli:403">transl_module_path</a></span> <span class="Constant">Loc_unknown</span> <span class="ocamlLCIdentifier">env</span> <span class="ocamlLCIdentifier"><a href="translclass.ml.html#L444" title="ocaml/lambda/translclass.ml:444">path</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">init_val</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">apply_coercion</span> <span class="Constant">Loc_unknown</span> <span class="Constant">Strict</span> <span class="ocamlLCIdentifier">cc</span> <span class="ocamlLCIdentifier">path_lam</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">Lprim</span><span class="Statement">(</span><span class="Constant">Psetfield</span><span class="Statement">(</span><span class="ocamlLCIdentifier">pos</span>, <span class="Constant">Pointer</span>, <span class="Constant">Root_initialization</span><span class="Statement">)</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">[</span><span class="Constant">Lprim</span><span class="Statement">(</span><span class="Constant">Pgetglobal</span> <span class="ocamlLCIdentifier">glob</span>, <span class="Constant">[]</span>, <span class="Constant">Loc_unknown</span><span class="Statement">);<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier">init_val</span><span class="Statement">]</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">Loc_unknown</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">aliases</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="lambda.mli.html#L408" title="ocaml/lambda/lambda.mli:408">make_sequence</a></span> <span class="ocamlLCIdentifier">store_alias</span> <span class="ocamlLCIdentifier">aliases</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="PreProc">List</span>.<span class="ocamlLCIdentifier">fold_right</span> <span class="ocamlLCIdentifier">store_primitive</span> <span class="ocamlLCIdentifier">prims<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">(</span><span class="ocamlLCIdentifier">transl_store</span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L53" title="ocaml/lambda/translmod.ml:53">global_path</a></span> <span class="ocamlLCIdentifier">glob</span><span class="Statement">)</span> <span class="Statement">!</span><span class="ocamlLCIdentifier"><a href="#L961" title="ocaml/lambda/translmod.ml:961">transl_store_subst</a></span> <span class="ocamlLCIdentifier">aliases</span> <span class="ocamlLCIdentifier">str</span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li><span class="Comment">(* Transform a coercion and the <a href="tmc.ml.html#L478" title="ocaml/lambda/tmc.ml:478">list</a> of value identifiers defined by<br/></li>
<li></span><span class="Comment">&nbsp;&nbsp; a toplevel structure into a <a href="translclass.ml.html#L769" title="ocaml/lambda/translclass.ml:769">table</a> [<a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a> -&gt; (pos, coercion)],<br/></li>
<li></span><span class="Comment">&nbsp;&nbsp; with [pos] being the position in the global block where the value of<br/></li>
<li></span><span class="Comment">&nbsp;&nbsp; [<a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a>] must be stored, and [coercion] the coercion to be applied to it.<br/></li>
<li></span><span class="Comment">&nbsp;&nbsp; A given identifier may appear several times<br/></li>
<li></span><span class="Comment">&nbsp;&nbsp; in the coercion (if it occurs several times in the signature); remember<br/></li>
<li></span><span class="Comment">&nbsp;&nbsp; to assign it the position of its <a href="matching.ml.html#L2491" title="ocaml/lambda/matching.ml:2491">last</a> occurrence.<br/></li>
<li></span><span class="Comment">&nbsp;&nbsp; Identifiers that are not exported are assigned positions at the<br/></li>
<li></span><span class="Comment">&nbsp;&nbsp; end of the block (beyond the positions of all exported idents).<br/></li>
<li></span><span class="Comment">&nbsp;&nbsp; Also compute the total <a href="matching.ml.html#L3846" title="ocaml/lambda/matching.ml:3846">size</a> of the global block,<br/></li>
<li></span><span class="Comment">&nbsp;&nbsp; and the <a href="tmc.ml.html#L478" title="ocaml/lambda/tmc.ml:478">list</a> of all primitives exported as values. *)<br/></li>
<li></span><br/></li>
<li><a id="L1340">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">build_ident_map</span></span> <span class="ocamlLCIdentifier">restr</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L906" title="ocaml/lambda/translcore.ml:906">idlist</a></span> <span class="ocamlLCIdentifier">more_ids</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="Statement">rec</span> <span class="ocamlLCIdentifier">natural_map</span> <span class="ocamlLCIdentifier">pos</span> <span class="ocamlLCIdentifier"><a href="matching.ml.html#L922" title="ocaml/lambda/matching.ml:922">map</a></span> <span class="ocamlLCIdentifier">prims</span> <span class="ocamlLCIdentifier">aliases</span> <span class="Statement">=</span> <span class="Statement">function<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">[]</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="matching.ml.html#L922" title="ocaml/lambda/matching.ml:922">map</a></span>, <span class="ocamlLCIdentifier">prims</span>, <span class="ocamlLCIdentifier">aliases</span>, <span class="ocamlLCIdentifier">pos</span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span> <span class="Statement">::</span> <span class="ocamlLCIdentifier">rem</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">natural_map</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">pos</span>+<span class="Constant">1</span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="PreProc">Ident</span>.<span class="ocamlLCIdentifier"><a href="matching.ml.html#L884" title="ocaml/lambda/matching.ml:884">add</a></span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span> <span class="Statement">(</span><span class="ocamlLCIdentifier">pos</span>, <span class="Constant">Tcoerce_none</span><span class="Statement">)</span> <span class="ocamlLCIdentifier"><a href="matching.ml.html#L922" title="ocaml/lambda/matching.ml:922">map</a></span><span class="Statement">)</span> <span class="ocamlLCIdentifier">prims</span> <span class="ocamlLCIdentifier">aliases</span> <span class="ocamlLCIdentifier">rem<br/></li>
<li></span>&nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="matching.ml.html#L922" title="ocaml/lambda/matching.ml:922">map</a></span>, <span class="ocamlLCIdentifier">prims</span>, <span class="ocamlLCIdentifier">aliases</span>, <span class="ocamlLCIdentifier">pos</span><span class="Statement">)</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">match</span> <span class="ocamlLCIdentifier">restr</span> <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tcoerce_none</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">natural_map</span> <span class="Constant">0</span> <span class="PreProc">Ident</span>.<span class="ocamlLCIdentifier"><a href="matching.ml.html#L533" title="ocaml/lambda/matching.ml:533">empty</a></span> <span class="Constant">[]</span> <span class="Constant">[]</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L906" title="ocaml/lambda/translcore.ml:906">idlist</a><br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tcoerce_structure</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">pos_cc_list</span>, <span class="ocamlLCIdentifier">_id_pos_list</span><span class="Statement">)</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">(* ignore _id_pos_list as the <a href="translcore.ml.html#L1050" title="ocaml/lambda/translcore.ml:1050">ids</a> are already bound *)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">idarray</span> <span class="Statement">=</span> <span class="PreProc">Array</span>.<span class="ocamlLCIdentifier">of_list</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L906" title="ocaml/lambda/translcore.ml:906">idlist</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="Statement">rec</span> <span class="ocamlLCIdentifier">export_map</span> <span class="ocamlLCIdentifier">pos</span> <span class="ocamlLCIdentifier"><a href="matching.ml.html#L922" title="ocaml/lambda/matching.ml:922">map</a></span> <span class="ocamlLCIdentifier">prims</span> <span class="ocamlLCIdentifier">aliases</span> <span class="ocamlLCIdentifier">undef</span> <span class="Statement">=</span> <span class="Statement">function<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">[]</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">natural_map</span> <span class="ocamlLCIdentifier">pos</span> <span class="ocamlLCIdentifier"><a href="matching.ml.html#L922" title="ocaml/lambda/matching.ml:922">map</a></span> <span class="ocamlLCIdentifier">prims</span> <span class="ocamlLCIdentifier">aliases</span> <span class="ocamlLCIdentifier">undef<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">_source_pos</span>, <span class="Constant">Tcoerce_primitive</span> <span class="ocamlLCIdentifier">p</span><span class="Statement">)</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier">rem</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">export_map</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">pos</span> + <span class="Constant">1</span><span class="Statement">)</span> <span class="ocamlLCIdentifier"><a href="matching.ml.html#L922" title="ocaml/lambda/matching.ml:922">map</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">((</span><span class="ocamlLCIdentifier">pos</span>, <span class="ocamlLCIdentifier">p</span><span class="Statement">)</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier">prims</span><span class="Statement">)</span> <span class="ocamlLCIdentifier">aliases</span> <span class="ocamlLCIdentifier">undef</span> <span class="ocamlLCIdentifier">rem<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">_source_pos</span>, <span class="Constant">Tcoerce_alias</span><span class="Statement">(</span><span class="ocamlLCIdentifier">env</span>, <span class="ocamlLCIdentifier"><a href="translclass.ml.html#L444" title="ocaml/lambda/translclass.ml:444">path</a></span>, <span class="ocamlLCIdentifier">cc</span><span class="Statement">))</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier">rem</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">export_map</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">pos</span> + <span class="Constant">1</span><span class="Statement">)</span> <span class="ocamlLCIdentifier"><a href="matching.ml.html#L922" title="ocaml/lambda/matching.ml:922">map</a></span> <span class="ocamlLCIdentifier">prims<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">((</span><span class="ocamlLCIdentifier">pos</span>, <span class="ocamlLCIdentifier">env</span>, <span class="ocamlLCIdentifier"><a href="translclass.ml.html#L444" title="ocaml/lambda/translclass.ml:444">path</a></span>, <span class="ocamlLCIdentifier">cc</span><span class="Statement">)</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier">aliases</span><span class="Statement">)</span> <span class="ocamlLCIdentifier">undef</span> <span class="ocamlLCIdentifier">rem<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">source_pos</span>, <span class="ocamlLCIdentifier">cc</span><span class="Statement">)</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier">rem</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">idarray</span>.<span class="Statement">(</span><span class="ocamlLCIdentifier">source_pos</span><span class="Statement">)</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">export_map</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">pos</span> + <span class="Constant">1</span><span class="Statement">)</span> <span class="Statement">(</span><span class="PreProc">Ident</span>.<span class="ocamlLCIdentifier"><a href="matching.ml.html#L884" title="ocaml/lambda/matching.ml:884">add</a></span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span> <span class="Statement">(</span><span class="ocamlLCIdentifier">pos</span>, <span class="ocamlLCIdentifier">cc</span><span class="Statement">)</span> <span class="ocamlLCIdentifier"><a href="matching.ml.html#L922" title="ocaml/lambda/matching.ml:922">map</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">prims</span> <span class="ocamlLCIdentifier">aliases</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">list_remove</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span> <span class="ocamlLCIdentifier">undef</span><span class="Statement">)</span> <span class="ocamlLCIdentifier">rem<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">export_map</span> <span class="Constant">0</span> <span class="PreProc">Ident</span>.<span class="ocamlLCIdentifier"><a href="matching.ml.html#L533" title="ocaml/lambda/matching.ml:533">empty</a></span> <span class="Constant">[]</span> <span class="Constant">[]</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L906" title="ocaml/lambda/translcore.ml:906">idlist</a></span> <span class="ocamlLCIdentifier">pos_cc_list<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Statement">_</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">fatal_error</span> <span class="Constant">&quot;Translmod.<a href="#L1340" title="ocaml/lambda/translmod.ml:1340">build_ident_map</a>&quot;<br/></li>
<li></span>&nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier">natural_map</span> <span class="ocamlLCIdentifier">pos</span> <span class="ocamlLCIdentifier"><a href="matching.ml.html#L922" title="ocaml/lambda/matching.ml:922">map</a></span> <span class="ocamlLCIdentifier">prims</span> <span class="ocamlLCIdentifier">aliases</span> <span class="ocamlLCIdentifier">more_ids<br/></li>
<li></span><br/></li>
<li><span class="Comment">(* Compile an implementation using <a href="#L985" title="ocaml/lambda/translmod.ml:985">transl_store_structure</a><br/></li>
<li></span><span class="Comment">&nbsp;&nbsp; (for the native-code compiler). *)<br/></li>
<li></span><br/></li>
<li><a id="L1378">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">transl_store_gen</span></span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier"><a href="translprim.ml.html#L648" title="ocaml/lambda/translprim.ml:648">module_name</a></span> <span class="Statement">({</span> <span class="ocamlLCIdentifier">str_items</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">str</span> <span class="Statement">}</span>, <span class="ocamlLCIdentifier">restr</span><span class="Statement">)</span> <span class="ocamlLCIdentifier">topl</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier"><a href="translobj.ml.html#L77" title="ocaml/lambda/translobj.ml:77">reset_labels</a></span> <span class="Constant">()</span><span class="Statement">;<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier"><a href="translmod.mli.html#L43" title="ocaml/lambda/translmod.mli:43">primitive_declarations</a></span> <span class="Statement">:=</span> <span class="Constant">[]</span><span class="Statement">;<br/></li>
<li></span>&nbsp; <span class="PreProc">Translprim</span>.<span class="ocamlLCIdentifier"><a href="translprim.mli.html#L29" title="ocaml/lambda/translprim.mli:29">clear_used_primitives</a></span> <span class="Constant">()</span><span class="Statement">;<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">module_id</span> <span class="Statement">=</span> <span class="PreProc">Ident</span>.<span class="ocamlLCIdentifier">create_persistent</span> <span class="ocamlLCIdentifier"><a href="translprim.ml.html#L648" title="ocaml/lambda/translprim.ml:648">module_name</a></span> <span class="Statement">in<br/></li>
<li><a id="L1383">&#x200c;</a></span>&nbsp; <span class="Statement">let</span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><span class="linkable">map</span></span>, <span class="ocamlLCIdentifier">prims</span>, <span class="ocamlLCIdentifier">aliases</span>, <span class="ocamlLCIdentifier"><a href="matching.ml.html#L3846" title="ocaml/lambda/matching.ml:3846">size</a></span><span class="Statement">)</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L1340" title="ocaml/lambda/translmod.ml:1340">build_ident_map</a></span> <span class="ocamlLCIdentifier">restr</span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L829" title="ocaml/lambda/translmod.ml:829">defined_idents</a></span> <span class="ocamlLCIdentifier">str</span><span class="Statement">)</span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L860" title="ocaml/lambda/translmod.ml:860">more_idents</a></span> <span class="ocamlLCIdentifier">str</span><span class="Statement">)</span> <span class="Statement">in<br/></li>
<li><a id="L1385">&#x200c;</a></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">f</span></span> <span class="Statement">=</span> <span class="Statement">function<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Statement">[</span> <span class="Statement">{</span> <span class="ocamlLCIdentifier">str_desc</span> <span class="Statement">=</span> <span class="Constant">Tstr_eval</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">expr</span>, <span class="ocamlLCIdentifier">_attrs</span><span class="Statement">)</span> <span class="Statement">}</span> <span class="Statement">]</span> <span class="Statement">when</span> <span class="ocamlLCIdentifier">topl</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">assert</span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="matching.ml.html#L3846" title="ocaml/lambda/matching.ml:3846">size</a></span> <span class="Statement">=</span> <span class="Constant">0</span><span class="Statement">);<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="PreProc">Lambda</span>.<span class="ocamlLCIdentifier"><a href="simplif.ml.html#L475" title="ocaml/lambda/simplif.ml:475">subst</a></span> <span class="Statement">(fun</span> <span class="Statement">_</span> <span class="Statement">_</span> <span class="ocamlLCIdentifier">env</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier">env</span><span class="Statement">)</span> <span class="Statement">!</span><span class="ocamlLCIdentifier"><a href="#L961" title="ocaml/lambda/translmod.ml:961">transl_store_subst</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="translcore.ml.html#L216" title="ocaml/lambda/translcore.ml:216">transl_exp</a></span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier">expr</span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="ocamlLCIdentifier">str</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier"><a href="#L985" title="ocaml/lambda/translmod.ml:985">transl_store_structure</a></span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier">module_id</span> <span class="ocamlLCIdentifier"><a href="matching.ml.html#L922" title="ocaml/lambda/matching.ml:922">map</a></span> <span class="ocamlLCIdentifier">prims</span> <span class="ocamlLCIdentifier">aliases</span> <span class="ocamlLCIdentifier">str<br/></li>
<li></span>&nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier"><a href="translobj.ml.html#L125" title="ocaml/lambda/translobj.ml:125">transl_store_label_init</a></span> <span class="ocamlLCIdentifier">module_id</span> <span class="ocamlLCIdentifier"><a href="matching.ml.html#L3846" title="ocaml/lambda/matching.ml:3846">size</a></span> <span class="ocamlLCIdentifier"><a href="#L1385" title="ocaml/lambda/translmod.ml:1385">f</a></span> <span class="ocamlLCIdentifier">str<br/></li>
<li></span>&nbsp; <span class="Comment">(*<a href="matching.ml.html#L3846" title="ocaml/lambda/matching.ml:3846">size</a>, <a href="translobj.ml.html#L148" title="ocaml/lambda/translobj.ml:148">transl_label_init</a> (<a href="#L985" title="ocaml/lambda/translmod.ml:985">transl_store_structure</a> module_id <a href="matching.ml.html#L922" title="ocaml/lambda/matching.ml:922">map</a> prims str)*)<br/></li>
<li></span><br/></li>
<li><a id="L1395">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">transl_store_phrases</span></span> <span class="ocamlLCIdentifier"><a href="translprim.ml.html#L648" title="ocaml/lambda/translprim.ml:648">module_name</a></span> <span class="ocamlLCIdentifier">str</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier">enter_module_definition</span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span>:<span class="ocamlLCIdentifier"><a href="debuginfo.ml.html#L39" title="ocaml/lambda/debuginfo.ml:39">empty_scopes</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="PreProc">Ident</span>.<span class="ocamlLCIdentifier">create_persistent</span> <span class="ocamlLCIdentifier"><a href="translprim.ml.html#L648" title="ocaml/lambda/translprim.ml:648">module_name</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier"><a href="#L1378" title="ocaml/lambda/translmod.ml:1378">transl_store_gen</a></span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier"><a href="translprim.ml.html#L648" title="ocaml/lambda/translprim.ml:648">module_name</a></span> <span class="Statement">(</span><span class="ocamlLCIdentifier">str</span>,<span class="Constant">Tcoerce_none</span><span class="Statement">)</span> <span class="Constant">true<br/></li>
<li></span><br/></li>
<li><a id="L1402">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">transl_store_implementation</span></span> <span class="ocamlLCIdentifier"><a href="translprim.ml.html#L648" title="ocaml/lambda/translprim.ml:648">module_name</a></span> <span class="Statement">(</span><span class="ocamlLCIdentifier">str</span>, <span class="ocamlLCIdentifier">restr</span><span class="Statement">)</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="translclass.ml.html#L563" title="ocaml/lambda/translclass.ml:563">s</a></span> <span class="Statement">=</span> <span class="Statement">!</span><span class="ocamlLCIdentifier"><a href="#L961" title="ocaml/lambda/translmod.ml:961">transl_store_subst</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier"><a href="#L961" title="ocaml/lambda/translmod.ml:961">transl_store_subst</a></span> <span class="Statement">:=</span> <span class="PreProc">Ident</span>.<span class="PreProc">Map</span>.<span class="ocamlLCIdentifier"><a href="matching.ml.html#L533" title="ocaml/lambda/matching.ml:533">empty</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">module_ident</span> <span class="Statement">=</span> <span class="PreProc">Ident</span>.<span class="ocamlLCIdentifier">create_persistent</span> <span class="ocamlLCIdentifier"><a href="translprim.ml.html#L648" title="ocaml/lambda/translprim.ml:648">module_name</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">enter_module_definition</span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span>:<span class="ocamlLCIdentifier"><a href="debuginfo.ml.html#L39" title="ocaml/lambda/debuginfo.ml:39">empty_scopes</a></span> <span class="ocamlLCIdentifier">module_ident</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="translclass.ml.html#L713" title="ocaml/lambda/translclass.ml:713">i</a></span>, <span class="ocamlLCIdentifier">code</span><span class="Statement">)</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="#L1378" title="ocaml/lambda/translmod.ml:1378">transl_store_gen</a></span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier"><a href="translprim.ml.html#L648" title="ocaml/lambda/translprim.ml:648">module_name</a></span> <span class="Statement">(</span><span class="ocamlLCIdentifier">str</span>, <span class="ocamlLCIdentifier">restr</span><span class="Statement">)</span> <span class="Constant">false</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier"><a href="#L961" title="ocaml/lambda/translmod.ml:961">transl_store_subst</a></span> <span class="Statement">:=</span> <span class="ocamlLCIdentifier"><a href="translclass.ml.html#L563" title="ocaml/lambda/translclass.ml:563">s</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; <span class="Statement">{</span> <span class="PreProc">Lambda</span>.<span class="ocamlLCIdentifier">main_module_block_size</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="translclass.ml.html#L713" title="ocaml/lambda/translclass.ml:713">i</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier">code</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="Comment">(* module_ident is not used by closure, but this allow to <a href="translobj.ml.html#L27" title="ocaml/lambda/translobj.ml:27">share</a><br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp;&nbsp; the type with the flambda version *)<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier">module_ident</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L777" title="ocaml/lambda/translmod.ml:777">required_globals</a></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="#L777" title="ocaml/lambda/translmod.ml:777">required_globals</a></span> <span class="Statement">~</span><span class="Identifier">flambda</span>:<span class="Constant">true</span> <span class="ocamlLCIdentifier">code</span> <span class="Statement">}<br/></li>
<li></span><br/></li>
<li><span class="Comment">(* Compile a toplevel phrase *)<br/></li>
<li></span><br/></li>
<li><a id="L1418">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">toploop_ident</span></span> <span class="Statement">=</span> <span class="PreProc">Ident</span>.<span class="ocamlLCIdentifier">create_persistent</span> <span class="Constant">&quot;Toploop&quot;<br/></li>
<li><a id="L1419">&#x200c;</a></span><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">toploop_getvalue_pos</span></span> <span class="Statement">=</span> <span class="Constant">0</span> <span class="Comment">(* position of getvalue in module Toploop *)<br/></li>
<li><a id="L1420">&#x200c;</a></span><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">toploop_setvalue_pos</span></span> <span class="Statement">=</span> <span class="Constant">1</span> <span class="Comment">(* position of setvalue in module Toploop *)<br/></li>
<li></span><br/></li>
<li><a id="L1422">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">aliased_idents</span></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">ref</span> <span class="PreProc">Ident</span>.<span class="ocamlLCIdentifier"><a href="matching.ml.html#L533" title="ocaml/lambda/matching.ml:533">empty</a><br/></li>
<li></span><br/></li>
<li><a id="L1424">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">set_toplevel_unique_name</span></span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier"><a href="#L1422" title="ocaml/lambda/translmod.ml:1422">aliased_idents</a></span> <span class="Statement">:=<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">Ident</span>.<span class="ocamlLCIdentifier"><a href="matching.ml.html#L884" title="ocaml/lambda/matching.ml:884">add</a></span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span> <span class="Statement">(</span><span class="PreProc">Ident</span>.<span class="ocamlLCIdentifier">unique_toplevel_name</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span><span class="Statement">)</span> <span class="Statement">!</span><span class="ocamlLCIdentifier"><a href="#L1422" title="ocaml/lambda/translmod.ml:1422">aliased_idents</a><br/></li>
<li></span><br/></li>
<li><a id="L1428">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">toplevel_name</span></span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">try</span> <span class="PreProc">Ident</span>.<span class="ocamlLCIdentifier">find_same</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span> <span class="Statement">!</span><span class="ocamlLCIdentifier"><a href="#L1422" title="ocaml/lambda/translmod.ml:1422">aliased_idents</a><br/></li>
<li></span>&nbsp; <span class="Statement">with</span> <span class="Constant">Not_found</span> <span class="Statement">-&gt;</span> <span class="PreProc">Ident</span>.<span class="ocamlLCIdentifier"><a href="translcore.ml.html#L56" title="ocaml/lambda/translcore.ml:56">name</a></span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a><br/></li>
<li></span><br/></li>
<li><a id="L1432">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">toploop_getvalue</span></span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Constant">Lapply</span><span class="Statement">{<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier">ap_loc</span><span class="Statement">=</span><span class="Constant">Loc_unknown</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier">ap_func</span><span class="Statement">=</span><span class="Constant">Lprim</span><span class="Statement">(</span><span class="Constant">Pfield</span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L1419" title="ocaml/lambda/translmod.ml:1419">toploop_getvalue_pos</a></span>, <span class="Constant">Pointer</span>, <span class="Constant">Mutable</span><span class="Statement">)</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">[</span><span class="Constant">Lprim</span><span class="Statement">(</span><span class="Constant">Pgetglobal</span> <span class="ocamlLCIdentifier"><a href="#L1418" title="ocaml/lambda/translmod.ml:1418">toploop_ident</a></span>, <span class="Constant">[]</span>, <span class="Constant">Loc_unknown</span><span class="Statement">)]</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">Loc_unknown</span><span class="Statement">);<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier">ap_args</span><span class="Statement">=[</span><span class="Constant">Lconst</span><span class="Statement">(</span><span class="Constant">Const_base</span><span class="Statement">(<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Constant">Const_string</span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="translmod.mli.html#L40" title="ocaml/lambda/translmod.mli:40">toplevel_name</a></span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span>, <span class="PreProc">Location</span>.<span class="ocamlLCIdentifier"><a href="debuginfo.ml.html#L118" title="ocaml/lambda/debuginfo.ml:118">none</a></span>, <span class="Constant">None</span><span class="Statement">)))];<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier">ap_tailcall</span><span class="Statement">=</span><span class="Constant">Default_tailcall</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier">ap_inlined</span><span class="Statement">=</span><span class="Constant">Default_inline</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier">ap_specialised</span><span class="Statement">=</span><span class="Constant">Default_specialise</span><span class="Statement">;<br/></li>
<li></span>&nbsp; <span class="Statement">}<br/></li>
<li></span><br/></li>
<li><a id="L1445">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">toploop_setvalue</span></span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span> <span class="ocamlLCIdentifier"><a href="translobj.ml.html#L145" title="ocaml/lambda/translobj.ml:145">lam</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Constant">Lapply</span><span class="Statement">{<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier">ap_loc</span><span class="Statement">=</span><span class="Constant">Loc_unknown</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier">ap_func</span><span class="Statement">=</span><span class="Constant">Lprim</span><span class="Statement">(</span><span class="Constant">Pfield</span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L1420" title="ocaml/lambda/translmod.ml:1420">toploop_setvalue_pos</a></span>, <span class="Constant">Pointer</span>, <span class="Constant">Mutable</span><span class="Statement">)</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">[</span><span class="Constant">Lprim</span><span class="Statement">(</span><span class="Constant">Pgetglobal</span> <span class="ocamlLCIdentifier"><a href="#L1418" title="ocaml/lambda/translmod.ml:1418">toploop_ident</a></span>, <span class="Constant">[]</span>, <span class="Constant">Loc_unknown</span><span class="Statement">)]</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">Loc_unknown</span><span class="Statement">);<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier">ap_args</span><span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">[</span><span class="Constant">Lconst</span><span class="Statement">(</span><span class="Constant">Const_base</span><span class="Statement">(<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">Const_string</span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="translmod.mli.html#L40" title="ocaml/lambda/translmod.mli:40">toplevel_name</a></span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span>, <span class="PreProc">Location</span>.<span class="ocamlLCIdentifier"><a href="debuginfo.ml.html#L118" title="ocaml/lambda/debuginfo.ml:118">none</a></span>, <span class="Constant">None</span><span class="Statement">)));<br/></li>
<li></span>&nbsp; &nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier"><a href="translobj.ml.html#L145" title="ocaml/lambda/translobj.ml:145">lam</a></span><span class="Statement">];<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier">ap_tailcall</span><span class="Statement">=</span><span class="Constant">Default_tailcall</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier">ap_inlined</span><span class="Statement">=</span><span class="Constant">Default_inline</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier">ap_specialised</span><span class="Statement">=</span><span class="Constant">Default_specialise</span><span class="Statement">;<br/></li>
<li></span>&nbsp; <span class="Statement">}<br/></li>
<li></span><br/></li>
<li><a id="L1460">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">toploop_setvalue_id</span></span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="#L1445" title="ocaml/lambda/translmod.ml:1445">toploop_setvalue</a></span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span> <span class="Statement">(</span><span class="Constant">Lvar</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li><a id="L1462">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">close_toplevel_term</span></span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="translobj.ml.html#L145" title="ocaml/lambda/translobj.ml:145">lam</a></span>, <span class="Constant">()</span><span class="Statement">)</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="PreProc">Ident</span>.<span class="PreProc">Set</span>.<span class="ocamlLCIdentifier">fold</span> <span class="Statement">(fun</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L708" title="ocaml/lambda/translcore.ml:708">l</a></span> <span class="Statement">-&gt;</span> <span class="Constant">Llet</span><span class="Statement">(</span><span class="Constant">Strict</span>, <span class="Constant">Pgenval</span>, <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L1432" title="ocaml/lambda/translmod.ml:1432">toploop_getvalue</a></span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span>, <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L708" title="ocaml/lambda/translcore.ml:708">l</a></span><span class="Statement">))<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="lambda.mli.html#L401" title="ocaml/lambda/lambda.mli:401">free_variables</a></span> <span class="ocamlLCIdentifier"><a href="translobj.ml.html#L145" title="ocaml/lambda/translobj.ml:145">lam</a></span><span class="Statement">)</span> <span class="ocamlLCIdentifier"><a href="translobj.ml.html#L145" title="ocaml/lambda/translobj.ml:145">lam</a><br/></li>
<li></span><br/></li>
<li><span class="Statement">let</span> <span class="ocamlLCIdentifier">transl_toplevel_item</span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier"><a href="debuginfo.mli.html#L38" title="ocaml/lambda/debuginfo.mli:38">item</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">match</span> <span class="ocamlLCIdentifier"><a href="debuginfo.mli.html#L38" title="ocaml/lambda/debuginfo.mli:38">item</a></span>.<span class="ocamlLCIdentifier">str_desc</span> <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">Tstr_eval</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">expr</span>, <span class="Statement">_)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_value</span><span class="Statement">(</span><span class="Constant">Nonrecursive</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">[{</span><span class="ocamlLCIdentifier">vb_pat</span> <span class="Statement">=</span> <span class="Statement">{</span><span class="ocamlLCIdentifier">pat_desc</span><span class="Statement">=</span><span class="Constant">Tpat_any</span><span class="Statement">};</span><span class="ocamlLCIdentifier">vb_expr</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">expr</span><span class="Statement">}])</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Comment">(* special compilation for toplevel &quot;let _ = expr&quot;, so<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; that Toploop can display the result of the expression.<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; Otherwise, the normal compilation would result<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; in a Lsequence returning <a href="tmc.ml.html#L197" title="ocaml/lambda/tmc.ml:197">unit</a>. *)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L216" title="ocaml/lambda/translcore.ml:216">transl_exp</a></span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier">expr<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_value</span><span class="Statement">(</span><span class="ocamlLCIdentifier">rec_flag</span>, <span class="ocamlLCIdentifier">pat_expr_list</span><span class="Statement">)</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">idents</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">let_bound_idents</span> <span class="ocamlLCIdentifier">pat_expr_list</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="translcore.mli.html#L33" title="ocaml/lambda/translcore.mli:33">transl_let</a></span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="Statement">~</span><span class="Identifier">in_structure</span>:<span class="Constant">true</span> <span class="ocamlLCIdentifier">rec_flag</span> <span class="ocamlLCIdentifier">pat_expr_list<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="lambda.mli.html#L408" title="ocaml/lambda/lambda.mli:408">make_sequence</a></span> <span class="ocamlLCIdentifier"><a href="#L1460" title="ocaml/lambda/translmod.ml:1460">toploop_setvalue_id</a></span> <span class="ocamlLCIdentifier">idents</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_typext</span><span class="Statement">(</span><span class="ocamlLCIdentifier">tyext</span><span class="Statement">)</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">idents</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="PreProc">List</span>.<span class="ocamlLCIdentifier"><a href="matching.ml.html#L922" title="ocaml/lambda/matching.ml:922">map</a></span> <span class="Statement">(fun</span> <span class="ocamlLCIdentifier">ext</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier">ext</span>.<span class="ocamlLCIdentifier">ext_id</span><span class="Statement">)</span> <span class="ocamlLCIdentifier">tyext</span>.<span class="ocamlLCIdentifier">tyext_constructors<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Comment">(* we need to use unique <a href="translcore.ml.html#L56" title="ocaml/lambda/translcore.ml:56">name</a> in case of multiple<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; definitions of the same extension constructor in the toplevel *)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="PreProc">List</span>.<span class="ocamlLCIdentifier">iter</span> <span class="ocamlLCIdentifier"><a href="#L1424" title="ocaml/lambda/translmod.ml:1424">set_toplevel_unique_name</a></span> <span class="ocamlLCIdentifier">idents</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L65" title="ocaml/lambda/translmod.ml:65">transl_type_extension</a></span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier"><a href="debuginfo.mli.html#L38" title="ocaml/lambda/debuginfo.mli:38">item</a></span>.<span class="ocamlLCIdentifier">str_env</span> <span class="Constant">None</span> <span class="ocamlLCIdentifier">tyext<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="lambda.mli.html#L408" title="ocaml/lambda/lambda.mli:408">make_sequence</a></span> <span class="ocamlLCIdentifier"><a href="#L1460" title="ocaml/lambda/translmod.ml:1460">toploop_setvalue_id</a></span> <span class="ocamlLCIdentifier">idents</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_exception</span> <span class="ocamlLCIdentifier">ext</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L1424" title="ocaml/lambda/translmod.ml:1424">set_toplevel_unique_name</a></span> <span class="ocamlLCIdentifier">ext</span>.<span class="ocamlLCIdentifier">tyexn_constructor</span>.<span class="ocamlLCIdentifier">ext_id</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L1445" title="ocaml/lambda/translmod.ml:1445">toploop_setvalue</a></span> <span class="ocamlLCIdentifier">ext</span>.<span class="ocamlLCIdentifier">tyexn_constructor</span>.<span class="ocamlLCIdentifier">ext_id<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="translcore.mli.html#L36" title="ocaml/lambda/translcore.mli:36">transl_extension_constructor</a></span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier"><a href="debuginfo.mli.html#L38" title="ocaml/lambda/debuginfo.mli:38">item</a></span>.<span class="ocamlLCIdentifier">str_env</span> <span class="Constant">None</span> <span class="ocamlLCIdentifier">ext</span>.<span class="ocamlLCIdentifier">tyexn_constructor</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_module</span> <span class="Statement">{</span><span class="ocamlLCIdentifier">mb_id</span><span class="Statement">=</span><span class="Constant">None</span><span class="Statement">;</span> <span class="ocamlLCIdentifier">mb_presence</span><span class="Statement">=</span><span class="Constant">Mp_present</span><span class="Statement">;</span> <span class="ocamlLCIdentifier">mb_expr</span><span class="Statement">=</span><span class="ocamlLCIdentifier"><a href="#L706" title="ocaml/lambda/translmod.ml:706">modl</a></span><span class="Statement">}</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L37" title="ocaml/lambda/translcore.ml:37">transl_module</a></span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="Constant">Tcoerce_none</span> <span class="Constant">None</span> <span class="ocamlLCIdentifier"><a href="#L706" title="ocaml/lambda/translmod.ml:706">modl</a><br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_module</span> <span class="Statement">{</span><span class="ocamlLCIdentifier">mb_id</span><span class="Statement">=</span><span class="Constant">Some</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span><span class="Statement">;</span> <span class="ocamlLCIdentifier">mb_presence</span><span class="Statement">=</span><span class="Constant">Mp_present</span><span class="Statement">;</span> <span class="ocamlLCIdentifier">mb_expr</span><span class="Statement">=</span><span class="ocamlLCIdentifier"><a href="#L706" title="ocaml/lambda/translmod.ml:706">modl</a></span><span class="Statement">}</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Comment">(* we need to use the unique <a href="translcore.ml.html#L56" title="ocaml/lambda/translcore.ml:56">name</a> for the module because of issues<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; with &quot;<a href="matching.ml.html#L419" title="ocaml/lambda/matching.ml:419">open</a>&quot; (PR#8133) *)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L1424" title="ocaml/lambda/translmod.ml:1424">set_toplevel_unique_name</a></span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="translobj.ml.html#L145" title="ocaml/lambda/translobj.ml:145">lam</a></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L37" title="ocaml/lambda/translcore.ml:37">transl_module</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span>:<span class="Statement">(</span><span class="ocamlLCIdentifier">enter_module_definition</span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">Tcoerce_none</span> <span class="Statement">(</span><span class="Constant">Some</span><span class="Statement">(</span><span class="Constant">Pident</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span><span class="Statement">))</span> <span class="ocamlLCIdentifier"><a href="#L706" title="ocaml/lambda/translmod.ml:706">modl</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L1445" title="ocaml/lambda/translmod.ml:1445">toploop_setvalue</a></span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span> <span class="ocamlLCIdentifier"><a href="translobj.ml.html#L145" title="ocaml/lambda/translobj.ml:145">lam</a><br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_recmodule</span> <span class="ocamlLCIdentifier">bindings</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">idents</span> <span class="Statement">=</span> <span class="PreProc">List</span>.<span class="ocamlLCIdentifier">filter_map</span> <span class="Statement">(fun</span> <span class="ocamlLCIdentifier">mb</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier">mb</span>.<span class="ocamlLCIdentifier">mb_id</span><span class="Statement">)</span> <span class="ocamlLCIdentifier">bindings</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L405" title="ocaml/lambda/translmod.ml:405">compile_recmodule</a></span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">(fun</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span> <span class="ocamlLCIdentifier"><a href="#L706" title="ocaml/lambda/translmod.ml:706">modl</a></span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">match</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span> <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">|</span> <span class="Constant">None</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L37" title="ocaml/lambda/translcore.ml:37">transl_module</a></span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="Constant">Tcoerce_none</span> <span class="Constant">None</span> <span class="ocamlLCIdentifier"><a href="#L706" title="ocaml/lambda/translmod.ml:706">modl</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">|</span> <span class="Constant">Some</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L37" title="ocaml/lambda/translcore.ml:37">transl_module</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span>:<span class="Statement">(</span><span class="ocamlLCIdentifier">enter_module_definition</span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">Tcoerce_none</span> <span class="Statement">(</span><span class="Constant">Some</span> <span class="Statement">(</span><span class="Constant">Pident</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span><span class="Statement">))</span> <span class="ocamlLCIdentifier"><a href="#L706" title="ocaml/lambda/translmod.ml:706">modl</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">bindings<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="lambda.mli.html#L408" title="ocaml/lambda/lambda.mli:408">make_sequence</a></span> <span class="ocamlLCIdentifier"><a href="#L1460" title="ocaml/lambda/translmod.ml:1460">toploop_setvalue_id</a></span> <span class="ocamlLCIdentifier">idents</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_class</span> <span class="ocamlLCIdentifier">cl_list</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Comment">(* we need to use unique names for the <a href="translobj.ml.html#L158" title="ocaml/lambda/translobj.ml:158">classes</a> because there might<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; be a value named identically *)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="translcore.ml.html#L1050" title="ocaml/lambda/translcore.ml:1050">ids</a></span>, <span class="ocamlLCIdentifier">class_bindings</span><span class="Statement">)</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">transl_class_bindings</span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier">cl_list</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="PreProc">List</span>.<span class="ocamlLCIdentifier">iter</span> <span class="ocamlLCIdentifier"><a href="#L1424" title="ocaml/lambda/translmod.ml:1424">set_toplevel_unique_name</a></span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L1050" title="ocaml/lambda/translcore.ml:1050">ids</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Constant">Lletrec</span><span class="Statement">(</span><span class="ocamlLCIdentifier">class_bindings</span>, <span class="ocamlLCIdentifier"><a href="lambda.mli.html#L408" title="ocaml/lambda/lambda.mli:408">make_sequence</a></span> <span class="ocamlLCIdentifier"><a href="#L1460" title="ocaml/lambda/translmod.ml:1460">toploop_setvalue_id</a></span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L1050" title="ocaml/lambda/translcore.ml:1050">ids</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_include</span> <span class="ocamlLCIdentifier">incl</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L1050" title="ocaml/lambda/translcore.ml:1050">ids</a></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">bound_value_identifiers</span> <span class="ocamlLCIdentifier">incl</span>.<span class="ocamlLCIdentifier">incl_type</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="#L706" title="ocaml/lambda/translmod.ml:706">modl</a></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">incl</span>.<span class="ocamlLCIdentifier">incl_mod</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="#L707" title="ocaml/lambda/translmod.ml:707">mid</a></span> <span class="Statement">=</span> <span class="PreProc">Ident</span>.<span class="ocamlLCIdentifier">create_local</span> <span class="Constant">&quot;include&quot;</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="Statement">rec</span> <span class="ocamlLCIdentifier">set_idents</span> <span class="ocamlLCIdentifier">pos</span> <span class="Statement">=</span> <span class="Statement">function<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">[]</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="lambda.mli.html#L366" title="ocaml/lambda/lambda.mli:366">lambda_unit</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span> <span class="Statement">::</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L1050" title="ocaml/lambda/translcore.ml:1050">ids</a></span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">Lsequence</span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L1445" title="ocaml/lambda/translmod.ml:1445">toploop_setvalue</a></span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="Constant">Lprim</span><span class="Statement">(</span><span class="Constant">Pfield</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">pos</span>, <span class="Constant">Pointer</span>, <span class="Constant">Mutable</span><span class="Statement">)</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">[</span><span class="Constant">Lvar</span> <span class="ocamlLCIdentifier"><a href="#L707" title="ocaml/lambda/translmod.ml:707">mid</a></span><span class="Statement">]</span>, <span class="Constant">Loc_unknown</span><span class="Statement">))</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">set_idents</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">pos</span> + <span class="Constant">1</span><span class="Statement">)</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L1050" title="ocaml/lambda/translcore.ml:1050">ids</a></span><span class="Statement">)</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Constant">Llet</span><span class="Statement">(</span><span class="Constant">Strict</span>, <span class="Constant">Pgenval</span>, <span class="ocamlLCIdentifier"><a href="#L707" title="ocaml/lambda/translmod.ml:707">mid</a></span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L37" title="ocaml/lambda/translcore.ml:37">transl_module</a></span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="Constant">Tcoerce_none</span> <span class="Constant">None</span> <span class="ocamlLCIdentifier"><a href="#L706" title="ocaml/lambda/translmod.ml:706">modl</a></span>, <span class="ocamlLCIdentifier">set_idents</span> <span class="Constant">0</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L1050" title="ocaml/lambda/translcore.ml:1050">ids</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_primitive</span> <span class="ocamlLCIdentifier">descr</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L212" title="ocaml/lambda/translmod.ml:212">record_primitive</a></span> <span class="ocamlLCIdentifier">descr</span>.<span class="ocamlLCIdentifier">val_val</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="lambda.mli.html#L366" title="ocaml/lambda/lambda.mli:366">lambda_unit</a><br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_open</span> <span class="ocamlLCIdentifier">od</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L592" title="ocaml/lambda/translcore.ml:592">pure</a></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L614" title="ocaml/lambda/translcore.ml:614">pure_module</a></span> <span class="ocamlLCIdentifier">od</span>.<span class="ocamlLCIdentifier">open_expr</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Comment">(* this optimization shouldn'<a href="debuginfo.ml.html#L79" title="ocaml/lambda/debuginfo.ml:79">t</a> be needed because Simplif would<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; actually <a href="matching.ml.html#L867" title="ocaml/lambda/matching.ml:867">remove</a> the [Llet] when it'<a href="translclass.ml.html#L563" title="ocaml/lambda/translclass.ml:563">s</a> not used.<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; But since [<a href="#L765" title="ocaml/lambda/translmod.ml:765">scan_used_globals</a>] runs before Simplif, we need to do<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; it. *)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">begin</span><span class="ocamlEnd"> </span><span class="Statement">match</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">od</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">open_bound_items</span><span class="ocamlEnd"> </span><span class="Statement">with<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Constant">[]</span><span class="ocamlEnd"> </span><span class="Statement">when</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="translcore.ml.html#L592" title="ocaml/lambda/translcore.ml:592">pure</a></span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="Constant">Alias</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="lambda.mli.html#L366" title="ocaml/lambda/lambda.mli:366">lambda_unit</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Statement">_</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="translcore.ml.html#L1050" title="ocaml/lambda/translcore.ml:1050">ids</a></span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">bound_value_identifiers</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">od</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">open_bound_items</span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L707" title="ocaml/lambda/translmod.ml:707">mid</a></span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="PreProc">Ident</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">create_local</span><span class="ocamlEnd"> </span><span class="Constant">&quot;<a href="matching.ml.html#L419" title="ocaml/lambda/matching.ml:419">open</a>&quot;</span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="Statement">rec</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">set_idents</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">pos</span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="Statement">function<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Constant">[]</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="lambda.mli.html#L366" title="ocaml/lambda/lambda.mli:366">lambda_unit</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span><span class="ocamlEnd"> </span><span class="Statement">::</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="translcore.ml.html#L1050" title="ocaml/lambda/translcore.ml:1050">ids</a></span><span class="ocamlEnd"> </span><span class="Statement">-&gt;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Constant">Lsequence</span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L1445" title="ocaml/lambda/translmod.ml:1445">toploop_setvalue</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">(</span><span class="Constant">Lprim</span><span class="Statement">(</span><span class="Constant">Pfield</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">pos</span><span class="ocamlEnd">, </span><span class="Constant">Pointer</span><span class="ocamlEnd">, </span><span class="Constant">Mutable</span><span class="Statement">)</span><span class="ocamlEnd">,<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">[</span><span class="Constant">Lvar</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L707" title="ocaml/lambda/translmod.ml:707">mid</a></span><span class="Statement">]</span><span class="ocamlEnd">, </span><span class="Constant">Loc_unknown</span><span class="Statement">))</span><span class="ocamlEnd">,<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier">set_idents</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">pos</span><span class="ocamlEnd"> + </span><span class="Constant">1</span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="translcore.ml.html#L1050" title="ocaml/lambda/translcore.ml:1050">ids</a></span><span class="Statement">)<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Constant">Llet</span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="translcore.ml.html#L592" title="ocaml/lambda/translcore.ml:592">pure</a></span><span class="ocamlEnd">, </span><span class="Constant">Pgenval</span><span class="ocamlEnd">, </span><span class="ocamlLCIdentifier"><a href="#L707" title="ocaml/lambda/translmod.ml:707">mid</a></span><span class="ocamlEnd">,<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="ocamlLCIdentifier"><a href="translcore.ml.html#L37" title="ocaml/lambda/translcore.ml:37">transl_module</a></span><span class="ocamlEnd"> </span><span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span><span class="ocamlEnd"> </span><span class="Constant">Tcoerce_none</span><span class="ocamlEnd"> </span><span class="Constant">None</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">od</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">open_expr</span><span class="ocamlEnd">,<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="ocamlLCIdentifier">set_idents</span><span class="ocamlEnd"> </span><span class="Constant">0</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="translcore.ml.html#L1050" title="ocaml/lambda/translcore.ml:1050">ids</a></span><span class="Statement">)<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">end<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_module</span> <span class="Statement">({</span><span class="ocamlLCIdentifier">mb_presence</span><span class="Statement">=</span><span class="Constant">Mp_absent</span><span class="Statement">}</span> <span class="Statement">as</span> <span class="ocamlLCIdentifier">mb</span><span class="Statement">)</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="PreProc">List</span>.<span class="ocamlLCIdentifier">iter</span> <span class="Statement">(</span><span class="PreProc">Translattribute</span>.<span class="ocamlLCIdentifier"><a href="translattribute.mli.html#L21" title="ocaml/lambda/translattribute.mli:21">check_attribute_on_module</a></span> <span class="ocamlLCIdentifier">mb</span>.<span class="ocamlLCIdentifier">mb_expr</span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">mb</span>.<span class="ocamlLCIdentifier">mb_attributes</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="PreProc">List</span>.<span class="ocamlLCIdentifier">iter</span> <span class="Statement">(</span><span class="PreProc">Translattribute</span>.<span class="ocamlLCIdentifier"><a href="translattribute.mli.html#L21" title="ocaml/lambda/translattribute.mli:21">check_attribute_on_module</a></span> <span class="ocamlLCIdentifier">mb</span>.<span class="ocamlLCIdentifier">mb_expr</span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">mb</span>.<span class="ocamlLCIdentifier">mb_expr</span>.<span class="ocamlLCIdentifier">mod_attributes</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="lambda.mli.html#L366" title="ocaml/lambda/lambda.mli:366">lambda_unit</a><br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_modtype</span> <span class="Statement">_<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_type</span> <span class="Statement">_<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_class_type</span> <span class="Statement">_<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Tstr_attribute</span> <span class="Statement">_</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="lambda.mli.html#L366" title="ocaml/lambda/lambda.mli:366">lambda_unit</a><br/></li>
<li></span><br/></li>
<li><a id="L1577">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">transl_toplevel_item_and_close</span></span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier">itm</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier"><a href="#L1462" title="ocaml/lambda/translmod.ml:1462">close_toplevel_term</a><br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="translobj.ml.html#L148" title="ocaml/lambda/translobj.ml:148">transl_label_init</a></span> <span class="Statement">(fun</span> <span class="Constant">()</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier">transl_toplevel_item</span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span> <span class="ocamlLCIdentifier">itm</span>, <span class="Constant">()</span><span class="Statement">))<br/></li>
<li></span><br/></li>
<li><span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="translmod.mli.html#L31" title="ocaml/lambda/translmod.mli:31">transl_toplevel_definition</a></span> <span class="ocamlLCIdentifier">str</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier"><a href="translobj.ml.html#L77" title="ocaml/lambda/translobj.ml:77">reset_labels</a></span> <span class="Constant">()</span><span class="Statement">;<br/></li>
<li></span>&nbsp; <span class="PreProc">Translprim</span>.<span class="ocamlLCIdentifier"><a href="translprim.mli.html#L29" title="ocaml/lambda/translprim.mli:29">clear_used_primitives</a></span> <span class="Constant">()</span><span class="Statement">;<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier"><a href="lambda.mli.html#L408" title="ocaml/lambda/lambda.mli:408">make_sequence</a><br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L1577" title="ocaml/lambda/translmod.ml:1577">transl_toplevel_item_and_close</a></span> <span class="Statement">~</span><span class="Identifier"><a href="debuginfo.ml.html#L28" title="ocaml/lambda/debuginfo.ml:28">scopes</a></span>:<span class="ocamlLCIdentifier"><a href="debuginfo.ml.html#L39" title="ocaml/lambda/debuginfo.ml:39">empty_scopes</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier">str</span>.<span class="ocamlLCIdentifier">str_items<br/></li>
<li></span><br/></li>
<li><span class="Comment">(* Compile the initialization code for a packed library *)<br/></li>
<li></span><br/></li>
<li><span class="Statement">let</span> <span class="ocamlLCIdentifier">get_component</span> <span class="Statement">=</span> <span class="Statement">function<br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">None</span> <span class="Statement">-&gt;</span> <span class="Constant">Lconst</span> <span class="ocamlLCIdentifier"><a href="lambda.mli.html#L364" title="ocaml/lambda/lambda.mli:364">const_unit</a><br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Some</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span> <span class="Statement">-&gt;</span> <span class="Constant">Lprim</span><span class="Statement">(</span><span class="Constant">Pgetglobal</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span>, <span class="Constant">[]</span>, <span class="Constant">Loc_unknown</span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li><a id="L1594">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">transl_package_flambda</span></span> <span class="ocamlLCIdentifier">component_names</span> <span class="ocamlLCIdentifier">coercion</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="matching.ml.html#L3846" title="ocaml/lambda/matching.ml:3846">size</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">match</span> <span class="ocamlLCIdentifier">coercion</span> <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tcoerce_none</span> <span class="Statement">-&gt;</span> <span class="PreProc">List</span>.<span class="ocamlLCIdentifier">length</span> <span class="ocamlLCIdentifier">component_names<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tcoerce_structure</span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="translcore.ml.html#L708" title="ocaml/lambda/translcore.ml:708">l</a></span>, <span class="Statement">_)</span> <span class="Statement">-&gt;</span> <span class="PreProc">List</span>.<span class="ocamlLCIdentifier">length</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L708" title="ocaml/lambda/translcore.ml:708">l</a><br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tcoerce_functor</span> <span class="Statement">_<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tcoerce_primitive</span> <span class="Statement">_<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Tcoerce_alias</span> <span class="Statement">_</span> <span class="Statement">-&gt;</span> <span class="Statement">assert</span> <span class="Constant">false<br/></li>
<li></span>&nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier"><a href="matching.ml.html#L3846" title="ocaml/lambda/matching.ml:3846">size</a></span>,<br/></li>
<li>&nbsp; <span class="ocamlLCIdentifier">apply_coercion</span> <span class="Constant">Loc_unknown</span> <span class="Constant">Strict</span> <span class="ocamlLCIdentifier">coercion<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">(</span><span class="Constant">Lprim</span><span class="Statement">(</span><span class="Constant">Pmakeblock</span><span class="Statement">(</span><span class="Constant">0</span>, <span class="Constant">Immutable</span>, <span class="Constant">None</span><span class="Statement">)</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="PreProc">List</span>.<span class="ocamlLCIdentifier"><a href="matching.ml.html#L922" title="ocaml/lambda/matching.ml:922">map</a></span> <span class="ocamlLCIdentifier">get_component</span> <span class="ocamlLCIdentifier">component_names</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">Loc_unknown</span><span class="Statement">))<br/></li>
<li></span><br/></li>
<li><a id="L1609">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">transl_package</span></span> <span class="ocamlLCIdentifier">component_names</span> <span class="ocamlLCIdentifier">target_name</span> <span class="ocamlLCIdentifier">coercion</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">components</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">Lprim</span><span class="Statement">(</span><span class="Constant">Pmakeblock</span><span class="Statement">(</span><span class="Constant">0</span>, <span class="Constant">Immutable</span>, <span class="Constant">None</span><span class="Statement">)</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="PreProc">List</span>.<span class="ocamlLCIdentifier"><a href="matching.ml.html#L922" title="ocaml/lambda/matching.ml:922">map</a></span> <span class="ocamlLCIdentifier">get_component</span> <span class="ocamlLCIdentifier">component_names</span>, <span class="Constant">Loc_unknown</span><span class="Statement">)</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Constant">Lprim</span><span class="Statement">(</span><span class="Constant">Psetglobal</span> <span class="ocamlLCIdentifier">target_name</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">[</span><span class="ocamlLCIdentifier">apply_coercion</span> <span class="Constant">Loc_unknown</span> <span class="Constant">Strict</span> <span class="ocamlLCIdentifier">coercion</span> <span class="ocamlLCIdentifier">components</span><span class="Statement">]</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">Loc_unknown</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Comment">(*<br/></li>
<li></span><span class="Comment">&nbsp; let components =<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; match coercion with<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; Tcoerce_none -&gt;<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; List.<a href="matching.ml.html#L922" title="ocaml/lambda/matching.ml:922">map</a> get_component component_names<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; | Tcoerce_structure (pos_cc_list, id_pos_list) -&gt;<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (* ignore id_pos_list as the <a href="translcore.ml.html#L1050" title="ocaml/lambda/translcore.ml:1050">ids</a> are already bound *)<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; let g = Array.of_list component_names in<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; List.<a href="matching.ml.html#L922" title="ocaml/lambda/matching.ml:922">map</a><br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (fun (pos, cc) -&gt; apply_coercion Strict cc (get_component g.(pos)))<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pos_cc_list<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; | _ -&gt;<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; assert false in<br/></li>
<li></span><span class="Comment">&nbsp; Lprim(Psetglobal target_name, [Lprim(Pmakeblock(0, Immutable), components)])<br/></li>
<li></span><span class="Comment">&nbsp;&nbsp; *)<br/></li>
<li></span><br/></li>
<li><a id="L1632">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">transl_store_package</span></span> <span class="ocamlLCIdentifier">component_names</span> <span class="ocamlLCIdentifier">target_name</span> <span class="ocamlLCIdentifier">coercion</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="Statement">rec</span> <span class="ocamlLCIdentifier"><a href="lambda.mli.html#L408" title="ocaml/lambda/lambda.mli:408">make_sequence</a></span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L567" title="ocaml/lambda/translcore.ml:567">fn</a></span> <span class="ocamlLCIdentifier">pos</span> <span class="ocamlLCIdentifier"><a href="matching.ml.html#L2339" title="ocaml/lambda/matching.ml:2339">arg</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">match</span> <span class="ocamlLCIdentifier"><a href="matching.ml.html#L2339" title="ocaml/lambda/matching.ml:2339">arg</a></span> <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Constant">[]</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier"><a href="lambda.mli.html#L366" title="ocaml/lambda/lambda.mli:366">lambda_unit</a><br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="ocamlLCIdentifier">hd</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier">tl</span> <span class="Statement">-&gt;</span> <span class="Constant">Lsequence</span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="translcore.ml.html#L567" title="ocaml/lambda/translcore.ml:567">fn</a></span> <span class="ocamlLCIdentifier">pos</span> <span class="ocamlLCIdentifier">hd</span>, <span class="ocamlLCIdentifier"><a href="lambda.mli.html#L408" title="ocaml/lambda/lambda.mli:408">make_sequence</a></span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L567" title="ocaml/lambda/translcore.ml:567">fn</a></span> <span class="Statement">(</span><span class="ocamlLCIdentifier">pos</span> + <span class="Constant">1</span><span class="Statement">)</span> <span class="ocamlLCIdentifier">tl</span><span class="Statement">)</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">match</span> <span class="ocamlLCIdentifier">coercion</span> <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">Tcoerce_none</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="PreProc">List</span>.<span class="ocamlLCIdentifier">length</span> <span class="ocamlLCIdentifier">component_names</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier"><a href="lambda.mli.html#L408" title="ocaml/lambda/lambda.mli:408">make_sequence</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">(fun</span> <span class="ocamlLCIdentifier">pos</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">Lprim</span><span class="Statement">(</span><span class="Constant">Psetfield</span><span class="Statement">(</span><span class="ocamlLCIdentifier">pos</span>, <span class="Constant">Pointer</span>, <span class="Constant">Root_initialization</span><span class="Statement">)</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">[</span><span class="Constant">Lprim</span><span class="Statement">(</span><span class="Constant">Pgetglobal</span> <span class="ocamlLCIdentifier">target_name</span>, <span class="Constant">[]</span>, <span class="Constant">Loc_unknown</span><span class="Statement">);<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">get_component</span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span><span class="Statement">]</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">Loc_unknown</span><span class="Statement">))<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">0</span> <span class="ocamlLCIdentifier">component_names</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Tcoerce_structure</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">pos_cc_list</span>, <span class="ocamlLCIdentifier">_id_pos_list</span><span class="Statement">)</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">components</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">Lprim</span><span class="Statement">(</span><span class="Constant">Pmakeblock</span><span class="Statement">(</span><span class="Constant">0</span>, <span class="Constant">Immutable</span>, <span class="Constant">None</span><span class="Statement">)</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="PreProc">List</span>.<span class="ocamlLCIdentifier"><a href="matching.ml.html#L922" title="ocaml/lambda/matching.ml:922">map</a></span> <span class="ocamlLCIdentifier">get_component</span> <span class="ocamlLCIdentifier">component_names</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">Loc_unknown</span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">blk</span> <span class="Statement">=</span> <span class="PreProc">Ident</span>.<span class="ocamlLCIdentifier">create_local</span> <span class="Constant">&quot;block&quot;</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="PreProc">List</span>.<span class="ocamlLCIdentifier">length</span> <span class="ocamlLCIdentifier">pos_cc_list</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">Llet</span> <span class="Statement">(</span><span class="Constant">Strict</span>, <span class="Constant">Pgenval</span>, <span class="ocamlLCIdentifier">blk</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier">apply_coercion</span> <span class="Constant">Loc_unknown</span> <span class="Constant">Strict</span> <span class="ocamlLCIdentifier">coercion</span> <span class="ocamlLCIdentifier">components</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier"><a href="lambda.mli.html#L408" title="ocaml/lambda/lambda.mli:408">make_sequence</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">(fun</span> <span class="ocamlLCIdentifier">pos</span> <span class="ocamlLCIdentifier">_id</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">Lprim</span><span class="Statement">(</span><span class="Constant">Psetfield</span><span class="Statement">(</span><span class="ocamlLCIdentifier">pos</span>, <span class="Constant">Pointer</span>, <span class="Constant">Root_initialization</span><span class="Statement">)</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">[</span><span class="Constant">Lprim</span><span class="Statement">(</span><span class="Constant">Pgetglobal</span> <span class="ocamlLCIdentifier">target_name</span>, <span class="Constant">[]</span>, <span class="Constant">Loc_unknown</span><span class="Statement">);<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">Lprim</span><span class="Statement">(</span><span class="Constant">Pfield</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">pos</span>, <span class="Constant">Pointer</span>, <span class="Constant">Mutable</span><span class="Statement">)</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">[</span><span class="Constant">Lvar</span> <span class="ocamlLCIdentifier">blk</span><span class="Statement">]</span>, <span class="Constant">Loc_unknown</span><span class="Statement">)]</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">Loc_unknown</span><span class="Statement">))<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">0</span> <span class="ocamlLCIdentifier">pos_cc_list</span><span class="Statement">))<br/></li>
<li></span>&nbsp; <span class="Comment">(*<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (* ignore id_pos_list as the <a href="translcore.ml.html#L1050" title="ocaml/lambda/translcore.ml:1050">ids</a> are already bound *)<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; let <a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a> = Array.of_list component_names in<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; (List.length pos_cc_list,<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp;&nbsp; <a href="lambda.mli.html#L408" title="ocaml/lambda/lambda.mli:408">make_sequence</a><br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (fun dst (src, cc) -&gt;<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; Lprim(Psetfield(dst, false),<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [Lprim(Pgetglobal target_name, []);<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; apply_coercion Strict cc (get_component <a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a>.(src))]))<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 0 pos_cc_list)<br/></li>
<li></span><span class="Comment">&nbsp; *)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Statement">_</span> <span class="Statement">-&gt;</span> <span class="Statement">assert</span> <span class="Constant">false<br/></li>
<li></span><br/></li>
<li><span class="Comment">(* Error report *)<br/></li>
<li></span><br/></li>
<li><span class="Statement"><a href="matching.ml.html#L419" title="ocaml/lambda/matching.ml:419">open</a></span><span class="ocamlNone"> </span><span class="PreProc">Format<br/></li>
<li></span><br/></li>
<li><a id="L1682">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">print_cycle</span></span> <span class="ocamlLCIdentifier">ppf</span> <span class="ocamlLCIdentifier">cycle</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">print_ident</span> <span class="ocamlLCIdentifier">ppf</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">x</span>,<span class="Statement">_)</span> <span class="Statement">=</span> <span class="PreProc">Format</span>.<span class="ocamlLCIdentifier">pp_print_string</span> <span class="ocamlLCIdentifier">ppf</span> <span class="Statement">(</span><span class="PreProc">Ident</span>.<span class="ocamlLCIdentifier"><a href="translcore.ml.html#L56" title="ocaml/lambda/translcore.ml:56">name</a></span> <span class="ocamlLCIdentifier">x</span><span class="Statement">)</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">pp_sep</span> <span class="ocamlLCIdentifier">ppf</span> <span class="Constant">()</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">fprintf</span> <span class="ocamlLCIdentifier">ppf</span> <span class="Constant">&quot;@ -&gt; &quot;</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="PreProc">Format</span>.<span class="ocamlLCIdentifier">fprintf</span> <span class="ocamlLCIdentifier">ppf</span> <span class="Constant">&quot;%a%a%<a href="translclass.ml.html#L563" title="ocaml/lambda/translclass.ml:563">s</a>&quot;<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">(</span><span class="PreProc">Format</span>.<span class="ocamlLCIdentifier">pp_print_list</span> <span class="Statement">~</span><span class="Identifier">pp_sep</span> <span class="ocamlLCIdentifier">print_ident</span><span class="Statement">)</span> <span class="ocamlLCIdentifier">cycle<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier">pp_sep</span> <span class="Constant">()<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">(</span><span class="PreProc">Ident</span>.<span class="ocamlLCIdentifier"><a href="translcore.ml.html#L56" title="ocaml/lambda/translcore.ml:56">name</a></span> @@ <span class="ocamlLCIdentifier">fst</span> @@ <span class="PreProc">List</span>.<span class="ocamlLCIdentifier">hd</span> <span class="ocamlLCIdentifier">cycle</span><span class="Statement">)<br/></li>
<li></span><span class="Comment">(* we repeat the first element to <a href="tmc.ml.html#L190" title="ocaml/lambda/tmc.ml:190">make</a> the cycle more apparent *)<br/></li>
<li></span><br/></li>
<li><a id="L1691">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">explanation_submsg</span></span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span>, <span class="ocamlLCIdentifier"><a href="translmod.mli.html#L51" title="ocaml/lambda/translmod.mli:51">unsafe_info</a></span><span class="Statement">)</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">match</span> <span class="ocamlLCIdentifier"><a href="translmod.mli.html#L51" title="ocaml/lambda/translmod.mli:51">unsafe_info</a></span> <span class="Statement">with<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Unnamed</span> <span class="Statement">-&gt;</span> <span class="Statement">assert</span> <span class="Constant">false</span> <span class="Comment">(* can'<a href="debuginfo.ml.html#L79" title="ocaml/lambda/debuginfo.ml:79">t</a> be part of a cycle. *)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Unsafe</span> <span class="Statement">{</span><span class="ocamlLCIdentifier">reason</span><span class="Statement">;</span><span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span><span class="Statement">;</span><span class="ocamlLCIdentifier">subid</span><span class="Statement">}</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">print</span> <span class="ocamlLCIdentifier">fmt</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">printer</span> <span class="Statement">=</span> <span class="PreProc">Format</span>.<span class="ocamlLCIdentifier">dprintf</span> <span class="ocamlLCIdentifier">fmt</span> <span class="Statement">(</span><span class="PreProc">Ident</span>.<span class="ocamlLCIdentifier"><a href="translcore.ml.html#L56" title="ocaml/lambda/translcore.ml:56">name</a></span> <span class="ocamlLCIdentifier"><a href="#L634" title="ocaml/lambda/translmod.ml:634">id</a></span><span class="Statement">)</span> <span class="Statement">(</span><span class="PreProc">Ident</span>.<span class="ocamlLCIdentifier"><a href="translcore.ml.html#L56" title="ocaml/lambda/translcore.ml:56">name</a></span> <span class="ocamlLCIdentifier">subid</span><span class="Statement">)</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="PreProc">Location</span>.<span class="ocamlLCIdentifier">mkloc</span> <span class="ocamlLCIdentifier">printer</span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">match</span> <span class="ocamlLCIdentifier">reason</span> <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Unsafe_module_binding</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">print</span> <span class="Constant">&quot;Module %<a href="translclass.ml.html#L563" title="ocaml/lambda/translclass.ml:563">s</a> defines an unsafe module, %<a href="translclass.ml.html#L563" title="ocaml/lambda/translclass.ml:563">s</a> .&quot;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Unsafe_functor</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier">print</span> <span class="Constant">&quot;Module %<a href="translclass.ml.html#L563" title="ocaml/lambda/translclass.ml:563">s</a> defines an unsafe functor, %<a href="translclass.ml.html#L563" title="ocaml/lambda/translclass.ml:563">s</a> .&quot;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Unsafe_typext</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">print</span> <span class="Constant">&quot;Module %<a href="translclass.ml.html#L563" title="ocaml/lambda/translclass.ml:563">s</a> defines an unsafe extension constructor, %<a href="translclass.ml.html#L563" title="ocaml/lambda/translclass.ml:563">s</a> .&quot;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Unsafe_non_function</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier">print</span> <span class="Constant">&quot;Module %<a href="translclass.ml.html#L563" title="ocaml/lambda/translclass.ml:563">s</a> defines an unsafe value, %<a href="translclass.ml.html#L563" title="ocaml/lambda/translclass.ml:563">s</a> .&quot;<br/></li>
<li></span><br/></li>
<li><a id="L1706">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">report_error</span></span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span> <span class="Statement">=</span> <span class="Statement">function<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Circular_dependency</span> <span class="ocamlLCIdentifier">cycle</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let[</span>@<span class="ocamlLCIdentifier">manual</span>.<span class="ocamlLCIdentifier">ref</span> <span class="Constant">&quot;<a href="translclass.ml.html#L563" title="ocaml/lambda/translclass.ml:563">s</a>:recursive-modules&quot;</span><span class="Statement">]</span> <span class="ocamlLCIdentifier">manual_ref</span> <span class="Statement">=</span> <span class="Statement">[</span> <span class="Constant">12</span><span class="Statement">;</span> <span class="Constant">2</span> <span class="Statement">]</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="PreProc">Location</span>.<span class="ocamlLCIdentifier">errorf</span> <span class="Statement">~</span><span class="Identifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span> <span class="Statement">~</span><span class="Identifier">sub</span>:<span class="Statement">(</span><span class="PreProc">List</span>.<span class="ocamlLCIdentifier"><a href="matching.ml.html#L922" title="ocaml/lambda/matching.ml:922">map</a></span> <span class="ocamlLCIdentifier"><a href="#L1691" title="ocaml/lambda/translmod.ml:1691">explanation_submsg</a></span> <span class="ocamlLCIdentifier">cycle</span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">&quot;Cannot safely evaluate the definition of the following cycle@ \<br/></li>
<li></span><span class="Constant">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; of recursively-defined modules:@ %a.@ \<br/></li>
<li></span><span class="Constant">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; There are no safe modules in this cycle@ %a.&quot;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L1682" title="ocaml/lambda/translmod.ml:1682">print_cycle</a></span> <span class="ocamlLCIdentifier">cycle</span> <span class="PreProc">Misc</span>.<span class="ocamlLCIdentifier">print_see_manual</span> <span class="ocamlLCIdentifier">manual_ref<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Conflicting_inline_attributes</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="PreProc">Location</span>.<span class="ocamlLCIdentifier">errorf</span> <span class="Constant">&quot;@[Conflicting '<a href="debuginfo.ml.html#L180" title="ocaml/lambda/debuginfo.ml:180">inline</a>' attributes@]&quot;<br/></li>
<li></span><br/></li>
<li><span class="Statement">let</span> <span class="Constant">()</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="PreProc">Location</span>.<span class="ocamlLCIdentifier">register_error_of_exn<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">(function<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Error</span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span>, <span class="ocamlLCIdentifier">err</span><span class="Statement">)</span> <span class="Statement">-&gt;</span> <span class="Constant">Some</span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="translprim.mli.html#L54" title="ocaml/lambda/translprim.mli:54">report_error</a></span> <span class="ocamlLCIdentifier"><a href="translcore.ml.html#L62" title="ocaml/lambda/translcore.ml:62">loc</a></span> <span class="ocamlLCIdentifier">err</span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Statement">_</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">None<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">)<br/></li>
<li></span><br/></li>
<li><a id="L1725">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">reset</span></span> <span class="Constant">()</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier"><a href="translmod.mli.html#L43" title="ocaml/lambda/translmod.mli:43">primitive_declarations</a></span> <span class="Statement">:=</span> <span class="Constant">[]</span><span class="Statement">;<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier"><a href="#L961" title="ocaml/lambda/translmod.ml:961">transl_store_subst</a></span> <span class="Statement">:=</span> <span class="PreProc">Ident</span>.<span class="PreProc">Map</span>.<span class="ocamlLCIdentifier"><a href="matching.ml.html#L533" title="ocaml/lambda/matching.ml:533">empty</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier"><a href="#L1422" title="ocaml/lambda/translmod.ml:1422">aliased_idents</a></span> <span class="Statement">:=</span> <span class="PreProc">Ident</span>.<span class="ocamlLCIdentifier"><a href="matching.ml.html#L533" title="ocaml/lambda/matching.ml:533">empty</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; <span class="PreProc">Env</span>.<span class="ocamlLCIdentifier">reset_required_globals</span> <span class="Constant">()</span><span class="Statement">;<br/></li>
<li></span>&nbsp; <span class="PreProc">Translprim</span>.<span class="ocamlLCIdentifier"><a href="translprim.mli.html#L29" title="ocaml/lambda/translprim.mli:29">clear_used_primitives</a></span> <span class="Constant">()<br/></li>
</ol></span></code>
 <p class="nav-bar">
  <span class="nav-link"><a href="./index.html">One Level Up</a></span>
  <span class="nav-link"><a href="index.html">Top Level</a></span>
 </p>

 </body>
</html>
