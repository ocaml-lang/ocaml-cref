<!-- generated by the vscode.pl tool from vscoded.-->

<html>
 <head>
  <title>ocaml/runtime/startup_aux.c - ocaml</title>
  <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
  <style>
body {
    text-align: left;
    text-align-last: left;
}

.nav-bar {
    font-size: 120%;
    margin-top: 5px;
    margin-bottom: 5px;
}

.nav-link {
    padding-left: 5em;
    padding-right: 5em;
}

ul.toc {
    line-height: 200%;
    font-size: 150%;
}

code {
    font-family: consolas, monospace;
    line-height: 130%;
}

span.Constant {
    color: DarkGreen;
}

span.Special {
    color: #c06000;
}

span.Comment {
    color: DarkRed;
    font-style: italic;
}

span.Identifier {
    color: DarkCyan;
}

span.PreProc {
    color: DarkMagenta;
}

span.Statement, span.Type, span.Keyword, span.Repeat, span.Conditional,
    span.Operator, span.Exception
{
    color: DarkBlue;
}

span.Todo {
    color: DarkRed;
    background-color: Gold;
    font-style: italic;
}

span.Underlined {
    text-decoration: underline;
}

span.linkable {
    font-weight: bold;
}

code ol {
    counter-reset: item;
    list-style-type: none;
    margin-left: 0;
    padding-left: 0;
    list-style-position: inside;
}

code li {
    display: block;
}

code li:before {
    content: counter(item) "  ";
    counter-increment: item;
    color: #999;
    padding-right: 0.5em;
    padding-left: 0.4em;
    list-style-position: inside;
    text-align: right
}

  </style>
 </head>
 <body>
 <p class="nav-bar">
  <span class="nav-link"><a href="./index.html">One Level Up</a></span>
  <span class="nav-link"><a href="index.html">Top Level</a></span>
 </p>

  <h1>ocaml/runtime/startup_aux.c - ocaml</h1>
 <h2>Global variables defined</h2>
 <ul class="toc">
<li><a href="#L41">caml_params</a></li>
<li><a href="#L40">params</a></li>
<li><a href="#L127">shutdown_happened</a></li>
<li><a href="#L124">startup_count</a></li>
</ul>
 <h2>Functions defined</h2>
 <ul class="toc">
<li><a href="#L148">call_registered_value</a></li>
<li><a href="#L183">caml_init_exe_name</a></li>
<li><a href="#L188">caml_init_section_table</a></li>
<li><a href="#L88">caml_parse_ocamlrunparam</a></li>
<li><a href="#L155">caml_shutdown</a></li>
<li><a href="#L130">caml_startup_aux</a></li>
<li><a href="#L43">init_startup_params</a></li>
<li><a href="#L73">scanmult</a></li>
</ul>
 <h2>Macros defined</h2>
 <ul class="toc">
<li><a href="#L16">CAML_INTERNALS</a></li>
</ul>
 <h2>Source code</h2>

  <code><ol><li><span class="Comment">/**************************************************************************/<br/></li>
<li></span><span class="Comment">/*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */<br/></li>
<li></span><span class="Comment">/*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; OCaml&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */<br/></li>
<li></span><span class="Comment">/*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */<br/></li>
<li></span><span class="Comment">/*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Xavier Leroy <a href="ints.c.html#L488" title="ocaml/runtime/ints.c:488">and</a> Damien Doligez, INRIA Rocquencourt&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; */<br/></li>
<li></span><span class="Comment">/*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */<br/></li>
<li></span><span class="Comment">/*&nbsp;&nbsp; Copyright 1996 Institut National de Recherche en Informatique et&nbsp; &nbsp;&nbsp; */<br/></li>
<li></span><span class="Comment">/*&nbsp; &nbsp;&nbsp; en Automatique.&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */<br/></li>
<li></span><span class="Comment">/*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */<br/></li>
<li></span><span class="Comment">/*&nbsp;&nbsp; All rights reserved.&nbsp; This file is distributed under the terms of&nbsp; &nbsp; */<br/></li>
<li></span><span class="Comment">/*&nbsp;&nbsp; the GNU Lesser General Public License version 2.1, with the&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */<br/></li>
<li></span><span class="Comment">/*&nbsp;&nbsp; special exception on linking described in the file LICENSE.&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */<br/></li>
<li></span><span class="Comment">/*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */<br/></li>
<li></span><span class="Comment">/**************************************************************************/<br/></li>
<li></span><br/></li>
<li><a id="L16">&#x200c;</a><span class="PreProc">#define <span class="linkable">CAML_INTERNALS</span><br/></li>
<li></span><br/></li>
<li><span class="Comment">/* Some runtime initialization functions that are common to <a href="meta.c.html#L53" title="ocaml/runtime/meta.c:53">bytecode</a><br/></li>
<li></span><span class="Comment">&nbsp;&nbsp; <a href="ints.c.html#L488" title="ocaml/runtime/ints.c:488">and</a> native code. */<br/></li>
<li></span><br/></li>
<li><span class="PreProc">#include </span><span class="Constant">&lt;stdio.h&gt;<br/></li>
<li></span><span class="PreProc">#include </span><span class="Constant">&quot;caml/backtrace.h&quot;<br/></li>
<li></span><span class="PreProc">#include </span><span class="Constant">&quot;caml/memory.h&quot;<br/></li>
<li></span><span class="PreProc">#include </span><span class="Constant">&quot;caml/callback.h&quot;<br/></li>
<li></span><span class="PreProc">#include </span><span class="Constant">&quot;caml/major_gc.h&quot;<br/></li>
<li></span><span class="PreProc">#ifndef NATIVE_CODE<br/></li>
<li></span><span class="PreProc">#include </span><span class="Constant">&quot;caml/dynlink.h&quot;<br/></li>
<li></span><span class="PreProc">#endif<br/></li>
<li></span><span class="PreProc">#include </span><span class="Constant">&quot;caml/osdeps.h&quot;<br/></li>
<li></span><span class="PreProc">#include </span><span class="Constant">&quot;caml/startup_aux.h&quot;<br/></li>
<li></span><span class="PreProc">#include </span><span class="Constant">&quot;caml/prims.h&quot;<br/></li>
<li></span><span class="PreProc">#include </span><span class="Constant">&quot;caml/signals.h&quot;<br/></li>
<li></span><br/></li>
<li><span class="PreProc">#ifdef _WIN32<br/></li>
<li></span><span class="Type">extern</span> <span class="Type">void</span> <a href="win32.c.html#L620" title="ocaml/runtime/win32.c:620">caml_win32_unregister_overflow_detection</a> (<span class="Type">void</span>);<br/></li>
<li><span class="PreProc">#endif<br/></li>
<li></span><br/></li>
<li><span class="Comment">/* Configuration parameters <a href="ints.c.html#L488" title="ocaml/runtime/ints.c:488">and</a> flags */<br/></li>
<li></span><br/></li>
<li><a id="L40">&#x200c;</a><span class="Type">static</span> <span class="Type">struct</span> <a href="#L41" title="ocaml/runtime/startup_aux.c:41">caml_params</a> <span class="linkable">params</span>;<br/></li>
<li><a id="L41">&#x200c;</a><span class="Type">const</span> <span class="Type">struct</span> <span class="linkable">caml_params</span>* <span class="Type">const</span> <span class="linkable">caml_params</span> = &amp;<a href="#L40" title="ocaml/runtime/startup_aux.c:40">params</a>;<br/></li>
<li><br/></li>
<li><a id="L43">&#x200c;</a><span class="Type">static</span> <span class="Type">void</span> <span class="linkable">init_startup_params</span>(<span class="Type">void</span>)<br/></li>
<li>{<br/></li>
<li><span class="PreProc">#ifndef NATIVE_CODE<br/></li>
<li></span>&nbsp; <a href="caml/misc.h.html#L227" title="ocaml/runtime/caml/misc.h:227">char_os</a> * cds_file;<br/></li>
<li><span class="PreProc">#endif<br/></li>
<li></span><br/></li>
<li>&nbsp; <a href="#L40" title="ocaml/runtime/startup_aux.c:40">params</a>.init_percent_free = <a href="caml/config.h.html#L240" title="ocaml/runtime/caml/config.h:240">Percent_free_def</a>;<br/></li>
<li>&nbsp; <a href="#L40" title="ocaml/runtime/startup_aux.c:40">params</a>.init_minor_heap_wsz = <a href="caml/config.h.html#L230" title="ocaml/runtime/caml/config.h:230">Minor_heap_def</a>;<br/></li>
<li>&nbsp; <a href="#L40" title="ocaml/runtime/startup_aux.c:40">params</a>.init_custom_major_ratio = <a href="caml/config.h.html#L252" title="ocaml/runtime/caml/config.h:252">Custom_major_ratio_def</a>;<br/></li>
<li>&nbsp; <a href="#L40" title="ocaml/runtime/startup_aux.c:40">params</a>.init_custom_minor_ratio = <a href="caml/config.h.html#L256" title="ocaml/runtime/caml/config.h:256">Custom_minor_ratio_def</a>;<br/></li>
<li>&nbsp; <a href="#L40" title="ocaml/runtime/startup_aux.c:40">params</a>.init_custom_minor_max_bsz = <a href="caml/config.h.html#L261" title="ocaml/runtime/caml/config.h:261">Custom_minor_max_bsz_def</a>;<br/></li>
<li>&nbsp; <a href="#L40" title="ocaml/runtime/startup_aux.c:40">params</a>.init_max_stack_wsz = <a href="caml/config.h.html#L216" title="ocaml/runtime/caml/config.h:216">Max_stack_def</a>;<br/></li>
<li>&nbsp; <a href="#L40" title="ocaml/runtime/startup_aux.c:40">params</a>.runtime_events_log_wsize = <a href="caml/config.h.html#L270" title="ocaml/runtime/caml/config.h:270">Default_runtime_events_log_wsize</a>;<br/></li>
<li><br/></li>
<li><span class="PreProc">#ifdef DEBUG<br/></li>
<li></span>&nbsp; <a href="caml/platform.h.html#L60" title="ocaml/runtime/caml/platform.h:60">atomic_store_relaxed</a>(&amp;<a href="misc.c.html#L79" title="ocaml/runtime/misc.c:79">caml_verb_gc</a>, <span class="Constant">0x3F</span>);<br/></li>
<li><span class="PreProc">#endif<br/></li>
<li></span><span class="PreProc">#ifndef NATIVE_CODE<br/></li>
<li></span>&nbsp; cds_file = <a href="unix.c.html#L414" title="ocaml/runtime/unix.c:414">caml_secure_getenv</a>(<a href="caml/misc.h.html#L363" title="ocaml/runtime/caml/misc.h:363">T</a>(<span class="Constant">&quot;CAML_DEBUG_FILE&quot;</span>));<br/></li>
<li>&nbsp; <span class="Statement">if</span> (cds_file != <span class="Constant"><a href="caml/misc.h.html#L71" title="ocaml/runtime/caml/misc.h:71">NULL</a></span>) {<br/></li>
<li>&nbsp; &nbsp; <a href="#L40" title="ocaml/runtime/startup_aux.c:40">params</a>.cds_file = <a href="caml/misc.h.html#L393" title="ocaml/runtime/caml/misc.h:393">caml_stat_strdup_os</a>(cds_file);<br/></li>
<li>&nbsp; }<br/></li>
<li><span class="PreProc">#endif<br/></li>
<li></span>&nbsp; <a href="#L40" title="ocaml/runtime/startup_aux.c:40">params</a>.trace_level = <span class="Constant">0</span>;<br/></li>
<li>&nbsp; <a href="#L40" title="ocaml/runtime/startup_aux.c:40">params</a>.cleanup_on_exit = <span class="Constant">0</span>;<br/></li>
<li>&nbsp; <a href="#L40" title="ocaml/runtime/startup_aux.c:40">params</a>.print_magic = <span class="Constant">0</span>;<br/></li>
<li>&nbsp; <a href="#L40" title="ocaml/runtime/startup_aux.c:40">params</a>.print_config = <span class="Constant">0</span>;<br/></li>
<li>&nbsp; <a href="#L40" title="ocaml/runtime/startup_aux.c:40">params</a>.event_trace = <span class="Constant">0</span>;<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><a id="L73">&#x200c;</a><span class="Type">static</span> <span class="Type">void</span> <span class="linkable">scanmult</span> (<a href="caml/misc.h.html#L227" title="ocaml/runtime/caml/misc.h:227">char_os</a> *opt, <a href="caml/config.h.html#L141" title="ocaml/runtime/caml/config.h:141">uintnat</a> *var)<br/></li>
<li>{<br/></li>
<li>&nbsp; <a href="caml/misc.h.html#L227" title="ocaml/runtime/caml/misc.h:227">char_os</a> mult = <span class="Constant">' '</span>;<br/></li>
<li>&nbsp; <span class="Type">unsigned</span> <span class="Type">int</span> val = <span class="Constant">1</span>;<br/></li>
<li>&nbsp; <a href="caml/misc.h.html#L386" title="ocaml/runtime/caml/misc.h:386">sscanf_os</a> (opt, <a href="caml/misc.h.html#L363" title="ocaml/runtime/caml/misc.h:363">T</a>(<span class="Constant">&quot;=</span><span class="Special">%u%c</span><span class="Constant">&quot;</span>), &amp;val, &amp;mult);<br/></li>
<li>&nbsp; <a href="caml/misc.h.html#L386" title="ocaml/runtime/caml/misc.h:386">sscanf_os</a> (opt, <a href="caml/misc.h.html#L363" title="ocaml/runtime/caml/misc.h:363">T</a>(<span class="Constant">&quot;=0x</span><span class="Special">%x%c</span><span class="Constant">&quot;</span>), &amp;val, &amp;mult);<br/></li>
<li>&nbsp; <span class="Statement">switch</span> (mult) {<br/></li>
<li>&nbsp; <span class="Statement">case</span> <span class="Constant">'k'</span>:&nbsp;&nbsp; *var = (<a href="caml/config.h.html#L141" title="ocaml/runtime/caml/config.h:141">uintnat</a>) val * <span class="Constant">1024</span>; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; <span class="Statement">case</span> <span class="Constant">'<a href="prng.c.html#L26" title="ocaml/runtime/prng.c:26">M</a>'</span>:&nbsp;&nbsp; *var = (<a href="caml/config.h.html#L141" title="ocaml/runtime/caml/config.h:141">uintnat</a>) val * (<span class="Constant">1024</span> * <span class="Constant">1024</span>); <span class="Statement">break</span>;<br/></li>
<li>&nbsp; <span class="Statement">case</span> <span class="Constant">'G'</span>:&nbsp;&nbsp; *var = (<a href="caml/config.h.html#L141" title="ocaml/runtime/caml/config.h:141">uintnat</a>) val * (<span class="Constant">1024</span> * <span class="Constant">1024</span> * <span class="Constant">1024</span>); <span class="Statement">break</span>;<br/></li>
<li>&nbsp; <span class="Statement">case</span> <span class="Constant">'v'</span>:&nbsp;&nbsp; <a href="caml/platform.h.html#L60" title="ocaml/runtime/caml/platform.h:60">atomic_store_relaxed</a>((<a href="caml/camlatomic.h.html#L32" title="ocaml/runtime/caml/camlatomic.h:32">atomic_uintnat</a> *)var, val); <span class="Statement">break</span>;<br/></li>
<li>&nbsp; <span class="Statement">default</span>:&nbsp; &nbsp; *var = (<a href="caml/config.h.html#L141" title="ocaml/runtime/caml/config.h:141">uintnat</a>) val; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; }<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><a id="L88">&#x200c;</a><span class="Type">void</span> <span class="linkable">caml_parse_ocamlrunparam</span>(<span class="Type">void</span>)<br/></li>
<li>{<br/></li>
<li>&nbsp; <a href="#L43" title="ocaml/runtime/startup_aux.c:43">init_startup_params</a>();<br/></li>
<li><br/></li>
<li>&nbsp; <a href="caml/misc.h.html#L227" title="ocaml/runtime/caml/misc.h:227">char_os</a> *opt = <a href="unix.c.html#L414" title="ocaml/runtime/unix.c:414">caml_secure_getenv</a> (<a href="caml/misc.h.html#L363" title="ocaml/runtime/caml/misc.h:363">T</a>(<span class="Constant">&quot;OCAMLRUNPARAM&quot;</span>));<br/></li>
<li>&nbsp; <span class="Statement">if</span> (opt == <span class="Constant"><a href="caml/misc.h.html#L71" title="ocaml/runtime/caml/misc.h:71">NULL</a></span>) opt = <a href="unix.c.html#L414" title="ocaml/runtime/unix.c:414">caml_secure_getenv</a> (<a href="caml/misc.h.html#L363" title="ocaml/runtime/caml/misc.h:363">T</a>(<span class="Constant">&quot;CAMLRUNPARAM&quot;</span>));<br/></li>
<li><br/></li>
<li>&nbsp; <span class="Statement">if</span> (opt != <span class="Constant"><a href="caml/misc.h.html#L71" title="ocaml/runtime/caml/misc.h:71">NULL</a></span>){<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">while</span> (*opt != <span class="Special">'\0'</span>){<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Statement">switch</span> (*opt++){<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Statement">case</span> <span class="Constant">'<a href="bigarray.c.html#L951" title="ocaml/runtime/bigarray.c:951">b</a>'</span>: <a href="#L73" title="ocaml/runtime/startup_aux.c:73">scanmult</a> (opt, &amp;<a href="#L40" title="ocaml/runtime/startup_aux.c:40">params</a>.backtrace_enabled); <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Statement">case</span> <span class="Constant">'c'</span>: <a href="#L73" title="ocaml/runtime/startup_aux.c:73">scanmult</a> (opt, &amp;<a href="#L40" title="ocaml/runtime/startup_aux.c:40">params</a>.cleanup_on_exit); <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Statement">case</span> <span class="Constant">'e'</span>: <a href="#L73" title="ocaml/runtime/startup_aux.c:73">scanmult</a> (opt, &amp;<a href="#L40" title="ocaml/runtime/startup_aux.c:40">params</a>.runtime_events_log_wsize); <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Statement">case</span> <span class="Constant">'l'</span>: <a href="#L73" title="ocaml/runtime/startup_aux.c:73">scanmult</a> (opt, &amp;<a href="#L40" title="ocaml/runtime/startup_aux.c:40">params</a>.init_max_stack_wsz); <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Statement">case</span> <span class="Constant">'<a href="prng.c.html#L26" title="ocaml/runtime/prng.c:26">M</a>'</span>: <a href="#L73" title="ocaml/runtime/startup_aux.c:73">scanmult</a> (opt, &amp;<a href="#L40" title="ocaml/runtime/startup_aux.c:40">params</a>.init_custom_major_ratio); <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Statement">case</span> <span class="Constant">'m'</span>: <a href="#L73" title="ocaml/runtime/startup_aux.c:73">scanmult</a> (opt, &amp;<a href="#L40" title="ocaml/runtime/startup_aux.c:40">params</a>.init_custom_minor_ratio); <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Statement">case</span> <span class="Constant">'n'</span>: <a href="#L73" title="ocaml/runtime/startup_aux.c:73">scanmult</a> (opt, &amp;<a href="#L40" title="ocaml/runtime/startup_aux.c:40">params</a>.init_custom_minor_max_bsz); <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Statement">case</span> <span class="Constant">'o'</span>: <a href="#L73" title="ocaml/runtime/startup_aux.c:73">scanmult</a> (opt, &amp;<a href="#L40" title="ocaml/runtime/startup_aux.c:40">params</a>.init_percent_free); <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Statement">case</span> <span class="Constant">'p'</span>: <a href="#L73" title="ocaml/runtime/startup_aux.c:73">scanmult</a> (opt, &amp;<a href="#L40" title="ocaml/runtime/startup_aux.c:40">params</a>.parser_trace); <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Statement">case</span> <span class="Constant">'R'</span>: <span class="Statement">break</span>; <span class="Comment">/*&nbsp; see stdlib/hashtbl.mli */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">case</span> <span class="Constant">'s'</span>: <a href="#L73" title="ocaml/runtime/startup_aux.c:73">scanmult</a> (opt, &amp;<a href="#L40" title="ocaml/runtime/startup_aux.c:40">params</a>.init_minor_heap_wsz); <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Statement">case</span> <span class="Constant">'t'</span>: <a href="#L73" title="ocaml/runtime/startup_aux.c:73">scanmult</a> (opt, &amp;<a href="#L40" title="ocaml/runtime/startup_aux.c:40">params</a>.trace_level); <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Statement">case</span> <span class="Constant">'v'</span>: <a href="#L73" title="ocaml/runtime/startup_aux.c:73">scanmult</a> (opt, (<a href="caml/config.h.html#L141" title="ocaml/runtime/caml/config.h:141">uintnat</a> *)&amp;<a href="misc.c.html#L79" title="ocaml/runtime/misc.c:79">caml_verb_gc</a>); <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Statement">case</span> <span class="Constant">'V'</span>: <a href="#L73" title="ocaml/runtime/startup_aux.c:73">scanmult</a> (opt, &amp;<a href="#L40" title="ocaml/runtime/startup_aux.c:40">params</a>.verify_heap); <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Statement">case</span> <span class="Constant">'W'</span>: <a href="#L73" title="ocaml/runtime/startup_aux.c:73">scanmult</a> (opt, &amp;<a href="misc.c.html#L235" title="ocaml/runtime/misc.c:235">caml_runtime_warnings</a>); <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Statement">case</span> <span class="Constant">','</span>: <span class="Statement">continue</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Statement">while</span> (*opt != <span class="Special">'\0'</span>){<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (*opt++ == <span class="Constant">','</span>) <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>&nbsp; }<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><br/></li>
<li><span class="Comment">/* The number of outstanding calls to <a href="startup_nat.c.html#L142" title="ocaml/runtime/startup_nat.c:142">caml_startup</a> */<br/></li>
<li><a id="L124">&#x200c;</a></span><span class="Type">static</span> <span class="Type">int</span> <span class="linkable">startup_count</span> = <span class="Constant">0</span>;<br/></li>
<li><br/></li>
<li><span class="Comment">/* Has the runtime been shut down already? */<br/></li>
<li><a id="L127">&#x200c;</a></span><span class="Type">static</span> <span class="Type">int</span> <span class="linkable">shutdown_happened</span> = <span class="Constant">0</span>;<br/></li>
<li><br/></li>
<li><br/></li>
<li><a id="L130">&#x200c;</a><span class="Type">int</span> <span class="linkable">caml_startup_aux</span>(<span class="Type">int</span> pooling)<br/></li>
<li>{<br/></li>
<li>&nbsp; <span class="Statement">if</span> (<a href="#L127" title="ocaml/runtime/startup_aux.c:127">shutdown_happened</a> == <span class="Constant">1</span>)<br/></li>
<li>&nbsp; &nbsp; <a href="misc.c.html#L108" title="ocaml/runtime/misc.c:108">caml_fatal_error</a>(<span class="Constant">&quot;<a href="startup_nat.c.html#L142" title="ocaml/runtime/startup_nat.c:142">caml_startup</a> was called after the runtime &quot;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">&quot;was shut down with <a href="#L155" title="ocaml/runtime/startup_aux.c:155">caml_shutdown</a>&quot;</span>);<br/></li>
<li><br/></li>
<li>&nbsp; <span class="Comment">/* Second <a href="ints.c.html#L488" title="ocaml/runtime/ints.c:488">and</a> subsequent calls are ignored,<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; since the runtime has already started */<br/></li>
<li></span>&nbsp; <a href="#L124" title="ocaml/runtime/startup_aux.c:124">startup_count</a>++;<br/></li>
<li>&nbsp; <span class="Statement">if</span> (<a href="#L124" title="ocaml/runtime/startup_aux.c:124">startup_count</a> &gt; <span class="Constant">1</span>)<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">return</span> <span class="Constant">0</span>;<br/></li>
<li><br/></li>
<li>&nbsp; <span class="Statement">if</span> (pooling)<br/></li>
<li>&nbsp; &nbsp; <a href="memory.c.html#L464" title="ocaml/runtime/memory.c:464">caml_stat_create_pool</a>();<br/></li>
<li><br/></li>
<li>&nbsp; <span class="Statement">return</span> <span class="Constant">1</span>;<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><a id="L148">&#x200c;</a><span class="Type">static</span> <span class="Type">void</span> <span class="linkable">call_registered_value</span>(<span class="Type">char</span>* name)<br/></li>
<li>{<br/></li>
<li>&nbsp; <span class="Type">const</span> <a href="caml/mlvalues.h.html#L57" title="ocaml/runtime/caml/mlvalues.h:57">value</a> *f = <a href="callback.c.html#L367" title="ocaml/runtime/callback.c:367">caml_named_value</a>(name);<br/></li>
<li>&nbsp; <span class="Statement">if</span> (f != <span class="Constant"><a href="caml/misc.h.html#L71" title="ocaml/runtime/caml/misc.h:71">NULL</a></span>)<br/></li>
<li>&nbsp; &nbsp; <a href="callback.c.html#L134" title="ocaml/runtime/callback.c:134">caml_callback_exn</a>(*f, <a href="caml/mlvalues.h.html#L431" title="ocaml/runtime/caml/mlvalues.h:431">Val_unit</a>);<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><a id="L155">&#x200c;</a><a href="caml/misc.h.html#L123" title="ocaml/runtime/caml/misc.h:123">CAMLexport</a> <span class="Type">void</span> <span class="linkable">caml_shutdown</span>(<span class="Type">void</span>)<br/></li>
<li>{<br/></li>
<li>&nbsp; <a href="caml/domain_state.h.html#L72" title="ocaml/runtime/caml/domain_state.h:72">Caml_check_caml_state</a>();<br/></li>
<li>&nbsp; <span class="Statement">if</span> (<a href="#L124" title="ocaml/runtime/startup_aux.c:124">startup_count</a> &lt;= <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; <a href="misc.c.html#L108" title="ocaml/runtime/misc.c:108">caml_fatal_error</a>(<span class="Constant">&quot;a call to <a href="#L155" title="ocaml/runtime/startup_aux.c:155">caml_shutdown</a> has no &quot;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">&quot;corresponding call to <a href="startup_nat.c.html#L142" title="ocaml/runtime/startup_nat.c:142">caml_startup</a>&quot;</span>);<br/></li>
<li><br/></li>
<li>&nbsp; <span class="Comment">/* Do nothing unless it's the last call remaining */<br/></li>
<li></span>&nbsp; <a href="#L124" title="ocaml/runtime/startup_aux.c:124">startup_count</a>--;<br/></li>
<li>&nbsp; <span class="Statement">if</span> (<a href="#L124" title="ocaml/runtime/startup_aux.c:124">startup_count</a> &gt; <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">return</span>;<br/></li>
<li><br/></li>
<li>&nbsp; <a href="#L148" title="ocaml/runtime/startup_aux.c:148">call_registered_value</a>(<span class="Constant">&quot;Pervasives.do_at_exit&quot;</span>);<br/></li>
<li>&nbsp; <a href="#L148" title="ocaml/runtime/startup_aux.c:148">call_registered_value</a>(<span class="Constant">&quot;Thread.at_shutdown&quot;</span>);<br/></li>
<li>&nbsp; <a href="major_gc.c.html#L1931" title="ocaml/runtime/major_gc.c:1931">caml_finalise_heap</a>();<br/></li>
<li>&nbsp; <a href="floats.c.html#L144" title="ocaml/runtime/floats.c:144">caml_free_locale</a>();<br/></li>
<li><span class="PreProc">#ifndef NATIVE_CODE<br/></li>
<li></span>&nbsp; <a href="dynlink.c.html#L226" title="ocaml/runtime/dynlink.c:226">caml_free_shared_libs</a>();<br/></li>
<li><span class="PreProc">#endif<br/></li>
<li></span>&nbsp; <a href="memory.c.html#L478" title="ocaml/runtime/memory.c:478">caml_stat_destroy_pool</a>();<br/></li>
<li>&nbsp; <a href="signals.c.html#L569" title="ocaml/runtime/signals.c:569">caml_terminate_signals</a>();<br/></li>
<li><span class="PreProc">#if defined(_WIN32) &amp;&amp; defined(NATIVE_CODE)<br/></li>
<li></span>&nbsp; <a href="win32.c.html#L620" title="ocaml/runtime/win32.c:620">caml_win32_unregister_overflow_detection</a>();<br/></li>
<li><span class="PreProc">#endif<br/></li>
<li></span><br/></li>
<li>&nbsp; <a href="#L127" title="ocaml/runtime/startup_aux.c:127">shutdown_happened</a> = <span class="Constant">1</span>;<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><a id="L183">&#x200c;</a><span class="Type">void</span> <span class="linkable">caml_init_exe_name</span>(<span class="Type">const</span> <a href="caml/misc.h.html#L227" title="ocaml/runtime/caml/misc.h:227">char_os</a>* exe_name)<br/></li>
<li>{<br/></li>
<li>&nbsp; <a href="#L40" title="ocaml/runtime/startup_aux.c:40">params</a>.exe_name = exe_name;<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><a id="L188">&#x200c;</a><span class="Type">void</span> <span class="linkable">caml_init_section_table</span>(<span class="Type">const</span> <span class="Type">char</span>* section_table,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <a href="caml/misc.h.html#L68" title="ocaml/runtime/caml/misc.h:68">asize_t</a> section_table_size)<br/></li>
<li>{<br/></li>
<li>&nbsp; <a href="#L40" title="ocaml/runtime/startup_aux.c:40">params</a>.section_table = section_table;<br/></li>
<li>&nbsp; <a href="#L40" title="ocaml/runtime/startup_aux.c:40">params</a>.section_table_size = section_table_size;<br/></li>
<li>}<br/></li>
</ol></code>
 <p class="nav-bar">
  <span class="nav-link"><a href="./index.html">One Level Up</a></span>
  <span class="nav-link"><a href="index.html">Top Level</a></span>
 </p>

 </body>
</html>
