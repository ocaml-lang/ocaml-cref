<!-- generated by the vscode.pl tool from vscoded.-->

<html>
 <head>
  <title>ocaml/runtime/md5.c - ocaml</title>
  <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
  <style>
body {
    text-align: left;
    text-align-last: left;
}

.nav-bar {
    font-size: 120%;
    margin-top: 5px;
    margin-bottom: 5px;
}

.nav-link {
    padding-left: 5em;
    padding-right: 5em;
}

ul.toc {
    line-height: 200%;
    font-size: 150%;
}

code {
    font-family: consolas, monospace;
    line-height: 130%;
}

span.Constant {
    color: DarkGreen;
}

span.Special {
    color: #c06000;
}

span.Comment {
    color: DarkRed;
    font-style: italic;
}

span.Identifier {
    color: DarkCyan;
}

span.PreProc {
    color: DarkMagenta;
}

span.Statement, span.Type, span.Keyword, span.Repeat, span.Conditional,
    span.Operator, span.Exception
{
    color: DarkBlue;
}

span.Todo {
    color: DarkRed;
    background-color: Gold;
    font-style: italic;
}

span.Underlined {
    text-decoration: underline;
}

span.linkable {
    font-weight: bold;
}

code ol {
    counter-reset: item;
    list-style-type: none;
    margin-left: 0;
    padding-left: 0;
    list-style-position: inside;
}

code li {
    display: block;
}

code li:before {
    content: counter(item) "  ";
    counter-increment: item;
    color: #999;
    padding-right: 0.5em;
    padding-left: 0.4em;
    list-style-position: inside;
    text-align: right
}

  </style>
 </head>
 <body>
 <p class="nav-bar">
  <span class="nav-link"><a href="./index.html">One Level Up</a></span>
  <span class="nav-link"><a href="index.html">Top Level</a></span>
 </p>

  <h1>ocaml/runtime/md5.c - ocaml</h1>
 <h2>Functions defined</h2>
 <ul class="toc">
<li><a href="#L106">byteReverse</a></li>
<li><a href="#L186">caml_MD5Final</a></li>
<li><a href="#L122">caml_MD5Init</a></li>
<li><a href="#L244">caml_MD5Transform</a></li>
<li><a href="#L137">caml_MD5Update</a></li>
<li><a href="#L77">caml_md5_block</a></li>
<li><a href="#L71">caml_md5_chan</a></li>
<li><a href="#L40">caml_md5_channel</a></li>
<li><a href="#L29">caml_md5_string</a></li>
</ul>
 <h2>Macros defined</h2>
 <ul class="toc">
<li><a href="#L16">CAML_INTERNALS</a></li>
<li><a href="#L230">F1</a></li>
<li><a href="#L231">F2</a></li>
<li><a href="#L232">F3</a></li>
<li><a href="#L233">F4</a></li>
<li><a href="#L236">MD5STEP</a></li>
<li><a href="#L104">byteReverse</a></li>
</ul>
 <h2>Source code</h2>

  <code><ol><li><span class="Comment">/**************************************************************************/<br/></li>
<li></span><span class="Comment">/*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */<br/></li>
<li></span><span class="Comment">/*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; OCaml&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */<br/></li>
<li></span><span class="Comment">/*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */<br/></li>
<li></span><span class="Comment">/*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; Xavier Leroy, projet Cristal, INRIA Rocquencourt&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; */<br/></li>
<li></span><span class="Comment">/*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */<br/></li>
<li></span><span class="Comment">/*&nbsp;&nbsp; Copyright 1996 Institut National de Recherche en Informatique et&nbsp; &nbsp;&nbsp; */<br/></li>
<li></span><span class="Comment">/*&nbsp; &nbsp;&nbsp; en Automatique.&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */<br/></li>
<li></span><span class="Comment">/*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */<br/></li>
<li></span><span class="Comment">/*&nbsp;&nbsp; All rights reserved.&nbsp; This file is distributed under the terms of&nbsp; &nbsp; */<br/></li>
<li></span><span class="Comment">/*&nbsp;&nbsp; the GNU Lesser General Public License version 2.1, with the&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */<br/></li>
<li></span><span class="Comment">/*&nbsp;&nbsp; special exception on linking described in the file LICENSE.&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */<br/></li>
<li></span><span class="Comment">/*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */<br/></li>
<li></span><span class="Comment">/**************************************************************************/<br/></li>
<li></span><br/></li>
<li><a id="L16">&#x200c;</a><span class="PreProc">#define <span class="linkable">CAML_INTERNALS</span><br/></li>
<li></span><br/></li>
<li><span class="PreProc">#include </span><span class="Constant">&lt;string.h&gt;<br/></li>
<li></span><span class="PreProc">#include </span><span class="Constant">&quot;caml/alloc.h&quot;<br/></li>
<li></span><span class="PreProc">#include </span><span class="Constant">&quot;caml/fail.h&quot;<br/></li>
<li></span><span class="PreProc">#include </span><span class="Constant">&quot;caml/md5.h&quot;<br/></li>
<li></span><span class="PreProc">#include </span><span class="Constant">&quot;caml/memory.h&quot;<br/></li>
<li></span><span class="PreProc">#include </span><span class="Constant">&quot;caml/mlvalues.h&quot;<br/></li>
<li></span><span class="PreProc">#include </span><span class="Constant">&quot;caml/io.h&quot;<br/></li>
<li></span><span class="PreProc">#include </span><span class="Constant">&quot;caml/reverse.h&quot;<br/></li>
<li></span><br/></li>
<li><span class="Comment">/* MD5 message digest */<br/></li>
<li></span><br/></li>
<li><a id="L29">&#x200c;</a><a href="caml/misc.h.html#L124" title="ocaml/runtime/caml/misc.h:124">CAMLprim</a> <a href="caml/mlvalues.h.html#L57" title="ocaml/runtime/caml/mlvalues.h:57">value</a> <span class="linkable">caml_md5_string</span>(<a href="caml/mlvalues.h.html#L57" title="ocaml/runtime/caml/mlvalues.h:57">value</a> str, <a href="caml/mlvalues.h.html#L57" title="ocaml/runtime/caml/mlvalues.h:57">value</a> ofs, <a href="caml/mlvalues.h.html#L57" title="ocaml/runtime/caml/mlvalues.h:57">value</a> len)<br/></li>
<li>{<br/></li>
<li>&nbsp; <span class="Type">struct</span> <a href="caml/md5.h.html#L31" title="ocaml/runtime/caml/md5.h:31">MD5Context</a> ctx;<br/></li>
<li>&nbsp; <a href="caml/mlvalues.h.html#L57" title="ocaml/runtime/caml/mlvalues.h:57">value</a> res;<br/></li>
<li>&nbsp; <a href="#L122" title="ocaml/runtime/md5.c:122">caml_MD5Init</a>(&amp;ctx);<br/></li>
<li>&nbsp; <a href="#L137" title="ocaml/runtime/md5.c:137">caml_MD5Update</a>(&amp;ctx, &amp;<a href="caml/mlvalues.h.html#L316" title="ocaml/runtime/caml/mlvalues.h:316">Byte_u</a>(str, <a href="caml/mlvalues.h.html#L78" title="ocaml/runtime/caml/mlvalues.h:78">Long_val</a>(ofs)), <a href="caml/mlvalues.h.html#L78" title="ocaml/runtime/caml/mlvalues.h:78">Long_val</a>(len));<br/></li>
<li>&nbsp; res = <a href="alloc.c.html#L177" title="ocaml/runtime/alloc.c:177">caml_alloc_string</a>(<span class="Constant">16</span>);<br/></li>
<li>&nbsp; <a href="#L186" title="ocaml/runtime/md5.c:186">caml_MD5Final</a>(&amp;<a href="caml/mlvalues.h.html#L316" title="ocaml/runtime/caml/mlvalues.h:316">Byte_u</a>(res, <span class="Constant">0</span>), &amp;ctx);<br/></li>
<li>&nbsp; <span class="Statement">return</span> res;<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><a id="L40">&#x200c;</a><a href="caml/misc.h.html#L123" title="ocaml/runtime/caml/misc.h:123">CAMLexport</a> <a href="caml/mlvalues.h.html#L57" title="ocaml/runtime/caml/mlvalues.h:57">value</a> <span class="linkable">caml_md5_channel</span>(<span class="Type">struct</span> <a href="caml/io.h.html#L39" title="ocaml/runtime/caml/io.h:39">channel</a> *chan, <a href="caml/config.h.html#L140" title="ocaml/runtime/caml/config.h:140">intnat</a> toread)<br/></li>
<li>{<br/></li>
<li>&nbsp; <a href="caml/memory.h.html#L270" title="ocaml/runtime/caml/memory.h:270">CAMLparam0</a>();<br/></li>
<li>&nbsp; <span class="Type">struct</span> <a href="caml/md5.h.html#L31" title="ocaml/runtime/caml/md5.h:31">MD5Context</a> ctx;<br/></li>
<li>&nbsp; <a href="caml/mlvalues.h.html#L57" title="ocaml/runtime/caml/mlvalues.h:57">value</a> res;<br/></li>
<li>&nbsp; <a href="caml/config.h.html#L140" title="ocaml/runtime/caml/config.h:140">intnat</a> read;<br/></li>
<li>&nbsp; <span class="Type">char</span> buffer[<span class="Constant">4096</span>];<br/></li>
<li><br/></li>
<li>&nbsp; <a href="caml/io.h.html#L109" title="ocaml/runtime/caml/io.h:109">Lock</a>(chan);<br/></li>
<li>&nbsp; <a href="#L122" title="ocaml/runtime/md5.c:122">caml_MD5Init</a>(&amp;ctx);<br/></li>
<li>&nbsp; <span class="Statement">if</span> (toread &lt; <span class="Constant">0</span>){<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">while</span> (<span class="Constant">1</span>){<br/></li>
<li>&nbsp; &nbsp; &nbsp; read = <a href="io.c.html#L387" title="ocaml/runtime/io.c:387">caml_getblock</a> (chan, buffer, <span class="Statement"><a href="caml/fiber.h.html#L65" title="ocaml/runtime/caml/fiber.h:65">sizeof</a></span>(buffer));<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (read == <span class="Constant">0</span>) <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="#L137" title="ocaml/runtime/md5.c:137">caml_MD5Update</a> (&amp;ctx, (<span class="Type">unsigned</span> <span class="Type">char</span> *) buffer, read);<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>&nbsp; }<span class="Statement">else</span>{<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">while</span> (toread &gt; <span class="Constant">0</span>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; read = <a href="io.c.html#L387" title="ocaml/runtime/io.c:387">caml_getblock</a>(chan, buffer,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; toread &gt; <span class="Statement"><a href="caml/fiber.h.html#L65" title="ocaml/runtime/caml/fiber.h:65">sizeof</a></span>(buffer) ? <span class="Statement"><a href="caml/fiber.h.html#L65" title="ocaml/runtime/caml/fiber.h:65">sizeof</a></span>(buffer) : toread);<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (read == <span class="Constant">0</span>) <a href="fail_nat.c.html#L168" title="ocaml/runtime/fail_nat.c:168">caml_raise_end_of_file</a>();<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="#L137" title="ocaml/runtime/md5.c:137">caml_MD5Update</a>(&amp;ctx, (<span class="Type">unsigned</span> <span class="Type">char</span> *) buffer, read);<br/></li>
<li>&nbsp; &nbsp; &nbsp; toread -= read;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>&nbsp; }<br/></li>
<li>&nbsp; res = <a href="alloc.c.html#L177" title="ocaml/runtime/alloc.c:177">caml_alloc_string</a>(<span class="Constant">16</span>);<br/></li>
<li>&nbsp; <a href="#L186" title="ocaml/runtime/md5.c:186">caml_MD5Final</a>(&amp;<a href="caml/mlvalues.h.html#L316" title="ocaml/runtime/caml/mlvalues.h:316">Byte_u</a>(res, <span class="Constant">0</span>), &amp;ctx);<br/></li>
<li>&nbsp; <a href="caml/io.h.html#L111" title="ocaml/runtime/caml/io.h:111">Unlock</a>(chan);<br/></li>
<li>&nbsp; <a href="caml/memory.h.html#L419" title="ocaml/runtime/caml/memory.h:419">CAMLreturn</a> (res);<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><a id="L71">&#x200c;</a><a href="caml/misc.h.html#L124" title="ocaml/runtime/caml/misc.h:124">CAMLprim</a> <a href="caml/mlvalues.h.html#L57" title="ocaml/runtime/caml/mlvalues.h:57">value</a> <span class="linkable">caml_md5_chan</span>(<a href="caml/mlvalues.h.html#L57" title="ocaml/runtime/caml/mlvalues.h:57">value</a> vchan, <a href="caml/mlvalues.h.html#L57" title="ocaml/runtime/caml/mlvalues.h:57">value</a> len)<br/></li>
<li>{<br/></li>
<li>&nbsp;&nbsp; <a href="caml/memory.h.html#L280" title="ocaml/runtime/caml/memory.h:280">CAMLparam2</a> (vchan, len);<br/></li>
<li>&nbsp;&nbsp; <a href="caml/memory.h.html#L419" title="ocaml/runtime/caml/memory.h:419">CAMLreturn</a> (<a href="#L40" title="ocaml/runtime/md5.c:40">caml_md5_channel</a>(<a href="caml/io.h.html#L98" title="ocaml/runtime/caml/io.h:98">Channel</a>(vchan), <a href="caml/mlvalues.h.html#L78" title="ocaml/runtime/caml/mlvalues.h:78">Long_val</a>(len)));<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><a id="L77">&#x200c;</a><a href="caml/misc.h.html#L123" title="ocaml/runtime/caml/misc.h:123">CAMLexport</a> <span class="Type">void</span> <span class="linkable">caml_md5_block</span>(<span class="Type">unsigned</span> <span class="Type">char</span> digest[<span class="Constant">16</span>],<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Type">void</span> * data, <a href="caml/config.h.html#L141" title="ocaml/runtime/caml/config.h:141">uintnat</a> len)<br/></li>
<li>{<br/></li>
<li>&nbsp; <span class="Type">struct</span> <a href="caml/md5.h.html#L31" title="ocaml/runtime/caml/md5.h:31">MD5Context</a> ctx;<br/></li>
<li>&nbsp; <a href="#L122" title="ocaml/runtime/md5.c:122">caml_MD5Init</a>(&amp;ctx);<br/></li>
<li>&nbsp; <a href="#L137" title="ocaml/runtime/md5.c:137">caml_MD5Update</a>(&amp;ctx, data, len);<br/></li>
<li>&nbsp; <a href="#L186" title="ocaml/runtime/md5.c:186">caml_MD5Final</a>(digest, &amp;ctx);<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * This code implements the MD5 message-digest algorithm.<br/></li>
<li></span><span class="Comment"> * The algorithm is due to Ron Rivest.&nbsp; This code was<br/></li>
<li></span><span class="Comment"> * written by Colin Plumb in 1993, no copyright is claimed.<br/></li>
<li></span><span class="Comment"> * This code is in the public domain; do with it what you wish.<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> * Equivalent code is available from RSA Data Security, Inc.<br/></li>
<li></span><span class="Comment"> * This code has been tested against that, <a href="ints.c.html#L488" title="ocaml/runtime/ints.c:488">and</a> is equivalent,<br/></li>
<li></span><span class="Comment"> * except that you don't need to include two pages of legalese<br/></li>
<li></span><span class="Comment"> * with every copy.<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> * To compute the message digest of a chunk of bytes, declare an<br/></li>
<li></span><span class="Comment"> * <a href="caml/md5.h.html#L31" title="ocaml/runtime/caml/md5.h:31">MD5Context</a> structure, pass it to <a href="#L122" title="ocaml/runtime/md5.c:122">caml_MD5Init</a>, call <a href="#L137" title="ocaml/runtime/md5.c:137">caml_MD5Update</a> as<br/></li>
<li></span><span class="Comment"> * needed on buffers full of bytes, <a href="ints.c.html#L488" title="ocaml/runtime/ints.c:488">and</a> then call <a href="#L186" title="ocaml/runtime/md5.c:186">caml_MD5Final</a>, which<br/></li>
<li></span><span class="Comment"> * will fill a supplied 16-byte array with the digest.<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><br/></li>
<li><span class="PreProc">#ifndef ARCH_BIG_ENDIAN<br/></li>
<li><a id="L104">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">byteReverse</span>(buf, len)&nbsp;&nbsp; </span><span class="Comment">/* Nothing */<br/></li>
<li></span><span class="PreProc">#else<br/></li>
<li><a id="L106">&#x200c;</a></span><span class="Type">static</span> <span class="Type">void</span> <span class="linkable">byteReverse</span>(<span class="Type">unsigned</span> <span class="Type">char</span> * buf, <span class="Type">unsigned</span> longs)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <span class="Type"><a href="caml/config.h.html#L126" title="ocaml/runtime/caml/config.h:126">uint32_t</a></span> t;<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">do</span> {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; t = (<span class="Type"><a href="caml/config.h.html#L126" title="ocaml/runtime/caml/config.h:126">uint32_t</a></span>) ((<span class="Type">unsigned</span>) buf[<span class="Constant">3</span>] &lt;&lt; <span class="Constant">8</span> | buf[<span class="Constant">2</span>]) &lt;&lt; <span class="Constant">16</span> |<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ((<span class="Type">unsigned</span>) buf[<span class="Constant">1</span>] &lt;&lt; <span class="Constant">8</span> | buf[<span class="Constant">0</span>]);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; *(<span class="Type"><a href="caml/config.h.html#L126" title="ocaml/runtime/caml/config.h:126">uint32_t</a></span> *) buf = t;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; buf += <span class="Constant">4</span>;<br/></li>
<li>&nbsp; &nbsp; } <span class="Statement">while</span> (--longs);<br/></li>
<li>}<br/></li>
<li><span class="PreProc">#endif<br/></li>
<li></span><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * Start MD5 accumulation.&nbsp; Set bit count to 0 <a href="ints.c.html#L488" title="ocaml/runtime/ints.c:488">and</a> buffer to mysterious<br/></li>
<li></span><span class="Comment"> * initialization constants.<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li><a id="L122">&#x200c;</a></span><a href="caml/misc.h.html#L123" title="ocaml/runtime/caml/misc.h:123">CAMLexport</a> <span class="Type">void</span> <span class="linkable">caml_MD5Init</span>(<span class="Type">struct</span> <a href="caml/md5.h.html#L31" title="ocaml/runtime/caml/md5.h:31">MD5Context</a> *ctx)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; ctx-&gt;buf[<span class="Constant">0</span>] = <span class="Constant">0x67452301</span>;<br/></li>
<li>&nbsp; &nbsp; ctx-&gt;buf[<span class="Constant">1</span>] = <span class="Constant">0xefcdab89</span>;<br/></li>
<li>&nbsp; &nbsp; ctx-&gt;buf[<span class="Constant">2</span>] = <span class="Constant">0x98badcfe</span>;<br/></li>
<li>&nbsp; &nbsp; ctx-&gt;buf[<span class="Constant">3</span>] = <span class="Constant">0x10325476</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; ctx-&gt;bits[<span class="Constant">0</span>] = <span class="Constant">0</span>;<br/></li>
<li>&nbsp; &nbsp; ctx-&gt;bits[<span class="Constant">1</span>] = <span class="Constant">0</span>;<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * Update context to reflect the concatenation of another buffer full<br/></li>
<li></span><span class="Comment"> * of bytes.<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li><a id="L137">&#x200c;</a></span><a href="caml/misc.h.html#L123" title="ocaml/runtime/caml/misc.h:123">CAMLexport</a> <span class="Type">void</span> <span class="linkable">caml_MD5Update</span>(<span class="Type">struct</span> <a href="caml/md5.h.html#L31" title="ocaml/runtime/caml/md5.h:31">MD5Context</a> *ctx, <span class="Type">unsigned</span> <span class="Type">char</span> *buf,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <a href="caml/config.h.html#L141" title="ocaml/runtime/caml/config.h:141">uintnat</a> len)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <span class="Type"><a href="caml/config.h.html#L126" title="ocaml/runtime/caml/config.h:126">uint32_t</a></span> t;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* Update bitcount */<br/></li>
<li></span><br/></li>
<li>&nbsp; &nbsp; t = ctx-&gt;bits[<span class="Constant">0</span>];<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> ((ctx-&gt;bits[<span class="Constant">0</span>] = t + ((<span class="Type"><a href="caml/config.h.html#L126" title="ocaml/runtime/caml/config.h:126">uint32_t</a></span>) len &lt;&lt; <span class="Constant">3</span>)) &lt; t)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; ctx-&gt;bits[<span class="Constant">1</span>]++;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Comment">/* Carry from low to high */<br/></li>
<li></span>&nbsp; &nbsp; ctx-&gt;bits[<span class="Constant">1</span>] += len &gt;&gt; <span class="Constant">29</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; t = (t &gt;&gt; <span class="Constant">3</span>) &amp; <span class="Constant">0x3f</span>;&nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* Bytes already in shsInfo-&gt;data */<br/></li>
<li></span><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* Handle any leading odd-sized chunks */<br/></li>
<li></span><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (t) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Type">unsigned</span> <span class="Type">char</span> *p = (<span class="Type">unsigned</span> <span class="Type">char</span> *) ctx-&gt;in + t;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; t = <span class="Constant">64</span> - t;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (len &lt; t) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; memcpy(p, buf, len);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; memcpy(p, buf, t);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L104" title="ocaml/runtime/md5.c:104">byteReverse</a>(ctx-&gt;in, <span class="Constant">16</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L244" title="ocaml/runtime/md5.c:244">caml_MD5Transform</a>(ctx-&gt;buf, (<span class="Type"><a href="caml/config.h.html#L126" title="ocaml/runtime/caml/config.h:126">uint32_t</a></span> *) ctx-&gt;in);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; buf += t;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; len -= t;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* Process data in 64-byte chunks */<br/></li>
<li></span><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">while</span> (len &gt;= <span class="Constant">64</span>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; memcpy(ctx-&gt;in, buf, <span class="Constant">64</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L104" title="ocaml/runtime/md5.c:104">byteReverse</a>(ctx-&gt;in, <span class="Constant">16</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L244" title="ocaml/runtime/md5.c:244">caml_MD5Transform</a>(ctx-&gt;buf, (<span class="Type"><a href="caml/config.h.html#L126" title="ocaml/runtime/caml/config.h:126">uint32_t</a></span> *) ctx-&gt;in);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; buf += <span class="Constant">64</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; len -= <span class="Constant">64</span>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* Handle any remaining bytes of data. */<br/></li>
<li></span><br/></li>
<li>&nbsp; &nbsp; memcpy(ctx-&gt;in, buf, len);<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * Final wrapup - pad to 64-byte boundary with the bit pattern<br/></li>
<li></span><span class="Comment"> * 1 0* (64-bit count of bits processed, MSB-first)<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li><a id="L186">&#x200c;</a></span><a href="caml/misc.h.html#L123" title="ocaml/runtime/caml/misc.h:123">CAMLexport</a> <span class="Type">void</span> <span class="linkable">caml_MD5Final</span>(<span class="Type">unsigned</span> <span class="Type">char</span> *digest, <span class="Type">struct</span> <a href="caml/md5.h.html#L31" title="ocaml/runtime/caml/md5.h:31">MD5Context</a> *ctx)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <span class="Type">unsigned</span> count;<br/></li>
<li>&nbsp; &nbsp; <span class="Type">unsigned</span> <span class="Type">char</span> *p;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* Compute number of bytes <a href="ints.c.html#L479" title="ocaml/runtime/ints.c:479">mod</a> 64 */<br/></li>
<li></span>&nbsp; &nbsp; count = (ctx-&gt;bits[<span class="Constant">0</span>] &gt;&gt; <span class="Constant">3</span>) &amp; <span class="Constant">0x3F</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* Set the first char of padding to 0x80.&nbsp; This is safe since there is<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp;&nbsp; always at least one byte free */<br/></li>
<li></span>&nbsp; &nbsp; p = ctx-&gt;in + count;<br/></li>
<li>&nbsp; &nbsp; *p++ = <span class="Constant">0x80</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* Bytes of padding needed to make 64 bytes */<br/></li>
<li></span>&nbsp; &nbsp; count = <span class="Constant">64</span> - <span class="Constant">1</span> - count;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* Pad out to 56 <a href="ints.c.html#L479" title="ocaml/runtime/ints.c:479">mod</a> 64 */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span> (count &lt; <span class="Constant">8</span>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* Two lots of padding:&nbsp; Pad the first block to 64 bytes */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; memset(p, <span class="Constant">0</span>, count);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L104" title="ocaml/runtime/md5.c:104">byteReverse</a>(ctx-&gt;in, <span class="Constant">16</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L244" title="ocaml/runtime/md5.c:244">caml_MD5Transform</a>(ctx-&gt;buf, (<span class="Type"><a href="caml/config.h.html#L126" title="ocaml/runtime/caml/config.h:126">uint32_t</a></span> *) ctx-&gt;in);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* Now fill the next block with 56 bytes */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; memset(ctx-&gt;in, <span class="Constant">0</span>, <span class="Constant">56</span>);<br/></li>
<li>&nbsp; &nbsp; } <span class="Statement">else</span> {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* Pad block to 56 bytes */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; memset(p, <span class="Constant">0</span>, count - <span class="Constant">8</span>);<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; <a href="#L104" title="ocaml/runtime/md5.c:104">byteReverse</a>(ctx-&gt;in, <span class="Constant">14</span>);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* Append length in bits <a href="ints.c.html#L488" title="ocaml/runtime/ints.c:488">and</a> transform */<br/></li>
<li></span>&nbsp; &nbsp; ((<span class="Type"><a href="caml/config.h.html#L126" title="ocaml/runtime/caml/config.h:126">uint32_t</a></span> *) ctx-&gt;in)[<span class="Constant">14</span>] = ctx-&gt;bits[<span class="Constant">0</span>];<br/></li>
<li>&nbsp; &nbsp; ((<span class="Type"><a href="caml/config.h.html#L126" title="ocaml/runtime/caml/config.h:126">uint32_t</a></span> *) ctx-&gt;in)[<span class="Constant">15</span>] = ctx-&gt;bits[<span class="Constant">1</span>];<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="#L244" title="ocaml/runtime/md5.c:244">caml_MD5Transform</a>(ctx-&gt;buf, (<span class="Type"><a href="caml/config.h.html#L126" title="ocaml/runtime/caml/config.h:126">uint32_t</a></span> *) ctx-&gt;in);<br/></li>
<li>&nbsp; &nbsp; <a href="#L104" title="ocaml/runtime/md5.c:104">byteReverse</a>((<span class="Type">unsigned</span> <span class="Type">char</span> *) ctx-&gt;buf, <span class="Constant">4</span>);<br/></li>
<li>&nbsp; &nbsp; memcpy(digest, ctx-&gt;buf, <span class="Constant">16</span>);<br/></li>
<li>&nbsp; &nbsp; memset(ctx, <span class="Constant">0</span>, <span class="Statement"><a href="caml/fiber.h.html#L65" title="ocaml/runtime/caml/fiber.h:65">sizeof</a></span>(*ctx));&nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* In case it's sensitive */<br/></li>
<li></span>}<br/></li>
<li><br/></li>
<li><span class="Comment">/* The four core functions - <a href="#L230" title="ocaml/runtime/md5.c:230">F1</a> is optimized somewhat */<br/></li>
<li></span><br/></li>
<li><span class="Comment">/* #define <a href="#L230" title="ocaml/runtime/md5.c:230">F1</a>(x, y, z) (x &amp; y | ~x &amp; z) */<br/></li>
<li><a id="L230">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">F1</span>(x, y, z) (z ^ (x &amp; (y ^ z)))<br/></li>
<li><a id="L231">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">F2</span>(x, y, z) <a href="#L230" title="ocaml/runtime/md5.c:230">F1</a>(z, x, y)<br/></li>
<li><a id="L232">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">F3</span>(x, y, z) (x ^ y ^ z)<br/></li>
<li><a id="L233">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">F4</span>(x, y, z) (y ^ (x | ~z))<br/></li>
<li></span><br/></li>
<li><span class="Comment">/* This is the central step in the MD5 algorithm. */<br/></li>
<li><a id="L236">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">MD5STEP</span>(f, w, x, y, z, data, s) \<br/></li>
<li></span><span class="PreProc">&nbsp; &nbsp; &nbsp; &nbsp; ( w += f(x, y, z) + data,&nbsp; w = w&lt;&lt;s | w&gt;&gt;(</span><span class="Constant">32</span><span class="PreProc">-s),&nbsp; w += x )<br/></li>
<li></span><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * The core of the MD5 algorithm, this alters an existing MD5 hash to<br/></li>
<li></span><span class="Comment"> * reflect the addition of 16 longwords of new data.&nbsp; <a href="#L137" title="ocaml/runtime/md5.c:137">caml_MD5Update</a> blocks<br/></li>
<li></span><span class="Comment"> * the data <a href="ints.c.html#L488" title="ocaml/runtime/ints.c:488">and</a> converts bytes into longwords for this routine.<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li><a id="L244">&#x200c;</a></span><a href="caml/misc.h.html#L123" title="ocaml/runtime/caml/misc.h:123">CAMLexport</a> <span class="Type">void</span> <span class="linkable">caml_MD5Transform</span>(<span class="Type"><a href="caml/config.h.html#L126" title="ocaml/runtime/caml/config.h:126">uint32_t</a></span> *buf, <span class="Type"><a href="caml/config.h.html#L126" title="ocaml/runtime/caml/config.h:126">uint32_t</a></span> *in)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <span class="Type">register</span> <span class="Type"><a href="caml/config.h.html#L126" title="ocaml/runtime/caml/config.h:126">uint32_t</a></span> a, <a href="bigarray.c.html#L951" title="ocaml/runtime/bigarray.c:951">b</a>, c, d;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; a = buf[<span class="Constant">0</span>];<br/></li>
<li>&nbsp; &nbsp; <a href="bigarray.c.html#L951" title="ocaml/runtime/bigarray.c:951">b</a> = buf[<span class="Constant">1</span>];<br/></li>
<li>&nbsp; &nbsp; c = buf[<span class="Constant">2</span>];<br/></li>
<li>&nbsp; &nbsp; d = buf[<span class="Constant">3</span>];<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="#L236" title="ocaml/runtime/md5.c:236">MD5STEP</a>(<a href="#L230" title="ocaml/runtime/md5.c:230">F1</a>, a, <a href="bigarray.c.html#L951" title="ocaml/runtime/bigarray.c:951">b</a>, c, d, in[<span class="Constant">0</span>] + <span class="Constant">0xd76aa478</span>, <span class="Constant">7</span>);<br/></li>
<li>&nbsp; &nbsp; <a href="#L236" title="ocaml/runtime/md5.c:236">MD5STEP</a>(<a href="#L230" title="ocaml/runtime/md5.c:230">F1</a>, d, a, <a href="bigarray.c.html#L951" title="ocaml/runtime/bigarray.c:951">b</a>, c, in[<span class="Constant">1</span>] + <span class="Constant">0xe8c7b756</span>, <span class="Constant">12</span>);<br/></li>
<li>&nbsp; &nbsp; <a href="#L236" title="ocaml/runtime/md5.c:236">MD5STEP</a>(<a href="#L230" title="ocaml/runtime/md5.c:230">F1</a>, c, d, a, <a href="bigarray.c.html#L951" title="ocaml/runtime/bigarray.c:951">b</a>, in[<span class="Constant">2</span>] + <span class="Constant">0x242070db</span>, <span class="Constant">17</span>);<br/></li>
<li>&nbsp; &nbsp; <a href="#L236" title="ocaml/runtime/md5.c:236">MD5STEP</a>(<a href="#L230" title="ocaml/runtime/md5.c:230">F1</a>, <a href="bigarray.c.html#L951" title="ocaml/runtime/bigarray.c:951">b</a>, c, d, a, in[<span class="Constant">3</span>] + <span class="Constant">0xc1bdceee</span>, <span class="Constant">22</span>);<br/></li>
<li>&nbsp; &nbsp; <a href="#L236" title="ocaml/runtime/md5.c:236">MD5STEP</a>(<a href="#L230" title="ocaml/runtime/md5.c:230">F1</a>, a, <a href="bigarray.c.html#L951" title="ocaml/runtime/bigarray.c:951">b</a>, c, d, in[<span class="Constant">4</span>] + <span class="Constant">0xf57c0faf</span>, <span class="Constant">7</span>);<br/></li>
<li>&nbsp; &nbsp; <a href="#L236" title="ocaml/runtime/md5.c:236">MD5STEP</a>(<a href="#L230" title="ocaml/runtime/md5.c:230">F1</a>, d, a, <a href="bigarray.c.html#L951" title="ocaml/runtime/bigarray.c:951">b</a>, c, in[<span class="Constant">5</span>] + <span class="Constant">0x4787c62a</span>, <span class="Constant">12</span>);<br/></li>
<li>&nbsp; &nbsp; <a href="#L236" title="ocaml/runtime/md5.c:236">MD5STEP</a>(<a href="#L230" title="ocaml/runtime/md5.c:230">F1</a>, c, d, a, <a href="bigarray.c.html#L951" title="ocaml/runtime/bigarray.c:951">b</a>, in[<span class="Constant">6</span>] + <span class="Constant">0xa8304613</span>, <span class="Constant">17</span>);<br/></li>
<li>&nbsp; &nbsp; <a href="#L236" title="ocaml/runtime/md5.c:236">MD5STEP</a>(<a href="#L230" title="ocaml/runtime/md5.c:230">F1</a>, <a href="bigarray.c.html#L951" title="ocaml/runtime/bigarray.c:951">b</a>, c, d, a, in[<span class="Constant">7</span>] + <span class="Constant">0xfd469501</span>, <span class="Constant">22</span>);<br/></li>
<li>&nbsp; &nbsp; <a href="#L236" title="ocaml/runtime/md5.c:236">MD5STEP</a>(<a href="#L230" title="ocaml/runtime/md5.c:230">F1</a>, a, <a href="bigarray.c.html#L951" title="ocaml/runtime/bigarray.c:951">b</a>, c, d, in[<span class="Constant">8</span>] + <span class="Constant">0x698098d8</span>, <span class="Constant">7</span>);<br/></li>
<li>&nbsp; &nbsp; <a href="#L236" title="ocaml/runtime/md5.c:236">MD5STEP</a>(<a href="#L230" title="ocaml/runtime/md5.c:230">F1</a>, d, a, <a href="bigarray.c.html#L951" title="ocaml/runtime/bigarray.c:951">b</a>, c, in[<span class="Constant">9</span>] + <span class="Constant">0x8b44f7af</span>, <span class="Constant">12</span>);<br/></li>
<li>&nbsp; &nbsp; <a href="#L236" title="ocaml/runtime/md5.c:236">MD5STEP</a>(<a href="#L230" title="ocaml/runtime/md5.c:230">F1</a>, c, d, a, <a href="bigarray.c.html#L951" title="ocaml/runtime/bigarray.c:951">b</a>, in[<span class="Constant">10</span>] + <span class="Constant">0xffff5bb1</span>, <span class="Constant">17</span>);<br/></li>
<li>&nbsp; &nbsp; <a href="#L236" title="ocaml/runtime/md5.c:236">MD5STEP</a>(<a href="#L230" title="ocaml/runtime/md5.c:230">F1</a>, <a href="bigarray.c.html#L951" title="ocaml/runtime/bigarray.c:951">b</a>, c, d, a, in[<span class="Constant">11</span>] + <span class="Constant">0x895cd7be</span>, <span class="Constant">22</span>);<br/></li>
<li>&nbsp; &nbsp; <a href="#L236" title="ocaml/runtime/md5.c:236">MD5STEP</a>(<a href="#L230" title="ocaml/runtime/md5.c:230">F1</a>, a, <a href="bigarray.c.html#L951" title="ocaml/runtime/bigarray.c:951">b</a>, c, d, in[<span class="Constant">12</span>] + <span class="Constant">0x6b901122</span>, <span class="Constant">7</span>);<br/></li>
<li>&nbsp; &nbsp; <a href="#L236" title="ocaml/runtime/md5.c:236">MD5STEP</a>(<a href="#L230" title="ocaml/runtime/md5.c:230">F1</a>, d, a, <a href="bigarray.c.html#L951" title="ocaml/runtime/bigarray.c:951">b</a>, c, in[<span class="Constant">13</span>] + <span class="Constant">0xfd987193</span>, <span class="Constant">12</span>);<br/></li>
<li>&nbsp; &nbsp; <a href="#L236" title="ocaml/runtime/md5.c:236">MD5STEP</a>(<a href="#L230" title="ocaml/runtime/md5.c:230">F1</a>, c, d, a, <a href="bigarray.c.html#L951" title="ocaml/runtime/bigarray.c:951">b</a>, in[<span class="Constant">14</span>] + <span class="Constant">0xa679438e</span>, <span class="Constant">17</span>);<br/></li>
<li>&nbsp; &nbsp; <a href="#L236" title="ocaml/runtime/md5.c:236">MD5STEP</a>(<a href="#L230" title="ocaml/runtime/md5.c:230">F1</a>, <a href="bigarray.c.html#L951" title="ocaml/runtime/bigarray.c:951">b</a>, c, d, a, in[<span class="Constant">15</span>] + <span class="Constant">0x49b40821</span>, <span class="Constant">22</span>);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="#L236" title="ocaml/runtime/md5.c:236">MD5STEP</a>(<a href="#L231" title="ocaml/runtime/md5.c:231">F2</a>, a, <a href="bigarray.c.html#L951" title="ocaml/runtime/bigarray.c:951">b</a>, c, d, in[<span class="Constant">1</span>] + <span class="Constant">0xf61e2562</span>, <span class="Constant">5</span>);<br/></li>
<li>&nbsp; &nbsp; <a href="#L236" title="ocaml/runtime/md5.c:236">MD5STEP</a>(<a href="#L231" title="ocaml/runtime/md5.c:231">F2</a>, d, a, <a href="bigarray.c.html#L951" title="ocaml/runtime/bigarray.c:951">b</a>, c, in[<span class="Constant">6</span>] + <span class="Constant">0xc040b340</span>, <span class="Constant">9</span>);<br/></li>
<li>&nbsp; &nbsp; <a href="#L236" title="ocaml/runtime/md5.c:236">MD5STEP</a>(<a href="#L231" title="ocaml/runtime/md5.c:231">F2</a>, c, d, a, <a href="bigarray.c.html#L951" title="ocaml/runtime/bigarray.c:951">b</a>, in[<span class="Constant">11</span>] + <span class="Constant">0x265e5a51</span>, <span class="Constant">14</span>);<br/></li>
<li>&nbsp; &nbsp; <a href="#L236" title="ocaml/runtime/md5.c:236">MD5STEP</a>(<a href="#L231" title="ocaml/runtime/md5.c:231">F2</a>, <a href="bigarray.c.html#L951" title="ocaml/runtime/bigarray.c:951">b</a>, c, d, a, in[<span class="Constant">0</span>] + <span class="Constant">0xe9b6c7aa</span>, <span class="Constant">20</span>);<br/></li>
<li>&nbsp; &nbsp; <a href="#L236" title="ocaml/runtime/md5.c:236">MD5STEP</a>(<a href="#L231" title="ocaml/runtime/md5.c:231">F2</a>, a, <a href="bigarray.c.html#L951" title="ocaml/runtime/bigarray.c:951">b</a>, c, d, in[<span class="Constant">5</span>] + <span class="Constant">0xd62f105d</span>, <span class="Constant">5</span>);<br/></li>
<li>&nbsp; &nbsp; <a href="#L236" title="ocaml/runtime/md5.c:236">MD5STEP</a>(<a href="#L231" title="ocaml/runtime/md5.c:231">F2</a>, d, a, <a href="bigarray.c.html#L951" title="ocaml/runtime/bigarray.c:951">b</a>, c, in[<span class="Constant">10</span>] + <span class="Constant">0x02441453</span>, <span class="Constant">9</span>);<br/></li>
<li>&nbsp; &nbsp; <a href="#L236" title="ocaml/runtime/md5.c:236">MD5STEP</a>(<a href="#L231" title="ocaml/runtime/md5.c:231">F2</a>, c, d, a, <a href="bigarray.c.html#L951" title="ocaml/runtime/bigarray.c:951">b</a>, in[<span class="Constant">15</span>] + <span class="Constant">0xd8a1e681</span>, <span class="Constant">14</span>);<br/></li>
<li>&nbsp; &nbsp; <a href="#L236" title="ocaml/runtime/md5.c:236">MD5STEP</a>(<a href="#L231" title="ocaml/runtime/md5.c:231">F2</a>, <a href="bigarray.c.html#L951" title="ocaml/runtime/bigarray.c:951">b</a>, c, d, a, in[<span class="Constant">4</span>] + <span class="Constant">0xe7d3fbc8</span>, <span class="Constant">20</span>);<br/></li>
<li>&nbsp; &nbsp; <a href="#L236" title="ocaml/runtime/md5.c:236">MD5STEP</a>(<a href="#L231" title="ocaml/runtime/md5.c:231">F2</a>, a, <a href="bigarray.c.html#L951" title="ocaml/runtime/bigarray.c:951">b</a>, c, d, in[<span class="Constant">9</span>] + <span class="Constant">0x21e1cde6</span>, <span class="Constant">5</span>);<br/></li>
<li>&nbsp; &nbsp; <a href="#L236" title="ocaml/runtime/md5.c:236">MD5STEP</a>(<a href="#L231" title="ocaml/runtime/md5.c:231">F2</a>, d, a, <a href="bigarray.c.html#L951" title="ocaml/runtime/bigarray.c:951">b</a>, c, in[<span class="Constant">14</span>] + <span class="Constant">0xc33707d6</span>, <span class="Constant">9</span>);<br/></li>
<li>&nbsp; &nbsp; <a href="#L236" title="ocaml/runtime/md5.c:236">MD5STEP</a>(<a href="#L231" title="ocaml/runtime/md5.c:231">F2</a>, c, d, a, <a href="bigarray.c.html#L951" title="ocaml/runtime/bigarray.c:951">b</a>, in[<span class="Constant">3</span>] + <span class="Constant">0xf4d50d87</span>, <span class="Constant">14</span>);<br/></li>
<li>&nbsp; &nbsp; <a href="#L236" title="ocaml/runtime/md5.c:236">MD5STEP</a>(<a href="#L231" title="ocaml/runtime/md5.c:231">F2</a>, <a href="bigarray.c.html#L951" title="ocaml/runtime/bigarray.c:951">b</a>, c, d, a, in[<span class="Constant">8</span>] + <span class="Constant">0x455a14ed</span>, <span class="Constant">20</span>);<br/></li>
<li>&nbsp; &nbsp; <a href="#L236" title="ocaml/runtime/md5.c:236">MD5STEP</a>(<a href="#L231" title="ocaml/runtime/md5.c:231">F2</a>, a, <a href="bigarray.c.html#L951" title="ocaml/runtime/bigarray.c:951">b</a>, c, d, in[<span class="Constant">13</span>] + <span class="Constant">0xa9e3e905</span>, <span class="Constant">5</span>);<br/></li>
<li>&nbsp; &nbsp; <a href="#L236" title="ocaml/runtime/md5.c:236">MD5STEP</a>(<a href="#L231" title="ocaml/runtime/md5.c:231">F2</a>, d, a, <a href="bigarray.c.html#L951" title="ocaml/runtime/bigarray.c:951">b</a>, c, in[<span class="Constant">2</span>] + <span class="Constant">0xfcefa3f8</span>, <span class="Constant">9</span>);<br/></li>
<li>&nbsp; &nbsp; <a href="#L236" title="ocaml/runtime/md5.c:236">MD5STEP</a>(<a href="#L231" title="ocaml/runtime/md5.c:231">F2</a>, c, d, a, <a href="bigarray.c.html#L951" title="ocaml/runtime/bigarray.c:951">b</a>, in[<span class="Constant">7</span>] + <span class="Constant">0x676f02d9</span>, <span class="Constant">14</span>);<br/></li>
<li>&nbsp; &nbsp; <a href="#L236" title="ocaml/runtime/md5.c:236">MD5STEP</a>(<a href="#L231" title="ocaml/runtime/md5.c:231">F2</a>, <a href="bigarray.c.html#L951" title="ocaml/runtime/bigarray.c:951">b</a>, c, d, a, in[<span class="Constant">12</span>] + <span class="Constant">0x8d2a4c8a</span>, <span class="Constant">20</span>);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="#L236" title="ocaml/runtime/md5.c:236">MD5STEP</a>(<a href="#L232" title="ocaml/runtime/md5.c:232">F3</a>, a, <a href="bigarray.c.html#L951" title="ocaml/runtime/bigarray.c:951">b</a>, c, d, in[<span class="Constant">5</span>] + <span class="Constant">0xfffa3942</span>, <span class="Constant">4</span>);<br/></li>
<li>&nbsp; &nbsp; <a href="#L236" title="ocaml/runtime/md5.c:236">MD5STEP</a>(<a href="#L232" title="ocaml/runtime/md5.c:232">F3</a>, d, a, <a href="bigarray.c.html#L951" title="ocaml/runtime/bigarray.c:951">b</a>, c, in[<span class="Constant">8</span>] + <span class="Constant">0x8771f681</span>, <span class="Constant">11</span>);<br/></li>
<li>&nbsp; &nbsp; <a href="#L236" title="ocaml/runtime/md5.c:236">MD5STEP</a>(<a href="#L232" title="ocaml/runtime/md5.c:232">F3</a>, c, d, a, <a href="bigarray.c.html#L951" title="ocaml/runtime/bigarray.c:951">b</a>, in[<span class="Constant">11</span>] + <span class="Constant">0x6d9d6122</span>, <span class="Constant">16</span>);<br/></li>
<li>&nbsp; &nbsp; <a href="#L236" title="ocaml/runtime/md5.c:236">MD5STEP</a>(<a href="#L232" title="ocaml/runtime/md5.c:232">F3</a>, <a href="bigarray.c.html#L951" title="ocaml/runtime/bigarray.c:951">b</a>, c, d, a, in[<span class="Constant">14</span>] + <span class="Constant">0xfde5380c</span>, <span class="Constant">23</span>);<br/></li>
<li>&nbsp; &nbsp; <a href="#L236" title="ocaml/runtime/md5.c:236">MD5STEP</a>(<a href="#L232" title="ocaml/runtime/md5.c:232">F3</a>, a, <a href="bigarray.c.html#L951" title="ocaml/runtime/bigarray.c:951">b</a>, c, d, in[<span class="Constant">1</span>] + <span class="Constant">0xa4beea44</span>, <span class="Constant">4</span>);<br/></li>
<li>&nbsp; &nbsp; <a href="#L236" title="ocaml/runtime/md5.c:236">MD5STEP</a>(<a href="#L232" title="ocaml/runtime/md5.c:232">F3</a>, d, a, <a href="bigarray.c.html#L951" title="ocaml/runtime/bigarray.c:951">b</a>, c, in[<span class="Constant">4</span>] + <span class="Constant">0x4bdecfa9</span>, <span class="Constant">11</span>);<br/></li>
<li>&nbsp; &nbsp; <a href="#L236" title="ocaml/runtime/md5.c:236">MD5STEP</a>(<a href="#L232" title="ocaml/runtime/md5.c:232">F3</a>, c, d, a, <a href="bigarray.c.html#L951" title="ocaml/runtime/bigarray.c:951">b</a>, in[<span class="Constant">7</span>] + <span class="Constant">0xf6bb4b60</span>, <span class="Constant">16</span>);<br/></li>
<li>&nbsp; &nbsp; <a href="#L236" title="ocaml/runtime/md5.c:236">MD5STEP</a>(<a href="#L232" title="ocaml/runtime/md5.c:232">F3</a>, <a href="bigarray.c.html#L951" title="ocaml/runtime/bigarray.c:951">b</a>, c, d, a, in[<span class="Constant">10</span>] + <span class="Constant">0xbebfbc70</span>, <span class="Constant">23</span>);<br/></li>
<li>&nbsp; &nbsp; <a href="#L236" title="ocaml/runtime/md5.c:236">MD5STEP</a>(<a href="#L232" title="ocaml/runtime/md5.c:232">F3</a>, a, <a href="bigarray.c.html#L951" title="ocaml/runtime/bigarray.c:951">b</a>, c, d, in[<span class="Constant">13</span>] + <span class="Constant">0x289b7ec6</span>, <span class="Constant">4</span>);<br/></li>
<li>&nbsp; &nbsp; <a href="#L236" title="ocaml/runtime/md5.c:236">MD5STEP</a>(<a href="#L232" title="ocaml/runtime/md5.c:232">F3</a>, d, a, <a href="bigarray.c.html#L951" title="ocaml/runtime/bigarray.c:951">b</a>, c, in[<span class="Constant">0</span>] + <span class="Constant">0xeaa127fa</span>, <span class="Constant">11</span>);<br/></li>
<li>&nbsp; &nbsp; <a href="#L236" title="ocaml/runtime/md5.c:236">MD5STEP</a>(<a href="#L232" title="ocaml/runtime/md5.c:232">F3</a>, c, d, a, <a href="bigarray.c.html#L951" title="ocaml/runtime/bigarray.c:951">b</a>, in[<span class="Constant">3</span>] + <span class="Constant">0xd4ef3085</span>, <span class="Constant">16</span>);<br/></li>
<li>&nbsp; &nbsp; <a href="#L236" title="ocaml/runtime/md5.c:236">MD5STEP</a>(<a href="#L232" title="ocaml/runtime/md5.c:232">F3</a>, <a href="bigarray.c.html#L951" title="ocaml/runtime/bigarray.c:951">b</a>, c, d, a, in[<span class="Constant">6</span>] + <span class="Constant">0x04881d05</span>, <span class="Constant">23</span>);<br/></li>
<li>&nbsp; &nbsp; <a href="#L236" title="ocaml/runtime/md5.c:236">MD5STEP</a>(<a href="#L232" title="ocaml/runtime/md5.c:232">F3</a>, a, <a href="bigarray.c.html#L951" title="ocaml/runtime/bigarray.c:951">b</a>, c, d, in[<span class="Constant">9</span>] + <span class="Constant">0xd9d4d039</span>, <span class="Constant">4</span>);<br/></li>
<li>&nbsp; &nbsp; <a href="#L236" title="ocaml/runtime/md5.c:236">MD5STEP</a>(<a href="#L232" title="ocaml/runtime/md5.c:232">F3</a>, d, a, <a href="bigarray.c.html#L951" title="ocaml/runtime/bigarray.c:951">b</a>, c, in[<span class="Constant">12</span>] + <span class="Constant">0xe6db99e5</span>, <span class="Constant">11</span>);<br/></li>
<li>&nbsp; &nbsp; <a href="#L236" title="ocaml/runtime/md5.c:236">MD5STEP</a>(<a href="#L232" title="ocaml/runtime/md5.c:232">F3</a>, c, d, a, <a href="bigarray.c.html#L951" title="ocaml/runtime/bigarray.c:951">b</a>, in[<span class="Constant">15</span>] + <span class="Constant">0x1fa27cf8</span>, <span class="Constant">16</span>);<br/></li>
<li>&nbsp; &nbsp; <a href="#L236" title="ocaml/runtime/md5.c:236">MD5STEP</a>(<a href="#L232" title="ocaml/runtime/md5.c:232">F3</a>, <a href="bigarray.c.html#L951" title="ocaml/runtime/bigarray.c:951">b</a>, c, d, a, in[<span class="Constant">2</span>] + <span class="Constant">0xc4ac5665</span>, <span class="Constant">23</span>);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="#L236" title="ocaml/runtime/md5.c:236">MD5STEP</a>(<a href="#L233" title="ocaml/runtime/md5.c:233">F4</a>, a, <a href="bigarray.c.html#L951" title="ocaml/runtime/bigarray.c:951">b</a>, c, d, in[<span class="Constant">0</span>] + <span class="Constant">0xf4292244</span>, <span class="Constant">6</span>);<br/></li>
<li>&nbsp; &nbsp; <a href="#L236" title="ocaml/runtime/md5.c:236">MD5STEP</a>(<a href="#L233" title="ocaml/runtime/md5.c:233">F4</a>, d, a, <a href="bigarray.c.html#L951" title="ocaml/runtime/bigarray.c:951">b</a>, c, in[<span class="Constant">7</span>] + <span class="Constant">0x432aff97</span>, <span class="Constant">10</span>);<br/></li>
<li>&nbsp; &nbsp; <a href="#L236" title="ocaml/runtime/md5.c:236">MD5STEP</a>(<a href="#L233" title="ocaml/runtime/md5.c:233">F4</a>, c, d, a, <a href="bigarray.c.html#L951" title="ocaml/runtime/bigarray.c:951">b</a>, in[<span class="Constant">14</span>] + <span class="Constant">0xab9423a7</span>, <span class="Constant">15</span>);<br/></li>
<li>&nbsp; &nbsp; <a href="#L236" title="ocaml/runtime/md5.c:236">MD5STEP</a>(<a href="#L233" title="ocaml/runtime/md5.c:233">F4</a>, <a href="bigarray.c.html#L951" title="ocaml/runtime/bigarray.c:951">b</a>, c, d, a, in[<span class="Constant">5</span>] + <span class="Constant">0xfc93a039</span>, <span class="Constant">21</span>);<br/></li>
<li>&nbsp; &nbsp; <a href="#L236" title="ocaml/runtime/md5.c:236">MD5STEP</a>(<a href="#L233" title="ocaml/runtime/md5.c:233">F4</a>, a, <a href="bigarray.c.html#L951" title="ocaml/runtime/bigarray.c:951">b</a>, c, d, in[<span class="Constant">12</span>] + <span class="Constant">0x655b59c3</span>, <span class="Constant">6</span>);<br/></li>
<li>&nbsp; &nbsp; <a href="#L236" title="ocaml/runtime/md5.c:236">MD5STEP</a>(<a href="#L233" title="ocaml/runtime/md5.c:233">F4</a>, d, a, <a href="bigarray.c.html#L951" title="ocaml/runtime/bigarray.c:951">b</a>, c, in[<span class="Constant">3</span>] + <span class="Constant">0x8f0ccc92</span>, <span class="Constant">10</span>);<br/></li>
<li>&nbsp; &nbsp; <a href="#L236" title="ocaml/runtime/md5.c:236">MD5STEP</a>(<a href="#L233" title="ocaml/runtime/md5.c:233">F4</a>, c, d, a, <a href="bigarray.c.html#L951" title="ocaml/runtime/bigarray.c:951">b</a>, in[<span class="Constant">10</span>] + <span class="Constant">0xffeff47d</span>, <span class="Constant">15</span>);<br/></li>
<li>&nbsp; &nbsp; <a href="#L236" title="ocaml/runtime/md5.c:236">MD5STEP</a>(<a href="#L233" title="ocaml/runtime/md5.c:233">F4</a>, <a href="bigarray.c.html#L951" title="ocaml/runtime/bigarray.c:951">b</a>, c, d, a, in[<span class="Constant">1</span>] + <span class="Constant">0x85845dd1</span>, <span class="Constant">21</span>);<br/></li>
<li>&nbsp; &nbsp; <a href="#L236" title="ocaml/runtime/md5.c:236">MD5STEP</a>(<a href="#L233" title="ocaml/runtime/md5.c:233">F4</a>, a, <a href="bigarray.c.html#L951" title="ocaml/runtime/bigarray.c:951">b</a>, c, d, in[<span class="Constant">8</span>] + <span class="Constant">0x6fa87e4f</span>, <span class="Constant">6</span>);<br/></li>
<li>&nbsp; &nbsp; <a href="#L236" title="ocaml/runtime/md5.c:236">MD5STEP</a>(<a href="#L233" title="ocaml/runtime/md5.c:233">F4</a>, d, a, <a href="bigarray.c.html#L951" title="ocaml/runtime/bigarray.c:951">b</a>, c, in[<span class="Constant">15</span>] + <span class="Constant">0xfe2ce6e0</span>, <span class="Constant">10</span>);<br/></li>
<li>&nbsp; &nbsp; <a href="#L236" title="ocaml/runtime/md5.c:236">MD5STEP</a>(<a href="#L233" title="ocaml/runtime/md5.c:233">F4</a>, c, d, a, <a href="bigarray.c.html#L951" title="ocaml/runtime/bigarray.c:951">b</a>, in[<span class="Constant">6</span>] + <span class="Constant">0xa3014314</span>, <span class="Constant">15</span>);<br/></li>
<li>&nbsp; &nbsp; <a href="#L236" title="ocaml/runtime/md5.c:236">MD5STEP</a>(<a href="#L233" title="ocaml/runtime/md5.c:233">F4</a>, <a href="bigarray.c.html#L951" title="ocaml/runtime/bigarray.c:951">b</a>, c, d, a, in[<span class="Constant">13</span>] + <span class="Constant">0x4e0811a1</span>, <span class="Constant">21</span>);<br/></li>
<li>&nbsp; &nbsp; <a href="#L236" title="ocaml/runtime/md5.c:236">MD5STEP</a>(<a href="#L233" title="ocaml/runtime/md5.c:233">F4</a>, a, <a href="bigarray.c.html#L951" title="ocaml/runtime/bigarray.c:951">b</a>, c, d, in[<span class="Constant">4</span>] + <span class="Constant">0xf7537e82</span>, <span class="Constant">6</span>);<br/></li>
<li>&nbsp; &nbsp; <a href="#L236" title="ocaml/runtime/md5.c:236">MD5STEP</a>(<a href="#L233" title="ocaml/runtime/md5.c:233">F4</a>, d, a, <a href="bigarray.c.html#L951" title="ocaml/runtime/bigarray.c:951">b</a>, c, in[<span class="Constant">11</span>] + <span class="Constant">0xbd3af235</span>, <span class="Constant">10</span>);<br/></li>
<li>&nbsp; &nbsp; <a href="#L236" title="ocaml/runtime/md5.c:236">MD5STEP</a>(<a href="#L233" title="ocaml/runtime/md5.c:233">F4</a>, c, d, a, <a href="bigarray.c.html#L951" title="ocaml/runtime/bigarray.c:951">b</a>, in[<span class="Constant">2</span>] + <span class="Constant">0x2ad7d2bb</span>, <span class="Constant">15</span>);<br/></li>
<li>&nbsp; &nbsp; <a href="#L236" title="ocaml/runtime/md5.c:236">MD5STEP</a>(<a href="#L233" title="ocaml/runtime/md5.c:233">F4</a>, <a href="bigarray.c.html#L951" title="ocaml/runtime/bigarray.c:951">b</a>, c, d, a, in[<span class="Constant">9</span>] + <span class="Constant">0xeb86d391</span>, <span class="Constant">21</span>);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; buf[<span class="Constant">0</span>] += a;<br/></li>
<li>&nbsp; &nbsp; buf[<span class="Constant">1</span>] += <a href="bigarray.c.html#L951" title="ocaml/runtime/bigarray.c:951">b</a>;<br/></li>
<li>&nbsp; &nbsp; buf[<span class="Constant">2</span>] += c;<br/></li>
<li>&nbsp; &nbsp; buf[<span class="Constant">3</span>] += d;<br/></li>
<li>}<br/></li>
</ol></code>
 <p class="nav-bar">
  <span class="nav-link"><a href="./index.html">One Level Up</a></span>
  <span class="nav-link"><a href="index.html">Top Level</a></span>
 </p>

 </body>
</html>
