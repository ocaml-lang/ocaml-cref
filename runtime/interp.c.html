<!-- generated by the vscode.pl tool from vscoded.-->

<html>
 <head>
  <title>ocaml/runtime/interp.c - ocaml</title>
  <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
  <style>
body {
    text-align: left;
    text-align-last: left;
}

.nav-bar {
    font-size: 120%;
    margin-top: 5px;
    margin-bottom: 5px;
}

.nav-link {
    padding-left: 5em;
    padding-right: 5em;
}

ul.toc {
    line-height: 200%;
    font-size: 150%;
}

code {
    font-family: consolas, monospace;
    line-height: 130%;
}

span.Constant {
    color: DarkGreen;
}

span.Special {
    color: #c06000;
}

span.Comment {
    color: DarkRed;
    font-style: italic;
}

span.Identifier {
    color: DarkCyan;
}

span.PreProc {
    color: DarkMagenta;
}

span.Statement, span.Type, span.Keyword, span.Repeat, span.Conditional,
    span.Operator, span.Exception
{
    color: DarkBlue;
}

span.Todo {
    color: DarkRed;
    background-color: Gold;
    font-style: italic;
}

span.Underlined {
    text-decoration: underline;
}

span.linkable {
    font-weight: bold;
}

code ol {
    counter-reset: item;
    list-style-type: none;
    margin-left: 0;
    padding-left: 0;
    list-style-position: inside;
}

code li {
    display: block;
}

code li:before {
    content: counter(item) "  ";
    counter-increment: item;
    color: #999;
    padding-right: 0.5em;
    padding-left: 0.4em;
    list-style-position: inside;
    text-align: right
}

  </style>
 </head>
 <body>
 <p class="nav-bar">
  <span class="nav-link"><a href="./index.html">One Level Up</a></span>
  <span class="nav-link"><a href="index.html">Top Level</a></span>
 </p>

  <h1>ocaml/runtime/interp.c - ocaml</h1>
 <h2>Global variables defined</h2>
 <ul class="toc">
<li><a href="#L240">caml_bcodcount</a></li>
<li><a href="#L243">raise_unhandled_effect</a></li>
</ul>
 <h2>Functions defined</h2>
 <ul class="toc">
<li><a href="#L247">caml_interprete</a></li>
<li><a href="#L144">check_trap_barrier_for_effect</a></li>
<li><a href="#L136">check_trap_barrier_for_exception</a></li>
</ul>
 <h2>Macros defined</h2>
 <ul class="toc">
<li><a href="#L174">ACCU_REG</a></li>
<li><a href="#L179">ACCU_REG</a></li>
<li><a href="#L185">ACCU_REG</a></li>
<li><a href="#L190">ACCU_REG</a></li>
<li><a href="#L197">ACCU_REG</a></li>
<li><a href="#L202">ACCU_REG</a></li>
<li><a href="#L207">ACCU_REG</a></li>
<li><a href="#L212">ACCU_REG</a></li>
<li><a href="#L218">ACCU_REG</a></li>
<li><a href="#L223">ACCU_REG</a></li>
<li><a href="#L229">ACCU_REG</a></li>
<li><a href="#L234">ACCU_REG</a></li>
<li><a href="#L16">CAML_INTERNALS</a></li>
<li><a href="#L1196">CAML_METHOD_CACHE</a></li>
<li><a href="#L80">Enter_gc</a></li>
<li><a href="#L55">Instruct</a></li>
<li><a href="#L68">Instruct</a></li>
<li><a href="#L1158">Integer_branch_comparison</a></li>
<li><a href="#L1145">Integer_comparison</a></li>
<li><a href="#L186">JUMPTBL_BASE_REG</a></li>
<li><a href="#L191">JUMPTBL_BASE_REG</a></li>
<li><a href="#L224">JUMPTBL_BASE_REG</a></li>
<li><a href="#L235">JUMPTBL_BASE_REG</a></li>
<li><a href="#L57">Jumptbl_base</a></li>
<li><a href="#L59">Jumptbl_base</a></li>
<li><a href="#L1190">Lookup</a></li>
<li><a href="#L63">Next</a></li>
<li><a href="#L65">Next</a></li>
<li><a href="#L69">Next</a></li>
<li><a href="#L172">PC_REG</a></li>
<li><a href="#L177">PC_REG</a></li>
<li><a href="#L183">PC_REG</a></li>
<li><a href="#L188">PC_REG</a></li>
<li><a href="#L195">PC_REG</a></li>
<li><a href="#L200">PC_REG</a></li>
<li><a href="#L205">PC_REG</a></li>
<li><a href="#L210">PC_REG</a></li>
<li><a href="#L216">PC_REG</a></li>
<li><a href="#L221">PC_REG</a></li>
<li><a href="#L227">PC_REG</a></li>
<li><a href="#L232">PC_REG</a></li>
<li><a href="#L128">Restart_curr_instr</a></li>
<li><a href="#L131">Restart_curr_instr</a></li>
<li><a href="#L93">Restore_after_c_call</a></li>
<li><a href="#L121">Restore_after_debugger</a></li>
<li><a href="#L109">Restore_after_event</a></li>
<li><a href="#L77">Restore_after_gc</a></li>
<li><a href="#L173">SP_REG</a></li>
<li><a href="#L178">SP_REG</a></li>
<li><a href="#L184">SP_REG</a></li>
<li><a href="#L189">SP_REG</a></li>
<li><a href="#L196">SP_REG</a></li>
<li><a href="#L201">SP_REG</a></li>
<li><a href="#L206">SP_REG</a></li>
<li><a href="#L211">SP_REG</a></li>
<li><a href="#L217">SP_REG</a></li>
<li><a href="#L222">SP_REG</a></li>
<li><a href="#L228">SP_REG</a></li>
<li><a href="#L233">SP_REG</a></li>
<li><a href="#L90">Setup_for_c_call</a></li>
<li><a href="#L116">Setup_for_debugger</a></li>
<li><a href="#L100">Setup_for_event</a></li>
<li><a href="#L74">Setup_for_gc</a></li>
<li><a href="#L60">jumptbl_base</a></li>
</ul>
 <h2>Source code</h2>

  <code><ol><li><span class="Comment">/**************************************************************************/<br/></li>
<li></span><span class="Comment">/*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */<br/></li>
<li></span><span class="Comment">/*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; OCaml&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */<br/></li>
<li></span><span class="Comment">/*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */<br/></li>
<li></span><span class="Comment">/*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; Xavier Leroy, projet Cristal, INRIA Rocquencourt&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; */<br/></li>
<li></span><span class="Comment">/*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */<br/></li>
<li></span><span class="Comment">/*&nbsp;&nbsp; Copyright 1996 Institut National de Recherche en Informatique et&nbsp; &nbsp;&nbsp; */<br/></li>
<li></span><span class="Comment">/*&nbsp; &nbsp;&nbsp; en Automatique.&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */<br/></li>
<li></span><span class="Comment">/*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */<br/></li>
<li></span><span class="Comment">/*&nbsp;&nbsp; All rights reserved.&nbsp; This file is distributed under the terms of&nbsp; &nbsp; */<br/></li>
<li></span><span class="Comment">/*&nbsp;&nbsp; the GNU Lesser General Public License version 2.1, with the&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */<br/></li>
<li></span><span class="Comment">/*&nbsp;&nbsp; special exception on linking described in the file LICENSE.&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */<br/></li>
<li></span><span class="Comment">/*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; */<br/></li>
<li></span><span class="Comment">/**************************************************************************/<br/></li>
<li></span><br/></li>
<li><a id="L16">&#x200c;</a><span class="PreProc">#define <span class="linkable">CAML_INTERNALS</span><br/></li>
<li></span><br/></li>
<li><span class="Comment">/* The <a href="meta.c.html#L53" title="ocaml/runtime/meta.c:53">bytecode</a> interpreter */<br/></li>
<li></span><span class="PreProc">#include </span><span class="Constant">&lt;stdio.h&gt;<br/></li>
<li></span><span class="PreProc">#include </span><span class="Constant">&quot;caml/alloc.h&quot;<br/></li>
<li></span><span class="PreProc">#include </span><span class="Constant">&quot;caml/backtrace.h&quot;<br/></li>
<li></span><span class="PreProc">#include </span><span class="Constant">&quot;caml/callback.h&quot;<br/></li>
<li></span><span class="PreProc">#include </span><span class="Constant">&quot;caml/codefrag.h&quot;<br/></li>
<li></span><span class="PreProc">#include </span><span class="Constant">&quot;caml/debugger.h&quot;<br/></li>
<li></span><span class="PreProc">#include </span><span class="Constant">&quot;caml/fail.h&quot;<br/></li>
<li></span><span class="PreProc">#include </span><span class="Constant">&quot;caml/fix_code.h&quot;<br/></li>
<li></span><span class="PreProc">#include </span><span class="Constant">&quot;caml/instrtrace.h&quot;<br/></li>
<li></span><span class="PreProc">#include </span><span class="Constant">&quot;caml/instruct.h&quot;<br/></li>
<li></span><span class="PreProc">#include </span><span class="Constant">&quot;caml/interp.h&quot;<br/></li>
<li></span><span class="PreProc">#include </span><span class="Constant">&quot;caml/major_gc.h&quot;<br/></li>
<li></span><span class="PreProc">#include </span><span class="Constant">&quot;caml/memory.h&quot;<br/></li>
<li></span><span class="PreProc">#include </span><span class="Constant">&quot;caml/misc.h&quot;<br/></li>
<li></span><span class="PreProc">#include </span><span class="Constant">&quot;caml/mlvalues.h&quot;<br/></li>
<li></span><span class="PreProc">#include </span><span class="Constant">&quot;caml/prims.h&quot;<br/></li>
<li></span><span class="PreProc">#include </span><span class="Constant">&quot;caml/signals.h&quot;<br/></li>
<li></span><span class="PreProc">#include </span><span class="Constant">&quot;caml/fiber.h&quot;<br/></li>
<li></span><span class="PreProc">#include </span><span class="Constant">&quot;caml/domain.h&quot;<br/></li>
<li></span><span class="PreProc">#include </span><span class="Constant">&quot;caml/globroots.h&quot;<br/></li>
<li></span><span class="PreProc">#include </span><span class="Constant">&quot;caml/startup.h&quot;<br/></li>
<li></span><span class="PreProc">#include </span><span class="Constant">&quot;caml/startup_aux.h&quot;<br/></li>
<li></span><br/></li>
<li><span class="Comment">/* Registers for the abstract machine:<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; pc&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; the code pointer<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; sp&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; the stack pointer (grows downward)<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; accu&nbsp; &nbsp; &nbsp;&nbsp; the accumulator<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; env&nbsp; &nbsp; &nbsp; &nbsp; heap-allocated environment<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; <a href="caml/domain_state.h.html#L62" title="ocaml/runtime/caml/domain_state.h:62">Caml_state</a>-&gt;trap_sp_off offset to the current trap frame<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; extra_args number of extra arguments provided by the caller<br/></li>
<li></span><br/></li>
<li><span class="Comment">sp is a local copy of the global variable <a href="caml/domain_state.h.html#L62" title="ocaml/runtime/caml/domain_state.h:62">Caml_state</a>-&gt;extern_sp. */<br/></li>
<li></span><br/></li>
<li><span class="Comment">/* Instruction decoding */<br/></li>
<li></span><br/></li>
<li><span class="PreProc">#ifdef <a href="caml/config.h.html#L182" title="ocaml/runtime/caml/config.h:182">THREADED_CODE</a><br/></li>
<li><a id="L55">&#x200c;</a></span><span class="PreProc">#&nbsp; define <span class="linkable">Instruct</span>(name) lbl_##name<br/></li>
<li></span><span class="PreProc">#&nbsp; if defined(ARCH_SIXTYFOUR) &amp;&amp; !defined(<a href="caml/config.h.html#L34" title="ocaml/runtime/caml/config.h:34">ARCH_CODE32</a>)<br/></li>
<li><a id="L57">&#x200c;</a></span><span class="PreProc">#&nbsp; &nbsp; define <span class="linkable">Jumptbl_base</span> &amp;&amp;lbl_ACC0<br/></li>
<li></span><span class="PreProc">#&nbsp; else<br/></li>
<li><a id="L59">&#x200c;</a></span><span class="PreProc">#&nbsp; &nbsp; define <span class="linkable">Jumptbl_base</span> </span><span class="Constant">0<br/></li>
<li><a id="L60">&#x200c;</a></span><span class="PreProc">#&nbsp; &nbsp; define <span class="linkable">jumptbl_base</span> ((</span><span class="Type">char</span><span class="PreProc"> *) </span><span class="Constant">0</span><span class="PreProc">)<br/></li>
<li></span><span class="PreProc">#&nbsp; endif<br/></li>
<li></span><span class="PreProc">#&nbsp; ifdef DEBUG<br/></li>
<li><a id="L63">&#x200c;</a></span><span class="PreProc">#&nbsp; &nbsp; define <span class="linkable">Next</span> </span><span class="Statement">goto</span><span class="PreProc"> next_instr<br/></li>
<li></span><span class="PreProc">#&nbsp; else<br/></li>
<li><a id="L65">&#x200c;</a></span><span class="PreProc">#&nbsp; &nbsp; define <span class="linkable">Next</span> </span><span class="Statement">goto</span><span class="PreProc"> *(</span><span class="Type">void</span><span class="PreProc"> *)(<a href="#L60" title="ocaml/runtime/interp.c:60">jumptbl_base</a> + *pc++)<br/></li>
<li></span><span class="PreProc">#&nbsp; endif<br/></li>
<li></span><span class="PreProc">#else<br/></li>
<li><a id="L68">&#x200c;</a></span><span class="PreProc">#&nbsp; define <span class="linkable">Instruct</span>(name) </span><span class="Statement">case</span><span class="PreProc"> name<br/></li>
<li><a id="L69">&#x200c;</a></span><span class="PreProc">#&nbsp; define <span class="linkable">Next</span> </span><span class="Statement">break<br/></li>
<li></span><span class="PreProc">#endif<br/></li>
<li></span><br/></li>
<li><span class="Comment">/* GC interface */<br/></li>
<li></span><br/></li>
<li><a id="L74">&#x200c;</a><span class="PreProc">#define <span class="linkable">Setup_for_gc</span> \<br/></li>
<li></span><span class="PreProc">&nbsp; { sp -= </span><span class="Constant">3</span><span class="PreProc">; sp[</span><span class="Constant">0</span><span class="PreProc">] = accu; sp[</span><span class="Constant">1</span><span class="PreProc">] = env; sp[</span><span class="Constant">2</span><span class="PreProc">] = (<a href="caml/mlvalues.h.html#L57" title="ocaml/runtime/caml/mlvalues.h:57">value</a>)pc; \<br/></li>
<li></span><span class="PreProc">&nbsp; &nbsp; domain_state-&gt;current_stack-&gt;sp = sp; }<br/></li>
<li><a id="L77">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">Restore_after_gc</span> \<br/></li>
<li></span><span class="PreProc">&nbsp; { sp = domain_state-&gt;current_stack-&gt;sp; accu = sp[</span><span class="Constant">0</span><span class="PreProc">]; env = sp[</span><span class="Constant">1</span><span class="PreProc">]; sp += </span><span class="Constant">3</span><span class="PreProc">; }<br/></li>
<li></span><span class="Comment">/* Do call asynchronous callbacks from allocation functions */<br/></li>
<li><a id="L80">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">Enter_gc</span>(dom_st, wosize) </span><span class="Statement">do</span><span class="PreProc"> {&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \<br/></li>
<li></span><span class="PreProc">&nbsp; &nbsp; <a href="#L74" title="ocaml/runtime/interp.c:74">Setup_for_gc</a>;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \<br/></li>
<li></span><span class="PreProc">&nbsp; &nbsp; <a href="caml/memory.h.html#L195" title="ocaml/runtime/caml/memory.h:195">Alloc_small_enter_GC_flags</a>(CAML_DO_TRACK | CAML_FROM_CAML,&nbsp;&nbsp; \<br/></li>
<li></span><span class="PreProc">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; dom_st, wosize);&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \<br/></li>
<li></span><span class="PreProc">&nbsp; &nbsp; <a href="#L77" title="ocaml/runtime/interp.c:77">Restore_after_gc</a>;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \<br/></li>
<li></span><span class="PreProc">&nbsp; } </span><span class="Statement">while</span><span class="PreProc"> (</span><span class="Constant">0</span><span class="PreProc">)<br/></li>
<li></span><br/></li>
<li><span class="Comment">/* We store [pc+1] in the stack so that, in case of an exception, the<br/></li>
<li></span><span class="Comment">&nbsp;&nbsp; first backtrace slot points to the event following the C call<br/></li>
<li></span><span class="Comment">&nbsp;&nbsp; instruction. */<br/></li>
<li><a id="L90">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">Setup_for_c_call</span> \<br/></li>
<li></span><span class="PreProc">&nbsp; { sp -= </span><span class="Constant">2</span><span class="PreProc">; sp[</span><span class="Constant">0</span><span class="PreProc">] = env; sp[</span><span class="Constant">1</span><span class="PreProc">] = (<a href="caml/mlvalues.h.html#L57" title="ocaml/runtime/caml/mlvalues.h:57">value</a>)(pc + </span><span class="Constant">1</span><span class="PreProc">); \<br/></li>
<li></span><span class="PreProc">&nbsp; &nbsp; domain_state-&gt;current_stack-&gt;sp = sp; }<br/></li>
<li><a id="L93">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">Restore_after_c_call</span> \<br/></li>
<li></span><span class="PreProc">&nbsp; { sp = domain_state-&gt;current_stack-&gt;sp; env = *sp; sp += </span><span class="Constant">2</span><span class="PreProc">; }<br/></li>
<li></span><br/></li>
<li><span class="Comment">/* For VM threads purposes, an event frame must look like accu + a<br/></li>
<li></span><span class="Comment">&nbsp;&nbsp; C_CALL frame + a RETURN 1 frame.<br/></li>
<li></span><span class="Comment">&nbsp;&nbsp; </span><span class="Todo">TODO</span><span class="Comment">: now that VM threads are gone, we could get rid of that. But<br/></li>
<li></span><span class="Comment">&nbsp;&nbsp; we need to make sure that this is not used elsewhere. */<br/></li>
<li><a id="L100">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">Setup_for_event</span> \<br/></li>
<li></span><span class="PreProc">&nbsp; { sp -= </span><span class="Constant">6</span><span class="PreProc">; \<br/></li>
<li></span><span class="PreProc">&nbsp; &nbsp; sp[</span><span class="Constant">0</span><span class="PreProc">] = accu; </span><span class="Comment">/* accu */</span><span class="PreProc"> \<br/></li>
<li></span><span class="PreProc">&nbsp; &nbsp; sp[</span><span class="Constant">1</span><span class="PreProc">] = <a href="caml/mlvalues.h.html#L431" title="ocaml/runtime/caml/mlvalues.h:431">Val_unit</a>; </span><span class="Comment">/* C_CALL frame: dummy environment */</span><span class="PreProc"> \<br/></li>
<li></span><span class="PreProc">&nbsp; &nbsp; sp[</span><span class="Constant">2</span><span class="PreProc">] = <a href="caml/mlvalues.h.html#L431" title="ocaml/runtime/caml/mlvalues.h:431">Val_unit</a>; </span><span class="Comment">/* RETURN frame: dummy local 0 */</span><span class="PreProc"> \<br/></li>
<li></span><span class="PreProc">&nbsp; &nbsp; sp[</span><span class="Constant">3</span><span class="PreProc">] = (<a href="caml/mlvalues.h.html#L57" title="ocaml/runtime/caml/mlvalues.h:57">value</a>) pc; </span><span class="Comment">/* RETURN frame: saved return address */</span><span class="PreProc">&nbsp; \<br/></li>
<li></span><span class="PreProc">&nbsp; &nbsp; sp[</span><span class="Constant">4</span><span class="PreProc">] = env; </span><span class="Comment">/* RETURN frame: saved environment */</span><span class="PreProc"> \<br/></li>
<li></span><span class="PreProc">&nbsp; &nbsp; sp[</span><span class="Constant">5</span><span class="PreProc">] = <a href="caml/mlvalues.h.html#L77" title="ocaml/runtime/caml/mlvalues.h:77">Val_long</a>(extra_args); </span><span class="Comment">/* RETURN frame: saved extra args */</span><span class="PreProc"> \<br/></li>
<li></span><span class="PreProc">&nbsp; &nbsp; domain_state-&gt;current_stack-&gt;sp = sp; }<br/></li>
<li><a id="L109">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">Restore_after_event</span> \<br/></li>
<li></span><span class="PreProc">&nbsp; { sp = domain_state-&gt;current_stack-&gt;sp; accu = sp[</span><span class="Constant">0</span><span class="PreProc">]; \<br/></li>
<li></span><span class="PreProc">&nbsp; &nbsp; pc = (<a href="caml/mlvalues.h.html#L67" title="ocaml/runtime/caml/mlvalues.h:67">code_t</a>) sp[</span><span class="Constant">3</span><span class="PreProc">]; env = sp[</span><span class="Constant">4</span><span class="PreProc">]; extra_args = <a href="caml/mlvalues.h.html#L78" title="ocaml/runtime/caml/mlvalues.h:78">Long_val</a>(sp[</span><span class="Constant">5</span><span class="PreProc">]); \<br/></li>
<li></span><span class="PreProc">&nbsp; &nbsp; sp += </span><span class="Constant">6</span><span class="PreProc">; }<br/></li>
<li></span><br/></li>
<li><span class="Comment">/* Debugger interface */<br/></li>
<li></span><br/></li>
<li><a id="L116">&#x200c;</a><span class="PreProc">#define <span class="linkable">Setup_for_debugger</span> \<br/></li>
<li></span><span class="PreProc">&nbsp;&nbsp; { sp -= </span><span class="Constant">4</span><span class="PreProc">; \<br/></li>
<li></span><span class="PreProc">&nbsp; &nbsp;&nbsp; sp[</span><span class="Constant">0</span><span class="PreProc">] = accu; sp[</span><span class="Constant">1</span><span class="PreProc">] = (<a href="caml/mlvalues.h.html#L57" title="ocaml/runtime/caml/mlvalues.h:57">value</a>)(pc - </span><span class="Constant">1</span><span class="PreProc">); \<br/></li>
<li></span><span class="PreProc">&nbsp; &nbsp;&nbsp; sp[</span><span class="Constant">2</span><span class="PreProc">] = env; sp[</span><span class="Constant">3</span><span class="PreProc">] = <a href="caml/mlvalues.h.html#L77" title="ocaml/runtime/caml/mlvalues.h:77">Val_long</a>(extra_args); \<br/></li>
<li></span><span class="PreProc">&nbsp; &nbsp;&nbsp; domain_state-&gt;current_stack-&gt;sp = sp; }<br/></li>
<li><a id="L121">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">Restore_after_debugger</span> \<br/></li>
<li></span><span class="PreProc">&nbsp;&nbsp; { <a href="caml/misc.h.html#L247" title="ocaml/runtime/caml/misc.h:247">CAMLassert</a>(sp == domain_state-&gt;current_stack-&gt;sp); \<br/></li>
<li></span><span class="PreProc">&nbsp; &nbsp;&nbsp; <a href="caml/misc.h.html#L247" title="ocaml/runtime/caml/misc.h:247">CAMLassert</a>(sp[</span><span class="Constant">0</span><span class="PreProc">] == accu); \<br/></li>
<li></span><span class="PreProc">&nbsp; &nbsp;&nbsp; <a href="caml/misc.h.html#L247" title="ocaml/runtime/caml/misc.h:247">CAMLassert</a>(sp[</span><span class="Constant">2</span><span class="PreProc">] == env); \<br/></li>
<li></span><span class="PreProc">&nbsp; &nbsp;&nbsp; sp += </span><span class="Constant">4</span><span class="PreProc">; }<br/></li>
<li></span><br/></li>
<li><span class="PreProc">#ifdef <a href="caml/config.h.html#L182" title="ocaml/runtime/caml/config.h:182">THREADED_CODE</a><br/></li>
<li><a id="L128">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">Restart_curr_instr</span> \<br/></li>
<li></span><span class="PreProc">&nbsp; </span><span class="Statement">goto</span><span class="PreProc"> *((</span><span class="Type">void</span><span class="PreProc">*)(<a href="#L60" title="ocaml/runtime/interp.c:60">jumptbl_base</a> + <a href="debugger.c.html#L319" title="ocaml/runtime/debugger.c:319">caml_debugger_saved_instruction</a>(pc - </span><span class="Constant">1</span><span class="PreProc">)))<br/></li>
<li></span><span class="PreProc">#else<br/></li>
<li><a id="L131">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">Restart_curr_instr</span> \<br/></li>
<li></span><span class="PreProc">&nbsp; curr_instr = <a href="debugger.c.html#L319" title="ocaml/runtime/debugger.c:319">caml_debugger_saved_instruction</a>(pc - </span><span class="Constant">1</span><span class="PreProc">); \<br/></li>
<li></span><span class="PreProc">&nbsp; </span><span class="Statement">goto</span><span class="PreProc"> dispatch_instr<br/></li>
<li></span><span class="PreProc">#endif<br/></li>
<li></span><br/></li>
<li><a id="L136">&#x200c;</a><a href="caml/config.h.html#L42" title="ocaml/runtime/caml/config.h:42">Caml_inline</a> <span class="Type">void</span> <span class="linkable">check_trap_barrier_for_exception</span><br/></li>
<li>&nbsp; (<a href="caml/domain_state.h.html#L34" title="ocaml/runtime/caml/domain_state.h:34">caml_domain_state</a>* domain_state)<br/></li>
<li>{<br/></li>
<li>&nbsp; <span class="Statement">if</span> (domain_state-&gt;current_stack-&gt;id == domain_state-&gt;trap_barrier_block<br/></li>
<li>&nbsp; &nbsp; &nbsp; &amp;&amp; domain_state-&gt;trap_sp_off &gt;= domain_state-&gt;trap_barrier_off)<br/></li>
<li>&nbsp; &nbsp; <a href="debugger.c.html#L45" title="ocaml/runtime/debugger.c:45">caml_debugger</a>(TRAP_BARRIER, <a href="caml/mlvalues.h.html#L431" title="ocaml/runtime/caml/mlvalues.h:431">Val_unit</a>);<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><a id="L144">&#x200c;</a><a href="caml/config.h.html#L42" title="ocaml/runtime/caml/config.h:42">Caml_inline</a> <span class="Type">void</span> <span class="linkable">check_trap_barrier_for_effect</span><br/></li>
<li>&nbsp; (<a href="caml/domain_state.h.html#L34" title="ocaml/runtime/caml/domain_state.h:34">caml_domain_state</a>* domain_state)<br/></li>
<li>{<br/></li>
<li>&nbsp; <span class="Statement">if</span> (domain_state-&gt;current_stack-&gt;id == domain_state-&gt;trap_barrier_block){<br/></li>
<li>&nbsp; &nbsp; <a href="debugger.c.html#L45" title="ocaml/runtime/debugger.c:45">caml_debugger</a>(TRAP_BARRIER, <a href="caml/mlvalues.h.html#L431" title="ocaml/runtime/caml/mlvalues.h:431">Val_unit</a>);<br/></li>
<li>&nbsp; }<span class="Statement">else</span>{<br/></li>
<li>&nbsp; &nbsp; <span class="Type">struct</span> <a href="caml/fiber.h.html#L43" title="ocaml/runtime/caml/fiber.h:43">stack_info</a> *parent_stack<br/></li>
<li>&nbsp; &nbsp; &nbsp; = domain_state-&gt;current_stack-&gt;handler-&gt;parent;<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (parent_stack != <span class="Constant"><a href="caml/misc.h.html#L71" title="ocaml/runtime/caml/misc.h:71">NULL</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &amp;&amp; parent_stack-&gt;id == domain_state-&gt;trap_barrier_block<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &amp;&amp; parent_stack-&gt;sp + <span class="Constant">2</span> - <a href="caml/fiber.h.html#L69" title="ocaml/runtime/caml/fiber.h:69">Stack_high</a> (parent_stack)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* Note: +2 is the same constant as in debugger.c:552 */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; == domain_state-&gt;trap_barrier_off){<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="debugger.c.html#L45" title="ocaml/runtime/debugger.c:45">caml_debugger</a>(TRAP_BARRIER, <a href="caml/mlvalues.h.html#L431" title="ocaml/runtime/caml/mlvalues.h:431">Val_unit</a>);<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>&nbsp; }<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/* Register optimization.<br/></li>
<li></span><span class="Comment">&nbsp;&nbsp; Some compilers underestimate the use of the local variables representing<br/></li>
<li></span><span class="Comment">&nbsp;&nbsp; the abstract machine registers, <a href="ints.c.html#L488" title="ocaml/runtime/ints.c:488">and</a> don't put them in hardware registers,<br/></li>
<li></span><span class="Comment">&nbsp;&nbsp; which slows down the interpreter considerably.<br/></li>
<li></span><span class="Comment">&nbsp;&nbsp; For GCC, I have hand-assigned hardware registers for several architectures.<br/></li>
<li></span><span class="Comment">*/<br/></li>
<li></span><br/></li>
<li><span class="PreProc">#if defined(__GNUC__) &amp;&amp; !defined(DEBUG) &amp;&amp; !defined(__INTEL_COMPILER) \<br/></li>
<li></span><span class="PreProc">&nbsp; &nbsp; &amp;&amp; !defined(__llvm__)<br/></li>
<li></span><span class="PreProc">#ifdef __mips__<br/></li>
<li><a id="L172">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">PC_REG</span> </span><span class="Statement">asm</span><span class="PreProc">(</span><span class="Constant">&quot;$16&quot;</span><span class="PreProc">)<br/></li>
<li><a id="L173">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">SP_REG</span> </span><span class="Statement">asm</span><span class="PreProc">(</span><span class="Constant">&quot;$17&quot;</span><span class="PreProc">)<br/></li>
<li><a id="L174">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">ACCU_REG</span> </span><span class="Statement">asm</span><span class="PreProc">(</span><span class="Constant">&quot;$18&quot;</span><span class="PreProc">)<br/></li>
<li></span><span class="PreProc">#endif<br/></li>
<li></span><span class="PreProc">#ifdef __sparc__<br/></li>
<li><a id="L177">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">PC_REG</span> </span><span class="Statement">asm</span><span class="PreProc">(</span><span class="Constant">&quot;%l0&quot;</span><span class="PreProc">)<br/></li>
<li><a id="L178">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">SP_REG</span> </span><span class="Statement">asm</span><span class="PreProc">(</span><span class="Constant">&quot;%l1&quot;</span><span class="PreProc">)<br/></li>
<li><a id="L179">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">ACCU_REG</span> </span><span class="Statement">asm</span><span class="PreProc">(</span><span class="Constant">&quot;%l2&quot;</span><span class="PreProc">)<br/></li>
<li></span><span class="PreProc">#endif<br/></li>
<li></span><span class="PreProc">#ifdef __alpha__<br/></li>
<li></span><span class="PreProc">#ifdef __CRAY__<br/></li>
<li><a id="L183">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">PC_REG</span> </span><span class="Statement">asm</span><span class="PreProc">(</span><span class="Constant">&quot;r9&quot;</span><span class="PreProc">)<br/></li>
<li><a id="L184">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">SP_REG</span> </span><span class="Statement">asm</span><span class="PreProc">(</span><span class="Constant">&quot;r10&quot;</span><span class="PreProc">)<br/></li>
<li><a id="L185">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">ACCU_REG</span> </span><span class="Statement">asm</span><span class="PreProc">(</span><span class="Constant">&quot;r11&quot;</span><span class="PreProc">)<br/></li>
<li><a id="L186">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">JUMPTBL_BASE_REG</span> </span><span class="Statement">asm</span><span class="PreProc">(</span><span class="Constant">&quot;r12&quot;</span><span class="PreProc">)<br/></li>
<li></span><span class="PreProc">#else<br/></li>
<li><a id="L188">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">PC_REG</span> </span><span class="Statement">asm</span><span class="PreProc">(</span><span class="Constant">&quot;$9&quot;</span><span class="PreProc">)<br/></li>
<li><a id="L189">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">SP_REG</span> </span><span class="Statement">asm</span><span class="PreProc">(</span><span class="Constant">&quot;$10&quot;</span><span class="PreProc">)<br/></li>
<li><a id="L190">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">ACCU_REG</span> </span><span class="Statement">asm</span><span class="PreProc">(</span><span class="Constant">&quot;$11&quot;</span><span class="PreProc">)<br/></li>
<li><a id="L191">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">JUMPTBL_BASE_REG</span> </span><span class="Statement">asm</span><span class="PreProc">(</span><span class="Constant">&quot;$12&quot;</span><span class="PreProc">)<br/></li>
<li></span><span class="PreProc">#endif<br/></li>
<li></span><span class="PreProc">#endif<br/></li>
<li></span><span class="PreProc">#ifdef __i386__<br/></li>
<li><a id="L195">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">PC_REG</span> </span><span class="Statement">asm</span><span class="PreProc">(</span><span class="Constant">&quot;</span><span class="Special">%e</span><span class="Constant">si&quot;</span><span class="PreProc">)<br/></li>
<li><a id="L196">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">SP_REG</span> </span><span class="Statement">asm</span><span class="PreProc">(</span><span class="Constant">&quot;</span><span class="Special">%e</span><span class="Constant">di&quot;</span><span class="PreProc">)<br/></li>
<li><a id="L197">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">ACCU_REG</span><br/></li>
<li></span><span class="PreProc">#endif<br/></li>
<li></span><span class="PreProc">#if defined(__ppc__) || defined(__ppc64__)<br/></li>
<li><a id="L200">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">PC_REG</span> </span><span class="Statement">asm</span><span class="PreProc">(</span><span class="Constant">&quot;26&quot;</span><span class="PreProc">)<br/></li>
<li><a id="L201">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">SP_REG</span> </span><span class="Statement">asm</span><span class="PreProc">(</span><span class="Constant">&quot;27&quot;</span><span class="PreProc">)<br/></li>
<li><a id="L202">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">ACCU_REG</span> </span><span class="Statement">asm</span><span class="PreProc">(</span><span class="Constant">&quot;28&quot;</span><span class="PreProc">)<br/></li>
<li></span><span class="PreProc">#endif<br/></li>
<li></span><span class="PreProc">#ifdef __hppa__<br/></li>
<li><a id="L205">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">PC_REG</span> </span><span class="Statement">asm</span><span class="PreProc">(</span><span class="Constant">&quot;%r18&quot;</span><span class="PreProc">)<br/></li>
<li><a id="L206">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">SP_REG</span> </span><span class="Statement">asm</span><span class="PreProc">(</span><span class="Constant">&quot;%r17&quot;</span><span class="PreProc">)<br/></li>
<li><a id="L207">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">ACCU_REG</span> </span><span class="Statement">asm</span><span class="PreProc">(</span><span class="Constant">&quot;%r16&quot;</span><span class="PreProc">)<br/></li>
<li></span><span class="PreProc">#endif<br/></li>
<li></span><span class="PreProc">#ifdef __mc68000__<br/></li>
<li><a id="L210">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">PC_REG</span> </span><span class="Statement">asm</span><span class="PreProc">(</span><span class="Constant">&quot;a5&quot;</span><span class="PreProc">)<br/></li>
<li><a id="L211">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">SP_REG</span> </span><span class="Statement">asm</span><span class="PreProc">(</span><span class="Constant">&quot;a4&quot;</span><span class="PreProc">)<br/></li>
<li><a id="L212">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">ACCU_REG</span> </span><span class="Statement">asm</span><span class="PreProc">(</span><span class="Constant">&quot;d7&quot;</span><span class="PreProc">)<br/></li>
<li></span><span class="PreProc">#endif<br/></li>
<li></span><span class="Comment">/* PR#4953: these specific registers not available in Thumb mode */<br/></li>
<li></span><span class="PreProc">#if defined (__arm__) &amp;&amp; !defined(__thumb__)<br/></li>
<li><a id="L216">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">PC_REG</span> </span><span class="Statement">asm</span><span class="PreProc">(</span><span class="Constant">&quot;r6&quot;</span><span class="PreProc">)<br/></li>
<li><a id="L217">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">SP_REG</span> </span><span class="Statement">asm</span><span class="PreProc">(</span><span class="Constant">&quot;r8&quot;</span><span class="PreProc">)<br/></li>
<li><a id="L218">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">ACCU_REG</span> </span><span class="Statement">asm</span><span class="PreProc">(</span><span class="Constant">&quot;r7&quot;</span><span class="PreProc">)<br/></li>
<li></span><span class="PreProc">#endif<br/></li>
<li></span><span class="PreProc">#ifdef __ia64__<br/></li>
<li><a id="L221">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">PC_REG</span> </span><span class="Statement">asm</span><span class="PreProc">(</span><span class="Constant">&quot;36&quot;</span><span class="PreProc">)<br/></li>
<li><a id="L222">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">SP_REG</span> </span><span class="Statement">asm</span><span class="PreProc">(</span><span class="Constant">&quot;37&quot;</span><span class="PreProc">)<br/></li>
<li><a id="L223">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">ACCU_REG</span> </span><span class="Statement">asm</span><span class="PreProc">(</span><span class="Constant">&quot;38&quot;</span><span class="PreProc">)<br/></li>
<li><a id="L224">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">JUMPTBL_BASE_REG</span> </span><span class="Statement">asm</span><span class="PreProc">(</span><span class="Constant">&quot;39&quot;</span><span class="PreProc">)<br/></li>
<li></span><span class="PreProc">#endif<br/></li>
<li></span><span class="PreProc">#ifdef __x86_64__<br/></li>
<li><a id="L227">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">PC_REG</span> </span><span class="Statement">asm</span><span class="PreProc">(</span><span class="Constant">&quot;%r15&quot;</span><span class="PreProc">)<br/></li>
<li><a id="L228">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">SP_REG</span> </span><span class="Statement">asm</span><span class="PreProc">(</span><span class="Constant">&quot;%r14&quot;</span><span class="PreProc">)<br/></li>
<li><a id="L229">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">ACCU_REG</span> </span><span class="Statement">asm</span><span class="PreProc">(</span><span class="Constant">&quot;%r13&quot;</span><span class="PreProc">)<br/></li>
<li></span><span class="PreProc">#endif<br/></li>
<li></span><span class="PreProc">#ifdef __aarch64__<br/></li>
<li><a id="L232">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">PC_REG</span> </span><span class="Statement">asm</span><span class="PreProc">(</span><span class="Constant">&quot;</span><span class="Special">%x</span><span class="Constant">19&quot;</span><span class="PreProc">)<br/></li>
<li><a id="L233">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">SP_REG</span> </span><span class="Statement">asm</span><span class="PreProc">(</span><span class="Constant">&quot;</span><span class="Special">%x</span><span class="Constant">20&quot;</span><span class="PreProc">)<br/></li>
<li><a id="L234">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">ACCU_REG</span> </span><span class="Statement">asm</span><span class="PreProc">(</span><span class="Constant">&quot;</span><span class="Special">%x</span><span class="Constant">21&quot;</span><span class="PreProc">)<br/></li>
<li><a id="L235">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">JUMPTBL_BASE_REG</span> </span><span class="Statement">asm</span><span class="PreProc">(</span><span class="Constant">&quot;</span><span class="Special">%x</span><span class="Constant">22&quot;</span><span class="PreProc">)<br/></li>
<li></span><span class="PreProc">#endif<br/></li>
<li></span><span class="PreProc">#endif<br/></li>
<li></span><br/></li>
<li><span class="PreProc">#ifdef DEBUG<br/></li>
<li><a id="L240">&#x200c;</a></span><span class="Type">static</span> __thread <a href="caml/config.h.html#L140" title="ocaml/runtime/caml/config.h:140">intnat</a> <span class="linkable">caml_bcodcount</span>;<br/></li>
<li><span class="PreProc">#endif<br/></li>
<li></span><br/></li>
<li><a id="L243">&#x200c;</a><span class="Type">static</span> <a href="caml/mlvalues.h.html#L57" title="ocaml/runtime/caml/mlvalues.h:57">value</a> <span class="linkable">raise_unhandled_effect</span>;<br/></li>
<li><br/></li>
<li><span class="Comment">/* The interpreter itself */<br/></li>
<li></span><br/></li>
<li><a id="L247">&#x200c;</a><a href="caml/mlvalues.h.html#L57" title="ocaml/runtime/caml/mlvalues.h:57">value</a> <span class="linkable">caml_interprete</span>(<a href="caml/mlvalues.h.html#L67" title="ocaml/runtime/caml/mlvalues.h:67">code_t</a> prog, <a href="caml/misc.h.html#L68" title="ocaml/runtime/caml/misc.h:68">asize_t</a> prog_size)<br/></li>
<li>{<br/></li>
<li><span class="PreProc">#ifdef <a href="#L172" title="ocaml/runtime/interp.c:172">PC_REG</a><br/></li>
<li></span>&nbsp; <span class="Type">register</span> <a href="caml/mlvalues.h.html#L67" title="ocaml/runtime/caml/mlvalues.h:67">code_t</a> pc <a href="#L172" title="ocaml/runtime/interp.c:172">PC_REG</a>;<br/></li>
<li>&nbsp; <span class="Type">register</span> <a href="caml/mlvalues.h.html#L57" title="ocaml/runtime/caml/mlvalues.h:57">value</a> * sp <a href="#L173" title="ocaml/runtime/interp.c:173">SP_REG</a>;<br/></li>
<li>&nbsp; <span class="Type">register</span> <a href="caml/mlvalues.h.html#L57" title="ocaml/runtime/caml/mlvalues.h:57">value</a> accu <a href="#L174" title="ocaml/runtime/interp.c:174">ACCU_REG</a>;<br/></li>
<li><span class="PreProc">#else<br/></li>
<li></span>&nbsp; <span class="Type">register</span> <a href="caml/mlvalues.h.html#L67" title="ocaml/runtime/caml/mlvalues.h:67">code_t</a> pc;<br/></li>
<li>&nbsp; <span class="Type">register</span> <a href="caml/mlvalues.h.html#L57" title="ocaml/runtime/caml/mlvalues.h:57">value</a> * sp;<br/></li>
<li>&nbsp; <span class="Type">register</span> <a href="caml/mlvalues.h.html#L57" title="ocaml/runtime/caml/mlvalues.h:57">value</a> accu;<br/></li>
<li><span class="PreProc">#endif<br/></li>
<li></span><span class="PreProc">#if defined(<a href="caml/config.h.html#L182" title="ocaml/runtime/caml/config.h:182">THREADED_CODE</a>) &amp;&amp; defined(ARCH_SIXTYFOUR) &amp;&amp; !defined(<a href="caml/config.h.html#L34" title="ocaml/runtime/caml/config.h:34">ARCH_CODE32</a>)<br/></li>
<li></span><span class="PreProc">#ifdef <a href="#L186" title="ocaml/runtime/interp.c:186">JUMPTBL_BASE_REG</a><br/></li>
<li></span>&nbsp; <span class="Type">register</span> <span class="Type">char</span> * <a href="#L60" title="ocaml/runtime/interp.c:60">jumptbl_base</a> <a href="#L186" title="ocaml/runtime/interp.c:186">JUMPTBL_BASE_REG</a>;<br/></li>
<li><span class="PreProc">#else<br/></li>
<li></span>&nbsp; <span class="Type">register</span> <span class="Type">char</span> * <a href="#L60" title="ocaml/runtime/interp.c:60">jumptbl_base</a>;<br/></li>
<li><span class="PreProc">#endif<br/></li>
<li></span><span class="PreProc">#endif<br/></li>
<li></span>&nbsp; <a href="caml/mlvalues.h.html#L57" title="ocaml/runtime/caml/mlvalues.h:57">value</a> env;<br/></li>
<li>&nbsp; <a href="caml/config.h.html#L140" title="ocaml/runtime/caml/config.h:140">intnat</a> extra_args;<br/></li>
<li>&nbsp; <span class="Type">struct</span> <a href="caml/fail.h.html#L64" title="ocaml/runtime/caml/fail.h:64">caml_exception_context</a> * initial_external_raise;<br/></li>
<li>&nbsp; <span class="Type">int</span> initial_stack_words;<br/></li>
<li>&nbsp; <a href="caml/config.h.html#L140" title="ocaml/runtime/caml/config.h:140">intnat</a> initial_trap_sp_off;<br/></li>
<li>&nbsp; <span class="Type">volatile</span> <a href="caml/mlvalues.h.html#L57" title="ocaml/runtime/caml/mlvalues.h:57">value</a> raise_exn_bucket = <a href="caml/mlvalues.h.html#L431" title="ocaml/runtime/caml/mlvalues.h:431">Val_unit</a>;<br/></li>
<li>&nbsp; <span class="Type">struct</span> <a href="caml/fail.h.html#L46" title="ocaml/runtime/caml/fail.h:46">longjmp_buffer</a> raise_buf;<br/></li>
<li>&nbsp; <a href="caml/mlvalues.h.html#L57" title="ocaml/runtime/caml/mlvalues.h:57">value</a> resume_fn, resume_arg;<br/></li>
<li>&nbsp; <a href="caml/domain_state.h.html#L34" title="ocaml/runtime/caml/domain_state.h:34">caml_domain_state</a>* domain_state = <a href="caml/domain_state.h.html#L62" title="ocaml/runtime/caml/domain_state.h:62">Caml_state</a>;<br/></li>
<li>&nbsp; <span class="Type">struct</span> <a href="caml/fail.h.html#L64" title="ocaml/runtime/caml/fail.h:64">caml_exception_context</a> exception_ctx =<br/></li>
<li>&nbsp; &nbsp; { &amp;raise_buf, domain_state-&gt;local_roots, &amp;raise_exn_bucket};<br/></li>
<li><span class="PreProc">#ifndef <a href="caml/config.h.html#L182" title="ocaml/runtime/caml/config.h:182">THREADED_CODE</a><br/></li>
<li></span>&nbsp; <a href="caml/mlvalues.h.html#L66" title="ocaml/runtime/caml/mlvalues.h:66">opcode_t</a> curr_instr;<br/></li>
<li><span class="PreProc">#endif<br/></li>
<li></span><br/></li>
<li><span class="PreProc">#ifdef <a href="caml/config.h.html#L182" title="ocaml/runtime/caml/config.h:182">THREADED_CODE</a><br/></li>
<li></span>&nbsp; <span class="Type">static</span> <span class="Type">void</span> * jumptable[] = {<br/></li>
<li><span class="PreProc">#&nbsp; &nbsp; include </span><span class="Constant">&quot;caml/jumptbl.h&quot;<br/></li>
<li></span>&nbsp; };<br/></li>
<li><span class="PreProc">#endif<br/></li>
<li></span><br/></li>
<li>&nbsp; <span class="Statement">if</span> (prog == <span class="Constant"><a href="caml/misc.h.html#L71" title="ocaml/runtime/caml/misc.h:71">NULL</a></span>) {&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Comment">/* Interpreter is initializing */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Type">static</span> <a href="caml/mlvalues.h.html#L66" title="ocaml/runtime/caml/mlvalues.h:66">opcode_t</a> raise_unhandled_effect_code[] = { ACC, <span class="Constant">0</span>, RAISE };<br/></li>
<li>&nbsp; &nbsp; <a href="caml/mlvalues.h.html#L57" title="ocaml/runtime/caml/mlvalues.h:57">value</a> raise_unhandled_effect_closure;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="codefrag.c.html#L47" title="ocaml/runtime/codefrag.c:47">caml_register_code_fragment</a>(<br/></li>
<li>&nbsp; &nbsp; &nbsp; (<span class="Type">char</span> *) raise_unhandled_effect_code,<br/></li>
<li>&nbsp; &nbsp; &nbsp; (<span class="Type">char</span> *) raise_unhandled_effect_code +<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Statement"><a href="caml/fiber.h.html#L65" title="ocaml/runtime/caml/fiber.h:65">sizeof</a></span>(raise_unhandled_effect_code),<br/></li>
<li>&nbsp; &nbsp; &nbsp; DIGEST_IGNORE, <span class="Constant"><a href="caml/misc.h.html#L71" title="ocaml/runtime/caml/misc.h:71">NULL</a></span>);<br/></li>
<li><span class="PreProc">#ifdef <a href="caml/config.h.html#L182" title="ocaml/runtime/caml/config.h:182">THREADED_CODE</a><br/></li>
<li></span>&nbsp; &nbsp; <a href="fix_code.c.html#L88" title="ocaml/runtime/fix_code.c:88">caml_init_thread_code</a>(jumptable, <a href="#L57" title="ocaml/runtime/interp.c:57">Jumptbl_base</a>);<br/></li>
<li>&nbsp; &nbsp; <a href="fix_code.c.html#L129" title="ocaml/runtime/fix_code.c:129">caml_thread_code</a>(raise_unhandled_effect_code,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement"><a href="caml/fiber.h.html#L65" title="ocaml/runtime/caml/fiber.h:65">sizeof</a></span>(raise_unhandled_effect_code));<br/></li>
<li><span class="PreProc">#endif<br/></li>
<li></span>&nbsp; &nbsp; raise_unhandled_effect_closure = <a href="alloc.c.html#L158" title="ocaml/runtime/alloc.c:158">caml_alloc_small</a> (<span class="Constant">2</span>, <a href="caml/mlvalues.h.html#L275" title="ocaml/runtime/caml/mlvalues.h:275">Closure_tag</a>);<br/></li>
<li>&nbsp; &nbsp; <a href="caml/mlvalues.h.html#L276" title="ocaml/runtime/caml/mlvalues.h:276">Code_val</a>(raise_unhandled_effect_closure) =<br/></li>
<li>&nbsp; &nbsp; &nbsp; (<a href="caml/mlvalues.h.html#L67" title="ocaml/runtime/caml/mlvalues.h:67">code_t</a>)raise_unhandled_effect_code;<br/></li>
<li>&nbsp; &nbsp; <a href="caml/mlvalues.h.html#L277" title="ocaml/runtime/caml/mlvalues.h:277">Closinfo_val</a>(raise_unhandled_effect_closure) = <a href="caml/mlvalues.h.html#L286" title="ocaml/runtime/caml/mlvalues.h:286">Make_closinfo</a>(<span class="Constant">0</span>, <span class="Constant">2</span>);<br/></li>
<li>&nbsp; &nbsp; <a href="#L243" title="ocaml/runtime/interp.c:243">raise_unhandled_effect</a> = raise_unhandled_effect_closure;<br/></li>
<li>&nbsp; &nbsp; <a href="globroots.c.html#L95" title="ocaml/runtime/globroots.c:95">caml_register_generational_global_root</a>(&amp;<a href="#L243" title="ocaml/runtime/interp.c:243">raise_unhandled_effect</a>);<br/></li>
<li>&nbsp; &nbsp; <a href="fiber.c.html#L316" title="ocaml/runtime/fiber.c:316">caml_global_data</a> = <a href="caml/mlvalues.h.html#L431" title="ocaml/runtime/caml/mlvalues.h:431">Val_unit</a>;<br/></li>
<li>&nbsp; &nbsp; <a href="globroots.c.html#L95" title="ocaml/runtime/globroots.c:95">caml_register_generational_global_root</a>(&amp;<a href="fiber.c.html#L316" title="ocaml/runtime/fiber.c:316">caml_global_data</a>);<br/></li>
<li>&nbsp; &nbsp; <a href="callback.c.html#L325" title="ocaml/runtime/callback.c:325">caml_init_callbacks</a>();<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">return</span> <a href="caml/mlvalues.h.html#L431" title="ocaml/runtime/caml/mlvalues.h:431">Val_unit</a>;<br/></li>
<li>&nbsp; }<br/></li>
<li><br/></li>
<li><span class="PreProc">#if defined(<a href="caml/config.h.html#L182" title="ocaml/runtime/caml/config.h:182">THREADED_CODE</a>) &amp;&amp; defined(ARCH_SIXTYFOUR) &amp;&amp; !defined(<a href="caml/config.h.html#L34" title="ocaml/runtime/caml/config.h:34">ARCH_CODE32</a>)<br/></li>
<li></span>&nbsp; <a href="#L60" title="ocaml/runtime/interp.c:60">jumptbl_base</a> = <a href="#L57" title="ocaml/runtime/interp.c:57">Jumptbl_base</a>;<br/></li>
<li><span class="PreProc">#endif<br/></li>
<li></span>&nbsp; initial_trap_sp_off = domain_state-&gt;trap_sp_off;<br/></li>
<li>&nbsp; initial_stack_words =<br/></li>
<li>&nbsp; &nbsp; <a href="caml/fiber.h.html#L69" title="ocaml/runtime/caml/fiber.h:69">Stack_high</a>(domain_state-&gt;current_stack) - domain_state-&gt;current_stack-&gt;sp;<br/></li>
<li>&nbsp; initial_external_raise = domain_state-&gt;external_raise;<br/></li>
<li><br/></li>
<li>&nbsp; <span class="Statement">if</span> (<a href="caml/fail.h.html#L54" title="ocaml/runtime/caml/fail.h:54">sigsetjmp</a>(raise_buf.buf, <span class="Constant">0</span>)) {<br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* no non-volatile local variables read here */<br/></li>
<li></span>&nbsp; &nbsp; sp = domain_state-&gt;current_stack-&gt;sp;<br/></li>
<li>&nbsp; &nbsp; accu = raise_exn_bucket;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="#L136" title="ocaml/runtime/interp.c:136">check_trap_barrier_for_exception</a> (domain_state);<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (domain_state-&gt;backtrace_active) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Comment">/* pc has already been pushed on the stack when calling the C<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; function that raised the exception. No need to push it again<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; here. */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <a href="backtrace_nat.c.html#L91" title="ocaml/runtime/backtrace_nat.c:91">caml_stash_backtrace</a>(accu, sp, <span class="Constant">0</span>);<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">goto</span> raise_notrace;<br/></li>
<li>&nbsp; }<br/></li>
<li>&nbsp; domain_state-&gt;external_raise = &amp;exception_ctx;<br/></li>
<li><br/></li>
<li>&nbsp; domain_state-&gt;trap_sp_off = <span class="Constant">1</span>;<br/></li>
<li><br/></li>
<li>&nbsp; sp = domain_state-&gt;current_stack-&gt;sp;<br/></li>
<li>&nbsp; pc = prog;<br/></li>
<li>&nbsp; extra_args = <span class="Constant">0</span>;<br/></li>
<li>&nbsp; env = <a href="caml/mlvalues.h.html#L419" title="ocaml/runtime/caml/mlvalues.h:419">Atom</a>(<span class="Constant">0</span>);<br/></li>
<li>&nbsp; accu = <a href="caml/mlvalues.h.html#L81" title="ocaml/runtime/caml/mlvalues.h:81">Val_int</a>(<span class="Constant">0</span>);<br/></li>
<li><br/></li>
<li><span class="PreProc">#ifdef <a href="caml/config.h.html#L182" title="ocaml/runtime/caml/config.h:182">THREADED_CODE</a><br/></li>
<li></span><span class="PreProc">#ifdef DEBUG<br/></li>
<li></span> <span class="Statement">next_instr</span><span class="cUserCont">:<br/></li>
<li></span>&nbsp; <span class="Statement">if</span> (<a href="instrtrace.c.html#L39" title="ocaml/runtime/instrtrace.c:39">caml_icount</a>-- == <span class="Constant">0</span>) <a href="instrtrace.c.html#L41" title="ocaml/runtime/instrtrace.c:41">caml_stop_here</a> ();<br/></li>
<li>&nbsp; <a href="caml/misc.h.html#L247" title="ocaml/runtime/caml/misc.h:247">CAMLassert</a>(<a href="caml/fiber.h.html#L66" title="ocaml/runtime/caml/fiber.h:66">Stack_base</a>(domain_state-&gt;current_stack) &lt;= sp);<br/></li>
<li>&nbsp; <a href="caml/misc.h.html#L247" title="ocaml/runtime/caml/misc.h:247">CAMLassert</a>(sp &lt;= <a href="caml/fiber.h.html#L69" title="ocaml/runtime/caml/fiber.h:69">Stack_high</a>(domain_state-&gt;current_stack));<br/></li>
<li><span class="PreProc">#endif<br/></li>
<li></span>&nbsp; <span class="Statement">goto</span> *(<span class="Type">void</span> *)(<a href="#L60" title="ocaml/runtime/interp.c:60">jumptbl_base</a> + *pc++); <span class="Comment">/* Jump to the first instruction */<br/></li>
<li></span><span class="PreProc">#else<br/></li>
<li></span>&nbsp; <span class="Statement">while</span>(<span class="Constant">1</span>) {<br/></li>
<li><span class="PreProc">#ifdef DEBUG<br/></li>
<li></span>&nbsp; &nbsp; <a href="#L240" title="ocaml/runtime/interp.c:240">caml_bcodcount</a>++;<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (<a href="instrtrace.c.html#L39" title="ocaml/runtime/instrtrace.c:39">caml_icount</a>-- == <span class="Constant">0</span>) <a href="instrtrace.c.html#L41" title="ocaml/runtime/instrtrace.c:41">caml_stop_here</a> ();<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (<a href="startup_aux.c.html#L41" title="ocaml/runtime/startup_aux.c:41">caml_params</a>-&gt;trace_level&gt;<span class="Constant">1</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; printf(<span class="Constant">&quot;</span><span class="Special">\n</span><span class="Constant">##%&quot;</span> <a href="caml/config.h.html#L142" title="ocaml/runtime/caml/config.h:142">ARCH_INTNAT_PRINTF_FORMAT</a> <span class="Constant">&quot;d</span><span class="Special">\n</span><span class="Constant">&quot;</span>, <a href="#L240" title="ocaml/runtime/interp.c:240">caml_bcodcount</a>);<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (<a href="startup_aux.c.html#L41" title="ocaml/runtime/startup_aux.c:41">caml_params</a>-&gt;trace_level&gt;<span class="Constant">0</span>) <a href="instrtrace.c.html#L63" title="ocaml/runtime/instrtrace.c:63">caml_disasm_instr</a>(pc);<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (<a href="startup_aux.c.html#L41" title="ocaml/runtime/startup_aux.c:41">caml_params</a>-&gt;event_trace&gt;<span class="Constant">0</span>) <a href="instrtrace.c.html#L49" title="ocaml/runtime/instrtrace.c:49">caml_event_trace</a>(pc);<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (<a href="startup_aux.c.html#L41" title="ocaml/runtime/startup_aux.c:41">caml_params</a>-&gt;trace_level&gt;<span class="Constant">1</span>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; printf(<span class="Constant">&quot;env=&quot;</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="instrtrace.c.html#L117" title="ocaml/runtime/instrtrace.c:117">caml_trace_value_file</a>(env,prog,prog_size,<span class="Constant">stdout</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; putchar(<span class="Special">'\n'</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="instrtrace.c.html#L188" title="ocaml/runtime/instrtrace.c:188">caml_trace_accu_sp_file</a>(accu,sp,prog,prog_size,<span class="Constant">stdout</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; fflush(<span class="Constant">stdout</span>);<br/></li>
<li>&nbsp; &nbsp; };<br/></li>
<li>&nbsp; &nbsp; <a href="caml/misc.h.html#L247" title="ocaml/runtime/caml/misc.h:247">CAMLassert</a>(<a href="caml/fiber.h.html#L66" title="ocaml/runtime/caml/fiber.h:66">Stack_base</a>(domain_state-&gt;current_stack) &lt;= sp);<br/></li>
<li>&nbsp; &nbsp; <a href="caml/misc.h.html#L247" title="ocaml/runtime/caml/misc.h:247">CAMLassert</a>(sp &lt;= <a href="caml/fiber.h.html#L69" title="ocaml/runtime/caml/fiber.h:69">Stack_high</a>(domain_state-&gt;current_stack));<br/></li>
<li><br/></li>
<li><span class="PreProc">#endif<br/></li>
<li></span>&nbsp; &nbsp; curr_instr = *pc++;<br/></li>
<li><br/></li>
<li>&nbsp; <span class="Statement">dispatch_instr</span><span class="cUserCont">:<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">switch</span>(curr_instr) {<br/></li>
<li><span class="PreProc">#endif<br/></li>
<li></span><br/></li>
<li><span class="Comment">/* Basic stack operations */<br/></li>
<li></span><br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(ACC0):<br/></li>
<li>&nbsp; &nbsp; &nbsp; accu = sp[<span class="Constant">0</span>]; <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(ACC1):<br/></li>
<li>&nbsp; &nbsp; &nbsp; accu = sp[<span class="Constant">1</span>]; <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(ACC2):<br/></li>
<li>&nbsp; &nbsp; &nbsp; accu = sp[<span class="Constant">2</span>]; <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(ACC3):<br/></li>
<li>&nbsp; &nbsp; &nbsp; accu = sp[<span class="Constant">3</span>]; <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(ACC4):<br/></li>
<li>&nbsp; &nbsp; &nbsp; accu = sp[<span class="Constant">4</span>]; <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(ACC5):<br/></li>
<li>&nbsp; &nbsp; &nbsp; accu = sp[<span class="Constant">5</span>]; <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(ACC6):<br/></li>
<li>&nbsp; &nbsp; &nbsp; accu = sp[<span class="Constant">6</span>]; <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(ACC7):<br/></li>
<li>&nbsp; &nbsp; &nbsp; accu = sp[<span class="Constant">7</span>]; <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(PUSH): <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(PUSHACC0):<br/></li>
<li>&nbsp; &nbsp; &nbsp; *--sp = accu; <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(PUSHACC1):<br/></li>
<li>&nbsp; &nbsp; &nbsp; *--sp = accu; accu = sp[<span class="Constant">1</span>]; <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(PUSHACC2):<br/></li>
<li>&nbsp; &nbsp; &nbsp; *--sp = accu; accu = sp[<span class="Constant">2</span>]; <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(PUSHACC3):<br/></li>
<li>&nbsp; &nbsp; &nbsp; *--sp = accu; accu = sp[<span class="Constant">3</span>]; <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(PUSHACC4):<br/></li>
<li>&nbsp; &nbsp; &nbsp; *--sp = accu; accu = sp[<span class="Constant">4</span>]; <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(PUSHACC5):<br/></li>
<li>&nbsp; &nbsp; &nbsp; *--sp = accu; accu = sp[<span class="Constant">5</span>]; <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(PUSHACC6):<br/></li>
<li>&nbsp; &nbsp; &nbsp; *--sp = accu; accu = sp[<span class="Constant">6</span>]; <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(PUSHACC7):<br/></li>
<li>&nbsp; &nbsp; &nbsp; *--sp = accu; accu = sp[<span class="Constant">7</span>]; <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(PUSHACC):<br/></li>
<li>&nbsp; &nbsp; &nbsp; *--sp = accu;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Comment">/* Fallthrough */<br/></li>
<li></span>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(ACC):<br/></li>
<li>&nbsp; &nbsp; &nbsp; accu = sp[*pc++];<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(POP):<br/></li>
<li>&nbsp; &nbsp; &nbsp; sp += *pc++;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(ASSIGN):<br/></li>
<li>&nbsp; &nbsp; &nbsp; sp[*pc++] = accu;<br/></li>
<li>&nbsp; &nbsp; &nbsp; accu = <a href="caml/mlvalues.h.html#L431" title="ocaml/runtime/caml/mlvalues.h:431">Val_unit</a>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li><br/></li>
<li><span class="Comment">/* Access in heap-allocated environment */<br/></li>
<li></span><br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(ENVACC1):<br/></li>
<li>&nbsp; &nbsp; &nbsp; accu = <a href="caml/mlvalues.h.html#L228" title="ocaml/runtime/caml/mlvalues.h:228">Field</a>(env, <span class="Constant">1</span>); <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(ENVACC2):<br/></li>
<li>&nbsp; &nbsp; &nbsp; accu = <a href="caml/mlvalues.h.html#L228" title="ocaml/runtime/caml/mlvalues.h:228">Field</a>(env, <span class="Constant">2</span>); <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(ENVACC3):<br/></li>
<li>&nbsp; &nbsp; &nbsp; accu = <a href="caml/mlvalues.h.html#L228" title="ocaml/runtime/caml/mlvalues.h:228">Field</a>(env, <span class="Constant">3</span>); <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(ENVACC4):<br/></li>
<li>&nbsp; &nbsp; &nbsp; accu = <a href="caml/mlvalues.h.html#L228" title="ocaml/runtime/caml/mlvalues.h:228">Field</a>(env, <span class="Constant">4</span>); <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(PUSHENVACC1):<br/></li>
<li>&nbsp; &nbsp; &nbsp; *--sp = accu; accu = <a href="caml/mlvalues.h.html#L228" title="ocaml/runtime/caml/mlvalues.h:228">Field</a>(env, <span class="Constant">1</span>); <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(PUSHENVACC2):<br/></li>
<li>&nbsp; &nbsp; &nbsp; *--sp = accu; accu = <a href="caml/mlvalues.h.html#L228" title="ocaml/runtime/caml/mlvalues.h:228">Field</a>(env, <span class="Constant">2</span>); <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(PUSHENVACC3):<br/></li>
<li>&nbsp; &nbsp; &nbsp; *--sp = accu; accu = <a href="caml/mlvalues.h.html#L228" title="ocaml/runtime/caml/mlvalues.h:228">Field</a>(env, <span class="Constant">3</span>); <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(PUSHENVACC4):<br/></li>
<li>&nbsp; &nbsp; &nbsp; *--sp = accu; accu = <a href="caml/mlvalues.h.html#L228" title="ocaml/runtime/caml/mlvalues.h:228">Field</a>(env, <span class="Constant">4</span>); <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(PUSHENVACC):<br/></li>
<li>&nbsp; &nbsp; &nbsp; *--sp = accu;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Comment">/* Fallthrough */<br/></li>
<li></span>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(ENVACC):<br/></li>
<li>&nbsp; &nbsp; &nbsp; accu = <a href="caml/mlvalues.h.html#L228" title="ocaml/runtime/caml/mlvalues.h:228">Field</a>(env, *pc++);<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li><br/></li>
<li><span class="Comment">/* Function application */<br/></li>
<li></span><br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(PUSH_RETADDR): {<br/></li>
<li>&nbsp; &nbsp; &nbsp; sp -= <span class="Constant">3</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; sp[<span class="Constant">0</span>] = (<a href="caml/mlvalues.h.html#L57" title="ocaml/runtime/caml/mlvalues.h:57">value</a>) (pc + *pc);<br/></li>
<li>&nbsp; &nbsp; &nbsp; sp[<span class="Constant">1</span>] = env;<br/></li>
<li>&nbsp; &nbsp; &nbsp; sp[<span class="Constant">2</span>] = <a href="caml/mlvalues.h.html#L77" title="ocaml/runtime/caml/mlvalues.h:77">Val_long</a>(extra_args);<br/></li>
<li>&nbsp; &nbsp; &nbsp; pc++;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(APPLY): {<br/></li>
<li>&nbsp; &nbsp; &nbsp; extra_args = *pc - <span class="Constant">1</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; pc = <a href="caml/mlvalues.h.html#L276" title="ocaml/runtime/caml/mlvalues.h:276">Code_val</a>(accu);<br/></li>
<li>&nbsp; &nbsp; &nbsp; env = accu;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Statement">goto</span> check_stacks;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(APPLY1): {<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="caml/mlvalues.h.html#L57" title="ocaml/runtime/caml/mlvalues.h:57">value</a> arg1 = sp[<span class="Constant">0</span>];<br/></li>
<li>&nbsp; &nbsp; &nbsp; sp -= <span class="Constant">3</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; sp[<span class="Constant">0</span>] = arg1;<br/></li>
<li>&nbsp; &nbsp; &nbsp; sp[<span class="Constant">1</span>] = (<a href="caml/mlvalues.h.html#L57" title="ocaml/runtime/caml/mlvalues.h:57">value</a>)pc;<br/></li>
<li>&nbsp; &nbsp; &nbsp; sp[<span class="Constant">2</span>] = env;<br/></li>
<li>&nbsp; &nbsp; &nbsp; sp[<span class="Constant">3</span>] = <a href="caml/mlvalues.h.html#L77" title="ocaml/runtime/caml/mlvalues.h:77">Val_long</a>(extra_args);<br/></li>
<li>&nbsp; &nbsp; &nbsp; pc = <a href="caml/mlvalues.h.html#L276" title="ocaml/runtime/caml/mlvalues.h:276">Code_val</a>(accu);<br/></li>
<li>&nbsp; &nbsp; &nbsp; env = accu;<br/></li>
<li>&nbsp; &nbsp; &nbsp; extra_args = <span class="Constant">0</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Statement">goto</span> check_stacks;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(APPLY2): {<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="caml/mlvalues.h.html#L57" title="ocaml/runtime/caml/mlvalues.h:57">value</a> arg1 = sp[<span class="Constant">0</span>];<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="caml/mlvalues.h.html#L57" title="ocaml/runtime/caml/mlvalues.h:57">value</a> arg2 = sp[<span class="Constant">1</span>];<br/></li>
<li>&nbsp; &nbsp; &nbsp; sp -= <span class="Constant">3</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; sp[<span class="Constant">0</span>] = arg1;<br/></li>
<li>&nbsp; &nbsp; &nbsp; sp[<span class="Constant">1</span>] = arg2;<br/></li>
<li>&nbsp; &nbsp; &nbsp; sp[<span class="Constant">2</span>] = (<a href="caml/mlvalues.h.html#L57" title="ocaml/runtime/caml/mlvalues.h:57">value</a>)pc;<br/></li>
<li>&nbsp; &nbsp; &nbsp; sp[<span class="Constant">3</span>] = env;<br/></li>
<li>&nbsp; &nbsp; &nbsp; sp[<span class="Constant">4</span>] = <a href="caml/mlvalues.h.html#L77" title="ocaml/runtime/caml/mlvalues.h:77">Val_long</a>(extra_args);<br/></li>
<li>&nbsp; &nbsp; &nbsp; pc = <a href="caml/mlvalues.h.html#L276" title="ocaml/runtime/caml/mlvalues.h:276">Code_val</a>(accu);<br/></li>
<li>&nbsp; &nbsp; &nbsp; env = accu;<br/></li>
<li>&nbsp; &nbsp; &nbsp; extra_args = <span class="Constant">1</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Statement">goto</span> check_stacks;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(APPLY3): {<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="caml/mlvalues.h.html#L57" title="ocaml/runtime/caml/mlvalues.h:57">value</a> arg1 = sp[<span class="Constant">0</span>];<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="caml/mlvalues.h.html#L57" title="ocaml/runtime/caml/mlvalues.h:57">value</a> arg2 = sp[<span class="Constant">1</span>];<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="caml/mlvalues.h.html#L57" title="ocaml/runtime/caml/mlvalues.h:57">value</a> arg3 = sp[<span class="Constant">2</span>];<br/></li>
<li>&nbsp; &nbsp; &nbsp; sp -= <span class="Constant">3</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; sp[<span class="Constant">0</span>] = arg1;<br/></li>
<li>&nbsp; &nbsp; &nbsp; sp[<span class="Constant">1</span>] = arg2;<br/></li>
<li>&nbsp; &nbsp; &nbsp; sp[<span class="Constant">2</span>] = arg3;<br/></li>
<li>&nbsp; &nbsp; &nbsp; sp[<span class="Constant">3</span>] = (<a href="caml/mlvalues.h.html#L57" title="ocaml/runtime/caml/mlvalues.h:57">value</a>)pc;<br/></li>
<li>&nbsp; &nbsp; &nbsp; sp[<span class="Constant">4</span>] = env;<br/></li>
<li>&nbsp; &nbsp; &nbsp; sp[<span class="Constant">5</span>] = <a href="caml/mlvalues.h.html#L77" title="ocaml/runtime/caml/mlvalues.h:77">Val_long</a>(extra_args);<br/></li>
<li>&nbsp; &nbsp; &nbsp; pc = <a href="caml/mlvalues.h.html#L276" title="ocaml/runtime/caml/mlvalues.h:276">Code_val</a>(accu);<br/></li>
<li>&nbsp; &nbsp; &nbsp; env = accu;<br/></li>
<li>&nbsp; &nbsp; &nbsp; extra_args = <span class="Constant">2</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Statement">goto</span> check_stacks;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(APPTERM): {<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Type">int</span> nargs = *pc++;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Type">int</span> slotsize = *pc;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="caml/mlvalues.h.html#L57" title="ocaml/runtime/caml/mlvalues.h:57">value</a> * newsp;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Type">int</span> i;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Comment">/* Slide the nargs bottom words of the current frame to the top<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; of the frame, <a href="ints.c.html#L488" title="ocaml/runtime/ints.c:488">and</a> discard the remainder of the frame */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; newsp = sp + slotsize - nargs;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Statement">for</span> (i = nargs - <span class="Constant">1</span>; i &gt;= <span class="Constant">0</span>; i--) newsp[i] = sp[i];<br/></li>
<li>&nbsp; &nbsp; &nbsp; sp = newsp;<br/></li>
<li>&nbsp; &nbsp; &nbsp; pc = <a href="caml/mlvalues.h.html#L276" title="ocaml/runtime/caml/mlvalues.h:276">Code_val</a>(accu);<br/></li>
<li>&nbsp; &nbsp; &nbsp; env = accu;<br/></li>
<li>&nbsp; &nbsp; &nbsp; extra_args += nargs - <span class="Constant">1</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Statement">goto</span> check_stacks;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(APPTERM1): {<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="caml/mlvalues.h.html#L57" title="ocaml/runtime/caml/mlvalues.h:57">value</a> arg1 = sp[<span class="Constant">0</span>];<br/></li>
<li>&nbsp; &nbsp; &nbsp; sp = sp + *pc - <span class="Constant">1</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; sp[<span class="Constant">0</span>] = arg1;<br/></li>
<li>&nbsp; &nbsp; &nbsp; pc = <a href="caml/mlvalues.h.html#L276" title="ocaml/runtime/caml/mlvalues.h:276">Code_val</a>(accu);<br/></li>
<li>&nbsp; &nbsp; &nbsp; env = accu;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Statement">goto</span> check_stacks;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(APPTERM2): {<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="caml/mlvalues.h.html#L57" title="ocaml/runtime/caml/mlvalues.h:57">value</a> arg1 = sp[<span class="Constant">0</span>];<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="caml/mlvalues.h.html#L57" title="ocaml/runtime/caml/mlvalues.h:57">value</a> arg2 = sp[<span class="Constant">1</span>];<br/></li>
<li>&nbsp; &nbsp; &nbsp; sp = sp + *pc - <span class="Constant">2</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; sp[<span class="Constant">0</span>] = arg1;<br/></li>
<li>&nbsp; &nbsp; &nbsp; sp[<span class="Constant">1</span>] = arg2;<br/></li>
<li>&nbsp; &nbsp; &nbsp; pc = <a href="caml/mlvalues.h.html#L276" title="ocaml/runtime/caml/mlvalues.h:276">Code_val</a>(accu);<br/></li>
<li>&nbsp; &nbsp; &nbsp; env = accu;<br/></li>
<li>&nbsp; &nbsp; &nbsp; extra_args += <span class="Constant">1</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Statement">goto</span> check_stacks;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(APPTERM3): {<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="caml/mlvalues.h.html#L57" title="ocaml/runtime/caml/mlvalues.h:57">value</a> arg1 = sp[<span class="Constant">0</span>];<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="caml/mlvalues.h.html#L57" title="ocaml/runtime/caml/mlvalues.h:57">value</a> arg2 = sp[<span class="Constant">1</span>];<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="caml/mlvalues.h.html#L57" title="ocaml/runtime/caml/mlvalues.h:57">value</a> arg3 = sp[<span class="Constant">2</span>];<br/></li>
<li>&nbsp; &nbsp; &nbsp; sp = sp + *pc - <span class="Constant">3</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; sp[<span class="Constant">0</span>] = arg1;<br/></li>
<li>&nbsp; &nbsp; &nbsp; sp[<span class="Constant">1</span>] = arg2;<br/></li>
<li>&nbsp; &nbsp; &nbsp; sp[<span class="Constant">2</span>] = arg3;<br/></li>
<li>&nbsp; &nbsp; &nbsp; pc = <a href="caml/mlvalues.h.html#L276" title="ocaml/runtime/caml/mlvalues.h:276">Code_val</a>(accu);<br/></li>
<li>&nbsp; &nbsp; &nbsp; env = accu;<br/></li>
<li>&nbsp; &nbsp; &nbsp; extra_args += <span class="Constant">2</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Statement">goto</span> check_stacks;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(RETURN): {<br/></li>
<li>&nbsp; &nbsp; &nbsp; sp += *pc++;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (extra_args &gt; <span class="Constant">0</span>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; extra_args--;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; pc = <a href="caml/mlvalues.h.html#L276" title="ocaml/runtime/caml/mlvalues.h:276">Code_val</a>(accu);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; env = accu;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; } <span class="Statement">else</span> {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">goto</span> do_return;<br/></li>
<li>&nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">do_return</span><span class="cUserCont">:<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (sp == <a href="caml/fiber.h.html#L69" title="ocaml/runtime/caml/fiber.h:69">Stack_high</a>(domain_state-&gt;current_stack)) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* return to parent stack */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Type">struct</span> <a href="caml/fiber.h.html#L43" title="ocaml/runtime/caml/fiber.h:43">stack_info</a>* old_stack = domain_state-&gt;current_stack;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Type">struct</span> <a href="caml/fiber.h.html#L43" title="ocaml/runtime/caml/fiber.h:43">stack_info</a>* parent_stack = <a href="caml/fiber.h.html#L74" title="ocaml/runtime/caml/fiber.h:74">Stack_parent</a>(old_stack);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="caml/mlvalues.h.html#L57" title="ocaml/runtime/caml/mlvalues.h:57">value</a> hval = <a href="caml/fiber.h.html#L71" title="ocaml/runtime/caml/fiber.h:71">Stack_handle_value</a>(old_stack);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="caml/misc.h.html#L247" title="ocaml/runtime/caml/misc.h:247">CAMLassert</a>(parent_stack != <span class="Constant"><a href="caml/misc.h.html#L71" title="ocaml/runtime/caml/misc.h:71">NULL</a></span>);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; domain_state-&gt;current_stack = parent_stack;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; sp = domain_state-&gt;current_stack-&gt;sp;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="fiber.c.html#L558" title="ocaml/runtime/fiber.c:558">caml_free_stack</a>(old_stack);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; domain_state-&gt;trap_sp_off = <a href="caml/mlvalues.h.html#L78" title="ocaml/runtime/caml/mlvalues.h:78">Long_val</a>(sp[<span class="Constant">0</span>]);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; extra_args = <a href="caml/mlvalues.h.html#L78" title="ocaml/runtime/caml/mlvalues.h:78">Long_val</a>(sp[<span class="Constant">1</span>]);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; sp++;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; sp[<span class="Constant">0</span>] = accu;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; accu = hval;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; pc = <a href="caml/mlvalues.h.html#L276" title="ocaml/runtime/caml/mlvalues.h:276">Code_val</a>(accu);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; env = accu;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">goto</span> check_stacks;<br/></li>
<li>&nbsp; &nbsp; &nbsp; } <span class="Statement">else</span> {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* return to callee, no stack switching */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; pc = (<a href="caml/mlvalues.h.html#L67" title="ocaml/runtime/caml/mlvalues.h:67">code_t</a>)(sp[<span class="Constant">0</span>]);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; env = sp[<span class="Constant">1</span>];<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; extra_args = <a href="caml/mlvalues.h.html#L78" title="ocaml/runtime/caml/mlvalues.h:78">Long_val</a>(sp[<span class="Constant">2</span>]);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; sp += <span class="Constant">3</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(RESTART): {<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Type">int</span> num_args = <a href="caml/mlvalues.h.html#L174" title="ocaml/runtime/caml/mlvalues.h:174">Wosize_val</a>(env) - <span class="Constant">3</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Type">int</span> i;<br/></li>
<li>&nbsp; &nbsp; &nbsp; sp -= num_args;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Statement">for</span> (i = <span class="Constant">0</span>; i &lt; num_args; i++) sp[i] = <a href="caml/mlvalues.h.html#L228" title="ocaml/runtime/caml/mlvalues.h:228">Field</a>(env, i + <span class="Constant">3</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; env = <a href="caml/mlvalues.h.html#L228" title="ocaml/runtime/caml/mlvalues.h:228">Field</a>(env, <span class="Constant">2</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; extra_args += num_args;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(GRAB): {<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Type">int</span> required = *pc++;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (extra_args &gt;= required) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; extra_args -= required;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; } <span class="Statement">else</span> {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="caml/mlvalues.h.html#L60" title="ocaml/runtime/caml/mlvalues.h:60">mlsize_t</a> num_args, i;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; num_args = <span class="Constant">1</span> + extra_args; <span class="Comment">/* arg1 + extra args */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <a href="caml/memory.h.html#L217" title="ocaml/runtime/caml/memory.h:217">Alloc_small</a>(accu, num_args + <span class="Constant">3</span>, <a href="caml/mlvalues.h.html#L275" title="ocaml/runtime/caml/mlvalues.h:275">Closure_tag</a>, <a href="#L80" title="ocaml/runtime/interp.c:80">Enter_gc</a>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="caml/mlvalues.h.html#L228" title="ocaml/runtime/caml/mlvalues.h:228">Field</a>(accu, <span class="Constant">2</span>) = env;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">for</span> (i = <span class="Constant">0</span>; i &lt; num_args; i++) <a href="caml/mlvalues.h.html#L228" title="ocaml/runtime/caml/mlvalues.h:228">Field</a>(accu, i + <span class="Constant">3</span>) = sp[i];<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="caml/mlvalues.h.html#L276" title="ocaml/runtime/caml/mlvalues.h:276">Code_val</a>(accu) = pc - <span class="Constant">3</span>; <span class="Comment">/* Point to the preceding RESTART instr. */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <a href="caml/mlvalues.h.html#L277" title="ocaml/runtime/caml/mlvalues.h:277">Closinfo_val</a>(accu) = <a href="caml/mlvalues.h.html#L286" title="ocaml/runtime/caml/mlvalues.h:286">Make_closinfo</a>(<span class="Constant">0</span>, <span class="Constant">2</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; sp += num_args;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">goto</span> do_return;<br/></li>
<li>&nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(CLOSURE): {<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Type">int</span> nvars = *pc++;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Type">int</span> i;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (nvars &gt; <span class="Constant">0</span>) *--sp = accu;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (nvars &lt;= <a href="caml/config.h.html#L221" title="ocaml/runtime/caml/config.h:221">Max_young_wosize</a> - <span class="Constant">2</span>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* nvars + 2 &lt;= <a href="caml/config.h.html#L221" title="ocaml/runtime/caml/config.h:221">Max_young_wosize</a>, can allocate in minor heap */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <a href="caml/memory.h.html#L217" title="ocaml/runtime/caml/memory.h:217">Alloc_small</a>(accu, <span class="Constant">2</span> + nvars, <a href="caml/mlvalues.h.html#L275" title="ocaml/runtime/caml/mlvalues.h:275">Closure_tag</a>, <a href="#L80" title="ocaml/runtime/interp.c:80">Enter_gc</a>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">for</span> (i = <span class="Constant">0</span>; i &lt; nvars; i++) <a href="caml/mlvalues.h.html#L228" title="ocaml/runtime/caml/mlvalues.h:228">Field</a>(accu, i + <span class="Constant">2</span>) = sp[i];<br/></li>
<li>&nbsp; &nbsp; &nbsp; } <span class="Statement">else</span> {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* PR#6385: must allocate in major heap */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* <a href="memory.c.html#L359" title="ocaml/runtime/memory.c:359">caml_alloc_shr</a> <a href="ints.c.html#L488" title="ocaml/runtime/ints.c:488">and</a> <a href="memory.c.html#L207" title="ocaml/runtime/memory.c:207">caml_initialize</a> never trigger a GC,<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; so no need to <a href="#L74" title="ocaml/runtime/interp.c:74">Setup_for_gc</a> */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; accu = <a href="memory.c.html#L359" title="ocaml/runtime/memory.c:359">caml_alloc_shr</a>(<span class="Constant">2</span> + nvars, <a href="caml/mlvalues.h.html#L275" title="ocaml/runtime/caml/mlvalues.h:275">Closure_tag</a>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">for</span> (i = <span class="Constant">0</span>; i &lt; nvars; i++) <a href="memory.c.html#L207" title="ocaml/runtime/memory.c:207">caml_initialize</a>(&amp;<a href="caml/mlvalues.h.html#L228" title="ocaml/runtime/caml/mlvalues.h:228">Field</a>(accu, i + <span class="Constant">2</span>), sp[i]);<br/></li>
<li>&nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Comment">/* The code pointer is not in the heap, so no need to go through<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <a href="memory.c.html#L207" title="ocaml/runtime/memory.c:207">caml_initialize</a>. */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <a href="caml/mlvalues.h.html#L276" title="ocaml/runtime/caml/mlvalues.h:276">Code_val</a>(accu) = pc + *pc;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="caml/mlvalues.h.html#L277" title="ocaml/runtime/caml/mlvalues.h:277">Closinfo_val</a>(accu) = <a href="caml/mlvalues.h.html#L286" title="ocaml/runtime/caml/mlvalues.h:286">Make_closinfo</a>(<span class="Constant">0</span>, <span class="Constant">2</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; pc++;<br/></li>
<li>&nbsp; &nbsp; &nbsp; sp += nvars;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(CLOSUREREC): {<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Type">int</span> nfuncs = *pc++;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Type">int</span> nvars = *pc++;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="caml/mlvalues.h.html#L60" title="ocaml/runtime/caml/mlvalues.h:60">mlsize_t</a> envofs = nfuncs * <span class="Constant">3</span> - <span class="Constant">1</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="caml/mlvalues.h.html#L60" title="ocaml/runtime/caml/mlvalues.h:60">mlsize_t</a> blksize = envofs + nvars;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Type">int</span> i;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Type">volatile</span> <a href="caml/mlvalues.h.html#L57" title="ocaml/runtime/caml/mlvalues.h:57">value</a> * p;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (nvars &gt; <span class="Constant">0</span>) *--sp = accu;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (blksize &lt;= <a href="caml/config.h.html#L221" title="ocaml/runtime/caml/config.h:221">Max_young_wosize</a>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="caml/memory.h.html#L217" title="ocaml/runtime/caml/memory.h:217">Alloc_small</a>(accu, blksize, <a href="caml/mlvalues.h.html#L275" title="ocaml/runtime/caml/mlvalues.h:275">Closure_tag</a>, <a href="#L80" title="ocaml/runtime/interp.c:80">Enter_gc</a>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; p = &amp;<a href="caml/mlvalues.h.html#L228" title="ocaml/runtime/caml/mlvalues.h:228">Field</a>(accu, envofs);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">for</span> (i = <span class="Constant">0</span>; i &lt; nvars; i++, p++) *p = sp[i];<br/></li>
<li>&nbsp; &nbsp; &nbsp; } <span class="Statement">else</span> {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* PR#6385: must allocate in major heap */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* <a href="memory.c.html#L359" title="ocaml/runtime/memory.c:359">caml_alloc_shr</a> <a href="ints.c.html#L488" title="ocaml/runtime/ints.c:488">and</a> <a href="memory.c.html#L207" title="ocaml/runtime/memory.c:207">caml_initialize</a> never trigger a GC,<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; so no need to <a href="#L74" title="ocaml/runtime/interp.c:74">Setup_for_gc</a> */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; accu = <a href="memory.c.html#L359" title="ocaml/runtime/memory.c:359">caml_alloc_shr</a>(blksize, <a href="caml/mlvalues.h.html#L275" title="ocaml/runtime/caml/mlvalues.h:275">Closure_tag</a>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; p = &amp;<a href="caml/mlvalues.h.html#L228" title="ocaml/runtime/caml/mlvalues.h:228">Field</a>(accu, envofs);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">for</span> (i = <span class="Constant">0</span>; i &lt; nvars; i++, p++) <a href="memory.c.html#L207" title="ocaml/runtime/memory.c:207">caml_initialize</a>(p, sp[i]);<br/></li>
<li>&nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; sp += nvars;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Comment">/* The code pointers <a href="ints.c.html#L488" title="ocaml/runtime/ints.c:488">and</a> infix headers are not in the heap,<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; so no need to go through <a href="memory.c.html#L207" title="ocaml/runtime/memory.c:207">caml_initialize</a>. */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; *--sp = accu;<br/></li>
<li>&nbsp; &nbsp; &nbsp; p = &amp;<a href="caml/mlvalues.h.html#L228" title="ocaml/runtime/caml/mlvalues.h:228">Field</a>(accu, <span class="Constant">0</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; *p++ = (<a href="caml/mlvalues.h.html#L57" title="ocaml/runtime/caml/mlvalues.h:57">value</a>) (pc + pc[<span class="Constant">0</span>]);<br/></li>
<li>&nbsp; &nbsp; &nbsp; *p++ = <a href="caml/mlvalues.h.html#L286" title="ocaml/runtime/caml/mlvalues.h:286">Make_closinfo</a>(<span class="Constant">0</span>, envofs);<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Statement">for</span> (i = <span class="Constant">1</span>; i &lt; nfuncs; i++) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; *p++ = <a href="caml/gc.h.html#L32" title="ocaml/runtime/caml/gc.h:32">Make_header</a>(i * <span class="Constant">3</span>, <a href="caml/mlvalues.h.html#L248" title="ocaml/runtime/caml/mlvalues.h:248">Infix_tag</a>, <span class="Constant">0</span>); <span class="Comment">/* color irrelevant */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; *--sp = (<a href="caml/mlvalues.h.html#L57" title="ocaml/runtime/caml/mlvalues.h:57">value</a>) p;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; *p++ = (<a href="caml/mlvalues.h.html#L57" title="ocaml/runtime/caml/mlvalues.h:57">value</a>) (pc + pc[i]);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; envofs -= <span class="Constant">3</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; *p++ = <a href="caml/mlvalues.h.html#L286" title="ocaml/runtime/caml/mlvalues.h:286">Make_closinfo</a>(<span class="Constant">0</span>, envofs);<br/></li>
<li>&nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; pc += nfuncs;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(PUSHOFFSETCLOSURE):<br/></li>
<li>&nbsp; &nbsp; &nbsp; *--sp = accu; <span class="Comment">/* fallthrough */<br/></li>
<li></span>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(OFFSETCLOSURE):<br/></li>
<li>&nbsp; &nbsp; &nbsp; accu = env + *pc++ * <span class="Statement"><a href="caml/fiber.h.html#L65" title="ocaml/runtime/caml/fiber.h:65">sizeof</a></span>(<a href="caml/mlvalues.h.html#L57" title="ocaml/runtime/caml/mlvalues.h:57">value</a>); <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(PUSHOFFSETCLOSUREM3):<br/></li>
<li>&nbsp; &nbsp; &nbsp; *--sp = accu; <span class="Comment">/* fallthrough */<br/></li>
<li></span>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(OFFSETCLOSUREM3):<br/></li>
<li>&nbsp; &nbsp; &nbsp; accu = env - <span class="Constant">3</span> * <span class="Statement"><a href="caml/fiber.h.html#L65" title="ocaml/runtime/caml/fiber.h:65">sizeof</a></span>(<a href="caml/mlvalues.h.html#L57" title="ocaml/runtime/caml/mlvalues.h:57">value</a>); <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(PUSHOFFSETCLOSURE0):<br/></li>
<li>&nbsp; &nbsp; &nbsp; *--sp = accu; <span class="Comment">/* fallthrough */<br/></li>
<li></span>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(OFFSETCLOSURE0):<br/></li>
<li>&nbsp; &nbsp; &nbsp; accu = env; <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(PUSHOFFSETCLOSURE3):<br/></li>
<li>&nbsp; &nbsp; &nbsp; *--sp = accu; <span class="Comment">/* fallthrough */<br/></li>
<li></span>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(OFFSETCLOSURE3):<br/></li>
<li>&nbsp; &nbsp; &nbsp; accu = env + <span class="Constant">3</span> * <span class="Statement"><a href="caml/fiber.h.html#L65" title="ocaml/runtime/caml/fiber.h:65">sizeof</a></span>(<a href="caml/mlvalues.h.html#L57" title="ocaml/runtime/caml/mlvalues.h:57">value</a>); <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li><br/></li>
<li><br/></li>
<li><span class="Comment">/* Access to global variables */<br/></li>
<li></span><br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(PUSHGETGLOBAL):<br/></li>
<li>&nbsp; &nbsp; &nbsp; *--sp = accu;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Comment">/* Fallthrough */<br/></li>
<li></span>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(GETGLOBAL):<br/></li>
<li>&nbsp; &nbsp; &nbsp; accu = <a href="caml/mlvalues.h.html#L228" title="ocaml/runtime/caml/mlvalues.h:228">Field</a>(<a href="fiber.c.html#L316" title="ocaml/runtime/fiber.c:316">caml_global_data</a>, *pc);<br/></li>
<li>&nbsp; &nbsp; &nbsp; pc++;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(PUSHGETGLOBALFIELD):<br/></li>
<li>&nbsp; &nbsp; &nbsp; *--sp = accu;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Comment">/* Fallthrough */<br/></li>
<li></span>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(GETGLOBALFIELD): {<br/></li>
<li>&nbsp; &nbsp; &nbsp; accu = <a href="caml/mlvalues.h.html#L228" title="ocaml/runtime/caml/mlvalues.h:228">Field</a>(<a href="fiber.c.html#L316" title="ocaml/runtime/fiber.c:316">caml_global_data</a>, *pc);<br/></li>
<li>&nbsp; &nbsp; &nbsp; pc++;<br/></li>
<li>&nbsp; &nbsp; &nbsp; accu = <a href="caml/mlvalues.h.html#L228" title="ocaml/runtime/caml/mlvalues.h:228">Field</a>(accu, *pc);<br/></li>
<li>&nbsp; &nbsp; &nbsp; pc++;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(SETGLOBAL):&nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="memory.c.html#L149" title="ocaml/runtime/memory.c:149">caml_modify</a>(&amp;<a href="caml/mlvalues.h.html#L228" title="ocaml/runtime/caml/mlvalues.h:228">Field</a>(<a href="fiber.c.html#L316" title="ocaml/runtime/fiber.c:316">caml_global_data</a>, *pc), accu);<br/></li>
<li>&nbsp; &nbsp; &nbsp; accu = <a href="caml/mlvalues.h.html#L431" title="ocaml/runtime/caml/mlvalues.h:431">Val_unit</a>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; pc++;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li><span class="Comment">/* Allocation of blocks */<br/></li>
<li></span><br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(PUSHATOM0):<br/></li>
<li>&nbsp; &nbsp; &nbsp; *--sp = accu;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Comment">/* Fallthrough */<br/></li>
<li></span>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(ATOM0):<br/></li>
<li>&nbsp; &nbsp; &nbsp; accu = <a href="caml/mlvalues.h.html#L419" title="ocaml/runtime/caml/mlvalues.h:419">Atom</a>(<span class="Constant">0</span>); <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(PUSHATOM):<br/></li>
<li>&nbsp; &nbsp; &nbsp; *--sp = accu;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Comment">/* Fallthrough */<br/></li>
<li></span>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(<a href="debugger.c.html#L69" title="ocaml/runtime/debugger.c:69">ATOM</a>):<br/></li>
<li>&nbsp; &nbsp; &nbsp; accu = <a href="caml/mlvalues.h.html#L419" title="ocaml/runtime/caml/mlvalues.h:419">Atom</a>(*pc++); <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(MAKEBLOCK): {<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="caml/mlvalues.h.html#L60" title="ocaml/runtime/caml/mlvalues.h:60">mlsize_t</a> wosize = *pc++;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="caml/mlvalues.h.html#L61" title="ocaml/runtime/caml/mlvalues.h:61">tag_t</a> tag = *pc++;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="caml/mlvalues.h.html#L60" title="ocaml/runtime/caml/mlvalues.h:60">mlsize_t</a> i;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="caml/mlvalues.h.html#L57" title="ocaml/runtime/caml/mlvalues.h:57">value</a> block;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (wosize &lt;= <a href="caml/config.h.html#L221" title="ocaml/runtime/caml/config.h:221">Max_young_wosize</a>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="caml/memory.h.html#L217" title="ocaml/runtime/caml/memory.h:217">Alloc_small</a>(block, wosize, tag, <a href="#L80" title="ocaml/runtime/interp.c:80">Enter_gc</a>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="caml/mlvalues.h.html#L228" title="ocaml/runtime/caml/mlvalues.h:228">Field</a>(block, <span class="Constant">0</span>) = accu;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">for</span> (i = <span class="Constant">1</span>; i &lt; wosize; i++) <a href="caml/mlvalues.h.html#L228" title="ocaml/runtime/caml/mlvalues.h:228">Field</a>(block, i) = *sp++;<br/></li>
<li>&nbsp; &nbsp; &nbsp; } <span class="Statement">else</span> {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; block = <a href="memory.c.html#L359" title="ocaml/runtime/memory.c:359">caml_alloc_shr</a>(wosize, tag);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="memory.c.html#L207" title="ocaml/runtime/memory.c:207">caml_initialize</a>(&amp;<a href="caml/mlvalues.h.html#L228" title="ocaml/runtime/caml/mlvalues.h:228">Field</a>(block, <span class="Constant">0</span>), accu);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">for</span> (i = <span class="Constant">1</span>; i &lt; wosize; i++) <a href="memory.c.html#L207" title="ocaml/runtime/memory.c:207">caml_initialize</a>(&amp;<a href="caml/mlvalues.h.html#L228" title="ocaml/runtime/caml/mlvalues.h:228">Field</a>(block, i), *sp++);<br/></li>
<li>&nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; accu = block;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(MAKEBLOCK1): {<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="caml/mlvalues.h.html#L61" title="ocaml/runtime/caml/mlvalues.h:61">tag_t</a> tag = *pc++;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="caml/mlvalues.h.html#L57" title="ocaml/runtime/caml/mlvalues.h:57">value</a> block;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="caml/memory.h.html#L217" title="ocaml/runtime/caml/memory.h:217">Alloc_small</a>(block, <span class="Constant">1</span>, tag, <a href="#L80" title="ocaml/runtime/interp.c:80">Enter_gc</a>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="caml/mlvalues.h.html#L228" title="ocaml/runtime/caml/mlvalues.h:228">Field</a>(block, <span class="Constant">0</span>) = accu;<br/></li>
<li>&nbsp; &nbsp; &nbsp; accu = block;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(MAKEBLOCK2): {<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="caml/mlvalues.h.html#L61" title="ocaml/runtime/caml/mlvalues.h:61">tag_t</a> tag = *pc++;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="caml/mlvalues.h.html#L57" title="ocaml/runtime/caml/mlvalues.h:57">value</a> block;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="caml/memory.h.html#L217" title="ocaml/runtime/caml/memory.h:217">Alloc_small</a>(block, <span class="Constant">2</span>, tag, <a href="#L80" title="ocaml/runtime/interp.c:80">Enter_gc</a>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="caml/mlvalues.h.html#L228" title="ocaml/runtime/caml/mlvalues.h:228">Field</a>(block, <span class="Constant">0</span>) = accu;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="caml/mlvalues.h.html#L228" title="ocaml/runtime/caml/mlvalues.h:228">Field</a>(block, <span class="Constant">1</span>) = sp[<span class="Constant">0</span>];<br/></li>
<li>&nbsp; &nbsp; &nbsp; sp += <span class="Constant">1</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; accu = block;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(MAKEBLOCK3): {<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="caml/mlvalues.h.html#L61" title="ocaml/runtime/caml/mlvalues.h:61">tag_t</a> tag = *pc++;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="caml/mlvalues.h.html#L57" title="ocaml/runtime/caml/mlvalues.h:57">value</a> block;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="caml/memory.h.html#L217" title="ocaml/runtime/caml/memory.h:217">Alloc_small</a>(block, <span class="Constant">3</span>, tag, <a href="#L80" title="ocaml/runtime/interp.c:80">Enter_gc</a>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="caml/mlvalues.h.html#L228" title="ocaml/runtime/caml/mlvalues.h:228">Field</a>(block, <span class="Constant">0</span>) = accu;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="caml/mlvalues.h.html#L228" title="ocaml/runtime/caml/mlvalues.h:228">Field</a>(block, <span class="Constant">1</span>) = sp[<span class="Constant">0</span>];<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="caml/mlvalues.h.html#L228" title="ocaml/runtime/caml/mlvalues.h:228">Field</a>(block, <span class="Constant">2</span>) = sp[<span class="Constant">1</span>];<br/></li>
<li>&nbsp; &nbsp; &nbsp; sp += <span class="Constant">2</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; accu = block;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(MAKEFLOATBLOCK): {<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="caml/mlvalues.h.html#L60" title="ocaml/runtime/caml/mlvalues.h:60">mlsize_t</a> size = *pc++;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="caml/mlvalues.h.html#L60" title="ocaml/runtime/caml/mlvalues.h:60">mlsize_t</a> i;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="caml/mlvalues.h.html#L57" title="ocaml/runtime/caml/mlvalues.h:57">value</a> block;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (size &lt;= <a href="caml/config.h.html#L221" title="ocaml/runtime/caml/config.h:221">Max_young_wosize</a> / <a href="caml/mlvalues.h.html#L337" title="ocaml/runtime/caml/mlvalues.h:337">Double_wosize</a>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="caml/memory.h.html#L217" title="ocaml/runtime/caml/memory.h:217">Alloc_small</a>(block, size * <a href="caml/mlvalues.h.html#L337" title="ocaml/runtime/caml/mlvalues.h:337">Double_wosize</a>, <a href="caml/mlvalues.h.html#L349" title="ocaml/runtime/caml/mlvalues.h:349">Double_array_tag</a>, <a href="#L80" title="ocaml/runtime/interp.c:80">Enter_gc</a>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; } <span class="Statement">else</span> {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; block = <a href="memory.c.html#L359" title="ocaml/runtime/memory.c:359">caml_alloc_shr</a>(size * <a href="caml/mlvalues.h.html#L337" title="ocaml/runtime/caml/mlvalues.h:337">Double_wosize</a>, <a href="caml/mlvalues.h.html#L349" title="ocaml/runtime/caml/mlvalues.h:349">Double_array_tag</a>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="caml/mlvalues.h.html#L354" title="ocaml/runtime/caml/mlvalues.h:354">Store_double_flat_field</a>(block, <span class="Constant">0</span>, <a href="caml/mlvalues.h.html#L339" title="ocaml/runtime/caml/mlvalues.h:339">Double_val</a>(accu));<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Statement">for</span> (i = <span class="Constant">1</span>; i &lt; size; i++){<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="caml/mlvalues.h.html#L354" title="ocaml/runtime/caml/mlvalues.h:354">Store_double_flat_field</a>(block, i, <a href="caml/mlvalues.h.html#L339" title="ocaml/runtime/caml/mlvalues.h:339">Double_val</a>(*sp));<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; ++ sp;<br/></li>
<li>&nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; accu = block;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li><span class="Comment">/* Access to components of blocks */<br/></li>
<li></span><br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(GETFIELD0):<br/></li>
<li>&nbsp; &nbsp; &nbsp; accu = <a href="caml/mlvalues.h.html#L228" title="ocaml/runtime/caml/mlvalues.h:228">Field</a>(accu, <span class="Constant">0</span>); <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(GETFIELD1):<br/></li>
<li>&nbsp; &nbsp; &nbsp; accu = <a href="caml/mlvalues.h.html#L228" title="ocaml/runtime/caml/mlvalues.h:228">Field</a>(accu, <span class="Constant">1</span>); <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(GETFIELD2):<br/></li>
<li>&nbsp; &nbsp; &nbsp; accu = <a href="caml/mlvalues.h.html#L228" title="ocaml/runtime/caml/mlvalues.h:228">Field</a>(accu, <span class="Constant">2</span>); <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(GETFIELD3):<br/></li>
<li>&nbsp; &nbsp; &nbsp; accu = <a href="caml/mlvalues.h.html#L228" title="ocaml/runtime/caml/mlvalues.h:228">Field</a>(accu, <span class="Constant">3</span>); <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(GETFIELD):<br/></li>
<li>&nbsp; &nbsp; &nbsp; accu = <a href="caml/mlvalues.h.html#L228" title="ocaml/runtime/caml/mlvalues.h:228">Field</a>(accu, *pc); pc++; <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(GETFLOATFIELD): {<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Type">double</span> d = <a href="caml/mlvalues.h.html#L353" title="ocaml/runtime/caml/mlvalues.h:353">Double_flat_field</a>(accu, *pc++);<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="caml/memory.h.html#L217" title="ocaml/runtime/caml/memory.h:217">Alloc_small</a>(accu, <a href="caml/mlvalues.h.html#L337" title="ocaml/runtime/caml/mlvalues.h:337">Double_wosize</a>, <a href="caml/mlvalues.h.html#L336" title="ocaml/runtime/caml/mlvalues.h:336">Double_tag</a>, <a href="#L80" title="ocaml/runtime/interp.c:80">Enter_gc</a>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="caml/mlvalues.h.html#L340" title="ocaml/runtime/caml/mlvalues.h:340">Store_double_val</a>(accu, d);<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(SETFIELD0):<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="memory.c.html#L149" title="ocaml/runtime/memory.c:149">caml_modify</a>(&amp;<a href="caml/mlvalues.h.html#L228" title="ocaml/runtime/caml/mlvalues.h:228">Field</a>(accu, <span class="Constant">0</span>), *sp++);<br/></li>
<li>&nbsp; &nbsp; &nbsp; accu = <a href="caml/mlvalues.h.html#L431" title="ocaml/runtime/caml/mlvalues.h:431">Val_unit</a>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(SETFIELD1):<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="memory.c.html#L149" title="ocaml/runtime/memory.c:149">caml_modify</a>(&amp;<a href="caml/mlvalues.h.html#L228" title="ocaml/runtime/caml/mlvalues.h:228">Field</a>(accu, <span class="Constant">1</span>), *sp++);<br/></li>
<li>&nbsp; &nbsp; &nbsp; accu = <a href="caml/mlvalues.h.html#L431" title="ocaml/runtime/caml/mlvalues.h:431">Val_unit</a>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(SETFIELD2):<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="memory.c.html#L149" title="ocaml/runtime/memory.c:149">caml_modify</a>(&amp;<a href="caml/mlvalues.h.html#L228" title="ocaml/runtime/caml/mlvalues.h:228">Field</a>(accu, <span class="Constant">2</span>), *sp++);<br/></li>
<li>&nbsp; &nbsp; &nbsp; accu = <a href="caml/mlvalues.h.html#L431" title="ocaml/runtime/caml/mlvalues.h:431">Val_unit</a>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(SETFIELD3):<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="memory.c.html#L149" title="ocaml/runtime/memory.c:149">caml_modify</a>(&amp;<a href="caml/mlvalues.h.html#L228" title="ocaml/runtime/caml/mlvalues.h:228">Field</a>(accu, <span class="Constant">3</span>), *sp++);<br/></li>
<li>&nbsp; &nbsp; &nbsp; accu = <a href="caml/mlvalues.h.html#L431" title="ocaml/runtime/caml/mlvalues.h:431">Val_unit</a>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(SETFIELD):<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="memory.c.html#L149" title="ocaml/runtime/memory.c:149">caml_modify</a>(&amp;<a href="caml/mlvalues.h.html#L228" title="ocaml/runtime/caml/mlvalues.h:228">Field</a>(accu, *pc), *sp++);<br/></li>
<li>&nbsp; &nbsp; &nbsp; accu = <a href="caml/mlvalues.h.html#L431" title="ocaml/runtime/caml/mlvalues.h:431">Val_unit</a>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; pc++;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(SETFLOATFIELD):<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="caml/mlvalues.h.html#L354" title="ocaml/runtime/caml/mlvalues.h:354">Store_double_flat_field</a>(accu, *pc, <a href="caml/mlvalues.h.html#L339" title="ocaml/runtime/caml/mlvalues.h:339">Double_val</a>(*sp));<br/></li>
<li>&nbsp; &nbsp; &nbsp; accu = <a href="caml/mlvalues.h.html#L431" title="ocaml/runtime/caml/mlvalues.h:431">Val_unit</a>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; sp++;<br/></li>
<li>&nbsp; &nbsp; &nbsp; pc++;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li><br/></li>
<li><span class="Comment">/* Array operations */<br/></li>
<li></span><br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(VECTLENGTH): {<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Comment">/* Todo: when FLAT_FLOAT_ARRAY is false, this instruction should<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; be split into VECTLENGTH <a href="ints.c.html#L488" title="ocaml/runtime/ints.c:488">and</a> FLOATVECTLENGTH because we know<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; statically which one it is. */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <a href="caml/mlvalues.h.html#L60" title="ocaml/runtime/caml/mlvalues.h:60">mlsize_t</a> size = <a href="caml/mlvalues.h.html#L174" title="ocaml/runtime/caml/mlvalues.h:174">Wosize_val</a>(accu);<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (<a href="caml/mlvalues.h.html#L199" title="ocaml/runtime/caml/mlvalues.h:199">Tag_val</a>(accu) == <a href="caml/mlvalues.h.html#L349" title="ocaml/runtime/caml/mlvalues.h:349">Double_array_tag</a>) size = size / <a href="caml/mlvalues.h.html#L337" title="ocaml/runtime/caml/mlvalues.h:337">Double_wosize</a>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; accu = <a href="caml/mlvalues.h.html#L77" title="ocaml/runtime/caml/mlvalues.h:77">Val_long</a>(size);<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(GETVECTITEM):<br/></li>
<li>&nbsp; &nbsp; &nbsp; accu = <a href="caml/mlvalues.h.html#L228" title="ocaml/runtime/caml/mlvalues.h:228">Field</a>(accu, <a href="caml/mlvalues.h.html#L78" title="ocaml/runtime/caml/mlvalues.h:78">Long_val</a>(sp[<span class="Constant">0</span>]));<br/></li>
<li>&nbsp; &nbsp; &nbsp; sp += <span class="Constant">1</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(SETVECTITEM):<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="memory.c.html#L149" title="ocaml/runtime/memory.c:149">caml_modify</a>(&amp;<a href="caml/mlvalues.h.html#L228" title="ocaml/runtime/caml/mlvalues.h:228">Field</a>(accu, <a href="caml/mlvalues.h.html#L78" title="ocaml/runtime/caml/mlvalues.h:78">Long_val</a>(sp[<span class="Constant">0</span>])), sp[<span class="Constant">1</span>]);<br/></li>
<li>&nbsp; &nbsp; &nbsp; accu = <a href="caml/mlvalues.h.html#L431" title="ocaml/runtime/caml/mlvalues.h:431">Val_unit</a>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; sp += <span class="Constant">2</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li><br/></li>
<li><span class="Comment">/* Bytes/String operations */<br/></li>
<li></span>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(GETSTRINGCHAR):<br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(GETBYTESCHAR):<br/></li>
<li>&nbsp; &nbsp; &nbsp; accu = <a href="caml/mlvalues.h.html#L81" title="ocaml/runtime/caml/mlvalues.h:81">Val_int</a>(<a href="caml/mlvalues.h.html#L316" title="ocaml/runtime/caml/mlvalues.h:316">Byte_u</a>(accu, <a href="caml/mlvalues.h.html#L78" title="ocaml/runtime/caml/mlvalues.h:78">Long_val</a>(sp[<span class="Constant">0</span>])));<br/></li>
<li>&nbsp; &nbsp; &nbsp; sp += <span class="Constant">1</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(SETBYTESCHAR):<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="caml/mlvalues.h.html#L316" title="ocaml/runtime/caml/mlvalues.h:316">Byte_u</a>(accu, <a href="caml/mlvalues.h.html#L78" title="ocaml/runtime/caml/mlvalues.h:78">Long_val</a>(sp[<span class="Constant">0</span>])) = <a href="caml/mlvalues.h.html#L82" title="ocaml/runtime/caml/mlvalues.h:82">Int_val</a>(sp[<span class="Constant">1</span>]);<br/></li>
<li>&nbsp; &nbsp; &nbsp; sp += <span class="Constant">2</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; accu = <a href="caml/mlvalues.h.html#L431" title="ocaml/runtime/caml/mlvalues.h:431">Val_unit</a>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li><br/></li>
<li><span class="Comment">/* Branches <a href="ints.c.html#L488" title="ocaml/runtime/ints.c:488">and</a> conditional branches */<br/></li>
<li></span><br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(BRANCH):<br/></li>
<li>&nbsp; &nbsp; &nbsp; pc += *pc;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(BRANCHIF):<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (accu != <a href="caml/mlvalues.h.html#L425" title="ocaml/runtime/caml/mlvalues.h:425">Val_false</a>) pc += *pc; <span class="Statement">else</span> pc++;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(BRANCHIFNOT):<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (accu == <a href="caml/mlvalues.h.html#L425" title="ocaml/runtime/caml/mlvalues.h:425">Val_false</a>) pc += *pc; <span class="Statement">else</span> pc++;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(SWITCH): {<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Type"><a href="caml/config.h.html#L126" title="ocaml/runtime/caml/config.h:126">uint32_t</a></span> sizes = *pc++;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (<a href="caml/mlvalues.h.html#L73" title="ocaml/runtime/caml/mlvalues.h:73">Is_block</a>(accu)) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="caml/config.h.html#L140" title="ocaml/runtime/caml/config.h:140">intnat</a> index = <a href="caml/mlvalues.h.html#L199" title="ocaml/runtime/caml/mlvalues.h:199">Tag_val</a>(accu);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="caml/misc.h.html#L247" title="ocaml/runtime/caml/misc.h:247">CAMLassert</a> ((<a href="caml/config.h.html#L141" title="ocaml/runtime/caml/config.h:141">uintnat</a>) index &lt; (sizes &gt;&gt; <span class="Constant">16</span>));<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; pc += pc[(sizes &amp; <span class="Constant">0xFFFF</span>) + index];<br/></li>
<li>&nbsp; &nbsp; &nbsp; } <span class="Statement">else</span> {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="caml/config.h.html#L140" title="ocaml/runtime/caml/config.h:140">intnat</a> index = <a href="caml/mlvalues.h.html#L78" title="ocaml/runtime/caml/mlvalues.h:78">Long_val</a>(accu);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="caml/misc.h.html#L247" title="ocaml/runtime/caml/misc.h:247">CAMLassert</a> ((<a href="caml/config.h.html#L141" title="ocaml/runtime/caml/config.h:141">uintnat</a>) index &lt; (sizes &amp; <span class="Constant">0xFFFF</span>)) ;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; pc += pc[index];<br/></li>
<li>&nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(BOOLNOT):<br/></li>
<li>&nbsp; &nbsp; &nbsp; accu = <a href="caml/mlvalues.h.html#L427" title="ocaml/runtime/caml/mlvalues.h:427">Val_not</a>(accu);<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li><br/></li>
<li><span class="Comment">/* Exceptions */<br/></li>
<li></span><br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(PUSHTRAP):<br/></li>
<li>&nbsp; &nbsp; &nbsp; sp -= <span class="Constant">4</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="caml/fiber.h.html#L242" title="ocaml/runtime/caml/fiber.h:242">Trap_pc</a>(sp) = pc + *pc;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="caml/fiber.h.html#L243" title="ocaml/runtime/caml/fiber.h:243">Trap_link</a>(sp) = <a href="caml/mlvalues.h.html#L77" title="ocaml/runtime/caml/mlvalues.h:77">Val_long</a>(domain_state-&gt;trap_sp_off);<br/></li>
<li>&nbsp; &nbsp; &nbsp; sp[<span class="Constant">2</span>] = env;<br/></li>
<li>&nbsp; &nbsp; &nbsp; sp[<span class="Constant">3</span>] = <a href="caml/mlvalues.h.html#L77" title="ocaml/runtime/caml/mlvalues.h:77">Val_long</a>(extra_args);<br/></li>
<li>&nbsp; &nbsp; &nbsp; domain_state-&gt;trap_sp_off = sp - <a href="caml/fiber.h.html#L69" title="ocaml/runtime/caml/fiber.h:69">Stack_high</a>(domain_state-&gt;current_stack);<br/></li>
<li>&nbsp; &nbsp; &nbsp; pc++;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(POPTRAP):<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (<a href="caml/domain.h.html#L54" title="ocaml/runtime/caml/domain.h:54">Caml_check_gc_interrupt</a>(domain_state)) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* We must check here so that if a signal is pending <a href="ints.c.html#L488" title="ocaml/runtime/ints.c:488">and</a> its<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; handler triggers an exception, the exception is trapped<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; by the current try...with, not the enclosing one. */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; pc--; <span class="Comment">/* restart the POPTRAP after processing the signal */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">goto</span> process_signal;<br/></li>
<li>&nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; domain_state-&gt;trap_sp_off = <a href="caml/mlvalues.h.html#L78" title="ocaml/runtime/caml/mlvalues.h:78">Long_val</a>(<a href="caml/fiber.h.html#L243" title="ocaml/runtime/caml/fiber.h:243">Trap_link</a>(sp));<br/></li>
<li>&nbsp; &nbsp; &nbsp; sp += <span class="Constant">4</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(RAISE_NOTRACE):<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="#L136" title="ocaml/runtime/interp.c:136">check_trap_barrier_for_exception</a> (domain_state);<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Statement">goto</span> raise_notrace;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(RERAISE):<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="#L136" title="ocaml/runtime/interp.c:136">check_trap_barrier_for_exception</a> (domain_state);<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (domain_state-&gt;backtrace_active) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; *--sp = (<a href="caml/mlvalues.h.html#L57" title="ocaml/runtime/caml/mlvalues.h:57">value</a>)(pc - <span class="Constant">1</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="backtrace_nat.c.html#L91" title="ocaml/runtime/backtrace_nat.c:91">caml_stash_backtrace</a>(accu, sp, <span class="Constant">1</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Statement">goto</span> raise_notrace;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(RAISE):<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">raise_exception</span><span class="cUserCont">:<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <a href="#L136" title="ocaml/runtime/interp.c:136">check_trap_barrier_for_exception</a> (domain_state);<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (domain_state-&gt;backtrace_active) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; *--sp = (<a href="caml/mlvalues.h.html#L57" title="ocaml/runtime/caml/mlvalues.h:57">value</a>)(pc - <span class="Constant">1</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="backtrace_nat.c.html#L91" title="ocaml/runtime/backtrace_nat.c:91">caml_stash_backtrace</a>(accu, sp, <span class="Constant">0</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">raise_notrace</span><span class="cUserCont">:<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (domain_state-&gt;trap_sp_off &gt; <span class="Constant">0</span>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (<a href="caml/fiber.h.html#L74" title="ocaml/runtime/caml/fiber.h:74">Stack_parent</a>(domain_state-&gt;current_stack) == <span class="Constant"><a href="caml/misc.h.html#L71" title="ocaml/runtime/caml/misc.h:71">NULL</a></span>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; domain_state-&gt;external_raise = initial_external_raise;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; domain_state-&gt;trap_sp_off = initial_trap_sp_off;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; domain_state-&gt;current_stack-&gt;sp =<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="caml/fiber.h.html#L69" title="ocaml/runtime/caml/fiber.h:69">Stack_high</a>(domain_state-&gt;current_stack) - initial_stack_words ;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span> <a href="caml/mlvalues.h.html#L89" title="ocaml/runtime/caml/mlvalues.h:89">Make_exception_result</a>(accu);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; } <span class="Statement">else</span> {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Type">struct</span> <a href="caml/fiber.h.html#L43" title="ocaml/runtime/caml/fiber.h:43">stack_info</a>* old_stack = domain_state-&gt;current_stack;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Type">struct</span> <a href="caml/fiber.h.html#L43" title="ocaml/runtime/caml/fiber.h:43">stack_info</a>* parent_stack = <a href="caml/fiber.h.html#L74" title="ocaml/runtime/caml/fiber.h:74">Stack_parent</a>(old_stack);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="caml/mlvalues.h.html#L57" title="ocaml/runtime/caml/mlvalues.h:57">value</a> hexn = <a href="caml/fiber.h.html#L72" title="ocaml/runtime/caml/fiber.h:72">Stack_handle_exception</a>(old_stack);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; old_stack-&gt;sp = sp;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; domain_state-&gt;current_stack = parent_stack;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sp = domain_state-&gt;current_stack-&gt;sp;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="fiber.c.html#L558" title="ocaml/runtime/fiber.c:558">caml_free_stack</a>(old_stack);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; domain_state-&gt;trap_sp_off = <a href="caml/mlvalues.h.html#L78" title="ocaml/runtime/caml/mlvalues.h:78">Long_val</a>(sp[<span class="Constant">0</span>]);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; extra_args = <a href="caml/mlvalues.h.html#L78" title="ocaml/runtime/caml/mlvalues.h:78">Long_val</a>(sp[<span class="Constant">1</span>]);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sp++;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sp[<span class="Constant">0</span>] = accu;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; accu = hexn;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pc = <a href="caml/mlvalues.h.html#L276" title="ocaml/runtime/caml/mlvalues.h:276">Code_val</a>(accu);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; env = accu;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">goto</span> check_stacks;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; } <span class="Statement">else</span> {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; sp =<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <a href="caml/fiber.h.html#L69" title="ocaml/runtime/caml/fiber.h:69">Stack_high</a>(domain_state-&gt;current_stack) + domain_state-&gt;trap_sp_off;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; pc = <a href="caml/fiber.h.html#L242" title="ocaml/runtime/caml/fiber.h:242">Trap_pc</a>(sp);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; domain_state-&gt;trap_sp_off = <a href="caml/mlvalues.h.html#L78" title="ocaml/runtime/caml/mlvalues.h:78">Long_val</a>(<a href="caml/fiber.h.html#L243" title="ocaml/runtime/caml/fiber.h:243">Trap_link</a>(sp));<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; env = sp[<span class="Constant">2</span>];<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; extra_args = <a href="caml/mlvalues.h.html#L78" title="ocaml/runtime/caml/mlvalues.h:78">Long_val</a>(sp[<span class="Constant">3</span>]);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; sp += <span class="Constant">4</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li><br/></li>
<li><span class="Comment">/* Stack checks */<br/></li>
<li></span><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">check_stacks</span><span class="cUserCont">:<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (sp &lt; <a href="caml/fiber.h.html#L67" title="ocaml/runtime/caml/fiber.h:67">Stack_threshold_ptr</a>(domain_state-&gt;current_stack)) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; domain_state-&gt;current_stack-&gt;sp = sp;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (!<a href="fiber.c.html#L486" title="ocaml/runtime/fiber.c:486">caml_try_realloc_stack</a>(<a href="caml/config.h.html#L204" title="ocaml/runtime/caml/config.h:204">Stack_threshold</a> / <span class="Statement"><a href="caml/fiber.h.html#L65" title="ocaml/runtime/caml/fiber.h:65">sizeof</a></span>(<a href="caml/mlvalues.h.html#L57" title="ocaml/runtime/caml/mlvalues.h:57">value</a>))) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L90" title="ocaml/runtime/interp.c:90">Setup_for_c_call</a>; <a href="fail_nat.c.html#L158" title="ocaml/runtime/fail_nat.c:158">caml_raise_stack_overflow</a>();<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; sp = domain_state-&gt;current_stack-&gt;sp;<br/></li>
<li>&nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Comment">/* Fall through CHECK_SIGNALS */<br/></li>
<li></span><br/></li>
<li><span class="Comment">/* Signal handling */<br/></li>
<li></span><br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(CHECK_SIGNALS):&nbsp; &nbsp; <span class="Comment">/* accu not preserved */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (<a href="caml/domain.h.html#L54" title="ocaml/runtime/caml/domain.h:54">Caml_check_gc_interrupt</a>(domain_state))<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">goto</span> process_signal;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">process_signal</span><span class="cUserCont">:<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <a href="#L100" title="ocaml/runtime/interp.c:100">Setup_for_event</a>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="signals.c.html#L360" title="ocaml/runtime/signals.c:360">caml_process_pending_actions</a>();<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="#L109" title="ocaml/runtime/interp.c:109">Restore_after_event</a>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li><br/></li>
<li><span class="Comment">/* Calling C functions */<br/></li>
<li></span><br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(C_CALL1):<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="#L90" title="ocaml/runtime/interp.c:90">Setup_for_c_call</a>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; accu = <a href="caml/prims.h.html#L33" title="ocaml/runtime/caml/prims.h:33">Primitive1</a>(*pc)(accu);<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="#L93" title="ocaml/runtime/interp.c:93">Restore_after_c_call</a>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; pc++;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(C_CALL2):<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="#L90" title="ocaml/runtime/interp.c:90">Setup_for_c_call</a>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; accu = <a href="caml/prims.h.html#L35" title="ocaml/runtime/caml/prims.h:35">Primitive2</a>(*pc)(accu, sp[<span class="Constant">2</span>]);<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="#L93" title="ocaml/runtime/interp.c:93">Restore_after_c_call</a>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; sp += <span class="Constant">1</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; pc++;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(C_CALL3):<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="#L90" title="ocaml/runtime/interp.c:90">Setup_for_c_call</a>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; accu = <a href="caml/prims.h.html#L37" title="ocaml/runtime/caml/prims.h:37">Primitive3</a>(*pc)(accu, sp[<span class="Constant">2</span>], sp[<span class="Constant">3</span>]);<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="#L93" title="ocaml/runtime/interp.c:93">Restore_after_c_call</a>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; sp += <span class="Constant">2</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; pc++;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(C_CALL4):<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="#L90" title="ocaml/runtime/interp.c:90">Setup_for_c_call</a>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; accu = <a href="caml/prims.h.html#L39" title="ocaml/runtime/caml/prims.h:39">Primitive4</a>(*pc)(accu, sp[<span class="Constant">2</span>], sp[<span class="Constant">3</span>], sp[<span class="Constant">4</span>]);<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="#L93" title="ocaml/runtime/interp.c:93">Restore_after_c_call</a>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; sp += <span class="Constant">3</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; pc++;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(C_CALL5):<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="#L90" title="ocaml/runtime/interp.c:90">Setup_for_c_call</a>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; accu = <a href="caml/prims.h.html#L41" title="ocaml/runtime/caml/prims.h:41">Primitive5</a>(*pc)(accu, sp[<span class="Constant">2</span>], sp[<span class="Constant">3</span>], sp[<span class="Constant">4</span>], sp[<span class="Constant">5</span>]);<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="#L93" title="ocaml/runtime/interp.c:93">Restore_after_c_call</a>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; sp += <span class="Constant">4</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; pc++;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(C_CALLN): {<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Type">int</span> nargs = *pc++;<br/></li>
<li>&nbsp; &nbsp; &nbsp; *--sp = accu;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="#L90" title="ocaml/runtime/interp.c:90">Setup_for_c_call</a>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; accu = <a href="caml/prims.h.html#L43" title="ocaml/runtime/caml/prims.h:43">PrimitiveN</a>(*pc)(sp + <span class="Constant">2</span>, nargs);<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="#L93" title="ocaml/runtime/interp.c:93">Restore_after_c_call</a>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; sp += nargs;<br/></li>
<li>&nbsp; &nbsp; &nbsp; pc++;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li><span class="Comment">/* Integer constants */<br/></li>
<li></span><br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(CONST0):<br/></li>
<li>&nbsp; &nbsp; &nbsp; accu = <a href="caml/mlvalues.h.html#L81" title="ocaml/runtime/caml/mlvalues.h:81">Val_int</a>(<span class="Constant">0</span>); <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(CONST1):<br/></li>
<li>&nbsp; &nbsp; &nbsp; accu = <a href="caml/mlvalues.h.html#L81" title="ocaml/runtime/caml/mlvalues.h:81">Val_int</a>(<span class="Constant">1</span>); <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(CONST2):<br/></li>
<li>&nbsp; &nbsp; &nbsp; accu = <a href="caml/mlvalues.h.html#L81" title="ocaml/runtime/caml/mlvalues.h:81">Val_int</a>(<span class="Constant">2</span>); <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(CONST3):<br/></li>
<li>&nbsp; &nbsp; &nbsp; accu = <a href="caml/mlvalues.h.html#L81" title="ocaml/runtime/caml/mlvalues.h:81">Val_int</a>(<span class="Constant">3</span>); <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(PUSHCONST0):<br/></li>
<li>&nbsp; &nbsp; &nbsp; *--sp = accu; accu = <a href="caml/mlvalues.h.html#L81" title="ocaml/runtime/caml/mlvalues.h:81">Val_int</a>(<span class="Constant">0</span>); <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(PUSHCONST1):<br/></li>
<li>&nbsp; &nbsp; &nbsp; *--sp = accu; accu = <a href="caml/mlvalues.h.html#L81" title="ocaml/runtime/caml/mlvalues.h:81">Val_int</a>(<span class="Constant">1</span>); <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(PUSHCONST2):<br/></li>
<li>&nbsp; &nbsp; &nbsp; *--sp = accu; accu = <a href="caml/mlvalues.h.html#L81" title="ocaml/runtime/caml/mlvalues.h:81">Val_int</a>(<span class="Constant">2</span>); <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(PUSHCONST3):<br/></li>
<li>&nbsp; &nbsp; &nbsp; *--sp = accu; accu = <a href="caml/mlvalues.h.html#L81" title="ocaml/runtime/caml/mlvalues.h:81">Val_int</a>(<span class="Constant">3</span>); <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(PUSHCONSTINT):<br/></li>
<li>&nbsp; &nbsp; &nbsp; *--sp = accu;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Comment">/* Fallthrough */<br/></li>
<li></span>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(CONSTINT):<br/></li>
<li>&nbsp; &nbsp; &nbsp; accu = <a href="caml/mlvalues.h.html#L81" title="ocaml/runtime/caml/mlvalues.h:81">Val_int</a>(*pc);<br/></li>
<li>&nbsp; &nbsp; &nbsp; pc++;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li><br/></li>
<li><span class="Comment">/* Integer arithmetic */<br/></li>
<li></span><br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(NEGINT):<br/></li>
<li>&nbsp; &nbsp; &nbsp; accu = (<a href="caml/mlvalues.h.html#L57" title="ocaml/runtime/caml/mlvalues.h:57">value</a>)(<span class="Constant">2</span> - (<a href="caml/config.h.html#L140" title="ocaml/runtime/caml/config.h:140">intnat</a>)accu); <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(ADDINT):<br/></li>
<li>&nbsp; &nbsp; &nbsp; accu = (<a href="caml/mlvalues.h.html#L57" title="ocaml/runtime/caml/mlvalues.h:57">value</a>)((<a href="caml/config.h.html#L140" title="ocaml/runtime/caml/config.h:140">intnat</a>) accu + (<a href="caml/config.h.html#L140" title="ocaml/runtime/caml/config.h:140">intnat</a>) *sp++ - <span class="Constant">1</span>); <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(SUBINT):<br/></li>
<li>&nbsp; &nbsp; &nbsp; accu = (<a href="caml/mlvalues.h.html#L57" title="ocaml/runtime/caml/mlvalues.h:57">value</a>)((<a href="caml/config.h.html#L140" title="ocaml/runtime/caml/config.h:140">intnat</a>) accu - (<a href="caml/config.h.html#L140" title="ocaml/runtime/caml/config.h:140">intnat</a>) *sp++ + <span class="Constant">1</span>); <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(MULINT):<br/></li>
<li>&nbsp; &nbsp; &nbsp; accu = <a href="caml/mlvalues.h.html#L77" title="ocaml/runtime/caml/mlvalues.h:77">Val_long</a>(<a href="caml/mlvalues.h.html#L78" title="ocaml/runtime/caml/mlvalues.h:78">Long_val</a>(accu) * <a href="caml/mlvalues.h.html#L78" title="ocaml/runtime/caml/mlvalues.h:78">Long_val</a>(*sp++)); <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(DIVINT): {<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="caml/config.h.html#L140" title="ocaml/runtime/caml/config.h:140">intnat</a> divisor = <a href="caml/mlvalues.h.html#L78" title="ocaml/runtime/caml/mlvalues.h:78">Long_val</a>(*sp++);<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (divisor == <span class="Constant">0</span>) { <a href="#L90" title="ocaml/runtime/interp.c:90">Setup_for_c_call</a>; <a href="fail_nat.c.html#L173" title="ocaml/runtime/fail_nat.c:173">caml_raise_zero_divide</a>(); }<br/></li>
<li>&nbsp; &nbsp; &nbsp; accu = <a href="caml/mlvalues.h.html#L77" title="ocaml/runtime/caml/mlvalues.h:77">Val_long</a>(<a href="caml/mlvalues.h.html#L78" title="ocaml/runtime/caml/mlvalues.h:78">Long_val</a>(accu) / divisor);<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(MODINT): {<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="caml/config.h.html#L140" title="ocaml/runtime/caml/config.h:140">intnat</a> divisor = <a href="caml/mlvalues.h.html#L78" title="ocaml/runtime/caml/mlvalues.h:78">Long_val</a>(*sp++);<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (divisor == <span class="Constant">0</span>) { <a href="#L90" title="ocaml/runtime/interp.c:90">Setup_for_c_call</a>; <a href="fail_nat.c.html#L173" title="ocaml/runtime/fail_nat.c:173">caml_raise_zero_divide</a>(); }<br/></li>
<li>&nbsp; &nbsp; &nbsp; accu = <a href="caml/mlvalues.h.html#L77" title="ocaml/runtime/caml/mlvalues.h:77">Val_long</a>(<a href="caml/mlvalues.h.html#L78" title="ocaml/runtime/caml/mlvalues.h:78">Long_val</a>(accu) % divisor);<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(ANDINT):<br/></li>
<li>&nbsp; &nbsp; &nbsp; accu = (<a href="caml/mlvalues.h.html#L57" title="ocaml/runtime/caml/mlvalues.h:57">value</a>)((<a href="caml/config.h.html#L140" title="ocaml/runtime/caml/config.h:140">intnat</a>) accu &amp; (<a href="caml/config.h.html#L140" title="ocaml/runtime/caml/config.h:140">intnat</a>) *sp++); <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(ORINT):<br/></li>
<li>&nbsp; &nbsp; &nbsp; accu = (<a href="caml/mlvalues.h.html#L57" title="ocaml/runtime/caml/mlvalues.h:57">value</a>)((<a href="caml/config.h.html#L140" title="ocaml/runtime/caml/config.h:140">intnat</a>) accu | (<a href="caml/config.h.html#L140" title="ocaml/runtime/caml/config.h:140">intnat</a>) *sp++); <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(XORINT):<br/></li>
<li>&nbsp; &nbsp; &nbsp; accu = (<a href="caml/mlvalues.h.html#L57" title="ocaml/runtime/caml/mlvalues.h:57">value</a>)(((<a href="caml/config.h.html#L140" title="ocaml/runtime/caml/config.h:140">intnat</a>) accu ^ (<a href="caml/config.h.html#L140" title="ocaml/runtime/caml/config.h:140">intnat</a>) *sp++) | <span class="Constant">1</span>); <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(LSLINT):<br/></li>
<li>&nbsp; &nbsp; &nbsp; accu = (<a href="caml/mlvalues.h.html#L57" title="ocaml/runtime/caml/mlvalues.h:57">value</a>)((((<a href="caml/config.h.html#L140" title="ocaml/runtime/caml/config.h:140">intnat</a>) accu - <span class="Constant">1</span>) &lt;&lt; <a href="caml/mlvalues.h.html#L78" title="ocaml/runtime/caml/mlvalues.h:78">Long_val</a>(*sp++)) + <span class="Constant">1</span>); <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(LSRINT):<br/></li>
<li>&nbsp; &nbsp; &nbsp; accu = (<a href="caml/mlvalues.h.html#L57" title="ocaml/runtime/caml/mlvalues.h:57">value</a>)((((<a href="caml/config.h.html#L141" title="ocaml/runtime/caml/config.h:141">uintnat</a>) accu) &gt;&gt; <a href="caml/mlvalues.h.html#L78" title="ocaml/runtime/caml/mlvalues.h:78">Long_val</a>(*sp++)) | <span class="Constant">1</span>); <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(ASRINT):<br/></li>
<li>&nbsp; &nbsp; &nbsp; accu = (<a href="caml/mlvalues.h.html#L57" title="ocaml/runtime/caml/mlvalues.h:57">value</a>)((((<a href="caml/config.h.html#L140" title="ocaml/runtime/caml/config.h:140">intnat</a>) accu) &gt;&gt; <a href="caml/mlvalues.h.html#L78" title="ocaml/runtime/caml/mlvalues.h:78">Long_val</a>(*sp++)) | <span class="Constant">1</span>); <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li><br/></li>
<li><a id="L1145">&#x200c;</a><span class="PreProc">#define <span class="linkable">Integer_comparison</span>(typ,opname,tst) \<br/></li>
<li></span><span class="PreProc">&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(opname): \<br/></li>
<li></span><span class="PreProc">&nbsp; &nbsp; &nbsp; accu = <a href="caml/mlvalues.h.html#L81" title="ocaml/runtime/caml/mlvalues.h:81">Val_int</a>((typ) accu tst (typ) *sp++); <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li></span><br/></li>
<li>&nbsp; &nbsp; <a href="#L1145" title="ocaml/runtime/interp.c:1145">Integer_comparison</a>(<a href="caml/config.h.html#L140" title="ocaml/runtime/caml/config.h:140">intnat</a>,EQ, ==)<br/></li>
<li>&nbsp; &nbsp; <a href="#L1145" title="ocaml/runtime/interp.c:1145">Integer_comparison</a>(<a href="caml/config.h.html#L140" title="ocaml/runtime/caml/config.h:140">intnat</a>,NEQ, !=)<br/></li>
<li>&nbsp; &nbsp; <a href="#L1145" title="ocaml/runtime/interp.c:1145">Integer_comparison</a>(<a href="caml/config.h.html#L140" title="ocaml/runtime/caml/config.h:140">intnat</a>,LTINT, &lt;)<br/></li>
<li>&nbsp; &nbsp; <a href="#L1145" title="ocaml/runtime/interp.c:1145">Integer_comparison</a>(<a href="caml/config.h.html#L140" title="ocaml/runtime/caml/config.h:140">intnat</a>,LEINT, &lt;=)<br/></li>
<li>&nbsp; &nbsp; <a href="#L1145" title="ocaml/runtime/interp.c:1145">Integer_comparison</a>(<a href="caml/config.h.html#L140" title="ocaml/runtime/caml/config.h:140">intnat</a>,GTINT, &gt;)<br/></li>
<li>&nbsp; &nbsp; <a href="#L1145" title="ocaml/runtime/interp.c:1145">Integer_comparison</a>(<a href="caml/config.h.html#L140" title="ocaml/runtime/caml/config.h:140">intnat</a>,GEINT, &gt;=)<br/></li>
<li>&nbsp; &nbsp; <a href="#L1145" title="ocaml/runtime/interp.c:1145">Integer_comparison</a>(<a href="caml/config.h.html#L141" title="ocaml/runtime/caml/config.h:141">uintnat</a>,ULTINT, &lt;)<br/></li>
<li>&nbsp; &nbsp; <a href="#L1145" title="ocaml/runtime/interp.c:1145">Integer_comparison</a>(<a href="caml/config.h.html#L141" title="ocaml/runtime/caml/config.h:141">uintnat</a>,UGEINT, &gt;=)<br/></li>
<li><br/></li>
<li><a id="L1158">&#x200c;</a><span class="PreProc">#define <span class="linkable">Integer_branch_comparison</span>(typ,opname,tst,debug) \<br/></li>
<li></span><span class="PreProc">&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(opname): \<br/></li>
<li></span><span class="PreProc">&nbsp; &nbsp; &nbsp; </span><span class="Statement">if</span><span class="PreProc"> ( *pc++ tst (typ) <a href="caml/mlvalues.h.html#L78" title="ocaml/runtime/caml/mlvalues.h:78">Long_val</a>(accu)) { \<br/></li>
<li></span><span class="PreProc">&nbsp; &nbsp; &nbsp; &nbsp; pc += *pc ; \<br/></li>
<li></span><span class="PreProc">&nbsp; &nbsp; &nbsp; } </span><span class="Statement">else</span><span class="PreProc"> { \<br/></li>
<li></span><span class="PreProc">&nbsp; &nbsp; &nbsp; &nbsp; pc++ ; \<br/></li>
<li></span><span class="PreProc">&nbsp; &nbsp; &nbsp; } ; <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li></span><br/></li>
<li>&nbsp; &nbsp; <a href="#L1158" title="ocaml/runtime/interp.c:1158">Integer_branch_comparison</a>(<a href="caml/config.h.html#L140" title="ocaml/runtime/caml/config.h:140">intnat</a>,BEQ, ==, <span class="Constant">&quot;==&quot;</span>)<br/></li>
<li>&nbsp; &nbsp; <a href="#L1158" title="ocaml/runtime/interp.c:1158">Integer_branch_comparison</a>(<a href="caml/config.h.html#L140" title="ocaml/runtime/caml/config.h:140">intnat</a>,BNEQ, !=, <span class="Constant">&quot;!=&quot;</span>)<br/></li>
<li>&nbsp; &nbsp; <a href="#L1158" title="ocaml/runtime/interp.c:1158">Integer_branch_comparison</a>(<a href="caml/config.h.html#L140" title="ocaml/runtime/caml/config.h:140">intnat</a>,BLTINT, &lt;, <span class="Constant">&quot;&lt;&quot;</span>)<br/></li>
<li>&nbsp; &nbsp; <a href="#L1158" title="ocaml/runtime/interp.c:1158">Integer_branch_comparison</a>(<a href="caml/config.h.html#L140" title="ocaml/runtime/caml/config.h:140">intnat</a>,BLEINT, &lt;=, <span class="Constant">&quot;&lt;=&quot;</span>)<br/></li>
<li>&nbsp; &nbsp; <a href="#L1158" title="ocaml/runtime/interp.c:1158">Integer_branch_comparison</a>(<a href="caml/config.h.html#L140" title="ocaml/runtime/caml/config.h:140">intnat</a>,BGTINT, &gt;, <span class="Constant">&quot;&gt;&quot;</span>)<br/></li>
<li>&nbsp; &nbsp; <a href="#L1158" title="ocaml/runtime/interp.c:1158">Integer_branch_comparison</a>(<a href="caml/config.h.html#L140" title="ocaml/runtime/caml/config.h:140">intnat</a>,BGEINT, &gt;=, <span class="Constant">&quot;&gt;=&quot;</span>)<br/></li>
<li>&nbsp; &nbsp; <a href="#L1158" title="ocaml/runtime/interp.c:1158">Integer_branch_comparison</a>(<a href="caml/config.h.html#L141" title="ocaml/runtime/caml/config.h:141">uintnat</a>,BULTINT, &lt;, <span class="Constant">&quot;&lt;&quot;</span>)<br/></li>
<li>&nbsp; &nbsp; <a href="#L1158" title="ocaml/runtime/interp.c:1158">Integer_branch_comparison</a>(<a href="caml/config.h.html#L141" title="ocaml/runtime/caml/config.h:141">uintnat</a>,BUGEINT, &gt;=, <span class="Constant">&quot;&gt;=&quot;</span>)<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(OFFSETINT):<br/></li>
<li>&nbsp; &nbsp; &nbsp; accu += *pc &lt;&lt; <span class="Constant">1</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; pc++;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(OFFSETREF):<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="caml/mlvalues.h.html#L228" title="ocaml/runtime/caml/mlvalues.h:228">Field</a>(accu, <span class="Constant">0</span>) += *pc &lt;&lt; <span class="Constant">1</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; accu = <a href="caml/mlvalues.h.html#L431" title="ocaml/runtime/caml/mlvalues.h:431">Val_unit</a>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; pc++;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(ISINT):<br/></li>
<li>&nbsp; &nbsp; &nbsp; accu = <a href="caml/mlvalues.h.html#L77" title="ocaml/runtime/caml/mlvalues.h:77">Val_long</a>(accu &amp; <span class="Constant">1</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li><br/></li>
<li><span class="Comment">/* Object-oriented operations */<br/></li>
<li></span><br/></li>
<li><a id="L1190">&#x200c;</a><span class="PreProc">#define <span class="linkable">Lookup</span>(obj, lab) <a href="caml/mlvalues.h.html#L228" title="ocaml/runtime/caml/mlvalues.h:228">Field</a> (<a href="caml/mlvalues.h.html#L228" title="ocaml/runtime/caml/mlvalues.h:228">Field</a> (obj, </span><span class="Constant">0</span><span class="PreProc">), <a href="caml/mlvalues.h.html#L82" title="ocaml/runtime/caml/mlvalues.h:82">Int_val</a>(lab))<br/></li>
<li></span><br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(GETMETHOD):<br/></li>
<li>&nbsp; &nbsp; &nbsp; accu = <a href="#L1190" title="ocaml/runtime/interp.c:1190">Lookup</a>(sp[<span class="Constant">0</span>], accu);<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li><br/></li>
<li><a id="L1196">&#x200c;</a><span class="PreProc">#define <span class="linkable">CAML_METHOD_CACHE</span><br/></li>
<li></span><span class="PreProc">#ifdef <a href="#L1196" title="ocaml/runtime/interp.c:1196">CAML_METHOD_CACHE</a><br/></li>
<li></span>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(GETPUBMET): {<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Comment">/* accu == object, pc[0] == tag, pc[1] == cache */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <a href="caml/mlvalues.h.html#L57" title="ocaml/runtime/caml/mlvalues.h:57">value</a> meths = <a href="caml/mlvalues.h.html#L228" title="ocaml/runtime/caml/mlvalues.h:228">Field</a> (accu, <span class="Constant">0</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="caml/mlvalues.h.html#L57" title="ocaml/runtime/caml/mlvalues.h:57">value</a> ofs;<br/></li>
<li><span class="PreProc">#ifdef CAML_TEST_CACHE<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Type">static</span> <span class="Type">int</span> calls = <span class="Constant">0</span>, hits = <span class="Constant">0</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (calls &gt;= <span class="Constant">10000000</span>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; fprintf(<span class="Constant">stderr</span>, <span class="Constant">&quot;cache hit = </span><span class="Special">%d%%\n</span><span class="Constant">&quot;</span>, hits / <span class="Constant">100000</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; calls = <span class="Constant">0</span>; hits = <span class="Constant">0</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; calls++;<br/></li>
<li><span class="PreProc">#endif<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; *--sp = accu;<br/></li>
<li>&nbsp; &nbsp; &nbsp; accu = <a href="caml/mlvalues.h.html#L81" title="ocaml/runtime/caml/mlvalues.h:81">Val_int</a>(*pc++);<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Comment">/* We use relaxed atomic accesses to avoid racing with other domains<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; updating the cache */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; ofs = <a href="caml/platform.h.html#L56" title="ocaml/runtime/caml/platform.h:56">atomic_load_relaxed</a>((<span class="Type">_Atomic</span> <a href="caml/mlvalues.h.html#L66" title="ocaml/runtime/caml/mlvalues.h:66">opcode_t</a> *)pc) &amp; <a href="caml/mlvalues.h.html#L228" title="ocaml/runtime/caml/mlvalues.h:228">Field</a>(meths,<span class="Constant">1</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (*(<a href="caml/mlvalues.h.html#L57" title="ocaml/runtime/caml/mlvalues.h:57">value</a>*)(((<span class="Type">char</span>*)&amp;<a href="caml/mlvalues.h.html#L228" title="ocaml/runtime/caml/mlvalues.h:228">Field</a>(meths,<span class="Constant">3</span>)) + ofs) == accu) {<br/></li>
<li><span class="PreProc">#ifdef CAML_TEST_CACHE<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; hits++;<br/></li>
<li><span class="PreProc">#endif<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; accu = *(<a href="caml/mlvalues.h.html#L57" title="ocaml/runtime/caml/mlvalues.h:57">value</a>*)(((<span class="Type">char</span>*)&amp;<a href="caml/mlvalues.h.html#L228" title="ocaml/runtime/caml/mlvalues.h:228">Field</a>(meths,<span class="Constant">2</span>)) + ofs);<br/></li>
<li>&nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Type">int</span> li = <span class="Constant">3</span>, hi = <a href="caml/mlvalues.h.html#L228" title="ocaml/runtime/caml/mlvalues.h:228">Field</a>(meths,<span class="Constant">0</span>), mi;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">while</span> (li &lt; hi) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mi = ((li+hi) &gt;&gt; <span class="Constant">1</span>) | <span class="Constant">1</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (accu &lt; <a href="caml/mlvalues.h.html#L228" title="ocaml/runtime/caml/mlvalues.h:228">Field</a>(meths,mi)) hi = mi-<span class="Constant">2</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">else</span> li = mi;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="caml/platform.h.html#L60" title="ocaml/runtime/caml/platform.h:60">atomic_store_relaxed</a>((<span class="Type">_Atomic</span> <a href="caml/mlvalues.h.html#L66" title="ocaml/runtime/caml/mlvalues.h:66">opcode_t</a> *)pc, (li-<span class="Constant">3</span>)*<span class="Statement"><a href="caml/fiber.h.html#L65" title="ocaml/runtime/caml/fiber.h:65">sizeof</a></span>(<a href="caml/mlvalues.h.html#L57" title="ocaml/runtime/caml/mlvalues.h:57">value</a>));<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; accu = <a href="caml/mlvalues.h.html#L228" title="ocaml/runtime/caml/mlvalues.h:228">Field</a> (meths, li-<span class="Constant">1</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; pc++;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><span class="PreProc">#else<br/></li>
<li></span>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(GETPUBMET):<br/></li>
<li>&nbsp; &nbsp; &nbsp; *--sp = accu;<br/></li>
<li>&nbsp; &nbsp; &nbsp; accu = <a href="caml/mlvalues.h.html#L81" title="ocaml/runtime/caml/mlvalues.h:81">Val_int</a>(*pc);<br/></li>
<li>&nbsp; &nbsp; &nbsp; pc += <span class="Constant">2</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Comment">/* Fallthrough */<br/></li>
<li></span><span class="PreProc">#endif<br/></li>
<li></span>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(GETDYNMET): {<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Comment">/* accu == tag, sp[0] == object, *pc == cache */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <a href="caml/mlvalues.h.html#L57" title="ocaml/runtime/caml/mlvalues.h:57">value</a> meths = <a href="caml/mlvalues.h.html#L228" title="ocaml/runtime/caml/mlvalues.h:228">Field</a> (sp[<span class="Constant">0</span>], <span class="Constant">0</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Type">int</span> li = <span class="Constant">3</span>, hi = <a href="caml/mlvalues.h.html#L228" title="ocaml/runtime/caml/mlvalues.h:228">Field</a>(meths,<span class="Constant">0</span>), mi;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Statement">while</span> (li &lt; hi) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; mi = ((li+hi) &gt;&gt; <span class="Constant">1</span>) | <span class="Constant">1</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (accu &lt; <a href="caml/mlvalues.h.html#L228" title="ocaml/runtime/caml/mlvalues.h:228">Field</a>(meths,mi)) hi = mi-<span class="Constant">2</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">else</span> li = mi;<br/></li>
<li>&nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; accu = <a href="caml/mlvalues.h.html#L228" title="ocaml/runtime/caml/mlvalues.h:228">Field</a> (meths, li-<span class="Constant">1</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="#L63" title="ocaml/runtime/interp.c:63">Next</a>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li><span class="Comment">/* Debugging <a href="ints.c.html#L488" title="ocaml/runtime/ints.c:488">and</a> machine control */<br/></li>
<li></span><br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(STOP):<br/></li>
<li>&nbsp; &nbsp; &nbsp; domain_state-&gt;external_raise = initial_external_raise;<br/></li>
<li>&nbsp; &nbsp; &nbsp; domain_state-&gt;trap_sp_off = initial_trap_sp_off;<br/></li>
<li>&nbsp; &nbsp; &nbsp; domain_state-&gt;current_stack-&gt;sp = sp;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Statement">return</span> accu;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(EVENT):<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (--<a href="debugger.c.html#L37" title="ocaml/runtime/debugger.c:37">caml_event_count</a> == <span class="Constant">0</span>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L116" title="ocaml/runtime/interp.c:116">Setup_for_debugger</a>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="debugger.c.html#L45" title="ocaml/runtime/debugger.c:45">caml_debugger</a>(EVENT_COUNT, <a href="caml/mlvalues.h.html#L431" title="ocaml/runtime/caml/mlvalues.h:431">Val_unit</a>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L121" title="ocaml/runtime/interp.c:121">Restore_after_debugger</a>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="#L128" title="ocaml/runtime/interp.c:128">Restart_curr_instr</a>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(BREAK):<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="#L116" title="ocaml/runtime/interp.c:116">Setup_for_debugger</a>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="debugger.c.html#L45" title="ocaml/runtime/debugger.c:45">caml_debugger</a>(BREAKPOINT, <a href="caml/mlvalues.h.html#L431" title="ocaml/runtime/caml/mlvalues.h:431">Val_unit</a>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="#L121" title="ocaml/runtime/interp.c:121">Restore_after_debugger</a>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="#L128" title="ocaml/runtime/interp.c:128">Restart_curr_instr</a>;<br/></li>
<li><br/></li>
<li><span class="Comment">/* Context switching */<br/></li>
<li></span><br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(RESUME):<br/></li>
<li>&nbsp; &nbsp; &nbsp; resume_fn = sp[<span class="Constant">0</span>];<br/></li>
<li>&nbsp; &nbsp; &nbsp; resume_arg = sp[<span class="Constant">1</span>];<br/></li>
<li>&nbsp; &nbsp; &nbsp; sp -= <span class="Constant">3</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; sp[<span class="Constant">0</span>] = <a href="caml/mlvalues.h.html#L77" title="ocaml/runtime/caml/mlvalues.h:77">Val_long</a>(domain_state-&gt;trap_sp_off);<br/></li>
<li>&nbsp; &nbsp; &nbsp; sp[<span class="Constant">1</span>] = <a href="caml/mlvalues.h.html#L77" title="ocaml/runtime/caml/mlvalues.h:77">Val_long</a>(<span class="Constant">0</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; sp[<span class="Constant">2</span>] = (<a href="caml/mlvalues.h.html#L57" title="ocaml/runtime/caml/mlvalues.h:57">value</a>)pc;<br/></li>
<li>&nbsp; &nbsp; &nbsp; sp[<span class="Constant">3</span>] = env;<br/></li>
<li>&nbsp; &nbsp; &nbsp; sp[<span class="Constant">4</span>] = <a href="caml/mlvalues.h.html#L77" title="ocaml/runtime/caml/mlvalues.h:77">Val_long</a>(extra_args);<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Statement">goto</span> do_resume;<br/></li>
<li><br/></li>
<li><span class="Statement">do_resume</span><span class="cUserCont">:</span> {<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Type">struct</span> <a href="caml/fiber.h.html#L43" title="ocaml/runtime/caml/fiber.h:43">stack_info</a>* stk = <a href="caml/mlvalues.h.html#L268" title="ocaml/runtime/caml/mlvalues.h:268">Ptr_val</a>(accu);<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (stk == <span class="Constant"><a href="caml/misc.h.html#L71" title="ocaml/runtime/caml/misc.h:71">NULL</a></span>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L90" title="ocaml/runtime/interp.c:90">Setup_for_c_call</a>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="fiber.c.html#L685" title="ocaml/runtime/fiber.c:685">caml_raise_continuation_already_resumed</a>();<br/></li>
<li>&nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Statement">while</span> (<a href="caml/fiber.h.html#L74" title="ocaml/runtime/caml/fiber.h:74">Stack_parent</a>(stk) != <span class="Constant"><a href="caml/misc.h.html#L71" title="ocaml/runtime/caml/misc.h:71">NULL</a></span>) stk = <a href="caml/fiber.h.html#L74" title="ocaml/runtime/caml/fiber.h:74">Stack_parent</a>(stk);<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="caml/fiber.h.html#L74" title="ocaml/runtime/caml/fiber.h:74">Stack_parent</a>(stk) = <a href="caml/domain_state.h.html#L62" title="ocaml/runtime/caml/domain_state.h:62">Caml_state</a>-&gt;current_stack;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; domain_state-&gt;current_stack-&gt;sp = sp;<br/></li>
<li>&nbsp; &nbsp; &nbsp; domain_state-&gt;current_stack = <a href="caml/mlvalues.h.html#L268" title="ocaml/runtime/caml/mlvalues.h:268">Ptr_val</a>(accu);<br/></li>
<li>&nbsp; &nbsp; &nbsp; sp = domain_state-&gt;current_stack-&gt;sp;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; domain_state-&gt;trap_sp_off = <a href="caml/mlvalues.h.html#L78" title="ocaml/runtime/caml/mlvalues.h:78">Long_val</a>(sp[<span class="Constant">0</span>]);<br/></li>
<li>&nbsp; &nbsp; &nbsp; sp[<span class="Constant">0</span>] = resume_arg;<br/></li>
<li>&nbsp; &nbsp; &nbsp; accu = resume_fn;<br/></li>
<li>&nbsp; &nbsp; &nbsp; pc = <a href="caml/mlvalues.h.html#L276" title="ocaml/runtime/caml/mlvalues.h:276">Code_val</a>(accu);<br/></li>
<li>&nbsp; &nbsp; &nbsp; env = accu;<br/></li>
<li>&nbsp; &nbsp; &nbsp; extra_args = <span class="Constant">0</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Statement">goto</span> check_stacks;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(RESUMETERM):<br/></li>
<li>&nbsp; &nbsp; &nbsp; resume_fn = sp[<span class="Constant">0</span>];<br/></li>
<li>&nbsp; &nbsp; &nbsp; resume_arg = sp[<span class="Constant">1</span>];<br/></li>
<li>&nbsp; &nbsp; &nbsp; sp = sp + *pc - <span class="Constant">2</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; sp[<span class="Constant">0</span>] = <a href="caml/mlvalues.h.html#L77" title="ocaml/runtime/caml/mlvalues.h:77">Val_long</a>(domain_state-&gt;trap_sp_off);<br/></li>
<li>&nbsp; &nbsp; &nbsp; sp[<span class="Constant">1</span>] = <a href="caml/mlvalues.h.html#L77" title="ocaml/runtime/caml/mlvalues.h:77">Val_long</a>(extra_args);<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Statement">goto</span> do_resume;<br/></li>
<li><br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(PERFORM): {<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="caml/mlvalues.h.html#L57" title="ocaml/runtime/caml/mlvalues.h:57">value</a> cont;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Type">struct</span> <a href="caml/fiber.h.html#L43" title="ocaml/runtime/caml/fiber.h:43">stack_info</a>* old_stack = domain_state-&gt;current_stack;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Type">struct</span> <a href="caml/fiber.h.html#L43" title="ocaml/runtime/caml/fiber.h:43">stack_info</a>* parent_stack = <a href="caml/fiber.h.html#L74" title="ocaml/runtime/caml/fiber.h:74">Stack_parent</a>(old_stack);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="#L144" title="ocaml/runtime/interp.c:144">check_trap_barrier_for_effect</a> (domain_state);<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (parent_stack == <span class="Constant"><a href="caml/misc.h.html#L71" title="ocaml/runtime/caml/misc.h:71">NULL</a></span>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L90" title="ocaml/runtime/interp.c:90">Setup_for_c_call</a>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; accu = <a href="fiber.c.html#L693" title="ocaml/runtime/fiber.c:693">caml_make_unhandled_effect_exn</a>(accu);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L93" title="ocaml/runtime/interp.c:93">Restore_after_c_call</a>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">goto</span> raise_exception;<br/></li>
<li>&nbsp; &nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="caml/memory.h.html#L217" title="ocaml/runtime/caml/memory.h:217">Alloc_small</a>(cont, <span class="Constant">1</span>, <a href="caml/mlvalues.h.html#L300" title="ocaml/runtime/caml/mlvalues.h:300">Cont_tag</a>, <a href="#L80" title="ocaml/runtime/interp.c:80">Enter_gc</a>);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; sp -= <span class="Constant">4</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; sp[<span class="Constant">0</span>] = <a href="caml/mlvalues.h.html#L77" title="ocaml/runtime/caml/mlvalues.h:77">Val_long</a>(domain_state-&gt;trap_sp_off);<br/></li>
<li>&nbsp; &nbsp; &nbsp; sp[<span class="Constant">1</span>] = (<a href="caml/mlvalues.h.html#L57" title="ocaml/runtime/caml/mlvalues.h:57">value</a>)pc;<br/></li>
<li>&nbsp; &nbsp; &nbsp; sp[<span class="Constant">2</span>] = env;<br/></li>
<li>&nbsp; &nbsp; &nbsp; sp[<span class="Constant">3</span>] = <a href="caml/mlvalues.h.html#L77" title="ocaml/runtime/caml/mlvalues.h:77">Val_long</a>(extra_args);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; old_stack-&gt;sp = sp;<br/></li>
<li>&nbsp; &nbsp; &nbsp; domain_state-&gt;current_stack = parent_stack;<br/></li>
<li>&nbsp; &nbsp; &nbsp; sp = parent_stack-&gt;sp;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="caml/fiber.h.html#L74" title="ocaml/runtime/caml/fiber.h:74">Stack_parent</a>(old_stack) = <span class="Constant"><a href="caml/misc.h.html#L71" title="ocaml/runtime/caml/misc.h:71">NULL</a></span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="caml/mlvalues.h.html#L228" title="ocaml/runtime/caml/mlvalues.h:228">Field</a>(cont, <span class="Constant">0</span>) = <a href="caml/mlvalues.h.html#L263" title="ocaml/runtime/caml/mlvalues.h:263">Val_ptr</a>(old_stack);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; domain_state-&gt;trap_sp_off = <a href="caml/mlvalues.h.html#L78" title="ocaml/runtime/caml/mlvalues.h:78">Long_val</a>(sp[<span class="Constant">0</span>]);<br/></li>
<li>&nbsp; &nbsp; &nbsp; extra_args = <a href="caml/mlvalues.h.html#L78" title="ocaml/runtime/caml/mlvalues.h:78">Long_val</a>(sp[<span class="Constant">1</span>]);<br/></li>
<li>&nbsp; &nbsp; &nbsp; sp--;<br/></li>
<li>&nbsp; &nbsp; &nbsp; sp[<span class="Constant">0</span>] = accu;<br/></li>
<li>&nbsp; &nbsp; &nbsp; sp[<span class="Constant">1</span>] = cont;<br/></li>
<li>&nbsp; &nbsp; &nbsp; sp[<span class="Constant">2</span>] = <a href="caml/mlvalues.h.html#L263" title="ocaml/runtime/caml/mlvalues.h:263">Val_ptr</a>(old_stack);<br/></li>
<li>&nbsp; &nbsp; &nbsp; accu = <a href="caml/fiber.h.html#L73" title="ocaml/runtime/caml/fiber.h:73">Stack_handle_effect</a>(old_stack);<br/></li>
<li>&nbsp; &nbsp; &nbsp; pc = <a href="caml/mlvalues.h.html#L276" title="ocaml/runtime/caml/mlvalues.h:276">Code_val</a>(accu);<br/></li>
<li>&nbsp; &nbsp; &nbsp; env = accu;<br/></li>
<li>&nbsp; &nbsp; &nbsp; extra_args += <span class="Constant">2</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Statement">goto</span> check_stacks;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="#L55" title="ocaml/runtime/interp.c:55">Instruct</a>(REPERFORMTERM): {<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="caml/mlvalues.h.html#L57" title="ocaml/runtime/caml/mlvalues.h:57">value</a> eff = accu;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="caml/mlvalues.h.html#L57" title="ocaml/runtime/caml/mlvalues.h:57">value</a> cont = sp[<span class="Constant">0</span>];<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Type">struct</span> <a href="caml/fiber.h.html#L43" title="ocaml/runtime/caml/fiber.h:43">stack_info</a>* cont_tail = <a href="caml/mlvalues.h.html#L268" title="ocaml/runtime/caml/mlvalues.h:268">Ptr_val</a>(sp[<span class="Constant">1</span>]);<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Type">struct</span> <a href="caml/fiber.h.html#L43" title="ocaml/runtime/caml/fiber.h:43">stack_info</a>* self = domain_state-&gt;current_stack;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Type">struct</span> <a href="caml/fiber.h.html#L43" title="ocaml/runtime/caml/fiber.h:43">stack_info</a>* parent = <a href="caml/fiber.h.html#L74" title="ocaml/runtime/caml/fiber.h:74">Stack_parent</a>(domain_state-&gt;current_stack);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="#L144" title="ocaml/runtime/interp.c:144">check_trap_barrier_for_effect</a> (domain_state);<br/></li>
<li>&nbsp; &nbsp; &nbsp; sp = sp + *pc - <span class="Constant">2</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; sp[<span class="Constant">0</span>] = <a href="caml/mlvalues.h.html#L77" title="ocaml/runtime/caml/mlvalues.h:77">Val_long</a>(domain_state-&gt;trap_sp_off);<br/></li>
<li>&nbsp; &nbsp; &nbsp; sp[<span class="Constant">1</span>] = <a href="caml/mlvalues.h.html#L77" title="ocaml/runtime/caml/mlvalues.h:77">Val_long</a>(extra_args);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (parent == <span class="Constant"><a href="caml/misc.h.html#L71" title="ocaml/runtime/caml/misc.h:71">NULL</a></span>) {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L90" title="ocaml/runtime/interp.c:90">Setup_for_c_call</a>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; resume_arg = <a href="fiber.c.html#L693" title="ocaml/runtime/fiber.c:693">caml_make_unhandled_effect_exn</a>(eff);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; accu = <a href="fiber.c.html#L624" title="ocaml/runtime/fiber.c:624">caml_continuation_use</a>(cont);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L93" title="ocaml/runtime/interp.c:93">Restore_after_c_call</a>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; resume_fn = <a href="#L243" title="ocaml/runtime/interp.c:243">raise_unhandled_effect</a>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">goto</span> do_resume;<br/></li>
<li>&nbsp; &nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; self-&gt;sp = sp;<br/></li>
<li>&nbsp; &nbsp; &nbsp; domain_state-&gt;current_stack = parent;<br/></li>
<li>&nbsp; &nbsp; &nbsp; sp = parent-&gt;sp;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="caml/misc.h.html#L247" title="ocaml/runtime/caml/misc.h:247">CAMLassert</a>(<a href="caml/fiber.h.html#L74" title="ocaml/runtime/caml/fiber.h:74">Stack_parent</a>(cont_tail) == <span class="Constant"><a href="caml/misc.h.html#L71" title="ocaml/runtime/caml/misc.h:71">NULL</a></span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="caml/fiber.h.html#L74" title="ocaml/runtime/caml/fiber.h:74">Stack_parent</a>(self) = <span class="Constant"><a href="caml/misc.h.html#L71" title="ocaml/runtime/caml/misc.h:71">NULL</a></span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <a href="caml/fiber.h.html#L74" title="ocaml/runtime/caml/fiber.h:74">Stack_parent</a>(cont_tail) = self;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; domain_state-&gt;trap_sp_off = <a href="caml/mlvalues.h.html#L78" title="ocaml/runtime/caml/mlvalues.h:78">Long_val</a>(sp[<span class="Constant">0</span>]);<br/></li>
<li>&nbsp; &nbsp; &nbsp; extra_args = <a href="caml/mlvalues.h.html#L78" title="ocaml/runtime/caml/mlvalues.h:78">Long_val</a>(sp[<span class="Constant">1</span>]);<br/></li>
<li>&nbsp; &nbsp; &nbsp; sp--;<br/></li>
<li>&nbsp; &nbsp; &nbsp; sp[<span class="Constant">0</span>] = eff;<br/></li>
<li>&nbsp; &nbsp; &nbsp; sp[<span class="Constant">1</span>] = cont;<br/></li>
<li>&nbsp; &nbsp; &nbsp; sp[<span class="Constant">2</span>] = <a href="caml/mlvalues.h.html#L263" title="ocaml/runtime/caml/mlvalues.h:263">Val_ptr</a>(self);<br/></li>
<li>&nbsp; &nbsp; &nbsp; accu = <a href="caml/fiber.h.html#L73" title="ocaml/runtime/caml/fiber.h:73">Stack_handle_effect</a>(self);<br/></li>
<li>&nbsp; &nbsp; &nbsp; pc = <a href="caml/mlvalues.h.html#L276" title="ocaml/runtime/caml/mlvalues.h:276">Code_val</a>(accu);<br/></li>
<li>&nbsp; &nbsp; &nbsp; env = accu;<br/></li>
<li>&nbsp; &nbsp; &nbsp; extra_args += <span class="Constant">2</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; <span class="Statement">goto</span> check_stacks;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li><span class="PreProc">#ifndef <a href="caml/config.h.html#L182" title="ocaml/runtime/caml/config.h:182">THREADED_CODE</a><br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">default</span>:<br/></li>
<li><span class="PreProc">#ifdef _MSC_VER<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; __assume(<span class="Constant">0</span>);<br/></li>
<li><span class="PreProc">#else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <a href="misc.c.html#L108" title="ocaml/runtime/misc.c:108">caml_fatal_error</a>(<span class="Constant">&quot;bad opcode (%&quot;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <a href="caml/config.h.html#L142" title="ocaml/runtime/caml/config.h:142">ARCH_INTNAT_PRINTF_FORMAT</a> <span class="Constant">&quot;x)&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (<a href="caml/config.h.html#L140" title="ocaml/runtime/caml/config.h:140">intnat</a>) *(pc-<span class="Constant">1</span>));<br/></li>
<li><span class="PreProc">#endif<br/></li>
<li></span>&nbsp; &nbsp; }<br/></li>
<li>&nbsp; }<br/></li>
<li><span class="PreProc">#endif<br/></li>
<li></span>}<br/></li>
</ol></code>
 <p class="nav-bar">
  <span class="nav-link"><a href="./index.html">One Level Up</a></span>
  <span class="nav-link"><a href="index.html">Top Level</a></span>
 </p>

 </body>
</html>
