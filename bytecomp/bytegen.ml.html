<!-- generated by the vscode.pl tool from vscoded.-->

<html>
 <head>
  <title>ocaml/bytecomp/bytegen.ml - ocaml</title>
  <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
  <style>
body {
    text-align: left;
    text-align-last: left;
}

.nav-bar {
    font-size: 120%;
    margin-top: 5px;
    margin-bottom: 5px;
}

.nav-link {
    padding-left: 5em;
    padding-right: 5em;
}

ul.toc {
    line-height: 200%;
    font-size: 150%;
}

code {
    font-family: consolas, monospace;
    line-height: 130%;
}

span.Constant {
    color: DarkGreen;
}

span.Special {
    color: #c06000;
}

span.Comment {
    color: DarkRed;
    font-style: italic;
}

span.Identifier {
    color: DarkCyan;
}

span.PreProc {
    color: DarkMagenta;
}

span.Statement, span.Type, span.Keyword, span.Repeat, span.Conditional,
    span.Operator, span.Exception
{
    color: DarkBlue;
}

span.Todo {
    color: DarkRed;
    background-color: Gold;
    font-style: italic;
}

span.Underlined {
    text-decoration: underline;
}

span.linkable {
    font-weight: bold;
}

code ol {
    counter-reset: item;
    list-style-type: none;
    margin-left: 0;
    padding-left: 0;
    list-style-position: inside;
}

code li {
    display: block;
}

code li:before {
    content: counter(item) "  ";
    counter-increment: item;
    color: #999;
    padding-right: 0.5em;
    padding-left: 0.4em;
    list-style-position: inside;
    text-align: right
}

  </style>
 </head>
 <body>
 <p class="nav-bar">
  <span class="nav-link"><a href="./index.html">One Level Up</a></span>
  <span class="nav-link"><a href="index.html">Top Level</a></span>
 </p>

  <h1>ocaml/bytecomp/bytegen.ml - ocaml</h1>
 <h2>Global variables defined</h2>
 <ul class="toc">
<li><a href="#L939">act_consts</a></li>
<li><a href="#L151">add_const_unit</a></li>
<li><a href="#L291">add_event</a></li>
<li><a href="#L141">add_pop</a></li>
<li><a href="#L304">add_pseudo_event</a></li>
<li><a href="#L41">add_var</a></li>
<li><a href="#L46">add_vars</a></li>
<li><a href="#L898">body_cont</a></li>
<li><a href="#L934">branch</a></li>
<li><a href="#L853">branch1</a></li>
<li><a href="#L896">branch1</a></li>
<li><a href="#L87">branch_to</a></li>
<li><a href="#L935">c</a></li>
<li><a href="#L1019">c</a></li>
<li><a href="#L1023">c</a></li>
<li><a href="#L1027">c</a></li>
<li><a href="#L169">check_recordwith_updates</a></li>
<li><a href="#L384">check_stack</a></li>
<li><a href="#L358">code_as_jump</a></li>
<li><a href="#L924">comp</a></li>
<li><a href="#L1059">comp_args</a></li>
<li><a href="#L394">comp_bint_primitive</a></li>
<li><a href="#L1107">comp_block</a></li>
<li><a href="#L565">comp_expr</a></li>
<li><a href="#L649">comp_fun</a></li>
<li><a href="#L1120">comp_function</a></li>
<li><a href="#L670">comp_init</a></li>
<li><a href="#L401">comp_primitive</a></li>
<li><a href="#L554">compare_key</a></li>
<li><a href="#L1154">compile_implementation</a></li>
<li><a href="#L1165">compile_phrase</a></li>
<li><a href="#L382">compunit_name</a></li>
<li><a href="#L627">cont</a></li>
<li><a href="#L771">cont</a></li>
<li><a href="#L825">cont</a></li>
<li><a href="#L840">cont</a></li>
<li><a href="#L844">cont</a></li>
<li><a href="#L880">cont</a></li>
<li><a href="#L882">cont</a></li>
<li><a href="#L889">cont</a></li>
<li><a href="#L1048">cont1</a></li>
<li><a href="#L232">copy_event</a></li>
<li><a href="#L334">create_stack_info</a></li>
<li><a href="#L667">decl_size</a></li>
<li><a href="#L95">discard_dead_code</a></li>
<li><a href="#L36">empty_env</a></li>
<li><a href="#L1020">ev</a></li>
<li><a href="#L1024">ev</a></li>
<li><a href="#L1028">ev</a></li>
<li><a href="#L1047">ev</a></li>
<li><a href="#L991">ev_defname</a></li>
<li><a href="#L992">event</a></li>
<li><a href="#L349">find_raise_label</a></li>
<li><a href="#L378">functions_to_compile</a></li>
<li><a href="#L629">fv</a></li>
<li><a href="#L646">fv</a></li>
<li><a href="#L607">getmethod</a></li>
<li><a href="#L1040">info</a></li>
<li><a href="#L549">is_immed</a></li>
<li><a href="#L102">is_tailcall</a></li>
<li><a href="#L906">l</a></li>
<li><a href="#L881">label</a></li>
<li><a href="#L57">label_code</a></li>
<li><a href="#L29">label_counter</a></li>
<li><a href="#L621">lbl</a></li>
<li><a href="#L628">lbl</a></li>
<li><a href="#L738">lbl</a></li>
<li><a href="#L752">lbl</a></li>
<li><a href="#L964">lbl</a></li>
<li><a href="#L734">lbl2</a></li>
<li><a href="#L748">lbl2</a></li>
<li><a href="#L971">lbl_blocks</a></li>
<li><a href="#L975">lbl_consts</a></li>
<li><a href="#L922">lbl_exit</a></li>
<li><a href="#L897">lbl_handler</a></li>
<li><a href="#L913">lbl_loop</a></li>
<li><a href="#L921">lbl_loop</a></li>
<li><a href="#L914">lbl_test</a></li>
<li><a href="#L660">lbls</a></li>
<li><a href="#L962">lbls</a></li>
<li><a href="#L883">loop</a></li>
<li><a href="#L77">make_branch</a></li>
<li><a href="#L67">make_branch_2</a></li>
<li><a href="#L555">make_key</a></li>
<li><a href="#L253">merge_events</a></li>
<li><a href="#L239">merge_infos</a></li>
<li><a href="#L245">merge_repr</a></li>
<li><a href="#L606">nargs</a></li>
<li><a href="#L787">nargs</a></li>
<li><a href="#L797">nargs</a></li>
<li><a href="#L847">nargs</a></li>
<li><a href="#L642">ndecl</a></li>
<li><a href="#L31">new_label</a></li>
<li><a href="#L722">newcont</a></li>
<li><a href="#L852">nvars</a></li>
<li><a href="#L923">offset</a></li>
<li><a href="#L819">p</a></li>
<li><a href="#L985">pos</a></li>
<li><a href="#L1031">preserve_tailcall</a></li>
<li><a href="#L111">preserve_tailcall_for_prim</a></li>
<li><a href="#L811">prim_obj_dup</a></li>
<li><a href="#L155">push_dummies</a></li>
<li><a href="#L342">push_static_raise</a></li>
<li><a href="#L854">r</a></li>
<li><a href="#L648">rec_idents</a></li>
<li><a href="#L1149">reset</a></li>
<li><a href="#L176">size_of_lambda</a></li>
<li><a href="#L904">stack_info</a></li>
<li><a href="#L938">store</a></li>
<li><a href="#L630">to_compile</a></li>
<li><a href="#L851">vars</a></li>
<li><a href="#L266">weaken_event</a></li>
</ul>
 <h2>Data types defined</h2>
 <ul class="toc">
<li><a href="#L369">function_to_compile</a></li>
<li><a href="#L553">key</a></li>
<li><a href="#L162">rhs_kind</a></li>
<li><a href="#L325">stack_info</a></li>
<li><a href="#L553">t</a></li>
</ul>
 <h2>Source code</h2>

  <code><ol><li><span class="Comment">(**************************************************************************)<br/></li>
<li></span><span class="Comment">(*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *)<br/></li>
<li></span><span class="Comment">(*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; OCaml&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *)<br/></li>
<li></span><span class="Comment">(*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *)<br/></li>
<li></span><span class="Comment">(*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; Xavier Leroy, projet Cristal, INRIA Rocquencourt&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; *)<br/></li>
<li></span><span class="Comment">(*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *)<br/></li>
<li></span><span class="Comment">(*&nbsp;&nbsp; Copyright 1996 Institut National de Recherche en Informatique et&nbsp; &nbsp;&nbsp; *)<br/></li>
<li></span><span class="Comment">(*&nbsp; &nbsp;&nbsp; en Automatique.&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *)<br/></li>
<li></span><span class="Comment">(*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *)<br/></li>
<li></span><span class="Comment">(*&nbsp;&nbsp; All rights reserved.&nbsp; This file is distributed under the terms of&nbsp; &nbsp; *)<br/></li>
<li></span><span class="Comment">(*&nbsp;&nbsp; the GNU Lesser General Public License version 2.1, with the&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *)<br/></li>
<li></span><span class="Comment">(*&nbsp;&nbsp; special exception on linking described in the file LICENSE.&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *)<br/></li>
<li></span><span class="Comment">(*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *)<br/></li>
<li></span><span class="Comment">(**************************************************************************)<br/></li>
<li></span><br/></li>
<li><span class="Comment">(*&nbsp; bytegen.ml : translation of lambda terms to lists of instructions. *)<br/></li>
<li></span><br/></li>
<li><span class="Statement">open</span><span class="ocamlNone"> </span><span class="PreProc">Misc<br/></li>
<li></span><span class="Statement">open</span><span class="ocamlNone"> </span><span class="PreProc">Asttypes<br/></li>
<li></span><span class="Statement">open</span><span class="ocamlNone"> </span><span class="PreProc">Primitive<br/></li>
<li></span><span class="Statement">open</span><span class="ocamlNone"> </span><span class="PreProc">Types<br/></li>
<li></span><span class="Statement">open</span><span class="ocamlNone"> </span><span class="PreProc">Lambda<br/></li>
<li></span><span class="Statement">open</span><span class="ocamlNone"> </span><span class="PreProc">Switch<br/></li>
<li></span><span class="Statement">open</span><span class="ocamlNone"> </span><span class="PreProc">Instruct<br/></li>
<li></span><span class="Statement">open</span><span class="ocamlNone"> </span><span class="PreProc">Debuginfo.Scoped_location<br/></li>
<li></span><br/></li>
<li><span class="Comment">(**** Label generation ****)<br/></li>
<li></span><br/></li>
<li><a id="L29">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">label_counter</span></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">ref</span> <span class="Constant">0<br/></li>
<li></span><br/></li>
<li><a id="L31">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">new_label</span></span> <span class="Constant">()</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier"><a href="symtable.ml.html#L54" title="ocaml/bytecomp/symtable.ml:54">incr</a></span> <span class="ocamlLCIdentifier"><a href="#L29" title="ocaml/bytecomp/bytegen.ml:29">label_counter</a></span><span class="Statement">;</span> <span class="Statement">!</span><span class="ocamlLCIdentifier"><a href="#L29" title="ocaml/bytecomp/bytegen.ml:29">label_counter</a><br/></li>
<li></span><br/></li>
<li><span class="Comment">(**** Operations on compilation environments. ****)<br/></li>
<li></span><br/></li>
<li><a id="L36">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">empty_env</span></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">{</span> <span class="ocamlLCIdentifier">ce_stack</span> <span class="Statement">=</span> <span class="PreProc">Ident</span>.<span class="ocamlLCIdentifier"><a href="symtable.ml.html#L44" title="ocaml/bytecomp/symtable.ml:44">empty</a></span><span class="Statement">;</span> <span class="ocamlLCIdentifier">ce_heap</span> <span class="Statement">=</span> <span class="PreProc">Ident</span>.<span class="ocamlLCIdentifier"><a href="symtable.ml.html#L44" title="ocaml/bytecomp/symtable.ml:44">empty</a></span><span class="Statement">;</span> <span class="ocamlLCIdentifier">ce_rec</span> <span class="Statement">=</span> <span class="PreProc">Ident</span>.<span class="ocamlLCIdentifier"><a href="symtable.ml.html#L44" title="ocaml/bytecomp/symtable.ml:44">empty</a></span> <span class="Statement">}<br/></li>
<li></span><br/></li>
<li><span class="Comment">(* Add a stack-allocated variable *)<br/></li>
<li></span><br/></li>
<li><a id="L41">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">add_var</span></span> <span class="ocamlLCIdentifier">id</span> <span class="ocamlLCIdentifier"><a href="#L985" title="ocaml/bytecomp/bytegen.ml:985">pos</a></span> <span class="ocamlLCIdentifier">env</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">{</span> <span class="ocamlLCIdentifier">ce_stack</span> <span class="Statement">=</span> <span class="PreProc">Ident</span>.<span class="ocamlLCIdentifier">add</span> <span class="ocamlLCIdentifier">id</span> <span class="ocamlLCIdentifier"><a href="#L985" title="ocaml/bytecomp/bytegen.ml:985">pos</a></span> <span class="ocamlLCIdentifier">env</span>.<span class="ocamlLCIdentifier">ce_stack</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier">ce_heap</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">env</span>.<span class="ocamlLCIdentifier">ce_heap</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier">ce_rec</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">env</span>.<span class="ocamlLCIdentifier">ce_rec</span> <span class="Statement">}<br/></li>
<li></span><br/></li>
<li><a id="L46">&#x200c;</a><span class="Statement">let</span> <span class="Statement">rec</span> <span class="ocamlLCIdentifier"><span class="linkable">add_vars</span></span> <span class="ocamlLCIdentifier">idlist</span> <span class="ocamlLCIdentifier"><a href="#L985" title="ocaml/bytecomp/bytegen.ml:985">pos</a></span> <span class="ocamlLCIdentifier">env</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">match</span> <span class="ocamlLCIdentifier">idlist</span> <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">[]</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier">env<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="ocamlLCIdentifier">id</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier">rem</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier"><a href="#L46" title="ocaml/bytecomp/bytegen.ml:46">add_vars</a></span> <span class="ocamlLCIdentifier">rem</span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L985" title="ocaml/bytecomp/bytegen.ml:985">pos</a></span> + <span class="Constant">1</span><span class="Statement">)</span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L41" title="ocaml/bytecomp/bytegen.ml:41">add_var</a></span> <span class="ocamlLCIdentifier">id</span> <span class="ocamlLCIdentifier"><a href="#L985" title="ocaml/bytecomp/bytegen.ml:985">pos</a></span> <span class="ocamlLCIdentifier">env</span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li><span class="Comment">(**** Examination of the continuation ****)<br/></li>
<li></span><br/></li>
<li><span class="Comment">(* Return a <a href="instruct.ml.html#L51" title="ocaml/bytecomp/instruct.ml:51">label</a> to the beginning of the given continuation.<br/></li>
<li></span><span class="Comment">&nbsp;&nbsp; If the sequence starts with a <a href="#L934" title="ocaml/bytecomp/bytegen.ml:934">branch</a>, use the target of that <a href="#L934" title="ocaml/bytecomp/bytegen.ml:934">branch</a><br/></li>
<li></span><span class="Comment">&nbsp;&nbsp; as the <a href="instruct.ml.html#L51" title="ocaml/bytecomp/instruct.ml:51">label</a>, thus avoiding a jump to a jump. *)<br/></li>
<li></span><br/></li>
<li><a id="L57">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">label_code</span></span> <span class="Statement">=</span> <span class="Statement">function<br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">Kbranch</span> <span class="ocamlLCIdentifier"><a href="#L621" title="ocaml/bytecomp/bytegen.ml:621">lbl</a></span> <span class="Statement">::</span> <span class="Statement">_</span> <span class="Statement">as</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span> <span class="Statement">-&gt;</span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L621" title="ocaml/bytecomp/bytegen.ml:621">lbl</a></span>, <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Klabel</span> <span class="ocamlLCIdentifier"><a href="#L621" title="ocaml/bytecomp/bytegen.ml:621">lbl</a></span> <span class="Statement">::</span> <span class="Statement">_</span> <span class="Statement">as</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span> <span class="Statement">-&gt;</span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L621" title="ocaml/bytecomp/bytegen.ml:621">lbl</a></span>, <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span> <span class="Statement">-&gt;</span> <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="#L621" title="ocaml/bytecomp/bytegen.ml:621">lbl</a></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="#L31" title="ocaml/bytecomp/bytegen.ml:31">new_label</a></span><span class="Constant">()</span> <span class="Statement">in</span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L621" title="ocaml/bytecomp/bytegen.ml:621">lbl</a></span>, <span class="Constant">Klabel</span> <span class="ocamlLCIdentifier"><a href="#L621" title="ocaml/bytecomp/bytegen.ml:621">lbl</a></span> <span class="Statement">::</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li><span class="Comment">(* Return a <a href="#L934" title="ocaml/bytecomp/bytegen.ml:934">branch</a> to the continuation. That is, an <a href="instruct.ml.html#L53" title="ocaml/bytecomp/instruct.ml:53">instruction</a> that,<br/></li>
<li></span><span class="Comment">&nbsp;&nbsp; when executed, branches to the continuation or performs what the<br/></li>
<li></span><span class="Comment">&nbsp;&nbsp; continuation performs. We avoid generating branches to branches and<br/></li>
<li></span><span class="Comment">&nbsp;&nbsp; branches to returns. *)<br/></li>
<li></span><br/></li>
<li><a id="L67">&#x200c;</a><span class="Statement">let</span> <span class="Statement">rec</span> <span class="ocamlLCIdentifier"><span class="linkable">make_branch_2</span></span> <span class="ocamlLCIdentifier"><a href="#L621" title="ocaml/bytecomp/bytegen.ml:621">lbl</a></span> <span class="ocamlLCIdentifier">n</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">function<br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">Kreturn</span> <span class="ocamlLCIdentifier">m</span> <span class="Statement">::</span> <span class="Statement">_</span> <span class="Statement">-&gt;</span> <span class="Statement">(</span><span class="Constant">Kreturn</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">n</span> + <span class="ocamlLCIdentifier">m</span><span class="Statement">)</span>, <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Klabel</span> <span class="Statement">_</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier"><a href="#L935" title="ocaml/bytecomp/bytegen.ml:935">c</a></span>&nbsp; <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier"><a href="#L67" title="ocaml/bytecomp/bytegen.ml:67">make_branch_2</a></span> <span class="ocamlLCIdentifier"><a href="#L621" title="ocaml/bytecomp/bytegen.ml:621">lbl</a></span> <span class="ocamlLCIdentifier">n</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span> <span class="ocamlLCIdentifier"><a href="#L935" title="ocaml/bytecomp/bytegen.ml:935">c</a><br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Kpop</span> <span class="ocamlLCIdentifier">m</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier"><a href="#L935" title="ocaml/bytecomp/bytegen.ml:935">c</a></span>&nbsp; &nbsp; <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier"><a href="#L67" title="ocaml/bytecomp/bytegen.ml:67">make_branch_2</a></span> <span class="ocamlLCIdentifier"><a href="#L621" title="ocaml/bytecomp/bytegen.ml:621">lbl</a></span> <span class="Statement">(</span><span class="ocamlLCIdentifier">n</span> + <span class="ocamlLCIdentifier">m</span><span class="Statement">)</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span> <span class="ocamlLCIdentifier"><a href="#L935" title="ocaml/bytecomp/bytegen.ml:935">c</a><br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Statement">_</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">match</span> <span class="ocamlLCIdentifier"><a href="#L621" title="ocaml/bytecomp/bytegen.ml:621">lbl</a></span> <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">Some</span> <span class="ocamlLCIdentifier"><a href="#L621" title="ocaml/bytecomp/bytegen.ml:621">lbl</a></span> <span class="Statement">-&gt;</span> <span class="Statement">(</span><span class="Constant">Kbranch</span> <span class="ocamlLCIdentifier"><a href="#L621" title="ocaml/bytecomp/bytegen.ml:621">lbl</a></span>, <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">None</span>&nbsp; &nbsp;&nbsp; <span class="Statement">-&gt;</span> <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="#L621" title="ocaml/bytecomp/bytegen.ml:621">lbl</a></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="#L31" title="ocaml/bytecomp/bytegen.ml:31">new_label</a></span><span class="Constant">()</span> <span class="Statement">in</span> <span class="Statement">(</span><span class="Constant">Kbranch</span> <span class="ocamlLCIdentifier"><a href="#L621" title="ocaml/bytecomp/bytegen.ml:621">lbl</a></span>, <span class="Constant">Klabel</span> <span class="ocamlLCIdentifier"><a href="#L621" title="ocaml/bytecomp/bytegen.ml:621">lbl</a></span> <span class="Statement">::</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li><a id="L77">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">make_branch</span></span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">match</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span> <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">(</span><span class="Constant">Kbranch</span> <span class="Statement">_</span> <span class="Statement">as</span> <span class="ocamlLCIdentifier"><a href="#L934" title="ocaml/bytecomp/bytegen.ml:934">branch</a></span><span class="Statement">)</span> <span class="Statement">::</span> <span class="Statement">_</span> <span class="Statement">-&gt;</span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L934" title="ocaml/bytecomp/bytegen.ml:934">branch</a></span>, <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Statement">(</span><span class="Constant">Kreturn</span> <span class="Statement">_</span> <span class="Statement">as</span> <span class="ocamlLCIdentifier">return</span><span class="Statement">)</span> <span class="Statement">::</span> <span class="Statement">_</span> <span class="Statement">-&gt;</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">return</span>, <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Kraise</span> <span class="ocamlLCIdentifier">k</span> <span class="Statement">::</span> <span class="Statement">_</span> <span class="Statement">-&gt;</span> <span class="Statement">(</span><span class="Constant">Kraise</span> <span class="ocamlLCIdentifier">k</span>, <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Klabel</span> <span class="ocamlLCIdentifier"><a href="#L621" title="ocaml/bytecomp/bytegen.ml:621">lbl</a></span> <span class="Statement">::</span> <span class="Statement">_</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier"><a href="#L67" title="ocaml/bytecomp/bytegen.ml:67">make_branch_2</a></span> <span class="Statement">(</span><span class="Constant">Some</span> <span class="ocamlLCIdentifier"><a href="#L621" title="ocaml/bytecomp/bytegen.ml:621">lbl</a></span><span class="Statement">)</span> <span class="Constant">0</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a><br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Statement">_</span> <span class="Statement">-&gt;</span>&nbsp; <span class="ocamlLCIdentifier"><a href="#L67" title="ocaml/bytecomp/bytegen.ml:67">make_branch_2</a></span> <span class="Statement">(</span><span class="Constant">None</span><span class="Statement">)</span> <span class="Constant">0</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a><br/></li>
<li></span><br/></li>
<li><span class="Comment">(* Avoid a <a href="#L934" title="ocaml/bytecomp/bytegen.ml:934">branch</a> to a <a href="instruct.ml.html#L51" title="ocaml/bytecomp/instruct.ml:51">label</a> that follows immediately *)<br/></li>
<li></span><br/></li>
<li><a id="L87">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">branch_to</span></span> <span class="ocamlLCIdentifier"><a href="instruct.ml.html#L51" title="ocaml/bytecomp/instruct.ml:51">label</a></span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span> <span class="Statement">=</span> <span class="Statement">match</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span> <span class="Statement">with<br/></li>
<li></span><span class="Statement">|</span> <span class="Constant">Klabel</span> <span class="ocamlLCIdentifier">label0</span><span class="Statement">::_</span> <span class="Statement">when</span> <span class="ocamlLCIdentifier"><a href="instruct.ml.html#L51" title="ocaml/bytecomp/instruct.ml:51">label</a></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">label0</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a><br/></li>
<li></span><span class="Statement">|</span> <span class="Statement">_</span> <span class="Statement">-&gt;</span> <span class="Constant">Kbranch</span> <span class="ocamlLCIdentifier"><a href="instruct.ml.html#L51" title="ocaml/bytecomp/instruct.ml:51">label</a></span><span class="Statement">::</span><span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a><br/></li>
<li></span><br/></li>
<li><span class="Comment">(* Discard <a href="bytesections.mli.html#L83" title="ocaml/bytecomp/bytesections.mli:83">all</a> instructions up to the next <a href="instruct.ml.html#L51" title="ocaml/bytecomp/instruct.ml:51">label</a>.<br/></li>
<li></span><span class="Comment">&nbsp;&nbsp; This function is to be applied to the continuation before adding a<br/></li>
<li></span><span class="Comment">&nbsp;&nbsp; non-terminating <a href="instruct.ml.html#L53" title="ocaml/bytecomp/instruct.ml:53">instruction</a> (<a href="#L934" title="ocaml/bytecomp/bytegen.ml:934">branch</a>, raise, return) in front of it. *)<br/></li>
<li></span><br/></li>
<li><a id="L95">&#x200c;</a><span class="Statement">let</span> <span class="Statement">rec</span> <span class="ocamlLCIdentifier"><span class="linkable">discard_dead_code</span></span> <span class="Statement">=</span> <span class="Statement">function<br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">[]</span> <span class="Statement">-&gt;</span> <span class="Constant">[]<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Statement">(</span><span class="Constant">Klabel</span> <span class="Statement">_</span> <span class="Statement">|</span> <span class="Constant">Krestart</span> <span class="Statement">|</span> <span class="Constant">Ksetglobal</span> <span class="Statement">_)</span> <span class="Statement">::</span> <span class="Statement">_</span> <span class="Statement">as</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a><br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Statement">_</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier"><a href="#L95" title="ocaml/bytecomp/bytegen.ml:95">discard_dead_code</a></span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a><br/></li>
<li></span><br/></li>
<li><span class="Comment">(* Check if we're in tailcall position *)<br/></li>
<li></span><br/></li>
<li><a id="L102">&#x200c;</a><span class="Statement">let</span> <span class="Statement">rec</span> <span class="ocamlLCIdentifier"><span class="linkable">is_tailcall</span></span> <span class="Statement">=</span> <span class="Statement">function<br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">Kreturn</span> <span class="Statement">_</span> <span class="Statement">::</span> <span class="Statement">_</span> <span class="Statement">-&gt;</span> <span class="Constant">true<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Klabel</span> <span class="Statement">_</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier"><a href="#L935" title="ocaml/bytecomp/bytegen.ml:935">c</a></span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier"><a href="#L102" title="ocaml/bytecomp/bytegen.ml:102">is_tailcall</a></span> <span class="ocamlLCIdentifier"><a href="#L935" title="ocaml/bytecomp/bytegen.ml:935">c</a><br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Kpop</span> <span class="Statement">_</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier"><a href="#L935" title="ocaml/bytecomp/bytegen.ml:935">c</a></span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier"><a href="#L102" title="ocaml/bytecomp/bytegen.ml:102">is_tailcall</a></span> <span class="ocamlLCIdentifier"><a href="#L935" title="ocaml/bytecomp/bytegen.ml:935">c</a><br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Statement">_</span> <span class="Statement">-&gt;</span> <span class="Constant">false<br/></li>
<li></span><br/></li>
<li><span class="Comment">(* Will this primitive result in an OCaml call which would benefit<br/></li>
<li></span><span class="Comment">&nbsp;&nbsp; from the tail call optimization? *)<br/></li>
<li></span><br/></li>
<li><a id="L111">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">preserve_tailcall_for_prim</span></span> <span class="Statement">=</span> <span class="Statement">function<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Popaque</span> <span class="Statement">|</span> <span class="Constant">Psequor</span> <span class="Statement">|</span> <span class="Constant">Psequand<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Prunstack</span> <span class="Statement">|</span> <span class="Constant">Pperform</span> <span class="Statement">|</span> <span class="Constant">Presume</span> <span class="Statement">|</span> <span class="Constant">Preperform</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Constant">true<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pbytes_to_string</span> <span class="Statement">|</span> <span class="Constant">Pbytes_of_string</span> <span class="Statement">|</span> <span class="Constant">Pignore</span> <span class="Statement">|</span> <span class="Constant">Pgetglobal</span> <span class="Statement">_</span> <span class="Statement">|</span> <span class="Constant">Psetglobal</span> <span class="Statement">_<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pmakeblock</span> <span class="Statement">_</span> <span class="Statement">|</span> <span class="Constant">Pfield</span> <span class="Statement">_</span> <span class="Statement">|</span> <span class="Constant">Pfield_computed</span> <span class="Statement">|</span> <span class="Constant">Psetfield</span> <span class="Statement">_<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Psetfield_computed</span> <span class="Statement">_</span> <span class="Statement">|</span> <span class="Constant">Pfloatfield</span> <span class="Statement">_</span> <span class="Statement">|</span> <span class="Constant">Psetfloatfield</span> <span class="Statement">_</span> <span class="Statement">|</span> <span class="Constant">Pduprecord</span> <span class="Statement">_<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pccall</span> <span class="Statement">_</span> <span class="Statement">|</span> <span class="Constant">Praise</span> <span class="Statement">_</span> <span class="Statement">|</span> <span class="Constant">Pnot</span> <span class="Statement">|</span> <span class="Constant">Pnegint</span> <span class="Statement">|</span> <span class="Constant">Paddint</span> <span class="Statement">|</span> <span class="Constant">Psubint</span> <span class="Statement">|</span> <span class="Constant">Pmulint<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pdivint</span> <span class="Statement">_</span> <span class="Statement">|</span> <span class="Constant">Pmodint</span> <span class="Statement">_</span> <span class="Statement">|</span> <span class="Constant">Pandint</span> <span class="Statement">|</span> <span class="Constant">Porint</span> <span class="Statement">|</span> <span class="Constant">Pxorint</span> <span class="Statement">|</span> <span class="Constant">Plslint</span> <span class="Statement">|</span> <span class="Constant">Plsrint<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pasrint</span> <span class="Statement">|</span> <span class="Constant">Pintcomp</span> <span class="Statement">_</span> <span class="Statement">|</span> <span class="Constant">Poffsetint</span> <span class="Statement">_</span> <span class="Statement">|</span> <span class="Constant">Poffsetref</span> <span class="Statement">_</span> <span class="Statement">|</span> <span class="Constant">Pintoffloat<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pfloatofint</span> <span class="Statement">|</span> <span class="Constant">Pnegfloat</span> <span class="Statement">|</span> <span class="Constant">Pabsfloat</span> <span class="Statement">|</span> <span class="Constant">Paddfloat</span> <span class="Statement">|</span> <span class="Constant">Psubfloat</span> <span class="Statement">|</span> <span class="Constant">Pmulfloat<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pdivfloat</span> <span class="Statement">|</span> <span class="Constant">Pfloatcomp</span> <span class="Statement">_</span> <span class="Statement">|</span> <span class="Constant">Pstringlength</span> <span class="Statement">|</span> <span class="Constant">Pstringrefu</span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pstringrefs<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pcompare_ints</span> <span class="Statement">|</span> <span class="Constant">Pcompare_floats</span> <span class="Statement">|</span> <span class="Constant">Pcompare_bints</span> <span class="Statement">_<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pbyteslength</span> <span class="Statement">|</span> <span class="Constant">Pbytesrefu</span> <span class="Statement">|</span> <span class="Constant">Pbytessetu</span> <span class="Statement">|</span> <span class="Constant">Pbytesrefs</span> <span class="Statement">|</span> <span class="Constant">Pbytessets<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pmakearray</span> <span class="Statement">_</span> <span class="Statement">|</span> <span class="Constant">Pduparray</span> <span class="Statement">_</span> <span class="Statement">|</span> <span class="Constant">Parraylength</span> <span class="Statement">_</span> <span class="Statement">|</span> <span class="Constant">Parrayrefu</span> <span class="Statement">_</span> <span class="Statement">|</span> <span class="Constant">Parraysetu</span> <span class="Statement">_<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Parrayrefs</span> <span class="Statement">_</span> <span class="Statement">|</span> <span class="Constant">Parraysets</span> <span class="Statement">_</span> <span class="Statement">|</span> <span class="Constant">Pisint</span> <span class="Statement">|</span> <span class="Constant">Pisout</span> <span class="Statement">|</span> <span class="Constant">Pbintofint</span> <span class="Statement">_</span> <span class="Statement">|</span> <span class="Constant">Pintofbint</span> <span class="Statement">_<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pcvtbint</span> <span class="Statement">_</span> <span class="Statement">|</span> <span class="Constant">Pnegbint</span> <span class="Statement">_</span> <span class="Statement">|</span> <span class="Constant">Paddbint</span> <span class="Statement">_</span> <span class="Statement">|</span> <span class="Constant">Psubbint</span> <span class="Statement">_</span> <span class="Statement">|</span> <span class="Constant">Pmulbint</span> <span class="Statement">_</span> <span class="Statement">|</span> <span class="Constant">Pdivbint</span> <span class="Statement">_<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pmodbint</span> <span class="Statement">_</span> <span class="Statement">|</span> <span class="Constant">Pandbint</span> <span class="Statement">_</span> <span class="Statement">|</span> <span class="Constant">Porbint</span> <span class="Statement">_</span> <span class="Statement">|</span> <span class="Constant">Pxorbint</span> <span class="Statement">_</span> <span class="Statement">|</span> <span class="Constant">Plslbint</span> <span class="Statement">_</span> <span class="Statement">|</span> <span class="Constant">Plsrbint</span> <span class="Statement">_<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pasrbint</span> <span class="Statement">_</span> <span class="Statement">|</span> <span class="Constant">Pbintcomp</span> <span class="Statement">_</span> <span class="Statement">|</span> <span class="Constant">Pbigarrayref</span> <span class="Statement">_</span> <span class="Statement">|</span> <span class="Constant">Pbigarrayset</span> <span class="Statement">_</span> <span class="Statement">|</span> <span class="Constant">Pbigarraydim</span> <span class="Statement">_<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pstring_load_16</span> <span class="Statement">_</span> <span class="Statement">|</span> <span class="Constant">Pstring_load_32</span> <span class="Statement">_</span> <span class="Statement">|</span> <span class="Constant">Pstring_load_64</span> <span class="Statement">_</span> <span class="Statement">|</span> <span class="Constant">Pbytes_load_16</span> <span class="Statement">_<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pbytes_load_32</span> <span class="Statement">_</span> <span class="Statement">|</span> <span class="Constant">Pbytes_load_64</span> <span class="Statement">_</span> <span class="Statement">|</span> <span class="Constant">Pbytes_set_16</span> <span class="Statement">_</span> <span class="Statement">|</span> <span class="Constant">Pbytes_set_32</span> <span class="Statement">_<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pbytes_set_64</span> <span class="Statement">_</span> <span class="Statement">|</span> <span class="Constant">Pbigstring_load_16</span> <span class="Statement">_</span> <span class="Statement">|</span> <span class="Constant">Pbigstring_load_32</span> <span class="Statement">_<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pbigstring_load_64</span> <span class="Statement">_</span> <span class="Statement">|</span> <span class="Constant">Pbigstring_set_16</span> <span class="Statement">_</span> <span class="Statement">|</span> <span class="Constant">Pbigstring_set_32</span> <span class="Statement">_<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pbigstring_set_64</span> <span class="Statement">_</span> <span class="Statement">|</span> <span class="Constant">Pctconst</span> <span class="Statement">_</span> <span class="Statement">|</span> <span class="Constant">Pbswap16</span> <span class="Statement">|</span> <span class="Constant">Pbbswap</span> <span class="Statement">_</span> <span class="Statement">|</span> <span class="Constant">Pint_as_pointer<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Patomic_exchange</span> <span class="Statement">|</span> <span class="Constant">Patomic_cas</span> <span class="Statement">|</span> <span class="Constant">Patomic_fetch_add</span> <span class="Statement">|</span> <span class="Constant">Patomic_load</span> <span class="Statement">_<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pdls_get</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Constant">false<br/></li>
<li></span><br/></li>
<li><span class="Comment">(* Add a Kpop N <a href="instruct.ml.html#L53" title="ocaml/bytecomp/instruct.ml:53">instruction</a> in front of a continuation *)<br/></li>
<li></span><br/></li>
<li><a id="L141">&#x200c;</a><span class="Statement">let</span> <span class="Statement">rec</span> <span class="ocamlLCIdentifier"><span class="linkable">add_pop</span></span> <span class="ocamlLCIdentifier">n</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">n</span><span class="ocamlNone"> </span><span class="Statement">=</span><span class="ocamlNone"> </span><span class="Constant">0</span><span class="ocamlNone"> </span><span class="Statement">then</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span> <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">match</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span> <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Constant">Kpop</span> <span class="ocamlLCIdentifier">m</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier"><a href="#L141" title="ocaml/bytecomp/bytegen.ml:141">add_pop</a></span> <span class="Statement">(</span><span class="ocamlLCIdentifier">n</span> + <span class="ocamlLCIdentifier">m</span><span class="Statement">)</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a><br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Kreturn</span> <span class="ocamlLCIdentifier">m</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span> <span class="Statement">-&gt;</span> <span class="Constant">Kreturn</span><span class="Statement">(</span><span class="ocamlLCIdentifier">n</span> + <span class="ocamlLCIdentifier">m</span><span class="Statement">)</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a><br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Kraise</span> <span class="Statement">_</span> <span class="Statement">::</span> <span class="Statement">_</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a><br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Statement">_</span> <span class="Statement">-&gt;</span> <span class="Constant">Kpop</span> <span class="ocamlLCIdentifier">n</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a><br/></li>
<li></span><br/></li>
<li><span class="Comment">(* Add the constant &quot;unit&quot; in front of a continuation *)<br/></li>
<li></span><br/></li>
<li><a id="L151">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">add_const_unit</span></span> <span class="Statement">=</span> <span class="Statement">function<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">(</span><span class="Constant">Kacc</span> <span class="Statement">_</span> <span class="Statement">|</span> <span class="Constant">Kconst</span> <span class="Statement">_</span> <span class="Statement">|</span> <span class="Constant">Kgetglobal</span> <span class="Statement">_</span> <span class="Statement">|</span> <span class="Constant">Kpush_retaddr</span> <span class="Statement">_)</span> <span class="Statement">::</span> <span class="Statement">_</span> <span class="Statement">as</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a><br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span> <span class="Statement">-&gt;</span> <span class="Constant">Kconst</span> <span class="ocamlLCIdentifier">const_unit</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a><br/></li>
<li></span><br/></li>
<li><a id="L155">&#x200c;</a><span class="Statement">let</span> <span class="Statement">rec</span> <span class="ocamlLCIdentifier"><span class="linkable">push_dummies</span></span> <span class="ocamlLCIdentifier">n</span> <span class="ocamlLCIdentifier">k</span> <span class="Statement">=</span> <span class="Statement">match</span> <span class="ocamlLCIdentifier">n</span> <span class="Statement">with<br/></li>
<li></span><span class="Statement">|</span> <span class="Constant">0</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier">k<br/></li>
<li></span><span class="Statement">|</span> <span class="Statement">_</span> <span class="Statement">-&gt;</span> <span class="Constant">Kconst</span> <span class="ocamlLCIdentifier">const_unit</span><span class="Statement">::</span><span class="Constant">Kpush</span><span class="Statement">::</span><span class="ocamlLCIdentifier"><a href="#L155" title="ocaml/bytecomp/bytegen.ml:155">push_dummies</a></span> <span class="Statement">(</span><span class="ocamlLCIdentifier">n</span>-<span class="Constant">1</span><span class="Statement">)</span> <span class="ocamlLCIdentifier">k<br/></li>
<li></span><br/></li>
<li><br/></li>
<li><span class="Comment">(**** Auxiliary for compiling &quot;let rec&quot; ****)<br/></li>
<li></span><br/></li>
<li><a id="L162">&#x200c;</a><span class="Statement">type</span> <span class="ocamlLCIdentifier"><span class="linkable">rhs_kind</span></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">RHS_block</span> <span class="Statement">of</span> <span class="Type">int<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">RHS_infix</span> <span class="Statement">of</span> <span class="Statement">{</span> <span class="ocamlLCIdentifier">blocksize</span> : <span class="Type">int</span><span class="Statement">;</span> <span class="ocamlLCIdentifier"><a href="#L923" title="ocaml/bytecomp/bytegen.ml:923">offset</a></span> : <span class="Type">int</span> <span class="Statement">}<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">RHS_floatblock</span> <span class="Statement">of</span> <span class="Type">int<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">RHS_nonrec<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">RHS_function</span> <span class="Statement">of</span> <span class="Type">int</span> <span class="Statement">*</span> <span class="Type">int<br/></li>
<li></span><br/></li>
<li><a id="L169">&#x200c;</a><span class="Statement">let</span> <span class="Statement">rec</span> <span class="ocamlLCIdentifier"><span class="linkable">check_recordwith_updates</span></span> <span class="ocamlLCIdentifier">id</span> <span class="ocamlLCIdentifier">e</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">match</span> <span class="ocamlLCIdentifier">e</span> <span class="Statement">with<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Lsequence</span> <span class="Statement">(</span><span class="Constant">Lprim</span> <span class="Statement">((</span><span class="Constant">Psetfield</span> <span class="Statement">_</span> <span class="Statement">|</span> <span class="Constant">Psetfloatfield</span> <span class="Statement">_)</span>, <span class="Statement">[</span><span class="Constant">Lvar</span> <span class="ocamlLCIdentifier">id2</span><span class="Statement">;</span> <span class="Statement">_]</span>, <span class="Statement">_)</span>, <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier">id2</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">id</span> <span class="Statement">&amp;&amp;</span> <span class="ocamlLCIdentifier"><a href="#L169" title="ocaml/bytecomp/bytegen.ml:169">check_recordwith_updates</a></span> <span class="ocamlLCIdentifier">id</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a><br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Lvar</span> <span class="ocamlLCIdentifier">id2</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier">id2</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">id<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Statement">_</span> <span class="Statement">-&gt;</span> <span class="Constant">false<br/></li>
<li></span><br/></li>
<li><a id="L176">&#x200c;</a><span class="Statement">let</span> <span class="Statement">rec</span> <span class="ocamlLCIdentifier"><span class="linkable">size_of_lambda</span></span> <span class="ocamlLCIdentifier">env</span> <span class="Statement">=</span> <span class="Statement">function<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Lvar</span> <span class="ocamlLCIdentifier">id</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">begin</span><span class="ocamlEnd"> </span><span class="Statement">try</span><span class="ocamlEnd"> </span><span class="PreProc">Ident</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">find_same</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">id</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">env</span><span class="ocamlEnd"> </span><span class="Statement">with</span><span class="ocamlEnd"> </span><span class="Constant">Not_found</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;</span><span class="ocamlEnd"> </span><span class="Constant">RHS_nonrec</span><span class="ocamlEnd"> </span><span class="Statement">end<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Lfunction</span><span class="Statement">{</span><span class="ocamlLCIdentifier">params</span><span class="Statement">}</span> <span class="Statement">as</span> <span class="ocamlLCIdentifier">funct</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Constant">RHS_function</span> <span class="Statement">(</span><span class="Constant">2</span> + <span class="PreProc">Ident</span>.<span class="PreProc">Set</span>.<span class="ocamlLCIdentifier">cardinal</span><span class="Statement">(</span><span class="ocamlLCIdentifier">free_variables</span> <span class="ocamlLCIdentifier">funct</span><span class="Statement">)</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="PreProc">List</span>.<span class="ocamlLCIdentifier">length</span> <span class="ocamlLCIdentifier">params</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Llet</span> <span class="Statement">(</span><span class="Constant">Strict</span>, <span class="ocamlLCIdentifier">_k</span>, <span class="ocamlLCIdentifier">id</span>, <span class="Constant">Lprim</span> <span class="Statement">(</span><span class="Constant">Pduprecord</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">kind</span>, <span class="ocamlLCIdentifier">size</span><span class="Statement">)</span>, <span class="Statement">_</span>, <span class="Statement">_)</span>, <span class="ocamlLCIdentifier">body</span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">when</span> <span class="ocamlLCIdentifier"><a href="#L169" title="ocaml/bytecomp/bytegen.ml:169">check_recordwith_updates</a></span> <span class="ocamlLCIdentifier">id</span> <span class="ocamlLCIdentifier">body</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">begin</span><span class="ocamlEnd"> </span><span class="Statement">match</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">kind</span><span class="ocamlEnd"> </span><span class="Statement">with<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Constant">Record_regular</span><span class="ocamlEnd"> </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Constant">Record_inlined</span><span class="ocamlEnd"> </span><span class="Statement">_</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;</span><span class="ocamlEnd"> </span><span class="Constant">RHS_block</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">size<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Constant">Record_unboxed</span><span class="ocamlEnd"> </span><span class="Statement">_</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;</span><span class="ocamlEnd"> </span><span class="Statement">assert</span><span class="ocamlEnd"> </span><span class="Constant">false<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Constant">Record_float</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;</span><span class="ocamlEnd"> </span><span class="Constant">RHS_floatblock</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">size<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Constant">Record_extension</span><span class="ocamlEnd"> </span><span class="Statement">_</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;</span><span class="ocamlEnd"> </span><span class="Constant">RHS_block</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">size</span><span class="ocamlEnd"> + </span><span class="Constant">1</span><span class="Statement">)<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">end<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Llet</span><span class="Statement">(</span><span class="ocamlLCIdentifier">_str</span>, <span class="ocamlLCIdentifier">_k</span>, <span class="ocamlLCIdentifier">id</span>, <span class="ocamlLCIdentifier">arg</span>, <span class="ocamlLCIdentifier">body</span><span class="Statement">)</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L176" title="ocaml/bytecomp/bytegen.ml:176">size_of_lambda</a></span> <span class="Statement">(</span><span class="PreProc">Ident</span>.<span class="ocamlLCIdentifier">add</span> <span class="ocamlLCIdentifier">id</span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L176" title="ocaml/bytecomp/bytegen.ml:176">size_of_lambda</a></span> <span class="ocamlLCIdentifier">env</span> <span class="ocamlLCIdentifier">arg</span><span class="Statement">)</span> <span class="ocamlLCIdentifier">env</span><span class="Statement">)</span> <span class="ocamlLCIdentifier">body<br/></li>
<li></span>&nbsp; <span class="Comment">(* See the Lletrec case of <a href="#L565" title="ocaml/bytecomp/bytegen.ml:565">comp_expr</a> *)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Lletrec</span><span class="Statement">(</span><span class="ocamlLCIdentifier">bindings</span>, <span class="ocamlLCIdentifier">body</span><span class="Statement">)</span> <span class="Statement">when<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="PreProc">List</span>.<span class="ocamlLCIdentifier">for_all</span> <span class="Statement">(function</span> <span class="Statement">(_</span>, <span class="Constant">Lfunction</span> <span class="Statement">_)</span> <span class="Statement">-&gt;</span> <span class="Constant">true</span> <span class="Statement">|</span> <span class="Statement">_</span> <span class="Statement">-&gt;</span> <span class="Constant">false</span><span class="Statement">)</span> <span class="ocamlLCIdentifier">bindings</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Comment">(* let rec of functions *)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="#L629" title="ocaml/bytecomp/bytegen.ml:629">fv</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="PreProc">Ident</span>.<span class="PreProc">Set</span>.<span class="ocamlLCIdentifier">elements</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">free_variables</span> <span class="Statement">(</span><span class="Constant">Lletrec</span><span class="Statement">(</span><span class="ocamlLCIdentifier">bindings</span>, <span class="ocamlLCIdentifier">lambda_unit</span><span class="Statement">)))</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Comment">(* See Instruct(CLOSUREREC) in interp.<a href="#L935" title="ocaml/bytecomp/bytegen.ml:935">c</a> *)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">blocksize</span> <span class="Statement">=</span> <span class="PreProc">List</span>.<span class="ocamlLCIdentifier">length</span> <span class="ocamlLCIdentifier">bindings</span> <span class="Statement">*</span> <span class="Constant">3</span> - <span class="Constant">1</span> + <span class="PreProc">List</span>.<span class="ocamlLCIdentifier">length</span> <span class="ocamlLCIdentifier"><a href="#L629" title="ocaml/bytecomp/bytegen.ml:629">fv</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">offsets</span> <span class="Statement">=</span> <span class="PreProc">List</span>.<span class="ocamlLCIdentifier">mapi</span> <span class="Statement">(fun</span> <span class="ocamlLCIdentifier">i</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">id</span>, <span class="ocamlLCIdentifier">_e</span><span class="Statement">)</span> <span class="Statement">-&gt;</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">id</span>, <span class="ocamlLCIdentifier">i</span> <span class="Statement">*</span> <span class="Constant">3</span><span class="Statement">))</span> <span class="ocamlLCIdentifier">bindings</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">env</span> <span class="Statement">=</span> <span class="PreProc">List</span>.<span class="ocamlLCIdentifier">fold_right</span> <span class="Statement">(fun</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">id</span>, <span class="ocamlLCIdentifier"><a href="#L923" title="ocaml/bytecomp/bytegen.ml:923">offset</a></span><span class="Statement">)</span> <span class="ocamlLCIdentifier">env</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="PreProc">Ident</span>.<span class="ocamlLCIdentifier">add</span> <span class="ocamlLCIdentifier">id</span> <span class="Statement">(</span><span class="Constant">RHS_infix</span> <span class="Statement">{</span> <span class="ocamlLCIdentifier">blocksize</span><span class="Statement">;</span> <span class="ocamlLCIdentifier"><a href="#L923" title="ocaml/bytecomp/bytegen.ml:923">offset</a></span> <span class="Statement">})</span> <span class="ocamlLCIdentifier">env</span><span class="Statement">)</span> <span class="ocamlLCIdentifier">offsets</span> <span class="ocamlLCIdentifier">env</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L176" title="ocaml/bytecomp/bytegen.ml:176">size_of_lambda</a></span> <span class="ocamlLCIdentifier">env</span> <span class="ocamlLCIdentifier">body<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Lletrec</span><span class="Statement">(</span><span class="ocamlLCIdentifier">bindings</span>, <span class="ocamlLCIdentifier">body</span><span class="Statement">)</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">env</span> <span class="Statement">=</span> <span class="PreProc">List</span>.<span class="ocamlLCIdentifier">fold_right<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">(fun</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">id</span>, <span class="ocamlLCIdentifier">e</span><span class="Statement">)</span> <span class="ocamlLCIdentifier">env</span> <span class="Statement">-&gt;</span> <span class="PreProc">Ident</span>.<span class="ocamlLCIdentifier">add</span> <span class="ocamlLCIdentifier">id</span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L176" title="ocaml/bytecomp/bytegen.ml:176">size_of_lambda</a></span> <span class="ocamlLCIdentifier">env</span> <span class="ocamlLCIdentifier">e</span><span class="Statement">)</span> <span class="ocamlLCIdentifier">env</span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">bindings</span> <span class="ocamlLCIdentifier">env<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L176" title="ocaml/bytecomp/bytegen.ml:176">size_of_lambda</a></span> <span class="ocamlLCIdentifier">env</span> <span class="ocamlLCIdentifier">body<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Lprim</span><span class="Statement">(</span><span class="Constant">Pmakeblock</span> <span class="Statement">_</span>, <span class="ocamlLCIdentifier">args</span>, <span class="Statement">_)</span> <span class="Statement">-&gt;</span> <span class="Constant">RHS_block</span> <span class="Statement">(</span><span class="PreProc">List</span>.<span class="ocamlLCIdentifier">length</span> <span class="ocamlLCIdentifier">args</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Lprim</span> <span class="Statement">(</span><span class="Constant">Pmakearray</span> <span class="Statement">((</span><span class="Constant">Paddrarray</span><span class="Statement">|</span><span class="Constant">Pintarray</span><span class="Statement">)</span>, <span class="Statement">_)</span>, <span class="ocamlLCIdentifier">args</span>, <span class="Statement">_)</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Constant">RHS_block</span> <span class="Statement">(</span><span class="PreProc">List</span>.<span class="ocamlLCIdentifier">length</span> <span class="ocamlLCIdentifier">args</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Lprim</span> <span class="Statement">(</span><span class="Constant">Pmakearray</span> <span class="Statement">(</span><span class="Constant">Pfloatarray</span>, <span class="Statement">_)</span>, <span class="ocamlLCIdentifier">args</span>, <span class="Statement">_)</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Constant">RHS_floatblock</span> <span class="Statement">(</span><span class="PreProc">List</span>.<span class="ocamlLCIdentifier">length</span> <span class="ocamlLCIdentifier">args</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Lprim</span> <span class="Statement">(</span><span class="Constant">Pmakearray</span> <span class="Statement">(</span><span class="Constant">Pgenarray</span>, <span class="Statement">_)</span>, <span class="Statement">_</span>, <span class="Statement">_)</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp;&nbsp; <span class="Comment">(* Pgenarray is excluded from recursive bindings by the<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; check in Translcore.check_recursive_lambda *)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Constant">RHS_nonrec<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Lprim</span> <span class="Statement">(</span><span class="Constant">Pduprecord</span> <span class="Statement">((</span><span class="Constant">Record_regular</span> <span class="Statement">|</span> <span class="Constant">Record_inlined</span> <span class="Statement">_)</span>, <span class="ocamlLCIdentifier">size</span><span class="Statement">)</span>, <span class="Statement">_</span>, <span class="Statement">_)</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Constant">RHS_block</span> <span class="ocamlLCIdentifier">size<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Lprim</span> <span class="Statement">(</span><span class="Constant">Pduprecord</span> <span class="Statement">(</span><span class="Constant">Record_unboxed</span> <span class="Statement">_</span>, <span class="Statement">_)</span>, <span class="Statement">_</span>, <span class="Statement">_)</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">assert</span> <span class="Constant">false<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Lprim</span> <span class="Statement">(</span><span class="Constant">Pduprecord</span> <span class="Statement">(</span><span class="Constant">Record_extension</span> <span class="Statement">_</span>, <span class="ocamlLCIdentifier">size</span><span class="Statement">)</span>, <span class="Statement">_</span>, <span class="Statement">_)</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Constant">RHS_block</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">size</span> + <span class="Constant">1</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Lprim</span> <span class="Statement">(</span><span class="Constant">Pduprecord</span> <span class="Statement">(</span><span class="Constant">Record_float</span>, <span class="ocamlLCIdentifier">size</span><span class="Statement">)</span>, <span class="Statement">_</span>, <span class="Statement">_)</span> <span class="Statement">-&gt;</span> <span class="Constant">RHS_floatblock</span> <span class="ocamlLCIdentifier">size<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Levent</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">lam</span>, <span class="Statement">_)</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier"><a href="#L176" title="ocaml/bytecomp/bytegen.ml:176">size_of_lambda</a></span> <span class="ocamlLCIdentifier">env</span> <span class="ocamlLCIdentifier">lam<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Lsequence</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">_lam</span>, <span class="ocamlLCIdentifier">lam</span>'<span class="Statement">)</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier"><a href="#L176" title="ocaml/bytecomp/bytegen.ml:176">size_of_lambda</a></span> <span class="ocamlLCIdentifier">env</span> <span class="ocamlLCIdentifier">lam</span>'<br/></li>
<li>&nbsp; <span class="Statement">|</span> <span class="Statement">_</span> <span class="Statement">-&gt;</span> <span class="Constant">RHS_nonrec<br/></li>
<li></span><br/></li>
<li><span class="Comment">(**** Merging consecutive events ****)<br/></li>
<li></span><br/></li>
<li><a id="L232">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">copy_event</span></span> <span class="ocamlLCIdentifier"><a href="#L1020" title="ocaml/bytecomp/bytegen.ml:1020">ev</a></span> <span class="ocamlLCIdentifier">kind</span> <span class="ocamlLCIdentifier"><a href="#L1040" title="ocaml/bytecomp/bytegen.ml:1040">info</a></span> <span class="ocamlLCIdentifier">repr</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">{</span> <span class="ocamlLCIdentifier"><a href="#L1020" title="ocaml/bytecomp/bytegen.ml:1020">ev</a></span> <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier">ev_pos</span> <span class="Statement">=</span> <span class="Constant">0</span><span class="Statement">;</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Comment">(* patched in emitcode *)<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier">ev_kind</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">kind</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier">ev_info</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="#L1040" title="ocaml/bytecomp/bytegen.ml:1040">info</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier">ev_repr</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">repr</span> <span class="Statement">}<br/></li>
<li></span><br/></li>
<li><a id="L239">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">merge_infos</span></span> <span class="ocamlLCIdentifier"><a href="#L1020" title="ocaml/bytecomp/bytegen.ml:1020">ev</a></span> <span class="ocamlLCIdentifier"><a href="#L1020" title="ocaml/bytecomp/bytegen.ml:1020">ev</a></span>' <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">match</span> <span class="ocamlLCIdentifier"><a href="#L1020" title="ocaml/bytecomp/bytegen.ml:1020">ev</a></span>.<span class="ocamlLCIdentifier">ev_info</span>, <span class="ocamlLCIdentifier"><a href="#L1020" title="ocaml/bytecomp/bytegen.ml:1020">ev</a></span>'.<span class="ocamlLCIdentifier">ev_info</span> <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">Event_other</span>, <span class="ocamlLCIdentifier"><a href="#L1040" title="ocaml/bytecomp/bytegen.ml:1040">info</a></span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier"><a href="#L1040" title="ocaml/bytecomp/bytegen.ml:1040">info</a><br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="ocamlLCIdentifier"><a href="#L1040" title="ocaml/bytecomp/bytegen.ml:1040">info</a></span>, <span class="Constant">Event_other</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier"><a href="#L1040" title="ocaml/bytecomp/bytegen.ml:1040">info</a><br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Statement">_</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier">fatal_error</span> <span class="Constant">&quot;Bytegen.<a href="#L239" title="ocaml/bytecomp/bytegen.ml:239">merge_infos</a>&quot;<br/></li>
<li></span><br/></li>
<li><a id="L245">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">merge_repr</span></span> <span class="ocamlLCIdentifier"><a href="#L1020" title="ocaml/bytecomp/bytegen.ml:1020">ev</a></span> <span class="ocamlLCIdentifier"><a href="#L1020" title="ocaml/bytecomp/bytegen.ml:1020">ev</a></span>' <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">match</span> <span class="ocamlLCIdentifier"><a href="#L1020" title="ocaml/bytecomp/bytegen.ml:1020">ev</a></span>.<span class="ocamlLCIdentifier">ev_repr</span>, <span class="ocamlLCIdentifier"><a href="#L1020" title="ocaml/bytecomp/bytegen.ml:1020">ev</a></span>'.<span class="ocamlLCIdentifier">ev_repr</span> <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">Event_none</span>, <span class="ocamlLCIdentifier">x</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier">x<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="ocamlLCIdentifier">x</span>, <span class="Constant">Event_none</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier">x<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Event_parent</span> <span class="ocamlLCIdentifier"><a href="#L854" title="ocaml/bytecomp/bytegen.ml:854">r</a></span>, <span class="Constant">Event_child</span> <span class="ocamlLCIdentifier"><a href="#L854" title="ocaml/bytecomp/bytegen.ml:854">r</a></span>' <span class="Statement">when</span> <span class="ocamlLCIdentifier"><a href="#L854" title="ocaml/bytecomp/bytegen.ml:854">r</a></span> <span class="Statement">==</span> <span class="ocamlLCIdentifier"><a href="#L854" title="ocaml/bytecomp/bytegen.ml:854">r</a></span>' <span class="Statement">&amp;&amp;</span> <span class="Statement">!</span><span class="ocamlLCIdentifier"><a href="#L854" title="ocaml/bytecomp/bytegen.ml:854">r</a></span> <span class="Statement">=</span> <span class="Constant">1</span> <span class="Statement">-&gt;</span> <span class="Constant">Event_none<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Event_child</span> <span class="ocamlLCIdentifier"><a href="#L854" title="ocaml/bytecomp/bytegen.ml:854">r</a></span>, <span class="Constant">Event_parent</span> <span class="ocamlLCIdentifier"><a href="#L854" title="ocaml/bytecomp/bytegen.ml:854">r</a></span>' <span class="Statement">when</span> <span class="ocamlLCIdentifier"><a href="#L854" title="ocaml/bytecomp/bytegen.ml:854">r</a></span> <span class="Statement">==</span> <span class="ocamlLCIdentifier"><a href="#L854" title="ocaml/bytecomp/bytegen.ml:854">r</a></span>' <span class="Statement">-&gt;</span> <span class="Constant">Event_parent</span> <span class="ocamlLCIdentifier"><a href="#L854" title="ocaml/bytecomp/bytegen.ml:854">r</a><br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Statement">_</span>, <span class="Statement">_</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier">fatal_error</span> <span class="Constant">&quot;Bytegen.<a href="#L245" title="ocaml/bytecomp/bytegen.ml:245">merge_repr</a>&quot;<br/></li>
<li></span><br/></li>
<li><a id="L253">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">merge_events</span></span> <span class="ocamlLCIdentifier"><a href="#L1020" title="ocaml/bytecomp/bytegen.ml:1020">ev</a></span> <span class="ocamlLCIdentifier"><a href="#L1020" title="ocaml/bytecomp/bytegen.ml:1020">ev</a></span>' <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">maj</span>, <span class="ocamlLCIdentifier">min</span><span class="Statement">)</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">match</span> <span class="ocamlLCIdentifier"><a href="#L1020" title="ocaml/bytecomp/bytegen.ml:1020">ev</a></span>.<span class="ocamlLCIdentifier">ev_kind</span>, <span class="ocamlLCIdentifier"><a href="#L1020" title="ocaml/bytecomp/bytegen.ml:1020">ev</a></span>'.<span class="ocamlLCIdentifier">ev_kind</span> <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; <span class="Comment">(* Discard pseudo-events *)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Constant">Event_pseudo</span>,&nbsp; <span class="Statement">_</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier"><a href="#L1020" title="ocaml/bytecomp/bytegen.ml:1020">ev</a></span>', <span class="ocamlLCIdentifier"><a href="#L1020" title="ocaml/bytecomp/bytegen.ml:1020">ev</a><br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Statement">_</span>,&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">Event_pseudo</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier"><a href="#L1020" title="ocaml/bytecomp/bytegen.ml:1020">ev</a></span>,&nbsp; <span class="ocamlLCIdentifier"><a href="#L1020" title="ocaml/bytecomp/bytegen.ml:1020">ev</a></span>'<br/></li>
<li>&nbsp; &nbsp; <span class="Comment">(* Keep following <a href="#L992" title="ocaml/bytecomp/bytegen.ml:992">event</a>, supposedly more informative *)<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Event_before</span>,&nbsp; <span class="Statement">(</span><span class="Constant">Event_after</span> <span class="Statement">_</span> <span class="Statement">|</span> <span class="Constant">Event_before</span><span class="Statement">)</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier"><a href="#L1020" title="ocaml/bytecomp/bytegen.ml:1020">ev</a></span>',&nbsp; <span class="ocamlLCIdentifier"><a href="#L1020" title="ocaml/bytecomp/bytegen.ml:1020">ev</a><br/></li>
<li></span>&nbsp; &nbsp; <span class="Comment">(* Discard following events, supposedly less informative *)<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Event_after</span> <span class="Statement">_</span>, <span class="Statement">(</span><span class="Constant">Event_after</span> <span class="Statement">_</span> <span class="Statement">|</span> <span class="Constant">Event_before</span><span class="Statement">)</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier"><a href="#L1020" title="ocaml/bytecomp/bytegen.ml:1020">ev</a></span>, <span class="ocamlLCIdentifier"><a href="#L1020" title="ocaml/bytecomp/bytegen.ml:1020">ev</a></span>'<br/></li>
<li>&nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier"><a href="#L232" title="ocaml/bytecomp/bytegen.ml:232">copy_event</a></span> <span class="ocamlLCIdentifier">maj</span> <span class="ocamlLCIdentifier">maj</span>.<span class="ocamlLCIdentifier">ev_kind</span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L239" title="ocaml/bytecomp/bytegen.ml:239">merge_infos</a></span> <span class="ocamlLCIdentifier">maj</span> <span class="ocamlLCIdentifier">min</span><span class="Statement">)</span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L245" title="ocaml/bytecomp/bytegen.ml:245">merge_repr</a></span> <span class="ocamlLCIdentifier">maj</span> <span class="ocamlLCIdentifier">min</span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li><a id="L266">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">weaken_event</span></span> <span class="ocamlLCIdentifier"><a href="#L1020" title="ocaml/bytecomp/bytegen.ml:1020">ev</a></span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">match</span> <span class="ocamlLCIdentifier"><a href="#L1020" title="ocaml/bytecomp/bytegen.ml:1020">ev</a></span>.<span class="ocamlLCIdentifier">ev_kind</span> <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">Event_after</span> <span class="Statement">_</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">begin</span><span class="ocamlEnd"> </span><span class="Statement">match</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span><span class="ocamlEnd"> </span><span class="Statement">with<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Constant">Kpush</span><span class="ocamlEnd"> </span><span class="Statement">::</span><span class="ocamlEnd"> </span><span class="Constant">Kevent</span><span class="ocamlEnd"> </span><span class="Statement">({</span><span class="ocamlLCIdentifier">ev_repr</span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="Constant">Event_none</span><span class="Statement">}</span><span class="ocamlEnd"> </span><span class="Statement">as</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L1020" title="ocaml/bytecomp/bytegen.ml:1020">ev</a></span><span class="ocamlEnd">'</span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="Statement">::</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L935" title="ocaml/bytecomp/bytegen.ml:935">c</a></span><span class="ocamlEnd"> </span><span class="Statement">-&gt;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">begin</span><span class="ocamlEnd"> </span><span class="Statement">match</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L1020" title="ocaml/bytecomp/bytegen.ml:1020">ev</a></span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">ev_info</span><span class="ocamlEnd"> </span><span class="Statement">with<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Constant">Event_return</span><span class="ocamlEnd"> </span><span class="Statement">_</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Comment">(* Weaken <a href="#L992" title="ocaml/bytecomp/bytegen.ml:992">event</a> *)<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">repr</span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">ref</span><span class="ocamlEnd"> </span><span class="Constant">1</span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L1020" title="ocaml/bytecomp/bytegen.ml:1020">ev</a></span><span class="ocamlEnd"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="#L232" title="ocaml/bytecomp/bytegen.ml:232">copy_event</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L1020" title="ocaml/bytecomp/bytegen.ml:1020">ev</a></span><span class="ocamlEnd"> </span><span class="Constant">Event_pseudo</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L1020" title="ocaml/bytecomp/bytegen.ml:1020">ev</a></span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">ev_info</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="Constant">Event_parent</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">repr</span><span class="Statement">)<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">and</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L1020" title="ocaml/bytecomp/bytegen.ml:1020">ev</a></span><span class="ocamlEnd">' </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="#L232" title="ocaml/bytecomp/bytegen.ml:232">copy_event</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L1020" title="ocaml/bytecomp/bytegen.ml:1020">ev</a></span><span class="ocamlEnd">' </span><span class="ocamlLCIdentifier"><a href="#L1020" title="ocaml/bytecomp/bytegen.ml:1020">ev</a></span><span class="ocamlEnd">'.</span><span class="ocamlLCIdentifier">ev_kind</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L1020" title="ocaml/bytecomp/bytegen.ml:1020">ev</a></span><span class="ocamlEnd">'.</span><span class="ocamlLCIdentifier">ev_info</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="Constant">Event_child</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">repr</span><span class="Statement">)<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Constant">Kevent</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L1020" title="ocaml/bytecomp/bytegen.ml:1020">ev</a></span><span class="ocamlEnd"> </span><span class="Statement">::</span><span class="ocamlEnd"> </span><span class="Constant">Kpush</span><span class="ocamlEnd"> </span><span class="Statement">::</span><span class="ocamlEnd"> </span><span class="Constant">Kevent</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L1020" title="ocaml/bytecomp/bytegen.ml:1020">ev</a></span><span class="ocamlEnd">' </span><span class="Statement">::</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L935" title="ocaml/bytecomp/bytegen.ml:935">c</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Statement">_</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Comment">(* Only keep following <a href="#L992" title="ocaml/bytecomp/bytegen.ml:992">event</a>, equivalent *)<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">end<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Statement">_</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Constant">Kevent</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L1020" title="ocaml/bytecomp/bytegen.ml:1020">ev</a></span><span class="ocamlEnd"> </span><span class="Statement">::</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">end<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Statement">_</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Constant">Kevent</span> <span class="ocamlLCIdentifier"><a href="#L1020" title="ocaml/bytecomp/bytegen.ml:1020">ev</a></span> <span class="Statement">::</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a><br/></li>
<li></span><br/></li>
<li><a id="L291">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">add_event</span></span> <span class="ocamlLCIdentifier"><a href="#L1020" title="ocaml/bytecomp/bytegen.ml:1020">ev</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">function<br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">Kevent</span> <span class="ocamlLCIdentifier"><a href="#L1020" title="ocaml/bytecomp/bytegen.ml:1020">ev</a></span>' <span class="Statement">::</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier"><a href="#L266" title="ocaml/bytecomp/bytegen.ml:266">weaken_event</a></span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L253" title="ocaml/bytecomp/bytegen.ml:253">merge_events</a></span> <span class="ocamlLCIdentifier"><a href="#L1020" title="ocaml/bytecomp/bytegen.ml:1020">ev</a></span> <span class="ocamlLCIdentifier"><a href="#L1020" title="ocaml/bytecomp/bytegen.ml:1020">ev</a></span>'<span class="Statement">)</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a><br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier"><a href="#L266" title="ocaml/bytecomp/bytegen.ml:266">weaken_event</a></span> <span class="ocamlLCIdentifier"><a href="#L1020" title="ocaml/bytecomp/bytegen.ml:1020">ev</a></span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a><br/></li>
<li></span><br/></li>
<li><span class="Comment">(* Pseudo events are ignored by the debugger. They are only used for<br/></li>
<li></span><span class="Comment">&nbsp;&nbsp; generating backtraces.<br/></li>
<li></span><br/></li>
<li><span class="Comment">&nbsp;&nbsp; We prefer adding this <a href="#L992" title="ocaml/bytecomp/bytegen.ml:992">event</a> here rather than in lambda generation<br/></li>
<li></span><span class="Comment">&nbsp;&nbsp; 1) there are many different situations where a Pmakeblock can<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; be generated<br/></li>
<li></span><span class="Comment">&nbsp;&nbsp; 2) we prefer inserting a pseudo <a href="#L992" title="ocaml/bytecomp/bytegen.ml:992">event</a> rather than an <a href="#L992" title="ocaml/bytecomp/bytegen.ml:992">event</a> after<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; to prevent the debugger to stop at every single allocation. *)<br/></li>
<li><a id="L304">&#x200c;</a></span><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">add_pseudo_event</span></span> <span class="ocamlLCIdentifier">loc</span> <span class="ocamlLCIdentifier">modname</span> <span class="ocamlLCIdentifier"><a href="#L935" title="ocaml/bytecomp/bytegen.ml:935">c</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="Statement">!</span><span class="PreProc">Clflags</span><span class="ocamlNone">.</span><span class="ocamlLCIdentifier">debug</span><span class="ocamlNone"> </span><span class="Statement">then<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="#L991" title="ocaml/bytecomp/bytegen.ml:991">ev_defname</a></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">string_of_scoped_location</span> <span class="ocamlLCIdentifier">loc</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="#L1020" title="ocaml/bytecomp/bytegen.ml:1020">ev</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">{</span> <span class="ocamlLCIdentifier">ev_pos</span> <span class="Statement">=</span> <span class="Constant">0</span><span class="Statement">;</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Comment">(* patched in emitcode *)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">ev_module</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">modname</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">ev_loc</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">to_location</span> <span class="ocamlLCIdentifier">loc</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L991" title="ocaml/bytecomp/bytegen.ml:991">ev_defname</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">ev_kind</span> <span class="Statement">=</span> <span class="Constant">Event_pseudo</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">ev_info</span> <span class="Statement">=</span> <span class="Constant">Event_other</span><span class="Statement">;</span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">(* Dummy *)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">ev_typenv</span> <span class="Statement">=</span> <span class="PreProc">Env</span>.<span class="Constant">Env_empty</span><span class="Statement">;</span>&nbsp; &nbsp; <span class="Comment">(* Dummy *)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">ev_typsubst</span> <span class="Statement">=</span> <span class="PreProc">Subst</span>.<span class="ocamlLCIdentifier">identity</span><span class="Statement">;</span> <span class="Comment">(* Dummy *)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">ev_compenv</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="#L36" title="ocaml/bytecomp/bytegen.ml:36">empty_env</a></span><span class="Statement">;</span>&nbsp; &nbsp; &nbsp;&nbsp; <span class="Comment">(* Dummy *)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">ev_stacksize</span> <span class="Statement">=</span> <span class="Constant">0</span><span class="Statement">;</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Comment">(* Dummy *)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">ev_repr</span> <span class="Statement">=</span> <span class="Constant">Event_none</span> <span class="Statement">}</span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">(* Dummy *)<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L291" title="ocaml/bytecomp/bytegen.ml:291">add_event</a></span> <span class="ocamlLCIdentifier"><a href="#L1020" title="ocaml/bytecomp/bytegen.ml:1020">ev</a></span> <span class="ocamlLCIdentifier"><a href="#L935" title="ocaml/bytecomp/bytegen.ml:935">c</a><br/></li>
<li></span>&nbsp; <span class="Statement">else</span> <span class="ocamlLCIdentifier"><a href="#L935" title="ocaml/bytecomp/bytegen.ml:935">c</a><br/></li>
<li></span><br/></li>
<li><span class="Comment">(**** Compilation of a lambda expression ****)<br/></li>
<li></span><br/></li>
<li><a id="L325">&#x200c;</a><span class="Statement">type</span> <span class="ocamlLCIdentifier"><span class="linkable">stack_info</span></span> <span class="Statement">=</span> <span class="Statement">{<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier">try_blocks</span> : <span class="Type">int</span> <span class="Type">list</span><span class="Statement">;<br/></li>
<li></span>&nbsp; <span class="Comment">(* list of stack size for each nested try block *)<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier">sz_static_raises</span> : <span class="Statement">(</span><span class="Type">int</span> <span class="Statement">*</span> <span class="Statement">(</span><span class="Type">int</span> <span class="Statement">*</span> <span class="Type">int</span> <span class="Statement">*</span> <span class="Type">int</span> <span class="Type">list</span><span class="Statement">))</span> <span class="Type">list</span><span class="Statement">;<br/></li>
<li></span>&nbsp; <span class="Comment">(* association staticraise numbers -&gt; (<a href="#L621" title="ocaml/bytecomp/bytegen.ml:621">lbl</a>,size of stack, try_blocks *)<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier">max_stack_used</span> : <span class="Type">int</span> <span class="ocamlLCIdentifier">ref</span><span class="Statement">;<br/></li>
<li></span>&nbsp; <span class="Comment">(* Maximal stack size reached during the current function body *)<br/></li>
<li></span><span class="Statement">}<br/></li>
<li></span><br/></li>
<li><a id="L334">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">create_stack_info</span></span> <span class="Constant">()</span> <span class="Statement">=</span> <span class="Statement">{<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier">try_blocks</span> <span class="Statement">=</span> <span class="Constant">[]</span><span class="Statement">;<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier">sz_static_raises</span> <span class="Statement">=</span> <span class="Constant">[]</span><span class="Statement">;<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier">max_stack_used</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">ref</span> <span class="Constant">0<br/></li>
<li></span><span class="Statement">}<br/></li>
<li></span><br/></li>
<li><span class="Comment">(* association staticraise numbers -&gt; (<a href="#L621" title="ocaml/bytecomp/bytegen.ml:621">lbl</a>,size of stack, try_blocks *)<br/></li>
<li></span><br/></li>
<li><a id="L342">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">push_static_raise</span></span> <span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span> <span class="ocamlLCIdentifier">i</span> <span class="ocamlLCIdentifier"><a href="#L897" title="ocaml/bytecomp/bytegen.ml:897">lbl_handler</a></span> <span class="ocamlLCIdentifier">sz</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">{</span> <span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a><br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">sz_static_raises</span> <span class="Statement">=</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">i</span>, <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L897" title="ocaml/bytecomp/bytegen.ml:897">lbl_handler</a></span>, <span class="ocamlLCIdentifier">sz</span>, <span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span>.<span class="ocamlLCIdentifier">try_blocks</span><span class="Statement">))<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">::</span> <span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span>.<span class="ocamlLCIdentifier">sz_static_raises<br/></li>
<li></span>&nbsp; <span class="Statement">}<br/></li>
<li></span><br/></li>
<li><a id="L349">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">find_raise_label</span></span> <span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span> <span class="ocamlLCIdentifier">i</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">try<br/></li>
<li></span>&nbsp; &nbsp; <span class="PreProc">List</span>.<span class="ocamlLCIdentifier">assoc</span> <span class="ocamlLCIdentifier">i</span> <span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span>.<span class="ocamlLCIdentifier">sz_static_raises<br/></li>
<li></span>&nbsp; <span class="Statement">with<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Not_found</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="PreProc">Misc</span>.<span class="ocamlLCIdentifier">fatal_error<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="Constant">&quot;exit(&quot;</span><span class="Statement">^</span><span class="PreProc">Int</span>.<span class="ocamlLCIdentifier"><a href="bytesections.mli.html#L38" title="ocaml/bytecomp/bytesections.mli:38">to_string</a></span> <span class="ocamlLCIdentifier">i</span><span class="Statement">^</span><span class="Constant">&quot;) outside appropriated catch&quot;</span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li><span class="Comment">(* Will the translation of <a href="#L906" title="ocaml/bytecomp/bytegen.ml:906">l</a> lead to a jump to <a href="instruct.ml.html#L51" title="ocaml/bytecomp/instruct.ml:51">label</a> ? *)<br/></li>
<li><a id="L358">&#x200c;</a></span><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">code_as_jump</span></span> <span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span> <span class="ocamlLCIdentifier"><a href="#L906" title="ocaml/bytecomp/bytegen.ml:906">l</a></span> <span class="ocamlLCIdentifier">sz</span> <span class="Statement">=</span> <span class="Statement">match</span> <span class="ocamlLCIdentifier"><a href="#L906" title="ocaml/bytecomp/bytegen.ml:906">l</a></span> <span class="Statement">with<br/></li>
<li></span><span class="Statement">|</span> <span class="Constant">Lstaticraise</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">i</span>,<span class="Constant">[]</span><span class="Statement">)</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="instruct.ml.html#L51" title="ocaml/bytecomp/instruct.ml:51">label</a></span>,<span class="ocamlLCIdentifier">size</span>,<span class="ocamlLCIdentifier">tb</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="#L349" title="ocaml/bytecomp/bytegen.ml:349">find_raise_label</a></span> <span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span> <span class="ocamlLCIdentifier">i</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">sz</span><span class="ocamlNone"> </span><span class="Statement">=</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">size</span><span class="ocamlNone"> </span><span class="Statement">&amp;&amp;</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">tb</span><span class="ocamlNone"> </span><span class="Statement">==</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span><span class="ocamlNone">.</span><span class="ocamlLCIdentifier">try_blocks</span><span class="ocamlNone"> </span><span class="Statement">then<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Constant">Some</span> <span class="ocamlLCIdentifier"><a href="instruct.ml.html#L51" title="ocaml/bytecomp/instruct.ml:51">label</a><br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Constant">None<br/></li>
<li></span><span class="Statement">|</span> <span class="Statement">_</span> <span class="Statement">-&gt;</span> <span class="Constant">None<br/></li>
<li></span><br/></li>
<li><span class="Comment">(* Function bodies that remain to be compiled *)<br/></li>
<li></span><br/></li>
<li><a id="L369">&#x200c;</a><span class="Statement">type</span> <span class="ocamlLCIdentifier"><span class="linkable">function_to_compile</span></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">{</span> <span class="ocamlLCIdentifier">params</span>: <span class="PreProc">Ident</span>.<span class="ocamlLCIdentifier"><a href="bytesections.mli.html#L23" title="ocaml/bytecomp/bytesections.mli:23">t</a></span> <span class="Type">list</span><span class="Statement">;</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Comment">(* function parameters *)<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier">body</span>: <span class="ocamlLCIdentifier">lambda</span><span class="Statement">;</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Comment">(* the function body *)<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="instruct.ml.html#L51" title="ocaml/bytecomp/instruct.ml:51">label</a></span>: <span class="ocamlLCIdentifier"><a href="instruct.ml.html#L51" title="ocaml/bytecomp/instruct.ml:51">label</a></span><span class="Statement">;</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Comment">(* the <a href="instruct.ml.html#L51" title="ocaml/bytecomp/instruct.ml:51">label</a> of the function entry *)<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier">free_vars</span>: <span class="PreProc">Ident</span>.<span class="ocamlLCIdentifier"><a href="bytesections.mli.html#L23" title="ocaml/bytecomp/bytesections.mli:23">t</a></span> <span class="Type">list</span><span class="Statement">;</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">(* free variables of the function *)<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier">num_defs</span>: <span class="Type">int</span><span class="Statement">;</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">(* number of mutually recursive definitions *)<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier">rec_vars</span>: <span class="PreProc">Ident</span>.<span class="ocamlLCIdentifier"><a href="bytesections.mli.html#L23" title="ocaml/bytecomp/bytesections.mli:23">t</a></span> <span class="Type">list</span><span class="Statement">;</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Comment">(* mutually recursive fn names *)<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier">rec_pos</span>: <span class="Type">int</span> <span class="Statement">}</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">(* rank in recursive definition *)<br/></li>
<li></span><br/></li>
<li><a id="L378">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">functions_to_compile</span></span>&nbsp; <span class="Statement">=</span> <span class="Statement">(</span><span class="PreProc">Stack</span>.<span class="ocamlLCIdentifier">create</span> <span class="Constant">()</span> : <span class="ocamlLCIdentifier"><a href="#L369" title="ocaml/bytecomp/bytegen.ml:369">function_to_compile</a></span> <span class="PreProc">Stack</span>.<span class="ocamlLCIdentifier"><a href="bytesections.mli.html#L23" title="ocaml/bytecomp/bytesections.mli:23">t</a></span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li><span class="Comment">(* Name of current compilation unit (for debugging events) *)<br/></li>
<li></span><br/></li>
<li><a id="L382">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">compunit_name</span></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">ref</span> <span class="Constant">&quot;&quot;<br/></li>
<li></span><br/></li>
<li><a id="L384">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">check_stack</span></span> <span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span> <span class="ocamlLCIdentifier">sz</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">curr</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span>.<span class="ocamlLCIdentifier">max_stack_used</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">sz</span><span class="ocamlNone"> </span><span class="Statement">&gt;</span><span class="ocamlNone"> </span><span class="Statement">!</span><span class="ocamlLCIdentifier">curr</span><span class="ocamlNone"> </span><span class="Statement">then</span> <span class="ocamlLCIdentifier">curr</span> <span class="Statement">:=</span> <span class="ocamlLCIdentifier">sz<br/></li>
<li></span><br/></li>
<li><span class="Comment">(* Sequence of string tests *)<br/></li>
<li></span><br/></li>
<li><br/></li>
<li><span class="Comment">(* Translate a primitive to a <a href="meta.ml.html#L19" title="ocaml/bytecomp/meta.ml:19">bytecode</a> <a href="instruct.ml.html#L53" title="ocaml/bytecomp/instruct.ml:53">instruction</a> (possibly a call to a C<br/></li>
<li></span><span class="Comment">&nbsp;&nbsp; function) *)<br/></li>
<li></span><br/></li>
<li><a id="L394">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">comp_bint_primitive</span></span> <span class="ocamlLCIdentifier">bi</span> <span class="ocamlLCIdentifier">suff</span> <span class="ocamlLCIdentifier">args</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">pref</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">match</span> <span class="ocamlLCIdentifier">bi</span> <span class="Statement">with</span> <span class="Constant">Pnativeint</span> <span class="Statement">-&gt;</span> <span class="Constant">&quot;caml_nativeint_&quot;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Pint32</span> <span class="Statement">-&gt;</span> <span class="Constant">&quot;caml_int32_&quot;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Pint64</span> <span class="Statement">-&gt;</span> <span class="Constant">&quot;caml_int64_&quot;</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Constant">Kccall</span><span class="Statement">(</span><span class="ocamlLCIdentifier">pref</span> <span class="Statement">^</span> <span class="ocamlLCIdentifier">suff</span>, <span class="PreProc">List</span>.<span class="ocamlLCIdentifier">length</span> <span class="ocamlLCIdentifier">args</span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li><a id="L401">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">comp_primitive</span></span> <span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span> <span class="ocamlLCIdentifier"><a href="#L819" title="ocaml/bytecomp/bytegen.ml:819">p</a></span> <span class="ocamlLCIdentifier">sz</span> <span class="ocamlLCIdentifier">args</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier"><a href="#L384" title="ocaml/bytecomp/bytegen.ml:384">check_stack</a></span> <span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span> <span class="ocamlLCIdentifier">sz</span><span class="Statement">;<br/></li>
<li></span>&nbsp; <span class="Statement">match</span> <span class="ocamlLCIdentifier"><a href="#L819" title="ocaml/bytecomp/bytegen.ml:819">p</a></span> <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">Pgetglobal</span> <span class="ocamlLCIdentifier">id</span> <span class="Statement">-&gt;</span> <span class="Constant">Kgetglobal</span> <span class="ocamlLCIdentifier">id<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Psetglobal</span> <span class="ocamlLCIdentifier">id</span> <span class="Statement">-&gt;</span> <span class="Constant">Ksetglobal</span> <span class="ocamlLCIdentifier">id<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pintcomp</span> <span class="ocamlLCIdentifier">cmp</span> <span class="Statement">-&gt;</span> <span class="Constant">Kintcomp</span> <span class="ocamlLCIdentifier">cmp<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pcompare_ints</span> <span class="Statement">-&gt;</span> <span class="Constant">Kccall</span><span class="Statement">(</span><span class="Constant">&quot;caml_int_compare&quot;</span>, <span class="Constant">2</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pcompare_floats</span> <span class="Statement">-&gt;</span> <span class="Constant">Kccall</span><span class="Statement">(</span><span class="Constant">&quot;caml_float_compare&quot;</span>, <span class="Constant">2</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pcompare_bints</span> <span class="ocamlLCIdentifier">bi</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier"><a href="#L394" title="ocaml/bytecomp/bytegen.ml:394">comp_bint_primitive</a></span> <span class="ocamlLCIdentifier">bi</span> <span class="Constant">&quot;<a href="bytelink.ml.html#L24" title="ocaml/bytecomp/bytelink.ml:24">compare</a>&quot;</span> <span class="ocamlLCIdentifier">args<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pfield</span><span class="Statement">(</span><span class="ocamlLCIdentifier">n</span>, <span class="ocamlLCIdentifier">_ptr</span>, <span class="ocamlLCIdentifier">_mut</span><span class="Statement">)</span> <span class="Statement">-&gt;</span> <span class="Constant">Kgetfield</span> <span class="ocamlLCIdentifier">n<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pfield_computed</span> <span class="Statement">-&gt;</span> <span class="Constant">Kgetvectitem<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Psetfield</span><span class="Statement">(</span><span class="ocamlLCIdentifier">n</span>, <span class="ocamlLCIdentifier">_ptr</span>, <span class="ocamlLCIdentifier">_init</span><span class="Statement">)</span> <span class="Statement">-&gt;</span> <span class="Constant">Ksetfield</span> <span class="ocamlLCIdentifier">n<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Psetfield_computed</span><span class="Statement">(</span><span class="ocamlLCIdentifier">_ptr</span>, <span class="ocamlLCIdentifier">_init</span><span class="Statement">)</span> <span class="Statement">-&gt;</span> <span class="Constant">Ksetvectitem<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Psetfloatfield</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">n</span>, <span class="ocamlLCIdentifier">_init</span><span class="Statement">)</span> <span class="Statement">-&gt;</span> <span class="Constant">Ksetfloatfield</span> <span class="ocamlLCIdentifier">n<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pduprecord</span> <span class="Statement">_</span> <span class="Statement">-&gt;</span> <span class="Constant">Kccall</span><span class="Statement">(</span><span class="Constant">&quot;caml_obj_dup&quot;</span>, <span class="Constant">1</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pccall</span> <span class="ocamlLCIdentifier"><a href="#L819" title="ocaml/bytecomp/bytegen.ml:819">p</a></span> <span class="Statement">-&gt;</span> <span class="Constant">Kccall</span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L819" title="ocaml/bytecomp/bytegen.ml:819">p</a></span>.<span class="ocamlLCIdentifier">prim_name</span>, <span class="ocamlLCIdentifier"><a href="#L819" title="ocaml/bytecomp/bytegen.ml:819">p</a></span>.<span class="ocamlLCIdentifier">prim_arity</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pperform</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L384" title="ocaml/bytecomp/bytegen.ml:384">check_stack</a></span> <span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span> <span class="Statement">(</span><span class="ocamlLCIdentifier">sz</span> + <span class="Constant">4</span><span class="Statement">);<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Constant">Kperform<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pnegint</span> <span class="Statement">-&gt;</span> <span class="Constant">Knegint<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Paddint</span> <span class="Statement">-&gt;</span> <span class="Constant">Kaddint<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Psubint</span> <span class="Statement">-&gt;</span> <span class="Constant">Ksubint<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pmulint</span> <span class="Statement">-&gt;</span> <span class="Constant">Kmulint<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pdivint</span> <span class="Statement">_</span> <span class="Statement">-&gt;</span> <span class="Constant">Kdivint<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pmodint</span> <span class="Statement">_</span> <span class="Statement">-&gt;</span> <span class="Constant">Kmodint<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pandint</span> <span class="Statement">-&gt;</span> <span class="Constant">Kandint<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Porint</span> <span class="Statement">-&gt;</span> <span class="Constant">Korint<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pxorint</span> <span class="Statement">-&gt;</span> <span class="Constant">Kxorint<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Plslint</span> <span class="Statement">-&gt;</span> <span class="Constant">Klslint<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Plsrint</span> <span class="Statement">-&gt;</span> <span class="Constant">Klsrint<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pasrint</span> <span class="Statement">-&gt;</span> <span class="Constant">Kasrint<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Poffsetint</span> <span class="ocamlLCIdentifier">n</span> <span class="Statement">-&gt;</span> <span class="Constant">Koffsetint</span> <span class="ocamlLCIdentifier">n<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Poffsetref</span> <span class="ocamlLCIdentifier">n</span> <span class="Statement">-&gt;</span> <span class="Constant">Koffsetref</span> <span class="ocamlLCIdentifier">n<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pintoffloat</span> <span class="Statement">-&gt;</span> <span class="Constant">Kccall</span><span class="Statement">(</span><span class="Constant">&quot;caml_int_of_float&quot;</span>, <span class="Constant">1</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pfloatofint</span> <span class="Statement">-&gt;</span> <span class="Constant">Kccall</span><span class="Statement">(</span><span class="Constant">&quot;caml_float_of_int&quot;</span>, <span class="Constant">1</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pnegfloat</span> <span class="Statement">-&gt;</span> <span class="Constant">Kccall</span><span class="Statement">(</span><span class="Constant">&quot;caml_neg_float&quot;</span>, <span class="Constant">1</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pabsfloat</span> <span class="Statement">-&gt;</span> <span class="Constant">Kccall</span><span class="Statement">(</span><span class="Constant">&quot;caml_abs_float&quot;</span>, <span class="Constant">1</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Paddfloat</span> <span class="Statement">-&gt;</span> <span class="Constant">Kccall</span><span class="Statement">(</span><span class="Constant">&quot;caml_add_float&quot;</span>, <span class="Constant">2</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Psubfloat</span> <span class="Statement">-&gt;</span> <span class="Constant">Kccall</span><span class="Statement">(</span><span class="Constant">&quot;caml_sub_float&quot;</span>, <span class="Constant">2</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pmulfloat</span> <span class="Statement">-&gt;</span> <span class="Constant">Kccall</span><span class="Statement">(</span><span class="Constant">&quot;caml_mul_float&quot;</span>, <span class="Constant">2</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pdivfloat</span> <span class="Statement">-&gt;</span> <span class="Constant">Kccall</span><span class="Statement">(</span><span class="Constant">&quot;caml_div_float&quot;</span>, <span class="Constant">2</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pstringlength</span> <span class="Statement">-&gt;</span> <span class="Constant">Kccall</span><span class="Statement">(</span><span class="Constant">&quot;caml_ml_string_length&quot;</span>, <span class="Constant">1</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pbyteslength</span> <span class="Statement">-&gt;</span> <span class="Constant">Kccall</span><span class="Statement">(</span><span class="Constant">&quot;caml_ml_bytes_length&quot;</span>, <span class="Constant">1</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pstringrefs</span> <span class="Statement">-&gt;</span> <span class="Constant">Kccall</span><span class="Statement">(</span><span class="Constant">&quot;caml_string_get&quot;</span>, <span class="Constant">2</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pbytesrefs</span> <span class="Statement">-&gt;</span> <span class="Constant">Kccall</span><span class="Statement">(</span><span class="Constant">&quot;caml_bytes_get&quot;</span>, <span class="Constant">2</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pbytessets</span> <span class="Statement">-&gt;</span> <span class="Constant">Kccall</span><span class="Statement">(</span><span class="Constant">&quot;caml_bytes_set&quot;</span>, <span class="Constant">3</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pstringrefu</span> <span class="Statement">-&gt;</span> <span class="Constant">Kgetstringchar<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pbytesrefu</span> <span class="Statement">-&gt;</span> <span class="Constant">Kgetbyteschar<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pbytessetu</span> <span class="Statement">-&gt;</span> <span class="Constant">Ksetbyteschar<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pstring_load_16</span><span class="Statement">(_)</span> <span class="Statement">-&gt;</span> <span class="Constant">Kccall</span><span class="Statement">(</span><span class="Constant">&quot;caml_string_get16&quot;</span>, <span class="Constant">2</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pstring_load_32</span><span class="Statement">(_)</span> <span class="Statement">-&gt;</span> <span class="Constant">Kccall</span><span class="Statement">(</span><span class="Constant">&quot;caml_string_get32&quot;</span>, <span class="Constant">2</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pstring_load_64</span><span class="Statement">(_)</span> <span class="Statement">-&gt;</span> <span class="Constant">Kccall</span><span class="Statement">(</span><span class="Constant">&quot;caml_string_get64&quot;</span>, <span class="Constant">2</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pbytes_set_16</span><span class="Statement">(_)</span> <span class="Statement">-&gt;</span> <span class="Constant">Kccall</span><span class="Statement">(</span><span class="Constant">&quot;caml_bytes_set16&quot;</span>, <span class="Constant">3</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pbytes_set_32</span><span class="Statement">(_)</span> <span class="Statement">-&gt;</span> <span class="Constant">Kccall</span><span class="Statement">(</span><span class="Constant">&quot;caml_bytes_set32&quot;</span>, <span class="Constant">3</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pbytes_set_64</span><span class="Statement">(_)</span> <span class="Statement">-&gt;</span> <span class="Constant">Kccall</span><span class="Statement">(</span><span class="Constant">&quot;caml_bytes_set64&quot;</span>, <span class="Constant">3</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pbytes_load_16</span><span class="Statement">(_)</span> <span class="Statement">-&gt;</span> <span class="Constant">Kccall</span><span class="Statement">(</span><span class="Constant">&quot;caml_bytes_get16&quot;</span>, <span class="Constant">2</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pbytes_load_32</span><span class="Statement">(_)</span> <span class="Statement">-&gt;</span> <span class="Constant">Kccall</span><span class="Statement">(</span><span class="Constant">&quot;caml_bytes_get32&quot;</span>, <span class="Constant">2</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pbytes_load_64</span><span class="Statement">(_)</span> <span class="Statement">-&gt;</span> <span class="Constant">Kccall</span><span class="Statement">(</span><span class="Constant">&quot;caml_bytes_get64&quot;</span>, <span class="Constant">2</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Parraylength</span> <span class="Statement">_</span> <span class="Statement">-&gt;</span> <span class="Constant">Kvectlength<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Parrayrefs</span> <span class="Constant">Pgenarray</span> <span class="Statement">-&gt;</span> <span class="Constant">Kccall</span><span class="Statement">(</span><span class="Constant">&quot;caml_array_get&quot;</span>, <span class="Constant">2</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Parrayrefs</span> <span class="Constant">Pfloatarray</span> <span class="Statement">-&gt;</span> <span class="Constant">Kccall</span><span class="Statement">(</span><span class="Constant">&quot;caml_floatarray_get&quot;</span>, <span class="Constant">2</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Parrayrefs</span> <span class="Statement">_</span> <span class="Statement">-&gt;</span> <span class="Constant">Kccall</span><span class="Statement">(</span><span class="Constant">&quot;caml_array_get_addr&quot;</span>, <span class="Constant">2</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Parraysets</span> <span class="Constant">Pgenarray</span> <span class="Statement">-&gt;</span> <span class="Constant">Kccall</span><span class="Statement">(</span><span class="Constant">&quot;caml_array_set&quot;</span>, <span class="Constant">3</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Parraysets</span> <span class="Constant">Pfloatarray</span> <span class="Statement">-&gt;</span> <span class="Constant">Kccall</span><span class="Statement">(</span><span class="Constant">&quot;caml_floatarray_set&quot;</span>, <span class="Constant">3</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Parraysets</span> <span class="Statement">_</span> <span class="Statement">-&gt;</span> <span class="Constant">Kccall</span><span class="Statement">(</span><span class="Constant">&quot;caml_array_set_addr&quot;</span>, <span class="Constant">3</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Parrayrefu</span> <span class="Constant">Pgenarray</span> <span class="Statement">-&gt;</span> <span class="Constant">Kccall</span><span class="Statement">(</span><span class="Constant">&quot;caml_array_unsafe_get&quot;</span>, <span class="Constant">2</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Parrayrefu</span> <span class="Constant">Pfloatarray</span> <span class="Statement">-&gt;</span> <span class="Constant">Kccall</span><span class="Statement">(</span><span class="Constant">&quot;caml_floatarray_unsafe_get&quot;</span>, <span class="Constant">2</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Parrayrefu</span> <span class="Statement">_</span> <span class="Statement">-&gt;</span> <span class="Constant">Kgetvectitem<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Parraysetu</span> <span class="Constant">Pgenarray</span> <span class="Statement">-&gt;</span> <span class="Constant">Kccall</span><span class="Statement">(</span><span class="Constant">&quot;caml_array_unsafe_set&quot;</span>, <span class="Constant">3</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Parraysetu</span> <span class="Constant">Pfloatarray</span> <span class="Statement">-&gt;</span> <span class="Constant">Kccall</span><span class="Statement">(</span><span class="Constant">&quot;caml_floatarray_unsafe_set&quot;</span>, <span class="Constant">3</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Parraysetu</span> <span class="Statement">_</span> <span class="Statement">-&gt;</span> <span class="Constant">Ksetvectitem<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pctconst</span> <span class="ocamlLCIdentifier"><a href="#L935" title="ocaml/bytecomp/bytegen.ml:935">c</a></span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp;&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">const_name</span> <span class="Statement">=</span> <span class="Statement">match</span> <span class="ocamlLCIdentifier"><a href="#L935" title="ocaml/bytecomp/bytegen.ml:935">c</a></span> <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">|</span> <span class="Constant">Big_endian</span> <span class="Statement">-&gt;</span> <span class="Constant">&quot;big_endian&quot;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">|</span> <span class="Constant">Word_size</span> <span class="Statement">-&gt;</span> <span class="Constant">&quot;word_size&quot;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">|</span> <span class="Constant">Int_size</span> <span class="Statement">-&gt;</span> <span class="Constant">&quot;int_size&quot;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">|</span> <span class="Constant">Max_wosize</span> <span class="Statement">-&gt;</span> <span class="Constant">&quot;max_wosize&quot;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">|</span> <span class="Constant">Ostype_unix</span> <span class="Statement">-&gt;</span> <span class="Constant">&quot;ostype_unix&quot;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">|</span> <span class="Constant">Ostype_win32</span> <span class="Statement">-&gt;</span> <span class="Constant">&quot;ostype_win32&quot;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">|</span> <span class="Constant">Ostype_cygwin</span> <span class="Statement">-&gt;</span> <span class="Constant">&quot;ostype_cygwin&quot;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">|</span> <span class="Constant">Backend_type</span> <span class="Statement">-&gt;</span> <span class="Constant">&quot;backend_type&quot;</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp;&nbsp; <span class="Constant">Kccall</span><span class="Statement">(</span><span class="PreProc">Printf</span>.<span class="ocamlLCIdentifier">sprintf</span> <span class="Constant">&quot;caml_sys_const_%s&quot;</span> <span class="ocamlLCIdentifier">const_name</span>, <span class="Constant">1</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pisint</span> <span class="Statement">-&gt;</span> <span class="Constant">Kisint<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pisout</span> <span class="Statement">-&gt;</span> <span class="Constant">Kisout<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pbintofint</span> <span class="ocamlLCIdentifier">bi</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier"><a href="#L394" title="ocaml/bytecomp/bytegen.ml:394">comp_bint_primitive</a></span> <span class="ocamlLCIdentifier">bi</span> <span class="Constant">&quot;of_int&quot;</span> <span class="ocamlLCIdentifier">args<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pintofbint</span> <span class="ocamlLCIdentifier">bi</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier"><a href="#L394" title="ocaml/bytecomp/bytegen.ml:394">comp_bint_primitive</a></span> <span class="ocamlLCIdentifier">bi</span> <span class="Constant">&quot;to_int&quot;</span> <span class="ocamlLCIdentifier">args<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pcvtbint</span><span class="Statement">(</span><span class="ocamlLCIdentifier">src</span>, <span class="ocamlLCIdentifier">dst</span><span class="Statement">)</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">begin</span><span class="ocamlEnd"> </span><span class="Statement">match</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">src</span><span class="ocamlEnd">, </span><span class="ocamlLCIdentifier">dst</span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="Statement">with<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="Constant">Pint32</span><span class="ocamlEnd">, </span><span class="Constant">Pnativeint</span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;</span><span class="ocamlEnd"> </span><span class="Constant">Kccall</span><span class="Statement">(</span><span class="Constant">&quot;caml_nativeint_of_int32&quot;</span><span class="ocamlEnd">, </span><span class="Constant">1</span><span class="Statement">)<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="Constant">Pnativeint</span><span class="ocamlEnd">, </span><span class="Constant">Pint32</span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;</span><span class="ocamlEnd"> </span><span class="Constant">Kccall</span><span class="Statement">(</span><span class="Constant">&quot;caml_nativeint_to_int32&quot;</span><span class="ocamlEnd">, </span><span class="Constant">1</span><span class="Statement">)<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="Constant">Pint32</span><span class="ocamlEnd">, </span><span class="Constant">Pint64</span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;</span><span class="ocamlEnd"> </span><span class="Constant">Kccall</span><span class="Statement">(</span><span class="Constant">&quot;caml_int64_of_int32&quot;</span><span class="ocamlEnd">, </span><span class="Constant">1</span><span class="Statement">)<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="Constant">Pint64</span><span class="ocamlEnd">, </span><span class="Constant">Pint32</span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;</span><span class="ocamlEnd"> </span><span class="Constant">Kccall</span><span class="Statement">(</span><span class="Constant">&quot;caml_int64_to_int32&quot;</span><span class="ocamlEnd">, </span><span class="Constant">1</span><span class="Statement">)<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="Constant">Pnativeint</span><span class="ocamlEnd">, </span><span class="Constant">Pint64</span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;</span><span class="ocamlEnd"> </span><span class="Constant">Kccall</span><span class="Statement">(</span><span class="Constant">&quot;caml_int64_of_nativeint&quot;</span><span class="ocamlEnd">, </span><span class="Constant">1</span><span class="Statement">)<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="Constant">Pint64</span><span class="ocamlEnd">, </span><span class="Constant">Pnativeint</span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;</span><span class="ocamlEnd"> </span><span class="Constant">Kccall</span><span class="Statement">(</span><span class="Constant">&quot;caml_int64_to_nativeint&quot;</span><span class="ocamlEnd">, </span><span class="Constant">1</span><span class="Statement">)<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Statement">((</span><span class="Constant">Pint32</span><span class="ocamlEnd"> </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Constant">Pint64</span><span class="ocamlEnd"> </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Constant">Pnativeint</span><span class="Statement">)</span><span class="ocamlEnd">, </span><span class="Statement">_)</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier">fatal_error</span><span class="ocamlEnd"> </span><span class="Constant">&quot;Bytegen.<a href="#L401" title="ocaml/bytecomp/bytegen.ml:401">comp_primitive</a>: invalid Pcvtbint cast&quot;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">end<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pnegbint</span> <span class="ocamlLCIdentifier">bi</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier"><a href="#L394" title="ocaml/bytecomp/bytegen.ml:394">comp_bint_primitive</a></span> <span class="ocamlLCIdentifier">bi</span> <span class="Constant">&quot;neg&quot;</span> <span class="ocamlLCIdentifier">args<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Paddbint</span> <span class="ocamlLCIdentifier">bi</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier"><a href="#L394" title="ocaml/bytecomp/bytegen.ml:394">comp_bint_primitive</a></span> <span class="ocamlLCIdentifier">bi</span> <span class="Constant">&quot;add&quot;</span> <span class="ocamlLCIdentifier">args<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Psubbint</span> <span class="ocamlLCIdentifier">bi</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier"><a href="#L394" title="ocaml/bytecomp/bytegen.ml:394">comp_bint_primitive</a></span> <span class="ocamlLCIdentifier">bi</span> <span class="Constant">&quot;sub&quot;</span> <span class="ocamlLCIdentifier">args<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pmulbint</span> <span class="ocamlLCIdentifier">bi</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier"><a href="#L394" title="ocaml/bytecomp/bytegen.ml:394">comp_bint_primitive</a></span> <span class="ocamlLCIdentifier">bi</span> <span class="Constant">&quot;mul&quot;</span> <span class="ocamlLCIdentifier">args<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pdivbint</span> <span class="Statement">{</span> <span class="ocamlLCIdentifier">size</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">bi</span> <span class="Statement">}</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier"><a href="#L394" title="ocaml/bytecomp/bytegen.ml:394">comp_bint_primitive</a></span> <span class="ocamlLCIdentifier">bi</span> <span class="Constant">&quot;div&quot;</span> <span class="ocamlLCIdentifier">args<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pmodbint</span> <span class="Statement">{</span> <span class="ocamlLCIdentifier">size</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">bi</span> <span class="Statement">}</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier"><a href="#L394" title="ocaml/bytecomp/bytegen.ml:394">comp_bint_primitive</a></span> <span class="ocamlLCIdentifier">bi</span> <span class="Constant">&quot;mod&quot;</span> <span class="ocamlLCIdentifier">args<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pandbint</span> <span class="ocamlLCIdentifier">bi</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier"><a href="#L394" title="ocaml/bytecomp/bytegen.ml:394">comp_bint_primitive</a></span> <span class="ocamlLCIdentifier">bi</span> <span class="Constant">&quot;and&quot;</span> <span class="ocamlLCIdentifier">args<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Porbint</span> <span class="ocamlLCIdentifier">bi</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier"><a href="#L394" title="ocaml/bytecomp/bytegen.ml:394">comp_bint_primitive</a></span> <span class="ocamlLCIdentifier">bi</span> <span class="Constant">&quot;or&quot;</span> <span class="ocamlLCIdentifier">args<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pxorbint</span> <span class="ocamlLCIdentifier">bi</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier"><a href="#L394" title="ocaml/bytecomp/bytegen.ml:394">comp_bint_primitive</a></span> <span class="ocamlLCIdentifier">bi</span> <span class="Constant">&quot;xor&quot;</span> <span class="ocamlLCIdentifier">args<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Plslbint</span> <span class="ocamlLCIdentifier">bi</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier"><a href="#L394" title="ocaml/bytecomp/bytegen.ml:394">comp_bint_primitive</a></span> <span class="ocamlLCIdentifier">bi</span> <span class="Constant">&quot;shift_left&quot;</span> <span class="ocamlLCIdentifier">args<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Plsrbint</span> <span class="ocamlLCIdentifier">bi</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier"><a href="#L394" title="ocaml/bytecomp/bytegen.ml:394">comp_bint_primitive</a></span> <span class="ocamlLCIdentifier">bi</span> <span class="Constant">&quot;shift_right_unsigned&quot;</span> <span class="ocamlLCIdentifier">args<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pasrbint</span> <span class="ocamlLCIdentifier">bi</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier"><a href="#L394" title="ocaml/bytecomp/bytegen.ml:394">comp_bint_primitive</a></span> <span class="ocamlLCIdentifier">bi</span> <span class="Constant">&quot;shift_right&quot;</span> <span class="ocamlLCIdentifier">args<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pbintcomp</span><span class="Statement">(_</span>, <span class="Constant">Ceq</span><span class="Statement">)</span> <span class="Statement">-&gt;</span> <span class="Constant">Kccall</span><span class="Statement">(</span><span class="Constant">&quot;caml_equal&quot;</span>, <span class="Constant">2</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pbintcomp</span><span class="Statement">(_</span>, <span class="Constant">Cne</span><span class="Statement">)</span> <span class="Statement">-&gt;</span> <span class="Constant">Kccall</span><span class="Statement">(</span><span class="Constant">&quot;caml_notequal&quot;</span>, <span class="Constant">2</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pbintcomp</span><span class="Statement">(_</span>, <span class="Constant">Clt</span><span class="Statement">)</span> <span class="Statement">-&gt;</span> <span class="Constant">Kccall</span><span class="Statement">(</span><span class="Constant">&quot;caml_lessthan&quot;</span>, <span class="Constant">2</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pbintcomp</span><span class="Statement">(_</span>, <span class="Constant">Cgt</span><span class="Statement">)</span> <span class="Statement">-&gt;</span> <span class="Constant">Kccall</span><span class="Statement">(</span><span class="Constant">&quot;caml_greaterthan&quot;</span>, <span class="Constant">2</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pbintcomp</span><span class="Statement">(_</span>, <span class="Constant">Cle</span><span class="Statement">)</span> <span class="Statement">-&gt;</span> <span class="Constant">Kccall</span><span class="Statement">(</span><span class="Constant">&quot;caml_lessequal&quot;</span>, <span class="Constant">2</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pbintcomp</span><span class="Statement">(_</span>, <span class="Constant">Cge</span><span class="Statement">)</span> <span class="Statement">-&gt;</span> <span class="Constant">Kccall</span><span class="Statement">(</span><span class="Constant">&quot;caml_greaterequal&quot;</span>, <span class="Constant">2</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pbigarrayref</span><span class="Statement">(_</span>, <span class="ocamlLCIdentifier">n</span>, <span class="Statement">_</span>, <span class="Statement">_)</span> <span class="Statement">-&gt;</span> <span class="Constant">Kccall</span><span class="Statement">(</span><span class="Constant">&quot;caml_ba_get_&quot;</span> <span class="Statement">^</span> <span class="PreProc">Int</span>.<span class="ocamlLCIdentifier"><a href="bytesections.mli.html#L38" title="ocaml/bytecomp/bytesections.mli:38">to_string</a></span> <span class="ocamlLCIdentifier">n</span>, <span class="ocamlLCIdentifier">n</span> + <span class="Constant">1</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pbigarrayset</span><span class="Statement">(_</span>, <span class="ocamlLCIdentifier">n</span>, <span class="Statement">_</span>, <span class="Statement">_)</span> <span class="Statement">-&gt;</span> <span class="Constant">Kccall</span><span class="Statement">(</span><span class="Constant">&quot;caml_ba_set_&quot;</span> <span class="Statement">^</span> <span class="PreProc">Int</span>.<span class="ocamlLCIdentifier"><a href="bytesections.mli.html#L38" title="ocaml/bytecomp/bytesections.mli:38">to_string</a></span> <span class="ocamlLCIdentifier">n</span>, <span class="ocamlLCIdentifier">n</span> + <span class="Constant">2</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pbigarraydim</span><span class="Statement">(</span><span class="ocamlLCIdentifier">n</span><span class="Statement">)</span> <span class="Statement">-&gt;</span> <span class="Constant">Kccall</span><span class="Statement">(</span><span class="Constant">&quot;caml_ba_dim_&quot;</span> <span class="Statement">^</span> <span class="PreProc">Int</span>.<span class="ocamlLCIdentifier"><a href="bytesections.mli.html#L38" title="ocaml/bytecomp/bytesections.mli:38">to_string</a></span> <span class="ocamlLCIdentifier">n</span>, <span class="Constant">1</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pbigstring_load_16</span><span class="Statement">(_)</span> <span class="Statement">-&gt;</span> <span class="Constant">Kccall</span><span class="Statement">(</span><span class="Constant">&quot;caml_ba_uint8_get16&quot;</span>, <span class="Constant">2</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pbigstring_load_32</span><span class="Statement">(_)</span> <span class="Statement">-&gt;</span> <span class="Constant">Kccall</span><span class="Statement">(</span><span class="Constant">&quot;caml_ba_uint8_get32&quot;</span>, <span class="Constant">2</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pbigstring_load_64</span><span class="Statement">(_)</span> <span class="Statement">-&gt;</span> <span class="Constant">Kccall</span><span class="Statement">(</span><span class="Constant">&quot;caml_ba_uint8_get64&quot;</span>, <span class="Constant">2</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pbigstring_set_16</span><span class="Statement">(_)</span> <span class="Statement">-&gt;</span> <span class="Constant">Kccall</span><span class="Statement">(</span><span class="Constant">&quot;caml_ba_uint8_set16&quot;</span>, <span class="Constant">3</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pbigstring_set_32</span><span class="Statement">(_)</span> <span class="Statement">-&gt;</span> <span class="Constant">Kccall</span><span class="Statement">(</span><span class="Constant">&quot;caml_ba_uint8_set32&quot;</span>, <span class="Constant">3</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pbigstring_set_64</span><span class="Statement">(_)</span> <span class="Statement">-&gt;</span> <span class="Constant">Kccall</span><span class="Statement">(</span><span class="Constant">&quot;caml_ba_uint8_set64&quot;</span>, <span class="Constant">3</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pbswap16</span> <span class="Statement">-&gt;</span> <span class="Constant">Kccall</span><span class="Statement">(</span><span class="Constant">&quot;caml_bswap16&quot;</span>, <span class="Constant">1</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pbbswap</span><span class="Statement">(</span><span class="ocamlLCIdentifier">bi</span><span class="Statement">)</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier"><a href="#L394" title="ocaml/bytecomp/bytegen.ml:394">comp_bint_primitive</a></span> <span class="ocamlLCIdentifier">bi</span> <span class="Constant">&quot;bswap&quot;</span> <span class="ocamlLCIdentifier">args<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pint_as_pointer</span> <span class="Statement">-&gt;</span> <span class="Constant">Kccall</span><span class="Statement">(</span><span class="Constant">&quot;caml_int_as_pointer&quot;</span>, <span class="Constant">1</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pbytes_to_string</span> <span class="Statement">-&gt;</span> <span class="Constant">Kccall</span><span class="Statement">(</span><span class="Constant">&quot;caml_string_of_bytes&quot;</span>, <span class="Constant">1</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pbytes_of_string</span> <span class="Statement">-&gt;</span> <span class="Constant">Kccall</span><span class="Statement">(</span><span class="Constant">&quot;caml_bytes_of_string&quot;</span>, <span class="Constant">1</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Patomic_load</span> <span class="Statement">_</span> <span class="Statement">-&gt;</span> <span class="Constant">Kccall</span><span class="Statement">(</span><span class="Constant">&quot;caml_atomic_load&quot;</span>, <span class="Constant">1</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Patomic_exchange</span> <span class="Statement">-&gt;</span> <span class="Constant">Kccall</span><span class="Statement">(</span><span class="Constant">&quot;caml_atomic_exchange&quot;</span>, <span class="Constant">2</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Patomic_cas</span> <span class="Statement">-&gt;</span> <span class="Constant">Kccall</span><span class="Statement">(</span><span class="Constant">&quot;caml_atomic_cas&quot;</span>, <span class="Constant">3</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Patomic_fetch_add</span> <span class="Statement">-&gt;</span> <span class="Constant">Kccall</span><span class="Statement">(</span><span class="Constant">&quot;caml_atomic_fetch_add&quot;</span>, <span class="Constant">2</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pdls_get</span> <span class="Statement">-&gt;</span> <span class="Constant">Kccall</span><span class="Statement">(</span><span class="Constant">&quot;caml_domain_dls_get&quot;</span>, <span class="Constant">1</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Comment">(* The cases below are handled in [<a href="#L565" title="ocaml/bytecomp/bytegen.ml:565">comp_expr</a>] before the [<a href="#L401" title="ocaml/bytecomp/bytegen.ml:401">comp_primitive</a>] call<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; (in the order in which they appear below),<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; so they should never be reached in this function. *)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Prunstack</span> <span class="Statement">|</span> <span class="Constant">Presume</span> <span class="Statement">|</span> <span class="Constant">Preperform<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pignore</span> <span class="Statement">|</span> <span class="Constant">Popaque<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pnot</span> <span class="Statement">|</span> <span class="Constant">Psequand</span> <span class="Statement">|</span> <span class="Constant">Psequor<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Praise</span> <span class="Statement">_<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pmakearray</span> <span class="Statement">_</span> <span class="Statement">|</span> <span class="Constant">Pduparray</span> <span class="Statement">_<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pfloatcomp</span> <span class="Statement">_<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pmakeblock</span> <span class="Statement">_<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Pfloatfield</span> <span class="Statement">_<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">fatal_error</span> <span class="Constant">&quot;Bytegen.<a href="#L401" title="ocaml/bytecomp/bytegen.ml:401">comp_primitive</a>&quot;<br/></li>
<li></span><br/></li>
<li><a id="L549">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">is_immed</span></span> <span class="ocamlLCIdentifier">n</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="instruct.ml.html#L113" title="ocaml/bytecomp/instruct.ml:113">immed_min</a></span> <span class="Statement">&lt;=</span> <span class="ocamlLCIdentifier">n</span> <span class="Statement">&amp;&amp;</span> <span class="ocamlLCIdentifier">n</span> <span class="Statement">&lt;=</span> <span class="ocamlLCIdentifier"><a href="instruct.mli.html#L134" title="ocaml/bytecomp/instruct.mli:134">immed_max</a><br/></li>
<li></span><br/></li>
<li><span class="Statement">module</span><span class="PreProc"> Storer</span><span class="ocamlPreDef"> </span><span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="PreProc">Switch.Store<br/></li>
<li><a id="L553">&#x200c;</a><a id="L553">&#x200c;</a></span>&nbsp; &nbsp; <span class="ocamlFuncWith">(</span><span class="PreProc">struct</span><span class="ocamlFuncStruct"> </span><span class="Statement">type</span><span class="ocamlFuncStruct"> </span><span class="ocamlLCIdentifier"><span class="linkable">t</span></span><span class="ocamlFuncStruct"> </span><span class="Statement">=</span><span class="ocamlFuncStruct"> </span><span class="ocamlLCIdentifier">lambda</span><span class="ocamlFuncStruct"> </span><span class="Statement">type</span><span class="ocamlFuncStruct"> </span><span class="ocamlLCIdentifier"><span class="linkable">key</span></span><span class="ocamlFuncStruct"> </span><span class="Statement">=</span><span class="ocamlFuncStruct"> </span><span class="ocamlLCIdentifier">lambda<br/></li>
<li><a id="L554">&#x200c;</a></span><span class="ocamlFuncStruct">&nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlFuncStruct"> </span><span class="ocamlLCIdentifier"><span class="linkable">compare_key</span></span><span class="ocamlFuncStruct"> </span><span class="Statement">=</span><span class="ocamlFuncStruct"> </span><span class="PreProc">Stdlib</span><span class="ocamlFuncStruct">.</span><span class="ocamlLCIdentifier"><a href="bytelink.ml.html#L24" title="ocaml/bytecomp/bytelink.ml:24">compare</a><br/></li>
<li><a id="L555">&#x200c;</a></span><span class="ocamlFuncStruct">&nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlFuncStruct"> </span><span class="ocamlLCIdentifier"><span class="linkable">make_key</span></span><span class="ocamlFuncStruct"> </span><span class="Statement">=</span><span class="ocamlFuncStruct"> </span><span class="PreProc">Lambda</span><span class="ocamlFuncStruct">.</span><span class="ocamlLCIdentifier"><span class="linkable">make_key</span></span><span class="ocamlFuncStruct"> </span><span class="PreProc">end</span><span class="ocamlFuncWith">)<br/></li>
<li></span><br/></li>
<li><span class="Comment">(* Compile an expression.<br/></li>
<li></span><span class="Comment">&nbsp;&nbsp; The value of the expression is left in the accumulator.<br/></li>
<li></span><span class="Comment">&nbsp;&nbsp; env = compilation environment<br/></li>
<li></span><span class="Comment">&nbsp;&nbsp; exp = the lambda expression to compile<br/></li>
<li></span><span class="Comment">&nbsp;&nbsp; sz = current size of the stack frame<br/></li>
<li></span><span class="Comment">&nbsp;&nbsp; <a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a> = list of instructions to execute afterwards<br/></li>
<li></span><span class="Comment">&nbsp;&nbsp; Result = list of instructions that evaluate exp, then perform <a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a>. *)<br/></li>
<li></span><br/></li>
<li><a id="L565">&#x200c;</a><span class="Statement">let</span> <span class="Statement">rec</span> <span class="ocamlLCIdentifier"><span class="linkable">comp_expr</span></span> <span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span> <span class="ocamlLCIdentifier">env</span> <span class="ocamlLCIdentifier">exp</span> <span class="ocamlLCIdentifier">sz</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier"><a href="#L384" title="ocaml/bytecomp/bytegen.ml:384">check_stack</a></span> <span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span> <span class="ocamlLCIdentifier">sz</span><span class="Statement">;<br/></li>
<li></span>&nbsp; <span class="Statement">match</span> <span class="ocamlLCIdentifier">exp</span> <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">Lvar</span> <span class="ocamlLCIdentifier">id</span> <span class="Statement">|</span> <span class="Constant">Lmutvar</span> <span class="ocamlLCIdentifier">id</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">begin</span><span class="ocamlEnd"> </span><span class="Statement">try<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L985" title="ocaml/bytecomp/bytegen.ml:985">pos</a></span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="PreProc">Ident</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">find_same</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">id</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">env</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">ce_stack</span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Constant">Kacc</span><span class="Statement">(</span><span class="ocamlLCIdentifier">sz</span><span class="ocamlEnd"> - </span><span class="ocamlLCIdentifier"><a href="#L985" title="ocaml/bytecomp/bytegen.ml:985">pos</a></span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="Statement">::</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">with</span><span class="ocamlEnd"> </span><span class="Constant">Not_found</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">try<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L985" title="ocaml/bytecomp/bytegen.ml:985">pos</a></span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="PreProc">Ident</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">find_same</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">id</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">env</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">ce_heap</span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Constant">Kenvacc</span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L985" title="ocaml/bytecomp/bytegen.ml:985">pos</a></span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="Statement">::</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">with</span><span class="ocamlEnd"> </span><span class="Constant">Not_found</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">try<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">ofs</span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="PreProc">Ident</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">find_same</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">id</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">env</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">ce_rec</span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Constant">Koffsetclosure</span><span class="Statement">(</span><span class="ocamlLCIdentifier">ofs</span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="Statement">::</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">with</span><span class="ocamlEnd"> </span><span class="Constant">Not_found</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier">fatal_error</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="Constant">&quot;Bytegen.<a href="#L565" title="ocaml/bytecomp/bytegen.ml:565">comp_expr</a>: var &quot;</span><span class="ocamlEnd"> </span><span class="Statement">^</span><span class="ocamlEnd"> </span><span class="PreProc">Ident</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">unique_name</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">id</span><span class="Statement">)<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">end<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Lconst</span> <span class="ocamlLCIdentifier">cst</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Constant">Kconst</span> <span class="ocamlLCIdentifier">cst</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a><br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Lapply</span><span class="Statement">{</span><span class="ocamlLCIdentifier">ap_func</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">func</span><span class="Statement">;</span> <span class="ocamlLCIdentifier">ap_args</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">args</span><span class="Statement">}</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="#L606" title="ocaml/bytecomp/bytegen.ml:606">nargs</a></span> <span class="Statement">=</span> <span class="PreProc">List</span>.<span class="ocamlLCIdentifier">length</span> <span class="ocamlLCIdentifier">args</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier"><a href="#L102" title="ocaml/bytecomp/bytegen.ml:102">is_tailcall</a></span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span><span class="ocamlNone"> </span><span class="Statement">then</span> <span class="Statement">begin<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="#L1059" title="ocaml/bytecomp/bytegen.ml:1059">comp_args</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">env</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">args</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">sz<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">(</span><span class="Constant">Kpush</span><span class="ocamlEnd"> </span><span class="Statement">::</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L565" title="ocaml/bytecomp/bytegen.ml:565">comp_expr</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">env</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">func</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">sz</span><span class="ocamlEnd"> + </span><span class="ocamlLCIdentifier"><a href="#L606" title="ocaml/bytecomp/bytegen.ml:606">nargs</a></span><span class="Statement">)<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">(</span><span class="Constant">Kappterm</span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L606" title="ocaml/bytecomp/bytegen.ml:606">nargs</a></span><span class="ocamlEnd">, </span><span class="ocamlLCIdentifier">sz</span><span class="ocamlEnd"> + </span><span class="ocamlLCIdentifier"><a href="#L606" title="ocaml/bytecomp/bytegen.ml:606">nargs</a></span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="Statement">::</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L95" title="ocaml/bytecomp/bytegen.ml:95">discard_dead_code</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span><span class="Statement">))<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">end</span> <span class="Statement">else</span> <span class="Statement">begin<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier"><a href="#L606" title="ocaml/bytecomp/bytegen.ml:606">nargs</a></span><span class="ocamlNone"> </span><span class="Statement">&lt;</span><span class="ocamlNone"> </span><span class="Constant">4</span><span class="ocamlNone"> </span><span class="Statement">then<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="#L1059" title="ocaml/bytecomp/bytegen.ml:1059">comp_args</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">env</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">args</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">sz<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">(</span><span class="Constant">Kpush</span><span class="ocamlEnd"> </span><span class="Statement">::<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="ocamlLCIdentifier"><a href="#L565" title="ocaml/bytecomp/bytegen.ml:565">comp_expr</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">env</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">func</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">sz</span><span class="ocamlEnd"> + </span><span class="ocamlLCIdentifier"><a href="#L606" title="ocaml/bytecomp/bytegen.ml:606">nargs</a></span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="Constant">Kapply</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L606" title="ocaml/bytecomp/bytegen.ml:606">nargs</a></span><span class="ocamlEnd"> </span><span class="Statement">::</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span><span class="Statement">))<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">else</span><span class="ocamlEnd"> </span><span class="Statement">begin<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L621" title="ocaml/bytecomp/bytegen.ml:621">lbl</a></span><span class="ocamlEnd">, </span><span class="ocamlLCIdentifier"><a href="#L1048" title="ocaml/bytecomp/bytegen.ml:1048">cont1</a></span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L57" title="ocaml/bytecomp/bytegen.ml:57">label_code</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Constant">Kpush_retaddr</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L621" title="ocaml/bytecomp/bytegen.ml:621">lbl</a></span><span class="ocamlEnd"> </span><span class="Statement">::<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="#L1059" title="ocaml/bytecomp/bytegen.ml:1059">comp_args</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">env</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">args</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">sz</span><span class="ocamlEnd"> + </span><span class="Constant">3</span><span class="Statement">)<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">(</span><span class="Constant">Kpush</span><span class="ocamlEnd"> </span><span class="Statement">::</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L565" title="ocaml/bytecomp/bytegen.ml:565">comp_expr</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">env</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">func</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">sz</span><span class="ocamlEnd"> + </span><span class="Constant">3</span><span class="ocamlEnd"> + </span><span class="ocamlLCIdentifier"><a href="#L606" title="ocaml/bytecomp/bytegen.ml:606">nargs</a></span><span class="Statement">)<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">(</span><span class="Constant">Kapply</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L606" title="ocaml/bytecomp/bytegen.ml:606">nargs</a></span><span class="ocamlEnd"> </span><span class="Statement">::</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L1048" title="ocaml/bytecomp/bytegen.ml:1048">cont1</a></span><span class="Statement">))<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">end<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">end<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Lsend</span><span class="Statement">(</span><span class="ocamlLCIdentifier">kind</span>, <span class="ocamlLCIdentifier">met</span>, <span class="ocamlLCIdentifier">obj</span>, <span class="ocamlLCIdentifier">args</span>, <span class="Statement">_)</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">assert</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">kind</span> <span class="Statement">&lt;&gt;</span> <span class="Constant">Cached</span><span class="Statement">);<br/></li>
<li><a id="L606">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">nargs</span></span> <span class="Statement">=</span> <span class="PreProc">List</span>.<span class="ocamlLCIdentifier">length</span> <span class="ocamlLCIdentifier">args</span> + <span class="Constant">1</span> <span class="Statement">in<br/></li>
<li><a id="L607">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">getmethod</span></span>, <span class="ocamlLCIdentifier">args</span>' <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">kind</span><span class="ocamlNone"> </span><span class="Statement">=</span><span class="ocamlNone"> </span><span class="Constant">Self</span><span class="ocamlNone"> </span><span class="Statement">then</span> <span class="Statement">(</span><span class="Constant">Kgetmethod</span>, <span class="ocamlLCIdentifier">met</span><span class="Statement">::</span><span class="ocamlLCIdentifier">obj</span><span class="Statement">::</span><span class="ocamlLCIdentifier">args</span><span class="Statement">)</span> <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">match</span> <span class="ocamlLCIdentifier">met</span> <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">Lconst</span><span class="Statement">(</span><span class="Constant">Const_base</span><span class="Statement">(</span><span class="Constant">Const_int</span> <span class="ocamlLCIdentifier">n</span><span class="Statement">))</span> <span class="Statement">-&gt;</span> <span class="Statement">(</span><span class="Constant">Kgetpubmet</span> <span class="ocamlLCIdentifier">n</span>, <span class="ocamlLCIdentifier">obj</span><span class="Statement">::</span><span class="ocamlLCIdentifier">args</span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Statement">_</span> <span class="Statement">-&gt;</span> <span class="Statement">(</span><span class="Constant">Kgetdynmet</span>, <span class="ocamlLCIdentifier">met</span><span class="Statement">::</span><span class="ocamlLCIdentifier">obj</span><span class="Statement">::</span><span class="ocamlLCIdentifier">args</span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier"><a href="#L102" title="ocaml/bytecomp/bytegen.ml:102">is_tailcall</a></span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span><span class="ocamlNone"> </span><span class="Statement">then<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L1059" title="ocaml/bytecomp/bytegen.ml:1059">comp_args</a></span> <span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span> <span class="ocamlLCIdentifier">env</span> <span class="ocamlLCIdentifier">args</span>' <span class="ocamlLCIdentifier">sz<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L607" title="ocaml/bytecomp/bytegen.ml:607">getmethod</a></span> <span class="Statement">::</span> <span class="Constant">Kappterm</span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L606" title="ocaml/bytecomp/bytegen.ml:606">nargs</a></span>, <span class="ocamlLCIdentifier">sz</span> + <span class="ocamlLCIdentifier"><a href="#L606" title="ocaml/bytecomp/bytegen.ml:606">nargs</a></span><span class="Statement">)</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier"><a href="#L95" title="ocaml/bytecomp/bytegen.ml:95">discard_dead_code</a></span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier"><a href="#L606" title="ocaml/bytecomp/bytegen.ml:606">nargs</a></span><span class="ocamlNone"> </span><span class="Statement">&lt;</span><span class="ocamlNone"> </span><span class="Constant">4</span><span class="ocamlNone"> </span><span class="Statement">then<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L1059" title="ocaml/bytecomp/bytegen.ml:1059">comp_args</a></span> <span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span> <span class="ocamlLCIdentifier">env</span> <span class="ocamlLCIdentifier">args</span>' <span class="ocamlLCIdentifier">sz<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L607" title="ocaml/bytecomp/bytegen.ml:607">getmethod</a></span> <span class="Statement">::</span> <span class="Constant">Kapply</span> <span class="ocamlLCIdentifier"><a href="#L606" title="ocaml/bytecomp/bytegen.ml:606">nargs</a></span> <span class="Statement">::</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">else</span> <span class="Statement">begin<br/></li>
<li><a id="L621">&#x200c;</a></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier"><span class="linkable">lbl</span></span><span class="ocamlEnd">, </span><span class="ocamlLCIdentifier"><a href="#L1048" title="ocaml/bytecomp/bytegen.ml:1048">cont1</a></span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L57" title="ocaml/bytecomp/bytegen.ml:57">label_code</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Constant">Kpush_retaddr</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L621" title="ocaml/bytecomp/bytegen.ml:621">lbl</a></span><span class="ocamlEnd"> </span><span class="Statement">::<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="#L1059" title="ocaml/bytecomp/bytegen.ml:1059">comp_args</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">env</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">args</span><span class="ocamlEnd">' </span><span class="Statement">(</span><span class="ocamlLCIdentifier">sz</span><span class="ocamlEnd"> + </span><span class="Constant">3</span><span class="Statement">)<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L607" title="ocaml/bytecomp/bytegen.ml:607">getmethod</a></span><span class="ocamlEnd"> </span><span class="Statement">::</span><span class="ocamlEnd"> </span><span class="Constant">Kapply</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L606" title="ocaml/bytecomp/bytegen.ml:606">nargs</a></span><span class="ocamlEnd"> </span><span class="Statement">::</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L1048" title="ocaml/bytecomp/bytegen.ml:1048">cont1</a></span><span class="Statement">)<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">end<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Lfunction</span><span class="Statement">{</span><span class="ocamlLCIdentifier">params</span><span class="Statement">;</span> <span class="ocamlLCIdentifier">body</span><span class="Statement">;</span> <span class="ocamlLCIdentifier">loc</span><span class="Statement">}</span> <span class="Statement">-&gt;</span> <span class="Comment">(* assume kind = Curried *)<br/></li>
<li><a id="L627">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">cont</span></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="#L304" title="ocaml/bytecomp/bytegen.ml:304">add_pseudo_event</a></span> <span class="ocamlLCIdentifier">loc</span> <span class="Statement">!</span><span class="ocamlLCIdentifier"><a href="#L382" title="ocaml/bytecomp/bytegen.ml:382">compunit_name</a></span> <span class="ocamlLCIdentifier"><span class="linkable">cont</span></span> <span class="Statement">in<br/></li>
<li><a id="L628">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">lbl</span></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="#L31" title="ocaml/bytecomp/bytegen.ml:31">new_label</a></span><span class="Constant">()</span> <span class="Statement">in<br/></li>
<li><a id="L629">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">fv</span></span> <span class="Statement">=</span> <span class="PreProc">Ident</span>.<span class="PreProc">Set</span>.<span class="ocamlLCIdentifier">elements</span><span class="Statement">(</span><span class="ocamlLCIdentifier">free_variables</span> <span class="ocamlLCIdentifier">exp</span><span class="Statement">)</span> <span class="Statement">in<br/></li>
<li><a id="L630">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">to_compile</span></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">{</span> <span class="ocamlLCIdentifier">params</span> <span class="Statement">=</span> <span class="PreProc">List</span>.<span class="ocamlLCIdentifier">map</span> <span class="ocamlLCIdentifier">fst</span> <span class="ocamlLCIdentifier">params</span><span class="Statement">;</span> <span class="ocamlLCIdentifier">body</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">body</span><span class="Statement">;</span> <span class="ocamlLCIdentifier"><a href="instruct.ml.html#L51" title="ocaml/bytecomp/instruct.ml:51">label</a></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="#L621" title="ocaml/bytecomp/bytegen.ml:621">lbl</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">free_vars</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="#L629" title="ocaml/bytecomp/bytegen.ml:629">fv</a></span><span class="Statement">;</span> <span class="ocamlLCIdentifier">num_defs</span> <span class="Statement">=</span> <span class="Constant">1</span><span class="Statement">;</span> <span class="ocamlLCIdentifier">rec_vars</span> <span class="Statement">=</span> <span class="Constant">[]</span><span class="Statement">;</span> <span class="ocamlLCIdentifier">rec_pos</span> <span class="Statement">=</span> <span class="Constant">0</span> <span class="Statement">}</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="PreProc">Stack</span>.<span class="ocamlLCIdentifier">push</span> <span class="ocamlLCIdentifier"><a href="#L630" title="ocaml/bytecomp/bytegen.ml:630">to_compile</a></span> <span class="ocamlLCIdentifier"><a href="#L378" title="ocaml/bytecomp/bytegen.ml:378">functions_to_compile</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L1059" title="ocaml/bytecomp/bytegen.ml:1059">comp_args</a></span> <span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span> <span class="ocamlLCIdentifier">env</span> <span class="Statement">(</span><span class="PreProc">List</span>.<span class="ocamlLCIdentifier">map</span> <span class="Statement">(fun</span> <span class="ocamlLCIdentifier">n</span> <span class="Statement">-&gt;</span> <span class="Constant">Lvar</span> <span class="ocamlLCIdentifier">n</span><span class="Statement">)</span> <span class="ocamlLCIdentifier"><a href="#L629" title="ocaml/bytecomp/bytegen.ml:629">fv</a></span><span class="Statement">)</span> <span class="ocamlLCIdentifier">sz<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="Constant">Kclosure</span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L621" title="ocaml/bytecomp/bytegen.ml:621">lbl</a></span>, <span class="PreProc">List</span>.<span class="ocamlLCIdentifier">length</span> <span class="ocamlLCIdentifier"><a href="#L629" title="ocaml/bytecomp/bytegen.ml:629">fv</a></span><span class="Statement">)</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Llet</span><span class="Statement">(_</span>, <span class="ocamlLCIdentifier">_k</span>, <span class="ocamlLCIdentifier">id</span>, <span class="ocamlLCIdentifier">arg</span>, <span class="ocamlLCIdentifier">body</span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Lmutlet</span><span class="Statement">(</span><span class="ocamlLCIdentifier">_k</span>, <span class="ocamlLCIdentifier">id</span>, <span class="ocamlLCIdentifier">arg</span>, <span class="ocamlLCIdentifier">body</span><span class="Statement">)</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L565" title="ocaml/bytecomp/bytegen.ml:565">comp_expr</a></span> <span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span> <span class="ocamlLCIdentifier">env</span> <span class="ocamlLCIdentifier">arg</span> <span class="ocamlLCIdentifier">sz<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="Constant">Kpush</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier"><a href="#L565" title="ocaml/bytecomp/bytegen.ml:565">comp_expr</a></span> <span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L41" title="ocaml/bytecomp/bytegen.ml:41">add_var</a></span> <span class="ocamlLCIdentifier">id</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">sz</span>+<span class="Constant">1</span><span class="Statement">)</span> <span class="ocamlLCIdentifier">env</span><span class="Statement">)</span> <span class="ocamlLCIdentifier">body</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">sz</span>+<span class="Constant">1</span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L141" title="ocaml/bytecomp/bytegen.ml:141">add_pop</a></span> <span class="Constant">1</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span><span class="Statement">))<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Lletrec</span><span class="Statement">(</span><span class="ocamlLCIdentifier">decl</span>, <span class="ocamlLCIdentifier">body</span><span class="Statement">)</span> <span class="Statement">-&gt;<br/></li>
<li><a id="L642">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">ndecl</span></span> <span class="Statement">=</span> <span class="PreProc">List</span>.<span class="ocamlLCIdentifier">length</span> <span class="ocamlLCIdentifier">decl</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="PreProc">List</span><span class="ocamlNone">.</span><span class="ocamlLCIdentifier">for_all</span><span class="ocamlNone"> </span><span class="Statement">(function</span><span class="ocamlNone"> </span><span class="Statement">(_</span><span class="ocamlNone">, </span><span class="Constant">Lfunction</span><span class="ocamlNone"> </span><span class="Statement">_)</span><span class="ocamlNone"> </span><span class="Statement">-&gt;</span><span class="ocamlNone"> </span><span class="Constant">true</span><span class="ocamlNone"> </span><span class="Statement">|</span><span class="ocamlNone"> </span><span class="Statement">_</span><span class="ocamlNone"> </span><span class="Statement">-&gt;</span><span class="ocamlNone"> </span><span class="Constant">false</span><span class="Statement">)<br/></li>
<li></span><span class="ocamlNone">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier">decl</span><span class="ocamlNone"> </span><span class="Statement">then</span> <span class="Statement">begin<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Comment">(* let rec of functions *)<br/></li>
<li><a id="L646">&#x200c;</a></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><span class="linkable">fv</span></span><span class="ocamlEnd"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="PreProc">Ident</span><span class="ocamlEnd">.</span><span class="PreProc">Set</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">elements</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">free_variables</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="Constant">Lletrec</span><span class="Statement">(</span><span class="ocamlLCIdentifier">decl</span><span class="ocamlEnd">, </span><span class="ocamlLCIdentifier">lambda_unit</span><span class="Statement">)))</span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li><a id="L648">&#x200c;</a></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><span class="linkable">rec_idents</span></span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="PreProc">List</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">map</span><span class="ocamlEnd"> </span><span class="Statement">(fun</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">id</span><span class="ocamlEnd">, </span><span class="ocamlLCIdentifier">_lam</span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">id</span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">decl</span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li><a id="L649">&#x200c;</a></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="Statement">rec</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><span class="linkable">comp_fun</span></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L985" title="ocaml/bytecomp/bytegen.ml:985">pos</a></span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="Statement">function<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Constant">[]</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;</span><span class="ocamlEnd"> </span><span class="Constant">[]<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">_id</span><span class="ocamlEnd">, </span><span class="Constant">Lfunction</span><span class="Statement">{</span><span class="ocamlLCIdentifier">params</span><span class="Statement">;</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">body</span><span class="Statement">})</span><span class="ocamlEnd"> </span><span class="Statement">::</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">rem</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L621" title="ocaml/bytecomp/bytegen.ml:621">lbl</a></span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L31" title="ocaml/bytecomp/bytegen.ml:31">new_label</a></span><span class="Constant">()</span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L630" title="ocaml/bytecomp/bytegen.ml:630">to_compile</a></span><span class="ocamlEnd"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">{</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">params</span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="PreProc">List</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">map</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">fst</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">params</span><span class="Statement">;</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">body</span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">body</span><span class="Statement">;</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="instruct.ml.html#L51" title="ocaml/bytecomp/instruct.ml:51">label</a></span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L621" title="ocaml/bytecomp/bytegen.ml:621">lbl</a></span><span class="Statement">;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier">free_vars</span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L629" title="ocaml/bytecomp/bytegen.ml:629">fv</a></span><span class="Statement">;</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">num_defs</span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L642" title="ocaml/bytecomp/bytegen.ml:642">ndecl</a></span><span class="Statement">;</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">rec_vars</span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L648" title="ocaml/bytecomp/bytegen.ml:648">rec_idents</a></span><span class="Statement">;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier">rec_pos</span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L985" title="ocaml/bytecomp/bytegen.ml:985">pos</a></span><span class="Statement">}</span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="PreProc">Stack</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">push</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L630" title="ocaml/bytecomp/bytegen.ml:630">to_compile</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L378" title="ocaml/bytecomp/bytegen.ml:378">functions_to_compile</a></span><span class="Statement">;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="#L621" title="ocaml/bytecomp/bytegen.ml:621">lbl</a></span><span class="ocamlEnd"> </span><span class="Statement">::</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L649" title="ocaml/bytecomp/bytegen.ml:649">comp_fun</a></span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L985" title="ocaml/bytecomp/bytegen.ml:985">pos</a></span><span class="ocamlEnd"> + </span><span class="Constant">1</span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">rem<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Statement">_</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;</span><span class="ocamlEnd"> </span><span class="Statement">assert</span><span class="ocamlEnd"> </span><span class="Constant">false</span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li><a id="L660">&#x200c;</a></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><span class="linkable">lbls</span></span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L649" title="ocaml/bytecomp/bytegen.ml:649">comp_fun</a></span><span class="ocamlEnd"> </span><span class="Constant">0</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">decl</span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="#L1059" title="ocaml/bytecomp/bytegen.ml:1059">comp_args</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">env</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="PreProc">List</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">map</span><span class="ocamlEnd"> </span><span class="Statement">(fun</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">n</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;</span><span class="ocamlEnd"> </span><span class="Constant">Lvar</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">n</span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L629" title="ocaml/bytecomp/bytegen.ml:629">fv</a></span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">sz<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">(</span><span class="Constant">Kclosurerec</span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L660" title="ocaml/bytecomp/bytegen.ml:660">lbls</a></span><span class="ocamlEnd">, </span><span class="PreProc">List</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">length</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L629" title="ocaml/bytecomp/bytegen.ml:629">fv</a></span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="Statement">::<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L565" title="ocaml/bytecomp/bytegen.ml:565">comp_expr</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L46" title="ocaml/bytecomp/bytegen.ml:46">add_vars</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L648" title="ocaml/bytecomp/bytegen.ml:648">rec_idents</a></span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">sz</span><span class="ocamlEnd">+</span><span class="Constant">1</span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">env</span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">body</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">sz</span><span class="ocamlEnd"> + </span><span class="ocamlLCIdentifier"><a href="#L642" title="ocaml/bytecomp/bytegen.ml:642">ndecl</a></span><span class="Statement">)<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L141" title="ocaml/bytecomp/bytegen.ml:141">add_pop</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L642" title="ocaml/bytecomp/bytegen.ml:642">ndecl</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span><span class="Statement">)))<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">end</span> <span class="Statement">else</span> <span class="Statement">begin<br/></li>
<li><a id="L667">&#x200c;</a></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><span class="linkable">decl_size</span></span><span class="ocamlEnd"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="PreProc">List</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">map</span><span class="ocamlEnd"> </span><span class="Statement">(fun</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">id</span><span class="ocamlEnd">, </span><span class="ocamlLCIdentifier">exp</span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">id</span><span class="ocamlEnd">, </span><span class="ocamlLCIdentifier">exp</span><span class="ocamlEnd">, </span><span class="ocamlLCIdentifier"><a href="#L176" title="ocaml/bytecomp/bytegen.ml:176">size_of_lambda</a></span><span class="ocamlEnd"> </span><span class="PreProc">Ident</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier"><a href="symtable.ml.html#L44" title="ocaml/bytecomp/symtable.ml:44">empty</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">exp</span><span class="Statement">))<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier">decl</span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li><a id="L670">&#x200c;</a></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="Statement">rec</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><span class="linkable">comp_init</span></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">new_env</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">sz</span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="Statement">function<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Constant">[]</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">comp_nonrec</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">new_env</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">sz</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L642" title="ocaml/bytecomp/bytegen.ml:642">ndecl</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L667" title="ocaml/bytecomp/bytegen.ml:667">decl_size</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">id</span><span class="ocamlEnd">, </span><span class="ocamlLCIdentifier">_exp</span><span class="ocamlEnd">, </span><span class="Constant">RHS_floatblock</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">blocksize</span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="Statement">::</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">rem</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Constant">Kconst</span><span class="Statement">(</span><span class="Constant">Const_base</span><span class="Statement">(</span><span class="Constant">Const_int</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">blocksize</span><span class="Statement">))</span><span class="ocamlEnd"> </span><span class="Statement">::<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Constant">Kccall</span><span class="Statement">(</span><span class="Constant">&quot;caml_alloc_dummy_float&quot;</span><span class="ocamlEnd">, </span><span class="Constant">1</span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="Statement">::</span><span class="ocamlEnd"> </span><span class="Constant">Kpush</span><span class="ocamlEnd"> </span><span class="Statement">::<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="#L670" title="ocaml/bytecomp/bytegen.ml:670">comp_init</a></span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L41" title="ocaml/bytecomp/bytegen.ml:41">add_var</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">id</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">sz</span><span class="ocamlEnd">+</span><span class="Constant">1</span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">new_env</span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">sz</span><span class="ocamlEnd">+</span><span class="Constant">1</span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">rem<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">id</span><span class="ocamlEnd">, </span><span class="ocamlLCIdentifier">_exp</span><span class="ocamlEnd">, </span><span class="Constant">RHS_block</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">blocksize</span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="Statement">::</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">rem</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Constant">Kconst</span><span class="Statement">(</span><span class="Constant">Const_base</span><span class="Statement">(</span><span class="Constant">Const_int</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">blocksize</span><span class="Statement">))</span><span class="ocamlEnd"> </span><span class="Statement">::<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Constant">Kccall</span><span class="Statement">(</span><span class="Constant">&quot;caml_alloc_dummy&quot;</span><span class="ocamlEnd">, </span><span class="Constant">1</span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="Statement">::</span><span class="ocamlEnd"> </span><span class="Constant">Kpush</span><span class="ocamlEnd"> </span><span class="Statement">::<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="#L670" title="ocaml/bytecomp/bytegen.ml:670">comp_init</a></span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L41" title="ocaml/bytecomp/bytegen.ml:41">add_var</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">id</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">sz</span><span class="ocamlEnd">+</span><span class="Constant">1</span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">new_env</span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">sz</span><span class="ocamlEnd">+</span><span class="Constant">1</span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">rem<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">id</span><span class="ocamlEnd">, </span><span class="ocamlLCIdentifier">_exp</span><span class="ocamlEnd">, </span><span class="Constant">RHS_infix</span><span class="ocamlEnd"> </span><span class="Statement">{</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">blocksize</span><span class="Statement">;</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L923" title="ocaml/bytecomp/bytegen.ml:923">offset</a></span><span class="ocamlEnd"> </span><span class="Statement">})</span><span class="ocamlEnd"> </span><span class="Statement">::</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">rem</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Constant">Kconst</span><span class="Statement">(</span><span class="Constant">Const_base</span><span class="Statement">(</span><span class="Constant">Const_int</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L923" title="ocaml/bytecomp/bytegen.ml:923">offset</a></span><span class="Statement">))</span><span class="ocamlEnd"> </span><span class="Statement">::<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Constant">Kpush</span><span class="ocamlEnd"> </span><span class="Statement">::<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Constant">Kconst</span><span class="Statement">(</span><span class="Constant">Const_base</span><span class="Statement">(</span><span class="Constant">Const_int</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">blocksize</span><span class="Statement">))</span><span class="ocamlEnd"> </span><span class="Statement">::<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Constant">Kccall</span><span class="Statement">(</span><span class="Constant">&quot;caml_alloc_dummy_infix&quot;</span><span class="ocamlEnd">, </span><span class="Constant">2</span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="Statement">::</span><span class="ocamlEnd"> </span><span class="Constant">Kpush</span><span class="ocamlEnd"> </span><span class="Statement">::<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="#L670" title="ocaml/bytecomp/bytegen.ml:670">comp_init</a></span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L41" title="ocaml/bytecomp/bytegen.ml:41">add_var</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">id</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">sz</span><span class="ocamlEnd">+</span><span class="Constant">1</span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">new_env</span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">sz</span><span class="ocamlEnd">+</span><span class="Constant">1</span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">rem<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">id</span><span class="ocamlEnd">, </span><span class="ocamlLCIdentifier">_exp</span><span class="ocamlEnd">, </span><span class="Constant">RHS_function</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">blocksize</span><span class="ocamlEnd">,</span><span class="ocamlLCIdentifier">arity</span><span class="Statement">))</span><span class="ocamlEnd"> </span><span class="Statement">::</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">rem</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Constant">Kconst</span><span class="Statement">(</span><span class="Constant">Const_base</span><span class="Statement">(</span><span class="Constant">Const_int</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">arity</span><span class="Statement">))</span><span class="ocamlEnd"> </span><span class="Statement">::<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Constant">Kpush</span><span class="ocamlEnd"> </span><span class="Statement">::<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Constant">Kconst</span><span class="Statement">(</span><span class="Constant">Const_base</span><span class="Statement">(</span><span class="Constant">Const_int</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">blocksize</span><span class="Statement">))</span><span class="ocamlEnd"> </span><span class="Statement">::<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Constant">Kccall</span><span class="Statement">(</span><span class="Constant">&quot;caml_alloc_dummy_function&quot;</span><span class="ocamlEnd">, </span><span class="Constant">2</span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="Statement">::</span><span class="ocamlEnd"> </span><span class="Constant">Kpush</span><span class="ocamlEnd"> </span><span class="Statement">::<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="#L670" title="ocaml/bytecomp/bytegen.ml:670">comp_init</a></span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L41" title="ocaml/bytecomp/bytegen.ml:41">add_var</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">id</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">sz</span><span class="ocamlEnd">+</span><span class="Constant">1</span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">new_env</span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">sz</span><span class="ocamlEnd">+</span><span class="Constant">1</span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">rem<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">id</span><span class="ocamlEnd">, </span><span class="ocamlLCIdentifier">_exp</span><span class="ocamlEnd">, </span><span class="Constant">RHS_nonrec</span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="Statement">::</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">rem</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Constant">Kconst</span><span class="Statement">(</span><span class="Constant">Const_base</span><span class="Statement">(</span><span class="Constant">Const_int</span><span class="ocamlEnd"> </span><span class="Constant">0</span><span class="Statement">))</span><span class="ocamlEnd"> </span><span class="Statement">::</span><span class="ocamlEnd"> </span><span class="Constant">Kpush</span><span class="ocamlEnd"> </span><span class="Statement">::<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="#L670" title="ocaml/bytecomp/bytegen.ml:670">comp_init</a></span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L41" title="ocaml/bytecomp/bytegen.ml:41">add_var</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">id</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">sz</span><span class="ocamlEnd">+</span><span class="Constant">1</span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">new_env</span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">sz</span><span class="ocamlEnd">+</span><span class="Constant">1</span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">rem<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">and</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">comp_nonrec</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">new_env</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">sz</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">i</span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="Statement">function<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Constant">[]</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">comp_rec</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">new_env</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">sz</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L642" title="ocaml/bytecomp/bytegen.ml:642">ndecl</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L667" title="ocaml/bytecomp/bytegen.ml:667">decl_size</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">_id</span><span class="ocamlEnd">, </span><span class="ocamlLCIdentifier">_exp</span><span class="ocamlEnd">, </span><span class="Statement">(</span><span class="Constant">RHS_block</span><span class="ocamlEnd"> </span><span class="Statement">_</span><span class="ocamlEnd"> </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Constant">RHS_infix</span><span class="ocamlEnd"> </span><span class="Statement">_</span><span class="ocamlEnd"> </span><span class="Statement">|<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="Constant">RHS_floatblock</span><span class="ocamlEnd"> </span><span class="Statement">_</span><span class="ocamlEnd"> </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Constant">RHS_function</span><span class="ocamlEnd"> </span><span class="Statement">_))<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">::</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">rem</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier">comp_nonrec</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">new_env</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">sz</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">i</span><span class="ocamlEnd">-</span><span class="Constant">1</span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">rem<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">_id</span><span class="ocamlEnd">, </span><span class="ocamlLCIdentifier">exp</span><span class="ocamlEnd">, </span><span class="Constant">RHS_nonrec</span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="Statement">::</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">rem</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="#L565" title="ocaml/bytecomp/bytegen.ml:565">comp_expr</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">new_env</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">exp</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">sz<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">(</span><span class="Constant">Kassign</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">i</span><span class="ocamlEnd">-</span><span class="Constant">1</span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="Statement">::</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">comp_nonrec</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">new_env</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">sz</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">i</span><span class="ocamlEnd">-</span><span class="Constant">1</span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">rem</span><span class="Statement">)<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">and</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">comp_rec</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">new_env</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">sz</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">i</span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="Statement">function<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Constant">[]</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L565" title="ocaml/bytecomp/bytegen.ml:565">comp_expr</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">new_env</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">body</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">sz</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L141" title="ocaml/bytecomp/bytegen.ml:141">add_pop</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L642" title="ocaml/bytecomp/bytegen.ml:642">ndecl</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span><span class="Statement">)<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">_id</span><span class="ocamlEnd">, </span><span class="ocamlLCIdentifier">exp</span><span class="ocamlEnd">, </span><span class="Statement">(</span><span class="Constant">RHS_block</span><span class="ocamlEnd"> </span><span class="Statement">_</span><span class="ocamlEnd"> </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Constant">RHS_infix</span><span class="ocamlEnd"> </span><span class="Statement">_</span><span class="ocamlEnd"> </span><span class="Statement">|<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Constant">RHS_floatblock</span><span class="ocamlEnd"> </span><span class="Statement">_</span><span class="ocamlEnd"> </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Constant">RHS_function</span><span class="ocamlEnd"> </span><span class="Statement">_))<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">::</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">rem</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="#L565" title="ocaml/bytecomp/bytegen.ml:565">comp_expr</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">new_env</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">exp</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">sz<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">(</span><span class="Constant">Kpush</span><span class="ocamlEnd"> </span><span class="Statement">::</span><span class="ocamlEnd"> </span><span class="Constant">Kacc</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">i</span><span class="ocamlEnd"> </span><span class="Statement">::</span><span class="ocamlEnd"> </span><span class="Constant">Kccall</span><span class="Statement">(</span><span class="Constant">&quot;caml_update_dummy&quot;</span><span class="ocamlEnd">, </span><span class="Constant">2</span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="Statement">::<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="ocamlLCIdentifier">comp_rec</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">new_env</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">sz</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">i</span><span class="ocamlEnd">-</span><span class="Constant">1</span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">rem</span><span class="Statement">)<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">_id</span><span class="ocamlEnd">, </span><span class="ocamlLCIdentifier">_exp</span><span class="ocamlEnd">, </span><span class="Constant">RHS_nonrec</span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="Statement">::</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">rem</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier">comp_rec</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">new_env</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">sz</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">i</span><span class="ocamlEnd">-</span><span class="Constant">1</span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">rem<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="#L670" title="ocaml/bytecomp/bytegen.ml:670">comp_init</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">env</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">sz</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L667" title="ocaml/bytecomp/bytegen.ml:667">decl_size</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">end<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Lprim</span><span class="Statement">(</span><span class="Constant">Popaque</span>, <span class="Statement">[</span><span class="ocamlLCIdentifier">arg</span><span class="Statement">]</span>, <span class="Statement">_)</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L565" title="ocaml/bytecomp/bytegen.ml:565">comp_expr</a></span> <span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span> <span class="ocamlLCIdentifier">env</span> <span class="ocamlLCIdentifier">arg</span> <span class="ocamlLCIdentifier">sz</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a><br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Lprim</span><span class="Statement">(</span><span class="Constant">Pignore</span>, <span class="Statement">[</span><span class="ocamlLCIdentifier">arg</span><span class="Statement">]</span>, <span class="Statement">_)</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L565" title="ocaml/bytecomp/bytegen.ml:565">comp_expr</a></span> <span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span> <span class="ocamlLCIdentifier">env</span> <span class="ocamlLCIdentifier">arg</span> <span class="ocamlLCIdentifier">sz</span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L151" title="ocaml/bytecomp/bytegen.ml:151">add_const_unit</a></span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Lprim</span><span class="Statement">(</span><span class="Constant">Pnot</span>, <span class="Statement">[</span><span class="ocamlLCIdentifier">arg</span><span class="Statement">]</span>, <span class="Statement">_)</span> <span class="Statement">-&gt;<br/></li>
<li><a id="L722">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">newcont</span></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">match</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span> <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">Kbranchif</span> <span class="ocamlLCIdentifier"><a href="#L621" title="ocaml/bytecomp/bytegen.ml:621">lbl</a></span> <span class="Statement">::</span> <span class="ocamlLCIdentifier"><a href="#L1048" title="ocaml/bytecomp/bytegen.ml:1048">cont1</a></span> <span class="Statement">-&gt;</span> <span class="Constant">Kbranchifnot</span> <span class="ocamlLCIdentifier"><a href="#L621" title="ocaml/bytecomp/bytegen.ml:621">lbl</a></span> <span class="Statement">::</span> <span class="ocamlLCIdentifier"><a href="#L1048" title="ocaml/bytecomp/bytegen.ml:1048">cont1</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Kbranchifnot</span> <span class="ocamlLCIdentifier"><a href="#L621" title="ocaml/bytecomp/bytegen.ml:621">lbl</a></span> <span class="Statement">::</span> <span class="ocamlLCIdentifier"><a href="#L1048" title="ocaml/bytecomp/bytegen.ml:1048">cont1</a></span> <span class="Statement">-&gt;</span> <span class="Constant">Kbranchif</span> <span class="ocamlLCIdentifier"><a href="#L621" title="ocaml/bytecomp/bytegen.ml:621">lbl</a></span> <span class="Statement">::</span> <span class="ocamlLCIdentifier"><a href="#L1048" title="ocaml/bytecomp/bytegen.ml:1048">cont1</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Statement">_</span> <span class="Statement">-&gt;</span> <span class="Constant">Kboolnot</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L565" title="ocaml/bytecomp/bytegen.ml:565">comp_expr</a></span> <span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span> <span class="ocamlLCIdentifier">env</span> <span class="ocamlLCIdentifier">arg</span> <span class="ocamlLCIdentifier">sz</span> <span class="ocamlLCIdentifier"><a href="#L722" title="ocaml/bytecomp/bytegen.ml:722">newcont</a><br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Lprim</span><span class="Statement">(</span><span class="Constant">Psequand</span>, <span class="Statement">[</span><span class="ocamlLCIdentifier">exp1</span><span class="Statement">;</span> <span class="ocamlLCIdentifier">exp2</span><span class="Statement">]</span>, <span class="Statement">_)</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">begin</span><span class="ocamlEnd"> </span><span class="Statement">match</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span><span class="ocamlEnd"> </span><span class="Statement">with<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Constant">Kbranchifnot</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L621" title="ocaml/bytecomp/bytegen.ml:621">lbl</a></span><span class="ocamlEnd"> </span><span class="Statement">::</span><span class="ocamlEnd"> </span><span class="Statement">_</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="#L565" title="ocaml/bytecomp/bytegen.ml:565">comp_expr</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">env</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">exp1</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">sz</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="Constant">Kbranchifnot</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L621" title="ocaml/bytecomp/bytegen.ml:621">lbl</a></span><span class="ocamlEnd"> </span><span class="Statement">::<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="#L565" title="ocaml/bytecomp/bytegen.ml:565">comp_expr</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">env</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">exp2</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">sz</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span><span class="Statement">)<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Constant">Kbranchif</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L621" title="ocaml/bytecomp/bytegen.ml:621">lbl</a></span><span class="ocamlEnd"> </span><span class="Statement">::</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L1048" title="ocaml/bytecomp/bytegen.ml:1048">cont1</a></span><span class="ocamlEnd"> </span><span class="Statement">-&gt;<br/></li>
<li><a id="L734">&#x200c;</a></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier"><span class="linkable">lbl2</span></span><span class="ocamlEnd">, </span><span class="ocamlLCIdentifier">cont2</span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L57" title="ocaml/bytecomp/bytegen.ml:57">label_code</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L1048" title="ocaml/bytecomp/bytegen.ml:1048">cont1</a></span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="#L565" title="ocaml/bytecomp/bytegen.ml:565">comp_expr</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">env</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">exp1</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">sz</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="Constant">Kbranchifnot</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L734" title="ocaml/bytecomp/bytegen.ml:734">lbl2</a></span><span class="ocamlEnd"> </span><span class="Statement">::<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="#L565" title="ocaml/bytecomp/bytegen.ml:565">comp_expr</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">env</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">exp2</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">sz</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="Constant">Kbranchif</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L621" title="ocaml/bytecomp/bytegen.ml:621">lbl</a></span><span class="ocamlEnd"> </span><span class="Statement">::</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">cont2</span><span class="Statement">))<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Statement">_</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;<br/></li>
<li><a id="L738">&#x200c;</a></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier"><span class="linkable">lbl</span></span><span class="ocamlEnd">, </span><span class="ocamlLCIdentifier"><a href="#L1048" title="ocaml/bytecomp/bytegen.ml:1048">cont1</a></span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L57" title="ocaml/bytecomp/bytegen.ml:57">label_code</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="#L565" title="ocaml/bytecomp/bytegen.ml:565">comp_expr</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">env</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">exp1</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">sz</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="Constant">Kstrictbranchifnot</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L621" title="ocaml/bytecomp/bytegen.ml:621">lbl</a></span><span class="ocamlEnd"> </span><span class="Statement">::<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="#L565" title="ocaml/bytecomp/bytegen.ml:565">comp_expr</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">env</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">exp2</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">sz</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L1048" title="ocaml/bytecomp/bytegen.ml:1048">cont1</a></span><span class="Statement">)<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">end<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Lprim</span><span class="Statement">(</span><span class="Constant">Psequor</span>, <span class="Statement">[</span><span class="ocamlLCIdentifier">exp1</span><span class="Statement">;</span> <span class="ocamlLCIdentifier">exp2</span><span class="Statement">]</span>, <span class="Statement">_)</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">begin</span><span class="ocamlEnd"> </span><span class="Statement">match</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span><span class="ocamlEnd"> </span><span class="Statement">with<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Constant">Kbranchif</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L621" title="ocaml/bytecomp/bytegen.ml:621">lbl</a></span><span class="ocamlEnd"> </span><span class="Statement">::</span><span class="ocamlEnd"> </span><span class="Statement">_</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="#L565" title="ocaml/bytecomp/bytegen.ml:565">comp_expr</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">env</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">exp1</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">sz</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="Constant">Kbranchif</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L621" title="ocaml/bytecomp/bytegen.ml:621">lbl</a></span><span class="ocamlEnd"> </span><span class="Statement">::<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="#L565" title="ocaml/bytecomp/bytegen.ml:565">comp_expr</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">env</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">exp2</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">sz</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span><span class="Statement">)<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Constant">Kbranchifnot</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L621" title="ocaml/bytecomp/bytegen.ml:621">lbl</a></span><span class="ocamlEnd"> </span><span class="Statement">::</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L1048" title="ocaml/bytecomp/bytegen.ml:1048">cont1</a></span><span class="ocamlEnd"> </span><span class="Statement">-&gt;<br/></li>
<li><a id="L748">&#x200c;</a></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier"><span class="linkable">lbl2</span></span><span class="ocamlEnd">, </span><span class="ocamlLCIdentifier">cont2</span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L57" title="ocaml/bytecomp/bytegen.ml:57">label_code</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L1048" title="ocaml/bytecomp/bytegen.ml:1048">cont1</a></span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="#L565" title="ocaml/bytecomp/bytegen.ml:565">comp_expr</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">env</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">exp1</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">sz</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="Constant">Kbranchif</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L734" title="ocaml/bytecomp/bytegen.ml:734">lbl2</a></span><span class="ocamlEnd"> </span><span class="Statement">::<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="#L565" title="ocaml/bytecomp/bytegen.ml:565">comp_expr</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">env</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">exp2</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">sz</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="Constant">Kbranchifnot</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L621" title="ocaml/bytecomp/bytegen.ml:621">lbl</a></span><span class="ocamlEnd"> </span><span class="Statement">::</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">cont2</span><span class="Statement">))<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Statement">_</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;<br/></li>
<li><a id="L752">&#x200c;</a></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier"><span class="linkable">lbl</span></span><span class="ocamlEnd">, </span><span class="ocamlLCIdentifier"><a href="#L1048" title="ocaml/bytecomp/bytegen.ml:1048">cont1</a></span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L57" title="ocaml/bytecomp/bytegen.ml:57">label_code</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="#L565" title="ocaml/bytecomp/bytegen.ml:565">comp_expr</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">env</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">exp1</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">sz</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="Constant">Kstrictbranchif</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L621" title="ocaml/bytecomp/bytegen.ml:621">lbl</a></span><span class="ocamlEnd"> </span><span class="Statement">::<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="#L565" title="ocaml/bytecomp/bytegen.ml:565">comp_expr</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">env</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">exp2</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">sz</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L1048" title="ocaml/bytecomp/bytegen.ml:1048">cont1</a></span><span class="Statement">)<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">end<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Lprim</span><span class="Statement">(</span><span class="Constant">Praise</span> <span class="ocamlLCIdentifier">k</span>, <span class="Statement">[</span><span class="ocamlLCIdentifier">arg</span><span class="Statement">]</span>, <span class="Statement">_)</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L565" title="ocaml/bytecomp/bytegen.ml:565">comp_expr</a></span> <span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span> <span class="ocamlLCIdentifier">env</span> <span class="ocamlLCIdentifier">arg</span> <span class="ocamlLCIdentifier">sz</span> <span class="Statement">(</span><span class="Constant">Kraise</span> <span class="ocamlLCIdentifier">k</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier"><a href="#L95" title="ocaml/bytecomp/bytegen.ml:95">discard_dead_code</a></span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Lprim</span><span class="Statement">(</span><span class="Constant">Paddint</span>, <span class="Statement">[</span><span class="ocamlLCIdentifier">arg</span><span class="Statement">;</span> <span class="Constant">Lconst</span><span class="Statement">(</span><span class="Constant">Const_base</span><span class="Statement">(</span><span class="Constant">Const_int</span> <span class="ocamlLCIdentifier">n</span><span class="Statement">))]</span>, <span class="Statement">_)<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">when</span> <span class="ocamlLCIdentifier"><a href="#L549" title="ocaml/bytecomp/bytegen.ml:549">is_immed</a></span> <span class="ocamlLCIdentifier">n</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L565" title="ocaml/bytecomp/bytegen.ml:565">comp_expr</a></span> <span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span> <span class="ocamlLCIdentifier">env</span> <span class="ocamlLCIdentifier">arg</span> <span class="ocamlLCIdentifier">sz</span> <span class="Statement">(</span><span class="Constant">Koffsetint</span> <span class="ocamlLCIdentifier">n</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Lprim</span><span class="Statement">(</span><span class="Constant">Psubint</span>, <span class="Statement">[</span><span class="ocamlLCIdentifier">arg</span><span class="Statement">;</span> <span class="Constant">Lconst</span><span class="Statement">(</span><span class="Constant">Const_base</span><span class="Statement">(</span><span class="Constant">Const_int</span> <span class="ocamlLCIdentifier">n</span><span class="Statement">))]</span>, <span class="Statement">_)<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">when</span> <span class="ocamlLCIdentifier"><a href="#L549" title="ocaml/bytecomp/bytegen.ml:549">is_immed</a></span> <span class="Statement">(</span>-<span class="ocamlLCIdentifier">n</span><span class="Statement">)</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L565" title="ocaml/bytecomp/bytegen.ml:565">comp_expr</a></span> <span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span> <span class="ocamlLCIdentifier">env</span> <span class="ocamlLCIdentifier">arg</span> <span class="ocamlLCIdentifier">sz</span> <span class="Statement">(</span><span class="Constant">Koffsetint</span> <span class="Statement">(</span>-<span class="ocamlLCIdentifier">n</span><span class="Statement">)</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Lprim</span> <span class="Statement">(</span><span class="Constant">Poffsetint</span> <span class="ocamlLCIdentifier">n</span>, <span class="Statement">[</span><span class="ocamlLCIdentifier">arg</span><span class="Statement">]</span>, <span class="Statement">_)<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">when</span> <span class="Statement">not</span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L549" title="ocaml/bytecomp/bytegen.ml:549">is_immed</a></span> <span class="ocamlLCIdentifier">n</span><span class="Statement">)</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L565" title="ocaml/bytecomp/bytegen.ml:565">comp_expr</a></span> <span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span> <span class="ocamlLCIdentifier">env</span> <span class="ocamlLCIdentifier">arg</span> <span class="ocamlLCIdentifier">sz<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="Constant">Kpush</span><span class="Statement">::<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">Kconst</span> <span class="Statement">(</span><span class="Constant">Const_base</span> <span class="Statement">(</span><span class="Constant">Const_int</span> <span class="ocamlLCIdentifier">n</span><span class="Statement">))::<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">Kaddint</span><span class="Statement">::</span><span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Lprim</span><span class="Statement">(</span><span class="Constant">Pmakearray</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">kind</span>, <span class="Statement">_)</span>, <span class="ocamlLCIdentifier">args</span>, <span class="ocamlLCIdentifier">loc</span><span class="Statement">)</span> <span class="Statement">-&gt;<br/></li>
<li><a id="L771">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">cont</span></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="#L304" title="ocaml/bytecomp/bytegen.ml:304">add_pseudo_event</a></span> <span class="ocamlLCIdentifier">loc</span> <span class="Statement">!</span><span class="ocamlLCIdentifier"><a href="#L382" title="ocaml/bytecomp/bytegen.ml:382">compunit_name</a></span> <span class="ocamlLCIdentifier"><span class="linkable">cont</span></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">begin</span><span class="ocamlEnd"> </span><span class="Statement">match</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">kind</span><span class="ocamlEnd"> </span><span class="Statement">with<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Constant">Pintarray</span><span class="ocamlEnd"> </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Constant">Paddrarray</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="#L1059" title="ocaml/bytecomp/bytegen.ml:1059">comp_args</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">env</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">args</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">sz<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">(</span><span class="Constant">Kmakeblock</span><span class="Statement">(</span><span class="PreProc">List</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">length</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">args</span><span class="ocamlEnd">, </span><span class="Constant">0</span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="Statement">::</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span><span class="Statement">)<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Constant">Pfloatarray</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="#L1059" title="ocaml/bytecomp/bytegen.ml:1059">comp_args</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">env</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">args</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">sz<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">(</span><span class="Constant">Kmakefloatblock</span><span class="Statement">(</span><span class="PreProc">List</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">length</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">args</span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="Statement">::</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span><span class="Statement">)<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Constant">Pgenarray</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">args</span><span class="ocamlNone"> </span><span class="Statement">=</span><span class="ocamlNone"> </span><span class="Constant">[]<br/></li>
<li></span><span class="ocamlNone">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">then</span><span class="ocamlEnd"> </span><span class="Constant">Kmakeblock</span><span class="Statement">(</span><span class="Constant">0</span><span class="ocamlEnd">, </span><span class="Constant">0</span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="Statement">::</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">else</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L1059" title="ocaml/bytecomp/bytegen.ml:1059">comp_args</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">env</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">args</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">sz<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="Statement">(</span><span class="Constant">Kmakeblock</span><span class="Statement">(</span><span class="PreProc">List</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">length</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">args</span><span class="ocamlEnd">, </span><span class="Constant">0</span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="Statement">::<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Constant">Kccall</span><span class="Statement">(</span><span class="Constant">&quot;caml_make_array&quot;</span><span class="ocamlEnd">, </span><span class="Constant">1</span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="Statement">::</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span><span class="Statement">)<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">end<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Lprim</span><span class="Statement">((</span><span class="Constant">Presume</span><span class="Statement">|</span><span class="Constant">Prunstack</span><span class="Statement">)</span>, <span class="ocamlLCIdentifier">args</span>, <span class="Statement">_)</span> <span class="Statement">-&gt;<br/></li>
<li><a id="L787">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">nargs</span></span> <span class="Statement">=</span> <span class="PreProc">List</span>.<span class="ocamlLCIdentifier">length</span> <span class="ocamlLCIdentifier">args</span> - <span class="Constant">1</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">assert</span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L606" title="ocaml/bytecomp/bytegen.ml:606">nargs</a></span> <span class="Statement">=</span> <span class="Constant">2</span><span class="Statement">);<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Comment">(* Resume itself only pushes 3 words, but perform adds another *)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L384" title="ocaml/bytecomp/bytegen.ml:384">check_stack</a></span> <span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span> <span class="Statement">(</span><span class="ocamlLCIdentifier">sz</span> + <span class="Constant">4</span><span class="Statement">);<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier"><a href="#L102" title="ocaml/bytecomp/bytegen.ml:102">is_tailcall</a></span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span><span class="ocamlNone"> </span><span class="Statement">then<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L1059" title="ocaml/bytecomp/bytegen.ml:1059">comp_args</a></span> <span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span> <span class="ocamlLCIdentifier">env</span> <span class="ocamlLCIdentifier">args</span> <span class="ocamlLCIdentifier">sz<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="Constant">Kresumeterm</span><span class="Statement">(</span><span class="ocamlLCIdentifier">sz</span> + <span class="ocamlLCIdentifier"><a href="#L606" title="ocaml/bytecomp/bytegen.ml:606">nargs</a></span><span class="Statement">)</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier"><a href="#L95" title="ocaml/bytecomp/bytegen.ml:95">discard_dead_code</a></span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L1059" title="ocaml/bytecomp/bytegen.ml:1059">comp_args</a></span> <span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span> <span class="ocamlLCIdentifier">env</span> <span class="ocamlLCIdentifier">args</span> <span class="ocamlLCIdentifier">sz</span> <span class="Statement">(</span><span class="Constant">Kresume</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Lprim</span><span class="Statement">(</span><span class="Constant">Preperform</span>, <span class="ocamlLCIdentifier">args</span>, <span class="Statement">_)</span> <span class="Statement">-&gt;<br/></li>
<li><a id="L797">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">nargs</span></span> <span class="Statement">=</span> <span class="PreProc">List</span>.<span class="ocamlLCIdentifier">length</span> <span class="ocamlLCIdentifier">args</span> - <span class="Constant">1</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">assert</span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L606" title="ocaml/bytecomp/bytegen.ml:606">nargs</a></span> <span class="Statement">=</span> <span class="Constant">2</span><span class="Statement">);<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L384" title="ocaml/bytecomp/bytegen.ml:384">check_stack</a></span> <span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span> <span class="Statement">(</span><span class="ocamlLCIdentifier">sz</span> + <span class="Constant">3</span><span class="Statement">);<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier"><a href="#L102" title="ocaml/bytecomp/bytegen.ml:102">is_tailcall</a></span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span><span class="ocamlNone"> </span><span class="Statement">then<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L1059" title="ocaml/bytecomp/bytegen.ml:1059">comp_args</a></span> <span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span> <span class="ocamlLCIdentifier">env</span> <span class="ocamlLCIdentifier">args</span> <span class="ocamlLCIdentifier">sz<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="Constant">Kreperformterm</span><span class="Statement">(</span><span class="ocamlLCIdentifier">sz</span> + <span class="ocamlLCIdentifier"><a href="#L606" title="ocaml/bytecomp/bytegen.ml:606">nargs</a></span><span class="Statement">)</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier"><a href="#L95" title="ocaml/bytecomp/bytegen.ml:95">discard_dead_code</a></span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">fatal_error</span> <span class="Constant">&quot;Reperform used in non-tail position&quot;<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Lprim</span> <span class="Statement">(</span><span class="Constant">Pduparray</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">kind</span>, <span class="ocamlLCIdentifier">mutability</span><span class="Statement">)</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">[</span><span class="Constant">Lprim</span> <span class="Statement">(</span><span class="Constant">Pmakearray</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">kind</span>',<span class="Statement">_)</span>,<span class="ocamlLCIdentifier">args</span>,<span class="Statement">_)]</span>, <span class="ocamlLCIdentifier">loc</span><span class="Statement">)</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">assert</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">kind</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">kind</span>'<span class="Statement">);<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L565" title="ocaml/bytecomp/bytegen.ml:565">comp_expr</a></span> <span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span> <span class="ocamlLCIdentifier">env<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="Constant">Lprim</span> <span class="Statement">(</span><span class="Constant">Pmakearray</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">kind</span>, <span class="ocamlLCIdentifier">mutability</span><span class="Statement">)</span>, <span class="ocamlLCIdentifier">args</span>, <span class="ocamlLCIdentifier">loc</span><span class="Statement">))</span> <span class="ocamlLCIdentifier">sz</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a><br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Lprim</span> <span class="Statement">(</span><span class="Constant">Pduparray</span> <span class="Statement">_</span>, <span class="Statement">[</span><span class="ocamlLCIdentifier">arg</span><span class="Statement">]</span>, <span class="ocamlLCIdentifier">loc</span><span class="Statement">)</span> <span class="Statement">-&gt;<br/></li>
<li><a id="L811">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">prim_obj_dup</span></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="PreProc">Primitive</span>.<span class="ocamlLCIdentifier">simple</span> <span class="Statement">~</span><span class="Identifier"><a href="bytepackager.ml.html#L91" title="ocaml/bytecomp/bytepackager.ml:91">name</a></span>:<span class="Constant">&quot;caml_obj_dup&quot;</span> <span class="Statement">~</span><span class="Identifier">arity</span>:<span class="Constant">1</span> <span class="Statement">~</span><span class="Identifier">alloc</span>:<span class="Constant">true<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L565" title="ocaml/bytecomp/bytegen.ml:565">comp_expr</a></span> <span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span> <span class="ocamlLCIdentifier">env</span> <span class="Statement">(</span><span class="Constant">Lprim</span> <span class="Statement">(</span><span class="Constant">Pccall</span> <span class="ocamlLCIdentifier"><a href="#L811" title="ocaml/bytecomp/bytegen.ml:811">prim_obj_dup</a></span>, <span class="Statement">[</span><span class="ocamlLCIdentifier">arg</span><span class="Statement">]</span>, <span class="ocamlLCIdentifier">loc</span><span class="Statement">))</span> <span class="ocamlLCIdentifier">sz</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a><br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Lprim</span> <span class="Statement">(</span><span class="Constant">Pduparray</span> <span class="Statement">_</span>, <span class="Statement">_</span>, <span class="Statement">_)</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="PreProc">Misc</span>.<span class="ocamlLCIdentifier">fatal_error</span> <span class="Constant">&quot;Bytegen.<a href="#L565" title="ocaml/bytecomp/bytegen.ml:565">comp_expr</a>: Pduparray takes exactly one arg&quot;<br/></li>
<li></span><span class="Comment">(* Integer first for enabling further optimization (cf. emitcode.ml)&nbsp; *)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Lprim</span> <span class="Statement">(</span><span class="Constant">Pintcomp</span> <span class="ocamlLCIdentifier"><a href="#L935" title="ocaml/bytecomp/bytegen.ml:935">c</a></span>, <span class="Statement">[</span><span class="ocamlLCIdentifier">arg</span> <span class="Statement">;</span> <span class="Statement">(</span><span class="Constant">Lconst</span> <span class="Statement">_</span> <span class="Statement">as</span> <span class="ocamlLCIdentifier">k</span><span class="Statement">)]</span>, <span class="Statement">_)</span> <span class="Statement">-&gt;<br/></li>
<li><a id="L819">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">p</span></span> <span class="Statement">=</span> <span class="Constant">Pintcomp</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">swap_integer_comparison</span> <span class="ocamlLCIdentifier"><a href="#L935" title="ocaml/bytecomp/bytegen.ml:935">c</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">and</span> <span class="ocamlLCIdentifier">args</span> <span class="Statement">=</span> <span class="Statement">[</span><span class="ocamlLCIdentifier">k</span> <span class="Statement">;</span> <span class="ocamlLCIdentifier">arg</span><span class="Statement">]</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="#L606" title="ocaml/bytecomp/bytegen.ml:606">nargs</a></span> <span class="Statement">=</span> <span class="PreProc">List</span>.<span class="ocamlLCIdentifier">length</span> <span class="ocamlLCIdentifier">args</span> - <span class="Constant">1</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L1059" title="ocaml/bytecomp/bytegen.ml:1059">comp_args</a></span> <span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span> <span class="ocamlLCIdentifier">env</span> <span class="ocamlLCIdentifier">args</span> <span class="ocamlLCIdentifier">sz<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L401" title="ocaml/bytecomp/bytegen.ml:401">comp_primitive</a></span> <span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span> <span class="ocamlLCIdentifier"><a href="#L819" title="ocaml/bytecomp/bytegen.ml:819">p</a></span> <span class="Statement">(</span><span class="ocamlLCIdentifier">sz</span> + <span class="ocamlLCIdentifier"><a href="#L606" title="ocaml/bytecomp/bytegen.ml:606">nargs</a></span> - <span class="Constant">1</span><span class="Statement">)</span> <span class="ocamlLCIdentifier">args</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Lprim</span> <span class="Statement">(</span><span class="Constant">Pfloatcomp</span> <span class="ocamlLCIdentifier">cmp</span>, <span class="ocamlLCIdentifier">args</span>, <span class="Statement">_)</span> <span class="Statement">-&gt;<br/></li>
<li><a id="L825">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">cont</span></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">match</span> <span class="ocamlLCIdentifier">cmp</span> <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">CFeq</span> <span class="Statement">-&gt;</span> <span class="Constant">Kccall</span><span class="Statement">(</span><span class="Constant">&quot;caml_eq_float&quot;</span>, <span class="Constant">2</span><span class="Statement">)</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">CFneq</span> <span class="Statement">-&gt;</span> <span class="Constant">Kccall</span><span class="Statement">(</span><span class="Constant">&quot;caml_neq_float&quot;</span>, <span class="Constant">2</span><span class="Statement">)</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">CFlt</span> <span class="Statement">-&gt;</span> <span class="Constant">Kccall</span><span class="Statement">(</span><span class="Constant">&quot;caml_lt_float&quot;</span>, <span class="Constant">2</span><span class="Statement">)</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">CFnlt</span> <span class="Statement">-&gt;</span> <span class="Constant">Kccall</span><span class="Statement">(</span><span class="Constant">&quot;caml_lt_float&quot;</span>, <span class="Constant">2</span><span class="Statement">)</span> <span class="Statement">::</span> <span class="Constant">Kboolnot</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">CFgt</span> <span class="Statement">-&gt;</span> <span class="Constant">Kccall</span><span class="Statement">(</span><span class="Constant">&quot;caml_gt_float&quot;</span>, <span class="Constant">2</span><span class="Statement">)</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">CFngt</span> <span class="Statement">-&gt;</span> <span class="Constant">Kccall</span><span class="Statement">(</span><span class="Constant">&quot;caml_gt_float&quot;</span>, <span class="Constant">2</span><span class="Statement">)</span> <span class="Statement">::</span> <span class="Constant">Kboolnot</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">CFle</span> <span class="Statement">-&gt;</span> <span class="Constant">Kccall</span><span class="Statement">(</span><span class="Constant">&quot;caml_le_float&quot;</span>, <span class="Constant">2</span><span class="Statement">)</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">CFnle</span> <span class="Statement">-&gt;</span> <span class="Constant">Kccall</span><span class="Statement">(</span><span class="Constant">&quot;caml_le_float&quot;</span>, <span class="Constant">2</span><span class="Statement">)</span> <span class="Statement">::</span> <span class="Constant">Kboolnot</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">CFge</span> <span class="Statement">-&gt;</span> <span class="Constant">Kccall</span><span class="Statement">(</span><span class="Constant">&quot;caml_ge_float&quot;</span>, <span class="Constant">2</span><span class="Statement">)</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">CFnge</span> <span class="Statement">-&gt;</span> <span class="Constant">Kccall</span><span class="Statement">(</span><span class="Constant">&quot;caml_ge_float&quot;</span>, <span class="Constant">2</span><span class="Statement">)</span> <span class="Statement">::</span> <span class="Constant">Kboolnot</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L1059" title="ocaml/bytecomp/bytegen.ml:1059">comp_args</a></span> <span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span> <span class="ocamlLCIdentifier">env</span> <span class="ocamlLCIdentifier">args</span> <span class="ocamlLCIdentifier">sz</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a><br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Lprim</span><span class="Statement">(</span><span class="Constant">Pmakeblock</span><span class="Statement">(</span><span class="ocamlLCIdentifier">tag</span>, <span class="ocamlLCIdentifier">_mut</span>, <span class="Statement">_)</span>, <span class="ocamlLCIdentifier">args</span>, <span class="ocamlLCIdentifier">loc</span><span class="Statement">)</span> <span class="Statement">-&gt;<br/></li>
<li><a id="L840">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">cont</span></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="#L304" title="ocaml/bytecomp/bytegen.ml:304">add_pseudo_event</a></span> <span class="ocamlLCIdentifier">loc</span> <span class="Statement">!</span><span class="ocamlLCIdentifier"><a href="#L382" title="ocaml/bytecomp/bytegen.ml:382">compunit_name</a></span> <span class="ocamlLCIdentifier"><span class="linkable">cont</span></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L1059" title="ocaml/bytecomp/bytegen.ml:1059">comp_args</a></span> <span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span> <span class="ocamlLCIdentifier">env</span> <span class="ocamlLCIdentifier">args</span> <span class="ocamlLCIdentifier">sz<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="Constant">Kmakeblock</span><span class="Statement">(</span><span class="PreProc">List</span>.<span class="ocamlLCIdentifier">length</span> <span class="ocamlLCIdentifier">args</span>, <span class="ocamlLCIdentifier">tag</span><span class="Statement">)</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Lprim</span><span class="Statement">(</span><span class="Constant">Pfloatfield</span> <span class="ocamlLCIdentifier">n</span>, <span class="ocamlLCIdentifier">args</span>, <span class="ocamlLCIdentifier">loc</span><span class="Statement">)</span> <span class="Statement">-&gt;<br/></li>
<li><a id="L844">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">cont</span></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="#L304" title="ocaml/bytecomp/bytegen.ml:304">add_pseudo_event</a></span> <span class="ocamlLCIdentifier">loc</span> <span class="Statement">!</span><span class="ocamlLCIdentifier"><a href="#L382" title="ocaml/bytecomp/bytegen.ml:382">compunit_name</a></span> <span class="ocamlLCIdentifier"><span class="linkable">cont</span></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L1059" title="ocaml/bytecomp/bytegen.ml:1059">comp_args</a></span> <span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span> <span class="ocamlLCIdentifier">env</span> <span class="ocamlLCIdentifier">args</span> <span class="ocamlLCIdentifier">sz</span> <span class="Statement">(</span><span class="Constant">Kgetfloatfield</span> <span class="ocamlLCIdentifier">n</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Lprim</span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L819" title="ocaml/bytecomp/bytegen.ml:819">p</a></span>, <span class="ocamlLCIdentifier">args</span>, <span class="Statement">_)</span> <span class="Statement">-&gt;<br/></li>
<li><a id="L847">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">nargs</span></span> <span class="Statement">=</span> <span class="PreProc">List</span>.<span class="ocamlLCIdentifier">length</span> <span class="ocamlLCIdentifier">args</span> - <span class="Constant">1</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L1059" title="ocaml/bytecomp/bytegen.ml:1059">comp_args</a></span> <span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span> <span class="ocamlLCIdentifier">env</span> <span class="ocamlLCIdentifier">args</span> <span class="ocamlLCIdentifier">sz<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L401" title="ocaml/bytecomp/bytegen.ml:401">comp_primitive</a></span> <span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span> <span class="ocamlLCIdentifier"><a href="#L819" title="ocaml/bytecomp/bytegen.ml:819">p</a></span> <span class="Statement">(</span><span class="ocamlLCIdentifier">sz</span> + <span class="ocamlLCIdentifier"><a href="#L606" title="ocaml/bytecomp/bytegen.ml:606">nargs</a></span> - <span class="Constant">1</span><span class="Statement">)</span> <span class="ocamlLCIdentifier">args</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Lstaticcatch</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">body</span>, <span class="Statement">(</span><span class="ocamlLCIdentifier">i</span>, <span class="ocamlLCIdentifier"><a href="#L851" title="ocaml/bytecomp/bytegen.ml:851">vars</a></span><span class="Statement">)</span> , <span class="ocamlLCIdentifier">handler</span><span class="Statement">)</span> <span class="Statement">-&gt;<br/></li>
<li><a id="L851">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">vars</span></span> <span class="Statement">=</span> <span class="PreProc">List</span>.<span class="ocamlLCIdentifier">map</span> <span class="ocamlLCIdentifier">fst</span> <span class="ocamlLCIdentifier"><span class="linkable">vars</span></span> <span class="Statement">in<br/></li>
<li><a id="L852">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">nvars</span></span> <span class="Statement">=</span> <span class="PreProc">List</span>.<span class="ocamlLCIdentifier">length</span> <span class="ocamlLCIdentifier"><a href="#L851" title="ocaml/bytecomp/bytegen.ml:851">vars</a></span> <span class="Statement">in<br/></li>
<li><a id="L853">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">branch1</span></span>, <span class="ocamlLCIdentifier"><a href="#L1048" title="ocaml/bytecomp/bytegen.ml:1048">cont1</a></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="#L77" title="ocaml/bytecomp/bytegen.ml:77">make_branch</a></span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span> <span class="Statement">in<br/></li>
<li><a id="L854">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">r</span></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier"><a href="#L852" title="ocaml/bytecomp/bytegen.ml:852">nvars</a></span><span class="ocamlNone"> </span><span class="Statement">&lt;&gt;</span><span class="ocamlNone"> </span><span class="Constant">1</span><span class="ocamlNone"> </span><span class="Statement">then</span> <span class="Statement">begin</span><span class="ocamlEnd"> </span><span class="Comment">(* general case *)<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L897" title="ocaml/bytecomp/bytegen.ml:897">lbl_handler</a></span><span class="ocamlEnd">, </span><span class="ocamlLCIdentifier">cont2</span><span class="ocamlEnd"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="#L57" title="ocaml/bytecomp/bytegen.ml:57">label_code</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L565" title="ocaml/bytecomp/bytegen.ml:565">comp_expr</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L46" title="ocaml/bytecomp/bytegen.ml:46">add_vars</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L851" title="ocaml/bytecomp/bytegen.ml:851">vars</a></span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">sz</span><span class="ocamlEnd">+</span><span class="Constant">1</span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">env</span><span class="Statement">)<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier">handler</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">sz</span><span class="ocamlEnd">+</span><span class="ocamlLCIdentifier"><a href="#L852" title="ocaml/bytecomp/bytegen.ml:852">nvars</a></span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L141" title="ocaml/bytecomp/bytegen.ml:141">add_pop</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L852" title="ocaml/bytecomp/bytegen.ml:852">nvars</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L1048" title="ocaml/bytecomp/bytegen.ml:1048">cont1</a></span><span class="Statement">))</span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span><span class="ocamlEnd"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="#L342" title="ocaml/bytecomp/bytegen.ml:342">push_static_raise</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">i</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L897" title="ocaml/bytecomp/bytegen.ml:897">lbl_handler</a></span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">sz</span><span class="ocamlEnd">+</span><span class="ocamlLCIdentifier"><a href="#L852" title="ocaml/bytecomp/bytegen.ml:852">nvars</a></span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="#L155" title="ocaml/bytecomp/bytegen.ml:155">push_dummies</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L852" title="ocaml/bytecomp/bytegen.ml:852">nvars</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L565" title="ocaml/bytecomp/bytegen.ml:565">comp_expr</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">env</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">body</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">sz</span><span class="ocamlEnd">+</span><span class="ocamlLCIdentifier"><a href="#L852" title="ocaml/bytecomp/bytegen.ml:852">nvars</a></span><span class="Statement">)<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L141" title="ocaml/bytecomp/bytegen.ml:141">add_pop</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L852" title="ocaml/bytecomp/bytegen.ml:852">nvars</a></span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L853" title="ocaml/bytecomp/bytegen.ml:853">branch1</a></span><span class="ocamlEnd"> </span><span class="Statement">::</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">cont2</span><span class="Statement">)))<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">end</span> <span class="Statement">else</span> <span class="Statement">begin</span><span class="ocamlEnd"> </span><span class="Comment">(* small optimization for <a href="#L852" title="ocaml/bytecomp/bytegen.ml:852">nvars</a> = 1 *)<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">var</span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="Statement">match</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L851" title="ocaml/bytecomp/bytegen.ml:851">vars</a></span><span class="ocamlEnd"> </span><span class="Statement">with</span><span class="ocamlEnd"> </span><span class="Statement">[</span><span class="ocamlLCIdentifier">var</span><span class="Statement">]</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">var</span><span class="ocamlEnd"> </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Statement">_</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;</span><span class="ocamlEnd"> </span><span class="Statement">assert</span><span class="ocamlEnd"> </span><span class="Constant">false</span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L897" title="ocaml/bytecomp/bytegen.ml:897">lbl_handler</a></span><span class="ocamlEnd">, </span><span class="ocamlLCIdentifier">cont2</span><span class="ocamlEnd"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="#L57" title="ocaml/bytecomp/bytegen.ml:57">label_code</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">(</span><span class="Constant">Kpush</span><span class="Statement">::</span><span class="ocamlLCIdentifier"><a href="#L565" title="ocaml/bytecomp/bytegen.ml:565">comp_expr</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L41" title="ocaml/bytecomp/bytegen.ml:41">add_var</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">var</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">sz</span><span class="ocamlEnd">+</span><span class="Constant">1</span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">env</span><span class="Statement">)<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier">handler</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">sz</span><span class="ocamlEnd">+</span><span class="Constant">1</span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L141" title="ocaml/bytecomp/bytegen.ml:141">add_pop</a></span><span class="ocamlEnd"> </span><span class="Constant">1</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L1048" title="ocaml/bytecomp/bytegen.ml:1048">cont1</a></span><span class="Statement">))</span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span><span class="ocamlEnd"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="#L342" title="ocaml/bytecomp/bytegen.ml:342">push_static_raise</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">i</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L897" title="ocaml/bytecomp/bytegen.ml:897">lbl_handler</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">sz</span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="#L565" title="ocaml/bytecomp/bytegen.ml:565">comp_expr</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">env</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">body</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">sz</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L853" title="ocaml/bytecomp/bytegen.ml:853">branch1</a></span><span class="ocamlEnd"> </span><span class="Statement">::</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">cont2</span><span class="Statement">)<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">end</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L854" title="ocaml/bytecomp/bytegen.ml:854">r</a><br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Lstaticraise</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">i</span>, <span class="ocamlLCIdentifier">args</span><span class="Statement">)</span> <span class="Statement">-&gt;<br/></li>
<li><a id="L880">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">cont</span></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="#L95" title="ocaml/bytecomp/bytegen.ml:95">discard_dead_code</a></span> <span class="ocamlLCIdentifier"><span class="linkable">cont</span></span> <span class="Statement">in<br/></li>
<li><a id="L881">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">label</span></span>,<span class="ocamlLCIdentifier">size</span>,<span class="ocamlLCIdentifier">tb</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="#L349" title="ocaml/bytecomp/bytegen.ml:349">find_raise_label</a></span> <span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span> <span class="ocamlLCIdentifier">i</span> <span class="Statement">in<br/></li>
<li><a id="L882">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">cont</span></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="#L87" title="ocaml/bytecomp/bytegen.ml:87">branch_to</a></span> <span class="ocamlLCIdentifier"><a href="instruct.ml.html#L51" title="ocaml/bytecomp/instruct.ml:51">label</a></span> <span class="ocamlLCIdentifier"><span class="linkable">cont</span></span> <span class="Statement">in<br/></li>
<li><a id="L883">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="Statement">rec</span> <span class="ocamlLCIdentifier"><span class="linkable">loop</span></span> <span class="ocamlLCIdentifier">sz</span> <span class="ocamlLCIdentifier">tbb</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">tb</span><span class="ocamlNone"> </span><span class="Statement">==</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">tbb</span><span class="ocamlNone"> </span><span class="Statement">then</span> <span class="ocamlLCIdentifier"><a href="#L141" title="ocaml/bytecomp/bytegen.ml:141">add_pop</a></span> <span class="Statement">(</span><span class="ocamlLCIdentifier">sz</span>-<span class="ocamlLCIdentifier">size</span><span class="Statement">)</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">else</span> <span class="Statement">match</span> <span class="ocamlLCIdentifier">tbb</span> <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">[]</span> <span class="Statement">-&gt;</span> <span class="Statement">assert</span> <span class="Constant">false<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="ocamlLCIdentifier">try_sz</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier">tbb</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier"><a href="#L141" title="ocaml/bytecomp/bytegen.ml:141">add_pop</a></span> <span class="Statement">(</span><span class="ocamlLCIdentifier">sz</span>-<span class="ocamlLCIdentifier">try_sz</span>-<span class="Constant">4</span><span class="Statement">)</span> <span class="Statement">(</span><span class="Constant">Kpoptrap</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier"><a href="#L883" title="ocaml/bytecomp/bytegen.ml:883">loop</a></span> <span class="ocamlLCIdentifier">try_sz</span> <span class="ocamlLCIdentifier">tbb</span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">in<br/></li>
<li><a id="L889">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">cont</span></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="#L883" title="ocaml/bytecomp/bytegen.ml:883">loop</a></span> <span class="ocamlLCIdentifier">sz</span> <span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span>.<span class="ocamlLCIdentifier">try_blocks</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">begin</span><span class="ocamlEnd"> </span><span class="Statement">match</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">args</span><span class="ocamlEnd"> </span><span class="Statement">with<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Statement">[</span><span class="ocamlLCIdentifier">arg</span><span class="Statement">]</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;</span><span class="ocamlEnd"> </span><span class="Comment">(* optim, argument passed in accumulator *)<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="#L565" title="ocaml/bytecomp/bytegen.ml:565">comp_expr</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">env</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">arg</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">sz</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Statement">_</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">comp_exit_args</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">env</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">args</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">sz</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">size</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">end<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Ltrywith</span><span class="Statement">(</span><span class="ocamlLCIdentifier">body</span>, <span class="ocamlLCIdentifier">id</span>, <span class="ocamlLCIdentifier">handler</span><span class="Statement">)</span> <span class="Statement">-&gt;<br/></li>
<li><a id="L896">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><span class="linkable">branch1</span></span>, <span class="ocamlLCIdentifier"><a href="#L1048" title="ocaml/bytecomp/bytegen.ml:1048">cont1</a></span><span class="Statement">)</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="#L77" title="ocaml/bytecomp/bytegen.ml:77">make_branch</a></span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span> <span class="Statement">in<br/></li>
<li><a id="L897">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">lbl_handler</span></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="#L31" title="ocaml/bytecomp/bytegen.ml:31">new_label</a></span><span class="Constant">()</span> <span class="Statement">in<br/></li>
<li><a id="L898">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">body_cont</span></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">Kpoptrap</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier"><a href="#L853" title="ocaml/bytecomp/bytegen.ml:853">branch1</a></span> <span class="Statement">::<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">Klabel</span> <span class="ocamlLCIdentifier"><a href="#L897" title="ocaml/bytecomp/bytegen.ml:897">lbl_handler</a></span> <span class="Statement">::</span> <span class="Constant">Kpush</span> <span class="Statement">::<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L565" title="ocaml/bytecomp/bytegen.ml:565">comp_expr</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L41" title="ocaml/bytecomp/bytegen.ml:41">add_var</a></span> <span class="ocamlLCIdentifier">id</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">sz</span>+<span class="Constant">1</span><span class="Statement">)</span> <span class="ocamlLCIdentifier">env</span><span class="Statement">)</span> <span class="ocamlLCIdentifier">handler</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">sz</span>+<span class="Constant">1</span><span class="Statement">)</span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L141" title="ocaml/bytecomp/bytegen.ml:141">add_pop</a></span> <span class="Constant">1</span> <span class="ocamlLCIdentifier"><a href="#L1048" title="ocaml/bytecomp/bytegen.ml:1048">cont1</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">in<br/></li>
<li><a id="L904">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">stack_info</span></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">{</span> <span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span> <span class="Statement">with</span> <span class="ocamlLCIdentifier">try_blocks</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">sz</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span>.<span class="ocamlLCIdentifier">try_blocks</span> <span class="Statement">}</span> <span class="Statement">in<br/></li>
<li><a id="L906">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">l</span></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="#L565" title="ocaml/bytecomp/bytegen.ml:565">comp_expr</a></span> <span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span> <span class="ocamlLCIdentifier">env</span> <span class="ocamlLCIdentifier">body</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">sz</span>+<span class="Constant">4</span><span class="Statement">)</span> <span class="ocamlLCIdentifier"><a href="#L898" title="ocaml/bytecomp/bytegen.ml:898">body_cont</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Constant">Kpushtrap</span> <span class="ocamlLCIdentifier"><a href="#L897" title="ocaml/bytecomp/bytegen.ml:897">lbl_handler</a></span> <span class="Statement">::</span> <span class="ocamlLCIdentifier"><a href="#L906" title="ocaml/bytecomp/bytegen.ml:906">l</a><br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Lifthenelse</span><span class="Statement">(</span><span class="ocamlLCIdentifier">cond</span>, <span class="ocamlLCIdentifier">ifso</span>, <span class="ocamlLCIdentifier">ifnot</span><span class="Statement">)</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">comp_binary_test</span> <span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span> <span class="ocamlLCIdentifier">env</span> <span class="ocamlLCIdentifier">cond</span> <span class="ocamlLCIdentifier">ifso</span> <span class="ocamlLCIdentifier">ifnot</span> <span class="ocamlLCIdentifier">sz</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a><br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Lsequence</span><span class="Statement">(</span><span class="ocamlLCIdentifier">exp1</span>, <span class="ocamlLCIdentifier">exp2</span><span class="Statement">)</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L565" title="ocaml/bytecomp/bytegen.ml:565">comp_expr</a></span> <span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span> <span class="ocamlLCIdentifier">env</span> <span class="ocamlLCIdentifier">exp1</span> <span class="ocamlLCIdentifier">sz</span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L565" title="ocaml/bytecomp/bytegen.ml:565">comp_expr</a></span> <span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span> <span class="ocamlLCIdentifier">env</span> <span class="ocamlLCIdentifier">exp2</span> <span class="ocamlLCIdentifier">sz</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Lwhile</span><span class="Statement">(</span><span class="ocamlLCIdentifier">cond</span>, <span class="ocamlLCIdentifier">body</span><span class="Statement">)</span> <span class="Statement">-&gt;<br/></li>
<li><a id="L913">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">lbl_loop</span></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="#L31" title="ocaml/bytecomp/bytegen.ml:31">new_label</a></span><span class="Constant">()</span> <span class="Statement">in<br/></li>
<li><a id="L914">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">lbl_test</span></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="#L31" title="ocaml/bytecomp/bytegen.ml:31">new_label</a></span><span class="Constant">()</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Constant">Kbranch</span> <span class="ocamlLCIdentifier"><a href="#L914" title="ocaml/bytecomp/bytegen.ml:914">lbl_test</a></span> <span class="Statement">::</span> <span class="Constant">Klabel</span> <span class="ocamlLCIdentifier"><a href="#L913" title="ocaml/bytecomp/bytegen.ml:913">lbl_loop</a></span> <span class="Statement">::</span> <span class="Constant">Kcheck_signals</span> <span class="Statement">::<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L565" title="ocaml/bytecomp/bytegen.ml:565">comp_expr</a></span> <span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span> <span class="ocamlLCIdentifier">env</span> <span class="ocamlLCIdentifier">body</span> <span class="ocamlLCIdentifier">sz<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="Constant">Klabel</span> <span class="ocamlLCIdentifier"><a href="#L914" title="ocaml/bytecomp/bytegen.ml:914">lbl_test</a></span> <span class="Statement">::<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier"><a href="#L565" title="ocaml/bytecomp/bytegen.ml:565">comp_expr</a></span> <span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span> <span class="ocamlLCIdentifier">env</span> <span class="ocamlLCIdentifier">cond</span> <span class="ocamlLCIdentifier">sz<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">(</span><span class="Constant">Kbranchif</span> <span class="ocamlLCIdentifier"><a href="#L913" title="ocaml/bytecomp/bytegen.ml:913">lbl_loop</a></span> <span class="Statement">::</span> <span class="ocamlLCIdentifier"><a href="#L151" title="ocaml/bytecomp/bytegen.ml:151">add_const_unit</a></span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span><span class="Statement">))<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Lfor</span><span class="Statement">(</span><span class="ocamlLCIdentifier">param</span>, <span class="ocamlLCIdentifier">start</span>, <span class="ocamlLCIdentifier">stop</span>, <span class="ocamlLCIdentifier">dir</span>, <span class="ocamlLCIdentifier">body</span><span class="Statement">)</span> <span class="Statement">-&gt;<br/></li>
<li><a id="L921">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">lbl_loop</span></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="#L31" title="ocaml/bytecomp/bytegen.ml:31">new_label</a></span><span class="Constant">()</span> <span class="Statement">in<br/></li>
<li><a id="L922">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">lbl_exit</span></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="#L31" title="ocaml/bytecomp/bytegen.ml:31">new_label</a></span><span class="Constant">()</span> <span class="Statement">in<br/></li>
<li><a id="L923">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">offset</span></span> <span class="Statement">=</span> <span class="Statement">match</span> <span class="ocamlLCIdentifier">dir</span> <span class="Statement">with</span> <span class="Constant">Upto</span> <span class="Statement">-&gt;</span> <span class="Constant">1</span> <span class="Statement">|</span> <span class="Constant">Downto</span> <span class="Statement">-&gt;</span> -<span class="Constant">1</span> <span class="Statement">in<br/></li>
<li><a id="L924">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">comp</span></span> <span class="Statement">=</span> <span class="Statement">match</span> <span class="ocamlLCIdentifier">dir</span> <span class="Statement">with</span> <span class="Constant">Upto</span> <span class="Statement">-&gt;</span> <span class="Constant">Cgt</span> <span class="Statement">|</span> <span class="Constant">Downto</span> <span class="Statement">-&gt;</span> <span class="Constant">Clt</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L565" title="ocaml/bytecomp/bytegen.ml:565">comp_expr</a></span> <span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span> <span class="ocamlLCIdentifier">env</span> <span class="ocamlLCIdentifier">start</span> <span class="ocamlLCIdentifier">sz<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="Constant">Kpush</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier"><a href="#L565" title="ocaml/bytecomp/bytegen.ml:565">comp_expr</a></span> <span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span> <span class="ocamlLCIdentifier">env</span> <span class="ocamlLCIdentifier">stop</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">sz</span>+<span class="Constant">1</span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="Constant">Kpush</span> <span class="Statement">::</span> <span class="Constant">Kpush</span> <span class="Statement">::</span> <span class="Constant">Kacc</span> <span class="Constant">2</span> <span class="Statement">::</span> <span class="Constant">Kintcomp</span> <span class="ocamlLCIdentifier"><a href="#L924" title="ocaml/bytecomp/bytegen.ml:924">comp</a></span> <span class="Statement">::</span> <span class="Constant">Kbranchif</span> <span class="ocamlLCIdentifier"><a href="#L922" title="ocaml/bytecomp/bytegen.ml:922">lbl_exit</a></span> <span class="Statement">::<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">Klabel</span> <span class="ocamlLCIdentifier"><a href="#L913" title="ocaml/bytecomp/bytegen.ml:913">lbl_loop</a></span> <span class="Statement">::</span> <span class="Constant">Kcheck_signals</span> <span class="Statement">::<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="ocamlLCIdentifier"><a href="#L565" title="ocaml/bytecomp/bytegen.ml:565">comp_expr</a></span> <span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L41" title="ocaml/bytecomp/bytegen.ml:41">add_var</a></span> <span class="ocamlLCIdentifier">param</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">sz</span>+<span class="Constant">1</span><span class="Statement">)</span> <span class="ocamlLCIdentifier">env</span><span class="Statement">)</span> <span class="ocamlLCIdentifier">body</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">sz</span>+<span class="Constant">2</span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">(</span><span class="Constant">Kacc</span> <span class="Constant">1</span> <span class="Statement">::</span> <span class="Constant">Kpush</span> <span class="Statement">::</span> <span class="Constant">Koffsetint</span> <span class="ocamlLCIdentifier"><a href="#L923" title="ocaml/bytecomp/bytegen.ml:923">offset</a></span> <span class="Statement">::</span> <span class="Constant">Kassign</span> <span class="Constant">2</span> <span class="Statement">::<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">Kacc</span> <span class="Constant">1</span> <span class="Statement">::</span> <span class="Constant">Kintcomp</span> <span class="Constant">Cne</span> <span class="Statement">::</span> <span class="Constant">Kbranchif</span> <span class="ocamlLCIdentifier"><a href="#L913" title="ocaml/bytecomp/bytegen.ml:913">lbl_loop</a></span> <span class="Statement">::<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">Klabel</span> <span class="ocamlLCIdentifier"><a href="#L922" title="ocaml/bytecomp/bytegen.ml:922">lbl_exit</a></span> <span class="Statement">::</span> <span class="ocamlLCIdentifier"><a href="#L151" title="ocaml/bytecomp/bytegen.ml:151">add_const_unit</a></span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L141" title="ocaml/bytecomp/bytegen.ml:141">add_pop</a></span> <span class="Constant">2</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span><span class="Statement">))))<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Lswitch</span><span class="Statement">(</span><span class="ocamlLCIdentifier">arg</span>, <span class="ocamlLCIdentifier">sw</span>, <span class="ocamlLCIdentifier">_loc</span><span class="Statement">)</span> <span class="Statement">-&gt;<br/></li>
<li><a id="L934">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><span class="linkable">branch</span></span>, <span class="ocamlLCIdentifier"><a href="#L1048" title="ocaml/bytecomp/bytegen.ml:1048">cont1</a></span><span class="Statement">)</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="#L77" title="ocaml/bytecomp/bytegen.ml:77">make_branch</a></span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span> <span class="Statement">in<br/></li>
<li><a id="L935">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">c</span></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">ref</span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L95" title="ocaml/bytecomp/bytegen.ml:95">discard_dead_code</a></span> <span class="ocamlLCIdentifier"><a href="#L1048" title="ocaml/bytecomp/bytegen.ml:1048">cont1</a></span><span class="Statement">)</span> <span class="Statement">in<br/></li>
<li></span><br/></li>
<li><span class="Comment">(* Build indirection vectors *)<br/></li>
<li><a id="L938">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">store</span></span> <span class="Statement">=</span> <span class="PreProc">Storer</span>.<span class="ocamlLCIdentifier">mk_store</span> <span class="Constant">()</span> <span class="Statement">in<br/></li>
<li><a id="L939">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">act_consts</span></span> <span class="Statement">=</span> <span class="PreProc">Array</span>.<span class="ocamlLCIdentifier">make</span> <span class="ocamlLCIdentifier">sw</span>.<span class="ocamlLCIdentifier">sw_numconsts</span> <span class="Constant">0<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">and</span> <span class="ocamlLCIdentifier">act_blocks</span> <span class="Statement">=</span> <span class="PreProc">Array</span>.<span class="ocamlLCIdentifier">make</span> <span class="ocamlLCIdentifier">sw</span>.<span class="ocamlLCIdentifier">sw_numblocks</span> <span class="Constant">0</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">begin</span><span class="ocamlEnd"> </span><span class="Statement">match</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">sw</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">sw_failaction</span><span class="ocamlEnd"> </span><span class="Statement">with</span><span class="ocamlEnd"> </span><span class="Comment">(* default is index 0 *)<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Constant">Some</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">fail</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">ignore</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L938" title="ocaml/bytecomp/bytegen.ml:938">store</a></span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">act_store</span><span class="ocamlEnd"> </span><span class="Constant">()</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">fail</span><span class="Statement">)<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Constant">None</span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">-&gt;</span><span class="ocamlEnd"> </span><span class="Constant">()<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">end</span> <span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="PreProc">List</span>.<span class="ocamlLCIdentifier">iter<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">(fun</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">n</span>, <span class="ocamlLCIdentifier">act</span><span class="Statement">)</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier"><a href="#L939" title="ocaml/bytecomp/bytegen.ml:939">act_consts</a></span>.<span class="Statement">(</span><span class="ocamlLCIdentifier">n</span><span class="Statement">)</span> <span class="Statement">&lt;-</span> <span class="ocamlLCIdentifier"><a href="#L938" title="ocaml/bytecomp/bytegen.ml:938">store</a></span>.<span class="ocamlLCIdentifier">act_store</span> <span class="Constant">()</span> <span class="ocamlLCIdentifier">act</span><span class="Statement">)</span> <span class="ocamlLCIdentifier">sw</span>.<span class="ocamlLCIdentifier">sw_consts</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="PreProc">List</span>.<span class="ocamlLCIdentifier">iter<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">(fun</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">n</span>, <span class="ocamlLCIdentifier">act</span><span class="Statement">)</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier">act_blocks</span>.<span class="Statement">(</span><span class="ocamlLCIdentifier">n</span><span class="Statement">)</span> <span class="Statement">&lt;-</span> <span class="ocamlLCIdentifier"><a href="#L938" title="ocaml/bytecomp/bytegen.ml:938">store</a></span>.<span class="ocamlLCIdentifier">act_store</span> <span class="Constant">()</span> <span class="ocamlLCIdentifier">act</span><span class="Statement">)</span> <span class="ocamlLCIdentifier">sw</span>.<span class="ocamlLCIdentifier">sw_blocks</span><span class="Statement">;<br/></li>
<li></span><span class="Comment">(* Compile and <a href="instruct.ml.html#L51" title="ocaml/bytecomp/instruct.ml:51">label</a> actions *)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">acts</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="#L938" title="ocaml/bytecomp/bytegen.ml:938">store</a></span>.<span class="ocamlLCIdentifier">act_get</span> <span class="Constant">()</span> <span class="Statement">in<br/></li>
<li></span><span class="Comment">(*<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; let a = <a href="#L938" title="ocaml/bytecomp/bytegen.ml:938">store</a>.act_get_shared () in<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; Array.iter<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; (function<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | Switch.Shared (Lstaticraise _) -&gt; ()<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | Switch.Shared act -&gt;<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Printlambda.lambda Format.str_formatter act ;<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Printf.eprintf &quot;SHARE BYTE:\n%s\n&quot; (Format.flush_str_formatter ())<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | _ -&gt; ())<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; a ;<br/></li>
<li></span><span class="Comment">*)<br/></li>
<li><a id="L962">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">lbls</span></span> <span class="Statement">=</span> <span class="PreProc">Array</span>.<span class="ocamlLCIdentifier">make</span> <span class="Statement">(</span><span class="PreProc">Array</span>.<span class="ocamlLCIdentifier">length</span> <span class="ocamlLCIdentifier">acts</span><span class="Statement">)</span> <span class="Constant">0</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">for</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">i</span><span class="ocamlNone"> </span><span class="Statement">=</span><span class="ocamlNone"> </span><span class="PreProc">Array</span><span class="ocamlNone">.</span><span class="ocamlLCIdentifier">length</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">acts</span><span class="ocamlNone">-</span><span class="Constant">1</span><span class="ocamlNone"> </span><span class="Statement">downto</span> <span class="Constant">0</span> <span class="Statement">do<br/></li>
<li><a id="L964">&#x200c;</a></span><span class="ocamlDo">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlDo"> </span><span class="ocamlLCIdentifier"><span class="linkable">lbl</span></span><span class="ocamlDo">,</span><span class="ocamlLCIdentifier">c1</span><span class="ocamlDo"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlDo">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="#L57" title="ocaml/bytecomp/bytegen.ml:57">label_code</a></span><span class="ocamlDo"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L565" title="ocaml/bytecomp/bytegen.ml:565">comp_expr</a></span><span class="ocamlDo"> </span><span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span><span class="ocamlDo"> </span><span class="ocamlLCIdentifier">env</span><span class="ocamlDo"> </span><span class="ocamlLCIdentifier">acts</span><span class="ocamlDo">.</span><span class="Statement">(</span><span class="ocamlLCIdentifier">i</span><span class="Statement">)</span><span class="ocamlDo"> </span><span class="ocamlLCIdentifier">sz</span><span class="ocamlDo"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L934" title="ocaml/bytecomp/bytegen.ml:934">branch</a></span><span class="ocamlDo"> </span><span class="Statement">::</span><span class="ocamlDo"> </span><span class="Statement">!</span><span class="ocamlLCIdentifier"><a href="#L935" title="ocaml/bytecomp/bytegen.ml:935">c</a></span><span class="Statement">))</span><span class="ocamlDo"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlDo">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="#L660" title="ocaml/bytecomp/bytegen.ml:660">lbls</a></span><span class="ocamlDo">.</span><span class="Statement">(</span><span class="ocamlLCIdentifier">i</span><span class="Statement">)</span><span class="ocamlDo"> </span><span class="Statement">&lt;-</span><span class="ocamlDo"> </span><span class="ocamlLCIdentifier"><a href="#L621" title="ocaml/bytecomp/bytegen.ml:621">lbl</a></span><span class="ocamlDo"> </span><span class="Statement">;<br/></li>
<li></span><span class="ocamlDo">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="#L935" title="ocaml/bytecomp/bytegen.ml:935">c</a></span><span class="ocamlDo"> </span><span class="Statement">:=</span><span class="ocamlDo"> </span><span class="ocamlLCIdentifier"><a href="#L95" title="ocaml/bytecomp/bytegen.ml:95">discard_dead_code</a></span><span class="ocamlDo"> </span><span class="ocamlLCIdentifier">c1<br/></li>
<li></span><span class="ocamlDo">&nbsp; &nbsp; &nbsp; </span><span class="Statement">done</span> <span class="Statement">;<br/></li>
<li></span><br/></li>
<li><span class="Comment">(* Build <a href="instruct.ml.html#L51" title="ocaml/bytecomp/instruct.ml:51">label</a> vectors *)<br/></li>
<li><a id="L971">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">lbl_blocks</span></span> <span class="Statement">=</span> <span class="PreProc">Array</span>.<span class="ocamlLCIdentifier">make</span> <span class="ocamlLCIdentifier">sw</span>.<span class="ocamlLCIdentifier">sw_numblocks</span> <span class="Constant">0</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">for</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">i</span><span class="ocamlNone"> </span><span class="Statement">=</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">sw</span><span class="ocamlNone">.</span><span class="ocamlLCIdentifier">sw_numblocks</span><span class="ocamlNone"> - </span><span class="Constant">1</span><span class="ocamlNone"> </span><span class="Statement">downto</span> <span class="Constant">0</span> <span class="Statement">do<br/></li>
<li></span><span class="ocamlDo">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="#L971" title="ocaml/bytecomp/bytegen.ml:971">lbl_blocks</a></span><span class="ocamlDo">.</span><span class="Statement">(</span><span class="ocamlLCIdentifier">i</span><span class="Statement">)</span><span class="ocamlDo"> </span><span class="Statement">&lt;-</span><span class="ocamlDo"> </span><span class="ocamlLCIdentifier"><a href="#L660" title="ocaml/bytecomp/bytegen.ml:660">lbls</a></span><span class="ocamlDo">.</span><span class="Statement">(</span><span class="ocamlLCIdentifier">act_blocks</span><span class="ocamlDo">.</span><span class="Statement">(</span><span class="ocamlLCIdentifier">i</span><span class="Statement">))<br/></li>
<li></span><span class="ocamlDo">&nbsp; &nbsp; &nbsp; </span><span class="Statement">done;<br/></li>
<li><a id="L975">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">lbl_consts</span></span> <span class="Statement">=</span> <span class="PreProc">Array</span>.<span class="ocamlLCIdentifier">make</span> <span class="ocamlLCIdentifier">sw</span>.<span class="ocamlLCIdentifier">sw_numconsts</span> <span class="Constant">0</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">for</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">i</span><span class="ocamlNone"> </span><span class="Statement">=</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">sw</span><span class="ocamlNone">.</span><span class="ocamlLCIdentifier">sw_numconsts</span><span class="ocamlNone"> - </span><span class="Constant">1</span><span class="ocamlNone"> </span><span class="Statement">downto</span> <span class="Constant">0</span> <span class="Statement">do<br/></li>
<li></span><span class="ocamlDo">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="#L975" title="ocaml/bytecomp/bytegen.ml:975">lbl_consts</a></span><span class="ocamlDo">.</span><span class="Statement">(</span><span class="ocamlLCIdentifier">i</span><span class="Statement">)</span><span class="ocamlDo"> </span><span class="Statement">&lt;-</span><span class="ocamlDo"> </span><span class="ocamlLCIdentifier"><a href="#L660" title="ocaml/bytecomp/bytegen.ml:660">lbls</a></span><span class="ocamlDo">.</span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L939" title="ocaml/bytecomp/bytegen.ml:939">act_consts</a></span><span class="ocamlDo">.</span><span class="Statement">(</span><span class="ocamlLCIdentifier">i</span><span class="Statement">))<br/></li>
<li></span><span class="ocamlDo">&nbsp; &nbsp; &nbsp; </span><span class="Statement">done;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L565" title="ocaml/bytecomp/bytegen.ml:565">comp_expr</a></span> <span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span> <span class="ocamlLCIdentifier">env</span> <span class="ocamlLCIdentifier">arg</span> <span class="ocamlLCIdentifier">sz</span> <span class="Statement">(</span><span class="Constant">Kswitch</span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L975" title="ocaml/bytecomp/bytegen.ml:975">lbl_consts</a></span>, <span class="ocamlLCIdentifier"><a href="#L971" title="ocaml/bytecomp/bytegen.ml:971">lbl_blocks</a></span><span class="Statement">)</span> <span class="Statement">::</span> <span class="Statement">!</span><span class="ocamlLCIdentifier"><a href="#L935" title="ocaml/bytecomp/bytegen.ml:935">c</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Lstringswitch</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">arg</span>,<span class="ocamlLCIdentifier">sw</span>,<span class="ocamlLCIdentifier">d</span>,<span class="ocamlLCIdentifier">loc</span><span class="Statement">)</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L565" title="ocaml/bytecomp/bytegen.ml:565">comp_expr</a></span> <span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span> <span class="ocamlLCIdentifier">env<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="PreProc">Matching</span>.<span class="ocamlLCIdentifier">expand_stringswitch</span> <span class="ocamlLCIdentifier">loc</span> <span class="ocamlLCIdentifier">arg</span> <span class="ocamlLCIdentifier">sw</span> <span class="ocamlLCIdentifier">d</span><span class="Statement">)</span> <span class="ocamlLCIdentifier">sz</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a><br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Lassign</span><span class="Statement">(</span><span class="ocamlLCIdentifier">id</span>, <span class="ocamlLCIdentifier">expr</span><span class="Statement">)</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">begin</span><span class="ocamlEnd"> </span><span class="Statement">try<br/></li>
<li><a id="L985">&#x200c;</a></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><span class="linkable">pos</span></span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="PreProc">Ident</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">find_same</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">id</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">env</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">ce_stack</span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="#L565" title="ocaml/bytecomp/bytegen.ml:565">comp_expr</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">env</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">expr</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">sz</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="Constant">Kassign</span><span class="Statement">(</span><span class="ocamlLCIdentifier">sz</span><span class="ocamlEnd"> - </span><span class="ocamlLCIdentifier"><a href="#L985" title="ocaml/bytecomp/bytegen.ml:985">pos</a></span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="Statement">::</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span><span class="Statement">)<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">with</span><span class="ocamlEnd"> </span><span class="Constant">Not_found</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier">fatal_error</span><span class="ocamlEnd"> </span><span class="Constant">&quot;Bytegen.<a href="#L565" title="ocaml/bytecomp/bytegen.ml:565">comp_expr</a>: assign&quot;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">end<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Levent</span><span class="Statement">(</span><span class="ocamlLCIdentifier">lam</span>, <span class="ocamlLCIdentifier">lev</span><span class="Statement">)</span> <span class="Statement">-&gt;<br/></li>
<li><a id="L991">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">ev_defname</span></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">string_of_scoped_location</span> <span class="ocamlLCIdentifier">lev</span>.<span class="ocamlLCIdentifier">lev_loc</span> <span class="Statement">in<br/></li>
<li><a id="L992">&#x200c;</a></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">event</span></span> <span class="ocamlLCIdentifier">kind</span> <span class="ocamlLCIdentifier"><a href="#L1040" title="ocaml/bytecomp/bytegen.ml:1040">info</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">{</span> <span class="ocamlLCIdentifier">ev_pos</span> <span class="Statement">=</span> <span class="Constant">0</span><span class="Statement">;</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Comment">(* patched in emitcode *)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">ev_module</span> <span class="Statement">=</span> <span class="Statement">!</span><span class="ocamlLCIdentifier"><a href="#L382" title="ocaml/bytecomp/bytegen.ml:382">compunit_name</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">ev_loc</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">to_location</span> <span class="ocamlLCIdentifier">lev</span>.<span class="ocamlLCIdentifier">lev_loc</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">ev_kind</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">kind</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L991" title="ocaml/bytecomp/bytegen.ml:991">ev_defname</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">ev_info</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="#L1040" title="ocaml/bytecomp/bytegen.ml:1040">info</a></span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">ev_typenv</span> <span class="Statement">=</span> <span class="PreProc">Env</span>.<span class="ocamlLCIdentifier">summary</span> <span class="ocamlLCIdentifier">lev</span>.<span class="ocamlLCIdentifier">lev_env</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">ev_typsubst</span> <span class="Statement">=</span> <span class="PreProc">Subst</span>.<span class="ocamlLCIdentifier">identity</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">ev_compenv</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">env</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">ev_stacksize</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">sz</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">ev_repr</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">begin</span><span class="ocamlEnd"> </span><span class="Statement">match</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">lev</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">lev_repr</span><span class="ocamlEnd"> </span><span class="Statement">with<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Constant">None</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Constant">Event_none<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Constant">Some</span><span class="ocamlEnd"> </span><span class="Statement">({</span><span class="ocamlLCIdentifier">contents</span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="Constant">1</span><span class="Statement">}</span><span class="ocamlEnd"> </span><span class="Statement">as</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">repr</span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="Statement">when</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">lev</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">lev_kind</span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="Constant">Lev_function</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Constant">Event_child</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">repr<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Constant">Some</span><span class="ocamlEnd"> </span><span class="Statement">({</span><span class="ocamlLCIdentifier">contents</span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="Constant">1</span><span class="Statement">}</span><span class="ocamlEnd"> </span><span class="Statement">as</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">repr</span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Constant">Event_parent</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">repr<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Constant">Some</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">repr</span><span class="ocamlEnd"> </span><span class="Statement">when</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">lev</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">lev_kind</span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="Constant">Lev_function</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Constant">Event_parent</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">repr<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Constant">Some</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">repr</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Constant">Event_child</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">repr<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">end</span> <span class="Statement">}<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">begin</span><span class="ocamlEnd"> </span><span class="Statement">match</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">lev</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">lev_kind</span><span class="ocamlEnd"> </span><span class="Statement">with<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Constant">Lev_before</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;<br/></li>
<li><a id="L1019">&#x200c;</a></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><span class="linkable">c</span></span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L565" title="ocaml/bytecomp/bytegen.ml:565">comp_expr</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">env</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">lam</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">sz</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li><a id="L1020">&#x200c;</a></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><span class="linkable">ev</span></span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L992" title="ocaml/bytecomp/bytegen.ml:992">event</a></span><span class="ocamlEnd"> </span><span class="Constant">Event_before</span><span class="ocamlEnd"> </span><span class="Constant">Event_other</span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="#L291" title="ocaml/bytecomp/bytegen.ml:291">add_event</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L1020" title="ocaml/bytecomp/bytegen.ml:1020">ev</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L935" title="ocaml/bytecomp/bytegen.ml:935">c</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Constant">Lev_function</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;<br/></li>
<li><a id="L1023">&#x200c;</a></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><span class="linkable">c</span></span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L565" title="ocaml/bytecomp/bytegen.ml:565">comp_expr</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">env</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">lam</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">sz</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li><a id="L1024">&#x200c;</a></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><span class="linkable">ev</span></span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L992" title="ocaml/bytecomp/bytegen.ml:992">event</a></span><span class="ocamlEnd"> </span><span class="Constant">Event_pseudo</span><span class="ocamlEnd"> </span><span class="Constant">Event_function</span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="#L291" title="ocaml/bytecomp/bytegen.ml:291">add_event</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L1020" title="ocaml/bytecomp/bytegen.ml:1020">ev</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L935" title="ocaml/bytecomp/bytegen.ml:935">c</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Constant">Lev_pseudo</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;<br/></li>
<li><a id="L1027">&#x200c;</a></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><span class="linkable">c</span></span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L565" title="ocaml/bytecomp/bytegen.ml:565">comp_expr</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">env</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">lam</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">sz</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li><a id="L1028">&#x200c;</a></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><span class="linkable">ev</span></span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L992" title="ocaml/bytecomp/bytegen.ml:992">event</a></span><span class="ocamlEnd"> </span><span class="Constant">Event_pseudo</span><span class="ocamlEnd"> </span><span class="Constant">Event_other</span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="#L291" title="ocaml/bytecomp/bytegen.ml:291">add_event</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L1020" title="ocaml/bytecomp/bytegen.ml:1020">ev</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L935" title="ocaml/bytecomp/bytegen.ml:935">c</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Constant">Lev_after</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">ty</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;<br/></li>
<li><a id="L1031">&#x200c;</a></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><span class="linkable">preserve_tailcall</span></span><span class="ocamlEnd"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">match</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">lam</span><span class="ocamlEnd"> </span><span class="Statement">with<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Constant">Lprim</span><span class="Statement">(</span><span class="ocamlLCIdentifier">prim</span><span class="ocamlEnd">, </span><span class="Statement">_</span><span class="ocamlEnd">, </span><span class="Statement">_)</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L111" title="ocaml/bytecomp/bytegen.ml:111">preserve_tailcall_for_prim</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">prim<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Statement">_</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;</span><span class="ocamlEnd"> </span><span class="Constant">true<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier"><a href="#L1031" title="ocaml/bytecomp/bytegen.ml:1031">preserve_tailcall</a></span><span class="ocamlNone"> </span><span class="Statement">&amp;&amp;</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier"><a href="#L102" title="ocaml/bytecomp/bytegen.ml:102">is_tailcall</a></span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span><span class="ocamlNone"> </span><span class="Statement">then<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Comment">(* don'<a href="bytesections.mli.html#L23" title="ocaml/bytecomp/bytesections.mli:23">t</a> destroy tail call opt *)<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="#L565" title="ocaml/bytecomp/bytegen.ml:565">comp_expr</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">env</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">lam</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">sz</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">else</span><span class="ocamlEnd"> </span><span class="Statement">begin<br/></li>
<li><a id="L1040">&#x200c;</a></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><span class="linkable">info</span></span><span class="ocamlEnd"> </span><span class="Statement">=<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">match</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">lam</span><span class="ocamlEnd"> </span><span class="Statement">with<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Constant">Lapply</span><span class="Statement">{</span><span class="ocamlLCIdentifier">ap_args</span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">args</span><span class="Statement">}</span><span class="ocamlEnd">&nbsp; </span><span class="Statement">-&gt;</span><span class="ocamlEnd"> </span><span class="Constant">Event_return</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="PreProc">List</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">length</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">args</span><span class="Statement">)<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Constant">Lsend</span><span class="Statement">(_</span><span class="ocamlEnd">, </span><span class="Statement">_</span><span class="ocamlEnd">, </span><span class="Statement">_</span><span class="ocamlEnd">, </span><span class="ocamlLCIdentifier">args</span><span class="ocamlEnd">, </span><span class="Statement">_)</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;</span><span class="ocamlEnd"> </span><span class="Constant">Event_return</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="PreProc">List</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">length</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">args</span><span class="ocamlEnd"> + </span><span class="Constant">1</span><span class="Statement">)<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Constant">Lprim</span><span class="Statement">(_</span><span class="ocamlEnd">,</span><span class="ocamlLCIdentifier">args</span><span class="ocamlEnd">,</span><span class="Statement">_)</span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="Statement">-&gt;</span><span class="ocamlEnd"> </span><span class="Constant">Event_return</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="PreProc">List</span><span class="ocamlEnd">.</span><span class="ocamlLCIdentifier">length</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">args</span><span class="Statement">)<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">|</span><span class="ocamlEnd"> </span><span class="Statement">_</span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="Statement">-&gt;</span><span class="ocamlEnd"> </span><span class="Constant">Event_other<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">in<br/></li>
<li><a id="L1047">&#x200c;</a></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><span class="linkable">ev</span></span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L992" title="ocaml/bytecomp/bytegen.ml:992">event</a></span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="Constant">Event_after</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">ty</span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L1040" title="ocaml/bytecomp/bytegen.ml:1040">info</a></span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li><a id="L1048">&#x200c;</a></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><span class="linkable">cont1</span></span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L291" title="ocaml/bytecomp/bytegen.ml:291">add_event</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L1020" title="ocaml/bytecomp/bytegen.ml:1020">ev</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="#L565" title="ocaml/bytecomp/bytegen.ml:565">comp_expr</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">env</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">lam</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">sz</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L1048" title="ocaml/bytecomp/bytegen.ml:1048">cont1</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="Statement">end<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">end<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">Lifused</span> <span class="Statement">(_</span>, <span class="ocamlLCIdentifier">exp</span><span class="Statement">)</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L565" title="ocaml/bytecomp/bytegen.ml:565">comp_expr</a></span> <span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span> <span class="ocamlLCIdentifier">env</span> <span class="ocamlLCIdentifier">exp</span> <span class="ocamlLCIdentifier">sz</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a><br/></li>
<li></span><br/></li>
<li><span class="Comment">(* Compile a list of arguments [e1; ...; eN] to a primitive operation.<br/></li>
<li></span><span class="Comment">&nbsp;&nbsp; The values of eN ... e2 are pushed on the stack, e2 at top of stack,<br/></li>
<li></span><span class="Comment">&nbsp;&nbsp; then e3, then ... The value of e1 is left in the accumulator. *)<br/></li>
<li></span><br/></li>
<li><a id="L1059">&#x200c;</a><span class="Statement">and</span> <span class="ocamlLCIdentifier"><span class="linkable">comp_args</span></span> <span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span> <span class="ocamlLCIdentifier">env</span> <span class="ocamlLCIdentifier">argl</span> <span class="ocamlLCIdentifier">sz</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier">comp_expr_list</span> <span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span> <span class="ocamlLCIdentifier">env</span> <span class="Statement">(</span><span class="PreProc">List</span>.<span class="ocamlLCIdentifier">rev</span> <span class="ocamlLCIdentifier">argl</span><span class="Statement">)</span> <span class="ocamlLCIdentifier">sz</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a><br/></li>
<li></span><br/></li>
<li><span class="Statement">and</span> <span class="ocamlLCIdentifier">comp_expr_list</span> <span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span> <span class="ocamlLCIdentifier">env</span> <span class="ocamlLCIdentifier">exprl</span> <span class="ocamlLCIdentifier">sz</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span> <span class="Statement">=</span> <span class="Statement">match</span> <span class="ocamlLCIdentifier">exprl</span> <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">[]</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a><br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Statement">[</span><span class="ocamlLCIdentifier">exp</span><span class="Statement">]</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier"><a href="#L565" title="ocaml/bytecomp/bytegen.ml:565">comp_expr</a></span> <span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span> <span class="ocamlLCIdentifier">env</span> <span class="ocamlLCIdentifier">exp</span> <span class="ocamlLCIdentifier">sz</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a><br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="ocamlLCIdentifier">exp</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier">rem</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L565" title="ocaml/bytecomp/bytegen.ml:565">comp_expr</a></span> <span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span> <span class="ocamlLCIdentifier">env</span> <span class="ocamlLCIdentifier">exp</span> <span class="ocamlLCIdentifier">sz<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="Constant">Kpush</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier">comp_expr_list</span> <span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span> <span class="ocamlLCIdentifier">env</span> <span class="ocamlLCIdentifier">rem</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">sz</span>+<span class="Constant">1</span><span class="Statement">)</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li><span class="Statement">and</span> <span class="ocamlLCIdentifier">comp_exit_args</span> <span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span> <span class="ocamlLCIdentifier">env</span> <span class="ocamlLCIdentifier">argl</span> <span class="ocamlLCIdentifier">sz</span> <span class="ocamlLCIdentifier"><a href="#L985" title="ocaml/bytecomp/bytegen.ml:985">pos</a></span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp;&nbsp; <span class="ocamlLCIdentifier">comp_expr_list_assign</span> <span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span> <span class="ocamlLCIdentifier">env</span> <span class="Statement">(</span><span class="PreProc">List</span>.<span class="ocamlLCIdentifier">rev</span> <span class="ocamlLCIdentifier">argl</span><span class="Statement">)</span> <span class="ocamlLCIdentifier">sz</span> <span class="ocamlLCIdentifier"><a href="#L985" title="ocaml/bytecomp/bytegen.ml:985">pos</a></span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a><br/></li>
<li></span><br/></li>
<li><span class="Statement">and</span> <span class="ocamlLCIdentifier">comp_expr_list_assign</span> <span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span> <span class="ocamlLCIdentifier">env</span> <span class="ocamlLCIdentifier">exprl</span> <span class="ocamlLCIdentifier">sz</span> <span class="ocamlLCIdentifier"><a href="#L985" title="ocaml/bytecomp/bytegen.ml:985">pos</a></span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span> <span class="Statement">=</span> <span class="Statement">match</span> <span class="ocamlLCIdentifier">exprl</span> <span class="Statement">with<br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="Constant">[]</span> <span class="Statement">-&gt;</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a><br/></li>
<li></span>&nbsp; <span class="Statement">|</span> <span class="ocamlLCIdentifier">exp</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier">rem</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L565" title="ocaml/bytecomp/bytegen.ml:565">comp_expr</a></span> <span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span> <span class="ocamlLCIdentifier">env</span> <span class="ocamlLCIdentifier">exp</span> <span class="ocamlLCIdentifier">sz<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">(</span><span class="Constant">Kassign</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">sz</span>-<span class="ocamlLCIdentifier"><a href="#L985" title="ocaml/bytecomp/bytegen.ml:985">pos</a></span><span class="Statement">)<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement">::</span><span class="ocamlLCIdentifier">comp_expr_list_assign</span> <span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span> <span class="ocamlLCIdentifier">env</span> <span class="ocamlLCIdentifier">rem</span> <span class="ocamlLCIdentifier">sz</span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L985" title="ocaml/bytecomp/bytegen.ml:985">pos</a></span>-<span class="Constant">1</span><span class="Statement">)</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li><span class="Comment">(* Compile an if-then-else test. *)<br/></li>
<li></span><br/></li>
<li><span class="Statement">and</span> <span class="ocamlLCIdentifier">comp_binary_test</span> <span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span> <span class="ocamlLCIdentifier">env</span> <span class="ocamlLCIdentifier">cond</span> <span class="ocamlLCIdentifier">ifso</span> <span class="ocamlLCIdentifier">ifnot</span> <span class="ocamlLCIdentifier">sz</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">cont_cond</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">ifnot</span><span class="ocamlNone"> </span><span class="Statement">=</span><span class="ocamlNone"> </span><span class="Constant">Lconst</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">const_unit</span><span class="ocamlNone"> </span><span class="Statement">then</span> <span class="Statement">begin<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="ocamlLCIdentifier">lbl_end</span><span class="ocamlEnd">, </span><span class="ocamlLCIdentifier"><a href="#L1048" title="ocaml/bytecomp/bytegen.ml:1048">cont1</a></span><span class="Statement">)</span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L57" title="ocaml/bytecomp/bytegen.ml:57">label_code</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; &nbsp; </span><span class="Constant">Kstrictbranchifnot</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">lbl_end</span><span class="ocamlEnd"> </span><span class="Statement">::</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L565" title="ocaml/bytecomp/bytegen.ml:565">comp_expr</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">env</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">ifso</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">sz</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L1048" title="ocaml/bytecomp/bytegen.ml:1048">cont1</a><br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="Statement">end</span> <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">match</span> <span class="ocamlLCIdentifier"><a href="#L358" title="ocaml/bytecomp/bytegen.ml:358">code_as_jump</a></span> <span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span> <span class="ocamlLCIdentifier">ifso</span> <span class="ocamlLCIdentifier">sz</span> <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Some</span> <span class="ocamlLCIdentifier"><a href="instruct.ml.html#L51" title="ocaml/bytecomp/instruct.ml:51">label</a></span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="#L565" title="ocaml/bytecomp/bytegen.ml:565">comp_expr</a></span> <span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span> <span class="ocamlLCIdentifier">env</span> <span class="ocamlLCIdentifier">ifnot</span> <span class="ocamlLCIdentifier">sz</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Constant">Kbranchif</span> <span class="ocamlLCIdentifier"><a href="instruct.ml.html#L51" title="ocaml/bytecomp/instruct.ml:51">label</a></span> <span class="Statement">::</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a><br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">None</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">match</span> <span class="ocamlLCIdentifier"><a href="#L358" title="ocaml/bytecomp/bytegen.ml:358">code_as_jump</a></span> <span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span> <span class="ocamlLCIdentifier">ifnot</span> <span class="ocamlLCIdentifier">sz</span> <span class="Statement">with<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">Some</span> <span class="ocamlLCIdentifier"><a href="instruct.ml.html#L51" title="ocaml/bytecomp/instruct.ml:51">label</a></span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="#L565" title="ocaml/bytecomp/bytegen.ml:565">comp_expr</a></span> <span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span> <span class="ocamlLCIdentifier">env</span> <span class="ocamlLCIdentifier">ifso</span> <span class="ocamlLCIdentifier">sz</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">Kbranchifnot</span> <span class="ocamlLCIdentifier"><a href="instruct.ml.html#L51" title="ocaml/bytecomp/instruct.ml:51">label</a></span> <span class="Statement">::</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a><br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">|</span> <span class="Constant">None</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">branch_end</span>, <span class="ocamlLCIdentifier"><a href="#L1048" title="ocaml/bytecomp/bytegen.ml:1048">cont1</a></span><span class="Statement">)</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="#L77" title="ocaml/bytecomp/bytegen.ml:77">make_branch</a></span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">let</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">lbl_not</span>, <span class="ocamlLCIdentifier">cont2</span><span class="Statement">)</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L57" title="ocaml/bytecomp/bytegen.ml:57">label_code</a></span><span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L565" title="ocaml/bytecomp/bytegen.ml:565">comp_expr</a></span> <span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span> <span class="ocamlLCIdentifier">env</span> <span class="ocamlLCIdentifier">ifnot</span> <span class="ocamlLCIdentifier">sz</span> <span class="ocamlLCIdentifier"><a href="#L1048" title="ocaml/bytecomp/bytegen.ml:1048">cont1</a></span><span class="Statement">)</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">Kbranchifnot</span> <span class="ocamlLCIdentifier">lbl_not</span> <span class="Statement">::<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L565" title="ocaml/bytecomp/bytegen.ml:565">comp_expr</a></span> <span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span> <span class="ocamlLCIdentifier">env</span> <span class="ocamlLCIdentifier">ifso</span> <span class="ocamlLCIdentifier">sz</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">branch_end</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier">cont2</span><span class="Statement">)</span> <span class="Statement">in<br/></li>
<li></span><br/></li>
<li>&nbsp; <span class="ocamlLCIdentifier"><a href="#L565" title="ocaml/bytecomp/bytegen.ml:565">comp_expr</a></span> <span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span> <span class="ocamlLCIdentifier">env</span> <span class="ocamlLCIdentifier">cond</span> <span class="ocamlLCIdentifier">sz</span> <span class="ocamlLCIdentifier">cont_cond<br/></li>
<li></span><br/></li>
<li><span class="Comment">(**** Compilation of a code block (with tracking of stack usage) ****)<br/></li>
<li></span><br/></li>
<li><a id="L1107">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">comp_block</span></span> <span class="ocamlLCIdentifier">env</span> <span class="ocamlLCIdentifier">exp</span> <span class="ocamlLCIdentifier">sz</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="#L334" title="ocaml/bytecomp/bytegen.ml:334">create_stack_info</a></span> <span class="Constant">()</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">code</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="#L565" title="ocaml/bytecomp/bytegen.ml:565">comp_expr</a></span> <span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span> <span class="ocamlLCIdentifier">env</span> <span class="ocamlLCIdentifier">exp</span> <span class="ocamlLCIdentifier">sz</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">used_safe</span> <span class="Statement">=</span> <span class="Statement">!(</span><span class="ocamlLCIdentifier"><a href="#L325" title="ocaml/bytecomp/bytegen.ml:325">stack_info</a></span>.<span class="ocamlLCIdentifier">max_stack_used</span><span class="Statement">)</span> + <span class="PreProc">Config</span>.<span class="ocamlLCIdentifier">stack_safety_margin</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">used_safe</span><span class="ocamlNone"> </span><span class="Statement">&gt;</span><span class="ocamlNone"> </span><span class="PreProc">Config</span><span class="ocamlNone">.</span><span class="ocamlLCIdentifier">stack_threshold</span><span class="ocamlNone"> </span><span class="Statement">then<br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">Kconst</span><span class="Statement">(</span><span class="Constant">Const_base</span><span class="Statement">(</span><span class="Constant">Const_int</span> <span class="ocamlLCIdentifier">used_safe</span><span class="Statement">))</span> <span class="Statement">::<br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">Kccall</span><span class="Statement">(</span><span class="Constant">&quot;caml_ensure_stack_capacity&quot;</span>, <span class="Constant">1</span><span class="Statement">)</span> <span class="Statement">::<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier">code<br/></li>
<li></span>&nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier">code<br/></li>
<li></span><br/></li>
<li><span class="Comment">(**** Compilation of functions ****)<br/></li>
<li></span><br/></li>
<li><a id="L1120">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">comp_function</span></span> <span class="ocamlLCIdentifier">tc</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">arity</span> <span class="Statement">=</span> <span class="PreProc">List</span>.<span class="ocamlLCIdentifier">length</span> <span class="ocamlLCIdentifier">tc</span>.<span class="ocamlLCIdentifier">params</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="Statement">rec</span> <span class="ocamlLCIdentifier">positions</span> <span class="ocamlLCIdentifier"><a href="#L985" title="ocaml/bytecomp/bytegen.ml:985">pos</a></span> <span class="ocamlLCIdentifier">delta</span> <span class="Statement">=</span> <span class="Statement">function<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="Constant">[]</span> <span class="Statement">-&gt;</span> <span class="PreProc">Ident</span>.<span class="ocamlLCIdentifier"><a href="symtable.ml.html#L44" title="ocaml/bytecomp/symtable.ml:44">empty</a><br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">|</span> <span class="ocamlLCIdentifier">id</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier">rem</span> <span class="Statement">-&gt;</span> <span class="PreProc">Ident</span>.<span class="ocamlLCIdentifier">add</span> <span class="ocamlLCIdentifier">id</span> <span class="ocamlLCIdentifier"><a href="#L985" title="ocaml/bytecomp/bytegen.ml:985">pos</a></span> <span class="Statement">(</span><span class="ocamlLCIdentifier">positions</span> <span class="Statement">(</span><span class="ocamlLCIdentifier"><a href="#L985" title="ocaml/bytecomp/bytegen.ml:985">pos</a></span> + <span class="ocamlLCIdentifier">delta</span><span class="Statement">)</span> <span class="ocamlLCIdentifier">delta</span> <span class="ocamlLCIdentifier">rem</span><span class="Statement">)</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">env</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">{</span> <span class="ocamlLCIdentifier">ce_stack</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">positions</span> <span class="ocamlLCIdentifier">arity</span> <span class="Statement">(</span>-<span class="Constant">1</span><span class="Statement">)</span> <span class="ocamlLCIdentifier">tc</span>.<span class="ocamlLCIdentifier">params</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">ce_heap</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">positions</span> <span class="Statement">(</span><span class="Constant">3</span> <span class="Statement">*</span> <span class="Statement">(</span><span class="ocamlLCIdentifier">tc</span>.<span class="ocamlLCIdentifier">num_defs</span> - <span class="ocamlLCIdentifier">tc</span>.<span class="ocamlLCIdentifier">rec_pos</span><span class="Statement">)</span> - <span class="Constant">1</span><span class="Statement">)</span> <span class="Constant">1</span> <span class="ocamlLCIdentifier">tc</span>.<span class="ocamlLCIdentifier">free_vars</span><span class="Statement">;<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; <span class="ocamlLCIdentifier">ce_rec</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">positions</span> <span class="Statement">(</span>-<span class="Constant">3</span> <span class="Statement">*</span> <span class="ocamlLCIdentifier">tc</span>.<span class="ocamlLCIdentifier">rec_pos</span><span class="Statement">)</span> <span class="Constant">3</span> <span class="ocamlLCIdentifier">tc</span>.<span class="ocamlLCIdentifier">rec_vars</span> <span class="Statement">}</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier"><a href="#L1107" title="ocaml/bytecomp/bytegen.ml:1107">comp_block</a></span> <span class="ocamlLCIdentifier">env</span> <span class="ocamlLCIdentifier">tc</span>.<span class="ocamlLCIdentifier">body</span> <span class="ocamlLCIdentifier">arity</span> <span class="Statement">(</span><span class="Constant">Kreturn</span> <span class="ocamlLCIdentifier">arity</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span><span class="Statement">)</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier">arity</span><span class="ocamlNone"> </span><span class="Statement">&gt;</span><span class="ocamlNone"> </span><span class="Constant">1</span><span class="ocamlNone"> </span><span class="Statement">then<br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">Krestart</span> <span class="Statement">::</span> <span class="Constant">Klabel</span> <span class="ocamlLCIdentifier">tc</span>.<span class="ocamlLCIdentifier"><a href="instruct.ml.html#L51" title="ocaml/bytecomp/instruct.ml:51">label</a></span> <span class="Statement">::</span> <span class="Constant">Kgrab</span><span class="Statement">(</span><span class="ocamlLCIdentifier">arity</span> - <span class="Constant">1</span><span class="Statement">)</span> <span class="Statement">::</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a><br/></li>
<li></span>&nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; <span class="Constant">Klabel</span> <span class="ocamlLCIdentifier">tc</span>.<span class="ocamlLCIdentifier"><a href="instruct.ml.html#L51" title="ocaml/bytecomp/instruct.ml:51">label</a></span> <span class="Statement">::</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a><br/></li>
<li></span><br/></li>
<li><span class="Statement">let</span> <span class="ocamlLCIdentifier">comp_remainder</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier"><a href="#L935" title="ocaml/bytecomp/bytegen.ml:935">c</a></span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">ref</span> <span class="ocamlLCIdentifier"><a href="#L627" title="ocaml/bytecomp/bytegen.ml:627">cont</a></span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">begin</span><span class="ocamlEnd"> </span><span class="Statement">try<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="Statement">while</span><span class="ocamlEnd"> </span><span class="Constant">true</span><span class="ocamlEnd"> </span><span class="Statement">do<br/></li>
<li></span><span class="ocamlDo">&nbsp; &nbsp; &nbsp; </span><span class="ocamlLCIdentifier"><a href="#L935" title="ocaml/bytecomp/bytegen.ml:935">c</a></span><span class="ocamlDo"> </span><span class="Statement">:=</span><span class="ocamlDo"> </span><span class="ocamlLCIdentifier"><a href="#L1120" title="ocaml/bytecomp/bytegen.ml:1120">comp_function</a></span><span class="ocamlDo"> </span><span class="Statement">(</span><span class="PreProc">Stack</span><span class="ocamlDo">.</span><span class="ocamlLCIdentifier">pop</span><span class="ocamlDo"> </span><span class="ocamlLCIdentifier"><a href="#L378" title="ocaml/bytecomp/bytegen.ml:378">functions_to_compile</a></span><span class="Statement">)</span><span class="ocamlDo"> </span><span class="Statement">!</span><span class="ocamlLCIdentifier"><a href="#L935" title="ocaml/bytecomp/bytegen.ml:935">c</a><br/></li>
<li></span><span class="ocamlDo">&nbsp; &nbsp; </span><span class="Statement">done<br/></li>
<li></span><span class="ocamlEnd">&nbsp; </span><span class="Statement">with</span><span class="ocamlEnd"> </span><span class="PreProc">Stack</span><span class="ocamlEnd">.</span><span class="Constant">Empty</span><span class="ocamlEnd"> </span><span class="Statement">-&gt;<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="Constant">()<br/></li>
<li></span><span class="ocamlEnd">&nbsp; </span><span class="Statement">end;<br/></li>
<li></span>&nbsp; <span class="Statement">!</span><span class="ocamlLCIdentifier"><a href="#L935" title="ocaml/bytecomp/bytegen.ml:935">c</a><br/></li>
<li></span><br/></li>
<li><span class="Comment">(**** Compilation of a lambda phrase ****)<br/></li>
<li></span><br/></li>
<li><a id="L1149">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">reset</span></span> <span class="Constant">()</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier"><a href="#L29" title="ocaml/bytecomp/bytegen.ml:29">label_counter</a></span> <span class="Statement">:=</span> <span class="Constant">0</span><span class="Statement">;<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier"><a href="#L382" title="ocaml/bytecomp/bytegen.ml:382">compunit_name</a></span> <span class="Statement">:=</span> <span class="Constant">&quot;&quot;</span><span class="Statement">;<br/></li>
<li></span>&nbsp; <span class="PreProc">Stack</span>.<span class="ocamlLCIdentifier"><a href="emitcode.ml.html#L184" title="ocaml/bytecomp/emitcode.ml:184">clear</a></span> <span class="ocamlLCIdentifier"><a href="#L378" title="ocaml/bytecomp/bytegen.ml:378">functions_to_compile</a><br/></li>
<li></span><br/></li>
<li><a id="L1154">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">compile_implementation</span></span> <span class="ocamlLCIdentifier">modulename</span> <span class="ocamlLCIdentifier">expr</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier"><a href="bytelibrarian.mli.html#L37" title="ocaml/bytecomp/bytelibrarian.mli:37">reset</a></span> <span class="Constant">()</span><span class="Statement">;<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier"><a href="#L382" title="ocaml/bytecomp/bytegen.ml:382">compunit_name</a></span> <span class="Statement">:=</span> <span class="ocamlLCIdentifier">modulename</span><span class="Statement">;<br/></li>
<li></span>&nbsp; <span class="PreProc">Fun</span>.<span class="ocamlLCIdentifier">protect</span> <span class="Statement">~</span><span class="Identifier">finally</span>:<span class="ocamlLCIdentifier"><a href="bytelibrarian.mli.html#L37" title="ocaml/bytecomp/bytelibrarian.mli:37">reset</a></span> <span class="Statement">(fun</span> <span class="Constant">()</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">init_code</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="#L1107" title="ocaml/bytecomp/bytegen.ml:1107">comp_block</a></span> <span class="ocamlLCIdentifier"><a href="#L36" title="ocaml/bytecomp/bytegen.ml:36">empty_env</a></span> <span class="ocamlLCIdentifier">expr</span> <span class="Constant">0</span> <span class="Constant">[]</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">if</span><span class="ocamlNone"> </span><span class="PreProc">Stack</span><span class="ocamlNone">.</span><span class="ocamlLCIdentifier">length</span><span class="ocamlNone"> </span><span class="ocamlLCIdentifier"><a href="#L378" title="ocaml/bytecomp/bytegen.ml:378">functions_to_compile</a></span><span class="ocamlNone"> </span><span class="Statement">&gt;</span><span class="ocamlNone"> </span><span class="Constant">0</span><span class="ocamlNone"> </span><span class="Statement">then</span> <span class="Statement">begin<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="Statement">let</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">lbl_init</span><span class="ocamlEnd"> </span><span class="Statement">=</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier"><a href="#L31" title="ocaml/bytecomp/bytegen.ml:31">new_label</a></span><span class="Constant">()</span><span class="ocamlEnd"> </span><span class="Statement">in<br/></li>
<li></span><span class="ocamlEnd">&nbsp; &nbsp; </span><span class="Constant">Kbranch</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">lbl_init</span><span class="ocamlEnd"> </span><span class="Statement">::</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">comp_remainder</span><span class="ocamlEnd"> </span><span class="Statement">(</span><span class="Constant">Klabel</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">lbl_init</span><span class="ocamlEnd"> </span><span class="Statement">::</span><span class="ocamlEnd"> </span><span class="ocamlLCIdentifier">init_code</span><span class="Statement">)<br/></li>
<li></span><span class="ocamlEnd">&nbsp; </span><span class="Statement">end</span> <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; <span class="ocamlLCIdentifier">init_code</span><span class="Statement">)<br/></li>
<li></span><br/></li>
<li><a id="L1165">&#x200c;</a><span class="Statement">let</span> <span class="ocamlLCIdentifier"><span class="linkable">compile_phrase</span></span> <span class="ocamlLCIdentifier">expr</span> <span class="Statement">=<br/></li>
<li></span>&nbsp; <span class="ocamlLCIdentifier"><a href="bytelibrarian.mli.html#L37" title="ocaml/bytecomp/bytelibrarian.mli:37">reset</a></span> <span class="Constant">()</span><span class="Statement">;<br/></li>
<li></span>&nbsp; <span class="PreProc">Fun</span>.<span class="ocamlLCIdentifier">protect</span> <span class="Statement">~</span><span class="Identifier">finally</span>:<span class="ocamlLCIdentifier"><a href="bytelibrarian.mli.html#L37" title="ocaml/bytecomp/bytelibrarian.mli:37">reset</a></span> <span class="Statement">(fun</span> <span class="Constant">()</span> <span class="Statement">-&gt;<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">init_code</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier"><a href="#L1107" title="ocaml/bytecomp/bytegen.ml:1107">comp_block</a></span> <span class="ocamlLCIdentifier"><a href="#L36" title="ocaml/bytecomp/bytegen.ml:36">empty_env</a></span> <span class="ocamlLCIdentifier">expr</span> <span class="Constant">1</span> <span class="Statement">[</span><span class="Constant">Kreturn</span> <span class="Constant">1</span><span class="Statement">]</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">let</span> <span class="ocamlLCIdentifier">fun_code</span> <span class="Statement">=</span> <span class="ocamlLCIdentifier">comp_remainder</span> <span class="Constant">[]</span> <span class="Statement">in<br/></li>
<li></span>&nbsp; <span class="Statement">(</span><span class="ocamlLCIdentifier">init_code</span>, <span class="ocamlLCIdentifier">fun_code</span><span class="Statement">))<br/></li>
</ol></span></code>
 <p class="nav-bar">
  <span class="nav-link"><a href="./index.html">One Level Up</a></span>
  <span class="nav-link"><a href="index.html">Top Level</a></span>
 </p>

 </body>
</html>
